<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title> Vaping Behaviors in American Youth</title>

<html>

<head>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-X2TLEM9MLD"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-X2TLEM9MLD');
</script>
</head>

<body>


</body>
</html>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="www/style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#section-TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#section-TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="section-TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="fluid-row" id="section-header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore"><p><img src="https://opencasestudies.github.io/img/icon-bahi.png" align="left" width="140" /><br />
Vaping Behaviors in American Youth</p></h1>

</div>


<p>
 
</p>
<div id="section-section" class="section level4 outline">
<h4></h4>
<p><img src="www/img/final_plot.png" width="800 px" style="display: block; margin: auto;" /></p>
</div>
<div id="section-section-1" class="section level4">
<h4></h4>
</div>
<div id="section-section-2" class="section level4 disclaimer_block">
<h4></h4>
<p><strong>Disclaimer</strong>: The purpose of the <a href="https://opencasestudies.github.io" target="_blank">Open Case Studies</a> project is <strong>to demonstrate the use of various data science methods, tools, and software in the context of messy, real-world data</strong>. A given case study does not cover all aspects of the research process, is not claiming to be the most appropriate way to analyze a given data set, and should not be used in the context of making policy decisions without external consultation from scientific experts.</p>
</div>
<div id="section-section-3" class="section level4">
<h4></h4>
</div>
<div id="section-section-4" class="section level4 license_block">
<h4></h4>
<p>This work is licensed under the Creative Commons Attribution-NonCommercial 3.0 <a href="https://creativecommons.org/licenses/by-nc/3.0/us/" target="_blank">(CC BY-NC 3.0)</a> United States License.</p>
</div>
<div id="section-section-5" class="section level4">
<h4></h4>
</div>
<div id="section-section-6" class="section level4 reference_block">
<h4></h4>
<p>To cite this case study please use:</p>
<p>Wright, Carrie and Ontiveros, Michael and Jager, Leah and Taub, Margaret and Hicks, Stephanie. (2020). <a href="https://github.com/opencasestudies/ocs-bp-vaping-case-study" class="uri">https://github.com/opencasestudies/ocs-bp-vaping-case-study</a>. Vaping Behaviors in American Youth (Version v1.0.0).</p>
</div>
<div id="section-section-7" class="section level4">
<h4></h4>
<p>To access the GitHub Repository for this case study see here: <a href="https://github.com/opencasestudies/ocs-bp-vaping-case-study" class="uri">https://github.com/opencasestudies/ocs-bp-vaping-case-study</a></p>
<p>This case study is part of a series of public health case studies for the <a href="https://americanhealth.jhu.edu/open-case-studies">Bloomberg American Health Initiative</a>.</p>
</div>
<div id="section-motivation" class="section level2">
<h2><strong>Motivation</strong></h2>
<hr />
<p>In the United States, there have been significant and historical declines in cigarette smoking. In the 1970s, 75% of high school seniors were smoking, that number is below 10% now. This progress is largely due to the tobacco control movement and their focus on initiatives like ending advertising to children (like Joe Camel), passing indoor smoking laws, health communication, etc.</p>
<p>According to a recent <a href="https://www.cdc.gov/mmwr/volumes/68/wr/mm6806e1.htm?s_cid=mm6806e1_w" target="_blank">report</a>, overall tobacco use <strong>increased</strong> in youths (middle school and high school students) in the United States in 2017 and 2018, despite previous years of declining use.</p>
<p>This major increase is attributed to an increase in the use of electronic cigarette (e-cigarette) products.</p>
<p>E-cigarettes are referred to by many different names, including but not limited to:</p>
<ol style="list-style-type: decimal">
<li>Electronic nicotine delivery systems (ENDS)</li>
<li>Vapes</li>
<li>e-hookahs</li>
<li>vape pens</li>
<li>tanks</li>
<li>mods</li>
</ol>
<p>The devices vary greatly:</p>
<p><img src="https://www.lung.org/getmedia/8ac8ab8c-e7fc-497b-8384-441615f50ff0/ecigs_K.jpg.jpg" width="90%" style="display: block; margin: auto;" /></p>
<div id="section-source" class="section level5">
<h5>[<a href="https://www.lung.org/quit-smoking/e-cigarettes-vaping/lung-health">source</a>]</h5>
<p>See this <a href="https://www.cdc.gov/tobacco/basic_information/e-cigarettes/pdfs/ecigarette-or-vaping-products-visual-dictionary-508.pdf" target="_blank">CDC guide</a> and the <a href="https://www.lung.org/quit-smoking/e-cigarettes-vaping/lung-health" target="_blank">American Lung Association website</a> for more information.</p>
<p>The report found that:</p>
<blockquote>
<p>During 2017–2018, current use of any tobacco product <strong>increased 38.3%</strong> (from 19.6% to 27.1%) among high school students and <strong>28.6%</strong> (from 5.6% to 7.2%) among middle school students; e-cigarette use <strong>increased 77.8%</strong> (from 11.7% to 20.8%) among high school students and <strong>48.5%</strong> (from 3.3% to 4.9%) among middle school students.</p>
</blockquote>
<p>In 2018, the <a href="https://acsjournals.onlinelibrary.wiley.com/doi/full/10.1002/cncr.31868" target="_blank">Federal Drug Administration (FDA) in the United States</a> stated that e-cigarette usage use among youth reached:</p>
<blockquote>
<p>“nothing short of an <strong>epidemic proportion of growth</strong>”</p>
</blockquote>
<p>In this case study, we will be investigating the same data used in the report that generated the above findings. This data comes from the <a href="https://www.cdc.gov/tobacco/data_statistics/surveys/nyts/index.htm" target="_blank">The National Youth Tobacco Survey (NYTS)</a>.</p>
</div>
<div id="section-section-8" class="section level4 reference_block">
<h4></h4>
<p>Gentzke, Andrea S., Melisa Creamer, Karen A. Cullen, Bridget K. Ambrose, Gordon Willis, Ahmed Jamal, and Brian A. King. “Vital Signs: Tobacco Product Use Among Middle and High School Students - United States, 2011-2018.” <strong>MMWR. Morbidity and Mortality Weekly Report</strong> 68 (6): 157–64 (2019).</p>
</div>
<div id="section-section-9" class="section level4">
<h4></h4>
</div>
</div>
<div id="section-main-questions" class="section level2">
<h2><strong>Main Questions</strong></h2>
<hr />
<div id="section-section-10" class="section level4 main_question_block">
<h4></h4>
<p><b><u> Our main question: </u></b></p>
<ol style="list-style-type: decimal">
<li>How has tobacco and e-cigarette/vaping use by American youths changed since 2015?</li>
<li>How does e-cigarette use compare between males and females?</li>
<li>What vaping brands and flavors appear to be used the most frequently?<br />
We will base this on the following survey questions:</li>
</ol>
<blockquote>
<p>“During the past 30 days, what brand of e-cigarettes did you usually use?”<br />
“What flavors of tobacco products have you used in the past 30 days?”</p>
</blockquote>
<ol start="4" style="list-style-type: decimal">
<li>Is there a relationship between e-cigarette/vaping use and other tobacco use?</li>
</ol>
</div>
<div id="section-section-11" class="section level4">
<h4></h4>
</div>
</div>
<div id="section-learning-objectives" class="section level2">
<h2><strong>Learning Objectives</strong></h2>
<hr />
<p>In this case study, we will cover how to import data from multiple files efficiently, how to import data from excel files, and how to make a variety of visualizations to compare multiple groups across time. We will also demonstrate how to work with codebooks. We will cover the concept of survey weighting and introduce the <code>srvyr</code> package. We will discuss the difference between pooled cross-sectional data and panel data. We will especially focus on using packages and functions from the <a href="https://www.tidyverse.org/" target="_blank"><code>Tidyverse</code></a> for wrangling data, such as <code>tidyr</code> and <code>dplyr</code> and for visualization, such as as <code>ggplot2</code>. The Tidyverse is a library of packages created by RStudio. While some students may be familiar with previous R programming packages, these packages make data science in R especially efficient.</p>
<p><img src="https://tidyverse.tidyverse.org/logo.png" width="20%" style="display: block; margin: auto;" /></p>
<p>The skills, methods, and concepts that students will be familiar with by the end of this case study are:</p>
<p><u><strong>Data Science Learning Objectives:</strong></u></p>
<ol style="list-style-type: decimal">
<li>Import data from Excel files</li>
<li>Merge data from multiple similar but not identical data structures</li>
<li>Create effective longitudinal data visualizations</li>
<li>Write functions in R</li>
<li>Apply functions across data subsets using <code>purrr</code> and <code>dplyr</code> functionality.</li>
</ol>
<p><u><strong>Statistical Learning Objectives:</strong></u></p>
<ol style="list-style-type: decimal">
<li>Understanding of different types of longitudinal data</li>
<li>Usage of codebooks</li>
<li>Conceptual understanding of survey weighting</li>
<li>Implementing logistic regression with survey weighting</li>
</ol>
<hr />
<p>We will begin by loading the packages that we will need:</p>
<div class="sourceCode" id="section-cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">library</span>(here)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="kw">library</span>(readxl)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="kw">library</span>(magrittr)</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="kw">library</span>(stringr)</span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="kw">library</span>(purrr)</span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="kw">library</span>(dplyr)</span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="kw">library</span>(readr)</span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="kw">library</span>(tidyr)</span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="kw">library</span>(scales)</span>
<span id="cb1-11"><a href="#cb1-11"></a><span class="kw">library</span>(viridis)</span>
<span id="cb1-12"><a href="#cb1-12"></a><span class="kw">library</span>(forcats)</span>
<span id="cb1-13"><a href="#cb1-13"></a><span class="kw">library</span>(naniar)</span>
<span id="cb1-14"><a href="#cb1-14"></a><span class="kw">library</span>(srvyr)</span>
<span id="cb1-15"><a href="#cb1-15"></a><span class="kw">library</span>(cowplot)</span>
<span id="cb1-16"><a href="#cb1-16"></a><span class="kw">library</span>(broom)</span>
<span id="cb1-17"><a href="#cb1-17"></a><span class="kw">library</span>(survey)</span></code></pre></div>
<p><u><strong>Packages used in this case study:</strong></u></p>
<table>
<colgroup>
<col width="43%" />
<col width="56%" />
</colgroup>
<thead>
<tr class="header">
<th>Package</th>
<th>Use in this case study</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="https://github.com/jennybc/here_here" target="_blank">here</a></td>
<td>to easily load and save data</td>
</tr>
<tr class="even">
<td><a href="https://readxl.tidyverse.org/" target="_blank">readxl</a></td>
<td>to import the data in the excel files</td>
</tr>
<tr class="odd">
<td><a href="https://cran.r-project.org/web/packages/magrittr/vignettes/magrittr.html" target="_blank">magrittr</a></td>
<td>to use the compound assignment pipe operator <code>%&lt;&gt;%</code></td>
</tr>
<tr class="even">
<td><a href="https://stringr.tidyverse.org/articles/stringr.html" target="_blank">stringr</a></td>
<td>to manipulate the character strings within the data</td>
</tr>
<tr class="odd">
<td><a href="https://purrr.tidyverse.org/" target="_blank">purrr</a></td>
<td>to import the data in all the different excel and csv files efficiently</td>
</tr>
<tr class="even">
<td><a href="https://dplyr.tidyverse.org/" target="_blank">dplyr</a></td>
<td>to arrange/filter/select/compare specific subsets of the data</td>
</tr>
<tr class="odd">
<td><a href="https://readr.tidyverse.org/" target="_blank">readr</a></td>
<td>to import the CSV file data</td>
</tr>
<tr class="even">
<td><a href="https://tidyr.tidyverse.org/" target="_blank">tidyr</a></td>
<td>to rearrange data in wide and long formats</td>
</tr>
<tr class="odd">
<td><a href="https://ggplot2.tidyverse.org/" target="_blank">ggplot2</a></td>
<td>to make visualizations with multiple layers</td>
</tr>
<tr class="even">
<td><a href="https://cran.r-project.org/web/packages/scales/scales.pdf" target="_blank">scales</a></td>
<td>to allow us to look at the colors within the viridis package</td>
</tr>
<tr class="odd">
<td><a href="https://cran.r-project.org/web/packages/viridis/vignettes/intro-to-viridis.html" target="_blank">viridis</a></td>
<td>to make plots with a color palette that is compatible with color blindness</td>
</tr>
<tr class="even">
<td><a href="https://forcats.tidyverse.org/" target="_blank">forcats</a></td>
<td>to allow for reordering of factors in plots</td>
</tr>
<tr class="odd">
<td><a href="https://cran.r-project.org/web/packages/naniar/vignettes/getting-started-w-naniar.html" target="_blank">naniar</a></td>
<td>to make a visualization of missing data</td>
</tr>
<tr class="even">
<td><a href="https://cran.r-project.org/web/packages/srvyr/srvyr.pdf" target="_blank">syrvr</a></td>
<td>to use survey weights</td>
</tr>
<tr class="odd">
<td><a href="https://cran.r-project.org/web/packages/cowplot/vignettes/introduction.html" target="_blank">cowplot</a></td>
<td>to allow plots to be combined</td>
</tr>
<tr class="even">
<td><a href="https://cran.r-project.org/web/packages/broom/vignettes/broom.html" target="_blank">broom</a></td>
<td>to create nicely formatted model output</td>
</tr>
<tr class="odd">
<td><a href="http://r-survey.r-forge.r-project.org/survey/index.html" target="_blank">survey</a></td>
<td>to fit survey-weighted logistic regression</td>
</tr>
</tbody>
</table>
<p>The first time we use a function, we will use the <code>::</code> to indicate which package we are using. Unless we have overlapping function names, this is not necessary, but we will include it here to be informative about where the functions we will use come from.</p>
</div>
<div id="section-context" class="section level2">
<h2><strong>Context</strong></h2>
<hr />
<p>According to the cited <a href="https://www.cdc.gov/mmwr/volumes/68/wr/mm6806e1.htm?s_cid=mm6806e1_w">Morbidity and Mortality Weekly Report</a> this was what was already known about this topic and the implications of this study:</p>
<p><img src="www/img/context.png" width="800 px" style="display: block; margin: auto;" /></p>
<div id="section-source-1" class="section level4">
<h4><span target="_blank"><a href="https://www.cdc.gov/mmwr/volumes/68/wr/mm6806e1.htm?s_cid=mm6806e1_w">source</a></span></h4>
<p>Importantly, the vapors used in e-cigarettes contain harmful chemicals:</p>
<p><img src="www/img/e-cigarette-aerosol-can-contain-harmful-ingredients.jpg" width="90%" style="display: block; margin: auto;" /></p>
</div>
<div id="section-source-2" class="section level4">
<h4><span target="_blank"><a href="https://www.cdc.gov/tobacco/basic_information/e-cigarettes/images/e-cigarette-aerosol-can-contain-harmful-ingredients-desktop-700.jpg">source</a></span></h4>
<p>E-cigarette usage has also been associated with <a href="(https://www.frontiersin.org/articles/10.3389/fphar.2019.01619/full)" target="_blank">lung injury</a>:</p>
<p><img src="www/img/lung.png" width="800 px" style="display: block; margin: auto;" /></p>
</div>
<div id="section-source-3" class="section level4">
<h4><span target="_blank"><a href="https://www.frontiersin.org/articles/10.3389/fphar.2019.01619/full">source</a></span></h4>
<p>See <a href="https://www.cdc.gov/tobacco/basic_information/e-cigarettes/Quick-Facts-on-the-Risks-of-E-cigarettes-for-Kids-Teens-and-Young-Adults.html" target="_blank">here</a> for additional information about the potential health effects of e-cigarettes in teens and young adults.</p>
</div>
</div>
<div id="section-limitations" class="section level2">
<h2><strong>Limitations</strong></h2>
<hr />
<p>There are some important considerations regarding this data analysis to keep in mind:</p>
<ol style="list-style-type: decimal">
<li>The <a href="https://www.cdc.gov/tobacco/data_statistics/surveys/nyts/index.htm" target="_blank">National Youth Tobacco Survey (NYTS)</a> does not follow the same individual student respondents over time. A <a href="https://www.bmj.com/about-bmj/resources-readers/publications/epidemiology-uninitiated/7-longitudinal-studies" target="_blank">longitudinal study</a> that does follow the same individuals over time collects data called <a href="https://en.wikipedia.org/wiki/Panel_data" target="_blank">panel data</a>. The data in this study is called pooled <a href="https://en.wikipedia.org/wiki/Cross-sectional_data" target="_blank">cross-sectional data</a>, and is obtained from random collection of observations across time.</li>
</ol>
<p>According to Wikipedia:</p>
<blockquote>
<p>Panel data differs from pooled cross-sectional data across time, because it deals with the observations on the same subjects in different times whereas the latter observes different subjects in different time periods</p>
</blockquote>
<ol start="2" style="list-style-type: decimal">
<li>The data include percentages of student respondents reporting use of each particular tobacco product, but the survey questions did not ask the relative amount of use of one product compared to another. For example, the survey included questions like:“What flavors of tobacco products have you used in the past 30 days?” but did not ask how often one flavor was used by the same individual over another.</li>
</ol>
<p>While <a href="https://www.genderspectrum.org/quick-links/understanding-gender/" target="_blank">gender</a> and <a href="https://www.who.int/genomics/gender/en/index1.html" target="_blank">sex</a> are not actually binary, the data used in this analysis only contain information for groups of individuals who answered the survey questions as male or female.</p>
</div>
<div id="section-what-are-the-data" class="section level2">
<h2><strong>What are the data?</strong></h2>
<hr />
<p>The data in this case study comes from the <a href="https://www.cdc.gov/tobacco/data_statistics/surveys/nyts/index.htm" target="_blank">National Youth Tobacco Survey (NYTS)</a> which is an annual survey that asks students in high school and middle school (grades 6-12) about tobacco usage in the United States of America.</p>
<p>The data for this survey is freely available online at this <a href="https://www.cdc.gov/tobacco/data_statistics/surveys/nyts/data/index.html" target="_blank">website</a> with data from 1999, 2000, 2002, 2004, 2006, 2009, and 2011-2019. We will be using data from <strong>2015-2019</strong> due to the fact that these years are the most recent that asked questions regarding e-cigarette usage.</p>
<p>Each year includes documentation, such as a <a href="https://www.lib.ncsu.edu/data/icpsrfaq#whatare" target="_blank">codebook</a> and an excel file containing the data:</p>
<p><img src="www/img/data.png" width="600 px" style="display: block; margin: auto;" /> Therefore, since we are using data from <strong>2015-2019</strong>, the data we are interested in are located in 5 different excel files, one for each year, each with its own <a href="./docs/2019-nyts-dataset-and-codebook-microsoft-excel/2019-nyts-codebook-p.pdf" target="_blank">codebook</a> (this is the one for 2019).</p>
<p>The <a href="https://www.icpsr.umich.edu/icpsrweb/content/shared/ICPSR/faqs/what-is-a-codebook.html" target="_blank">codebook</a> contains information describing the data within the excel file.</p>
<p>As you can see the excel file contains very short variable names and numeric values, and it is not clear what they mean without the codebook:</p>
<p><img src="www/img/excel.png" width="600 px" style="display: block; margin: auto;" /></p>
<p>The codebook explains what the variables (the columns) are: <img src="www/img/variables.png" width="600 px" style="display: block; margin: auto;" /></p>
<p>And the codebook explains what the values for each variable are:</p>
<p><img src="www/img/qn1.png" width="600 px" style="display: block; margin: auto;" /></p>
<p>We will explain more later about what the values on the right indicate.</p>
<p>The reason that there are codebooks for each year is because the questions asked each year varied slightly.</p>
<p>The data in this survey are pooled cross-sectional data. In this study design, different subsets of student respondents are surveyed each year and it is not clear which, if any, individuals participate more than once from one year to the next.</p>
</div>
<div id="section-data-import" class="section level2">
<h2><strong>Data Import</strong></h2>
<hr />
<div id="section-reading-in-the-excel-files" class="section level3">
<h3><strong>Reading in the excel files</strong></h3>
<hr />
<p>Since these excel files are so large (each has roughly 20,000 rows), it takes a bit of time for the data to load. To make the process faster, we previously imported these files, selected only the columns relevant to our questions of interest, and saved these data subsets as comma-separated (.csv) files.</p>
<p>If you have trouble accessing the GitHub Repository, these CSV files can be downloaded from <a href="https://github.com/opencasestudies/ocs-bp-vaping-case-study/tree/master/data/data_reduced" target="_blank">here</a>.</p>
<hr />
<details>
<p><summary> Click here for details on how the data were originally imported </summary></p>
<p>If you have trouble accessing the GitHub Repository, you can follow the links to download the excel files for <a href="https://github.com/opencasestudies/ocs-bp-vaping-case-study/blob/master/docs/2015-nyts-dataset-and-codebook-microsoft-excel/nyts2015.xlsx" target="_blank">2015</a>, <a href="https://github.com/opencasestudies/ocs-bp-vaping-case-study/blob/master/docs/2016-nyts-dataset-and-codebook-microsoft-excel/nyts2016.xlsx" target="_blank">2016</a>, <a href="https://github.com/opencasestudies/ocs-bp-vaping-case-study/blob/master/docs/2017-nyts-dataset-and-codebook-microsoft-excel/nyts2017.xlsx" target="_blank">2017</a>, <a href="https://github.com/opencasestudies/ocs-bp-vaping-case-study/blob/master/docs/2018-nyts-dataset-and-codebook-microsoft-excel/nyts2018.xlsx" target="_blank">2018</a>, and <a href="https://github.com/opencasestudies/ocs-bp-vaping-case-study/blob/master/docs/2019-nyts-dataset-and-codebook-microsoft-excel/nyts2019.xlsx" target="_blank">2019</a>.</p>
<p>First we created a vector of file names of all the different excel files. Using the <code>here()</code> function of the <code>here</code> package, we looked in all the directories of the project. The <code>list.files()</code> function looked for all files with .xlsx within these sub-directories.</p>
<div class="sourceCode" id="section-cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>excel_files &lt;-<span class="st"> </span><span class="kw">list.files</span>(here<span class="op">::</span><span class="kw">here</span>(), <span class="dt">recursive =</span> <span class="ot">TRUE</span>,</span>
<span id="cb2-2"><a href="#cb2-2"></a>                  <span class="dt">pattern =</span> <span class="st">&quot;*.xlsx&quot;</span>)</span>
<span id="cb2-3"><a href="#cb2-3"></a>excel_files</span></code></pre></div>
<pre><code>[1] &quot;www/docs/2015-nyts-dataset-and-codebook-microsoft-excel/nyts2015.xlsx&quot;
[2] &quot;www/docs/2016-nyts-dataset-and-codebook-microsoft-excel/nyts2016.xlsx&quot;
[3] &quot;www/docs/2017-nyts-dataset-and-codebook-microsoft-excel/nyts2017.xlsx&quot;
[4] &quot;www/docs/2018-nyts-dataset-and-codebook-microsoft-excel/nyts2018.xlsx&quot;
[5] &quot;www/docs/2019-nyts-dataset-and-codebook-microsoft-excel/nyts2019.xlsx&quot;</code></pre>
<p>All the files were read using <code>read_excel()</code> of the <code>readxl</code> package. Using the <code>map()</code> function of the <code>purrr</code> package this was done efficiently for all of the excel files in the vector using one command. The <code>.</code> is used to indicate that we want to apply the <code>read_excel()</code> function to each element of the data that we just piped into the <code>map()</code> function.</p>
<p>Here we also used the <code>%&gt;%</code> pipe which can be used to pass the input from one function to another for later sequential steps.</p>
<p>This created a single list of tibbles (one for each file).</p>
<div class="sourceCode" id="section-cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>tbl_files &lt;-<span class="st"> </span>excel_files <span class="op">%&gt;%</span></span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="st">       </span><span class="kw">map</span>(<span class="op">~</span><span class="st"> </span>readxl<span class="op">::</span><span class="kw">read_excel</span>(.))</span></code></pre></div>
<p>The elements of this list are in the same order as the elements of the <code>excel_files</code> vector, so we can extract the data for a particular file (year) by selecting a certain element of the list. However, it is safer to be able to select the data from this list for a specific year using a name based on the original vector of file names. We extracted a name from each Excel file name using the <code>str_extract()</code> function of the <code>stringr</code> package. Here we are keeping occurrences of the character string “nyts201” followed by a “5”, “6”, “7”, “8”, or “9”.</p>
<div class="sourceCode" id="section-cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>tbl_names &lt;-<span class="st"> </span>excel_files <span class="op">%&gt;%</span></span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="st">  </span><span class="kw">str_extract</span>(<span class="st">&quot;nyts201[5-9]&quot;</span>)</span>
<span id="cb5-3"><a href="#cb5-3"></a></span>
<span id="cb5-4"><a href="#cb5-4"></a>tbl_names</span></code></pre></div>
<pre><code>[1] &quot;nyts2015&quot; &quot;nyts2016&quot; &quot;nyts2017&quot; &quot;nyts2018&quot; &quot;nyts2019&quot;</code></pre>
<p>These names became the names of the tibbles in the list of tibbles.</p>
<div class="sourceCode" id="section-cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="kw">names</span>(tbl_files) &lt;-<span class="st"> </span>tbl_names</span></code></pre></div>
<p>Specific columns were selected using the <code>select()</code> function of <code>dplyr</code> from each of the tibbles using the variable name, as identified in the codebook as being of interest for our analysis. In some cases functions like <code>starts_with()</code> of the <code>dplyr</code> package were used to select several variables at once. Most of the survey questions about tobacco use start with an <code>"E"</code> or a <code>"C"</code> according to the codebooks.</p>
<div class="sourceCode" id="section-cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>tbl_files[[<span class="st">&quot;nyts2015&quot;</span>]] &lt;-<span class="st"> </span>tbl_files[[<span class="st">&quot;nyts2015&quot;</span>]] <span class="op">%&gt;%</span></span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="st">    </span>dplyr<span class="op">::</span><span class="kw">select</span>(psu, <span class="co"># Primary Sampling Unit</span></span>
<span id="cb8-3"><a href="#cb8-3"></a>                  finwgt, <span class="co"># Analysis Weight</span></span>
<span id="cb8-4"><a href="#cb8-4"></a>                  stratum, <span class="co"># Sampling stratum</span></span>
<span id="cb8-5"><a href="#cb8-5"></a>                  Qn1, <span class="co"># Age</span></span>
<span id="cb8-6"><a href="#cb8-6"></a>                  Qn2, <span class="co"># Sex</span></span>
<span id="cb8-7"><a href="#cb8-7"></a>                  Qn3, <span class="co"># Grade</span></span>
<span id="cb8-8"><a href="#cb8-8"></a>                  <span class="kw">starts_with</span>(<span class="st">&quot;E&quot;</span>,</span>
<span id="cb8-9"><a href="#cb8-9"></a>                              <span class="dt">ignore.case =</span> <span class="ot">FALSE</span>),</span>
<span id="cb8-10"><a href="#cb8-10"></a>                  <span class="kw">starts_with</span>(<span class="st">&quot;C&quot;</span>,</span>
<span id="cb8-11"><a href="#cb8-11"></a>                              <span class="dt">ignore.case =</span> <span class="ot">FALSE</span>),</span>
<span id="cb8-12"><a href="#cb8-12"></a>                  )</span>
<span id="cb8-13"><a href="#cb8-13"></a></span>
<span id="cb8-14"><a href="#cb8-14"></a></span>
<span id="cb8-15"><a href="#cb8-15"></a>tbl_files[[<span class="st">&quot;nyts2016&quot;</span>]] &lt;-<span class="st"> </span>tbl_files[[<span class="st">&quot;nyts2016&quot;</span>]] <span class="op">%&gt;%</span></span>
<span id="cb8-16"><a href="#cb8-16"></a><span class="st">    </span>dplyr<span class="op">::</span><span class="kw">select</span>(psu,</span>
<span id="cb8-17"><a href="#cb8-17"></a>                  finwgt,</span>
<span id="cb8-18"><a href="#cb8-18"></a>                  stratum,</span>
<span id="cb8-19"><a href="#cb8-19"></a>                  Q1, <span class="co"># Age</span></span>
<span id="cb8-20"><a href="#cb8-20"></a>                  Q2, <span class="co"># Sex</span></span>
<span id="cb8-21"><a href="#cb8-21"></a>                  Q3, <span class="co"># Grade</span></span>
<span id="cb8-22"><a href="#cb8-22"></a>                  <span class="kw">starts_with</span>(<span class="st">&quot;E&quot;</span>,</span>
<span id="cb8-23"><a href="#cb8-23"></a>                              <span class="dt">ignore.case =</span> <span class="ot">FALSE</span>),</span>
<span id="cb8-24"><a href="#cb8-24"></a>                  <span class="kw">starts_with</span>(<span class="st">&quot;C&quot;</span>,</span>
<span id="cb8-25"><a href="#cb8-25"></a>                              <span class="dt">ignore.case =</span> <span class="ot">FALSE</span>),</span>
<span id="cb8-26"><a href="#cb8-26"></a>                  Q50A, <span class="co"># Menthol # What flavors of tobacco products have you used in the past 30 days? (Select one or more)</span></span>
<span id="cb8-27"><a href="#cb8-27"></a>                  Q50B, <span class="co"># Clove or spice</span></span>
<span id="cb8-28"><a href="#cb8-28"></a>                  Q50C, <span class="co"># Fruit</span></span>
<span id="cb8-29"><a href="#cb8-29"></a>                  Q50D, <span class="co"># Chocolate</span></span>
<span id="cb8-30"><a href="#cb8-30"></a>                  Q50E, <span class="co"># Alcoholic Drink</span></span>
<span id="cb8-31"><a href="#cb8-31"></a>                  Q50F, <span class="co"># Candy/Desserts/Other Sweets</span></span>
<span id="cb8-32"><a href="#cb8-32"></a>                  Q50G  <span class="co"># Some Other Flavor Not Listed Here</span></span>
<span id="cb8-33"><a href="#cb8-33"></a>                  )</span>
<span id="cb8-34"><a href="#cb8-34"></a></span>
<span id="cb8-35"><a href="#cb8-35"></a>tbl_files[[<span class="st">&quot;nyts2017&quot;</span>]] &lt;-<span class="st"> </span>tbl_files[[<span class="st">&quot;nyts2017&quot;</span>]] <span class="op">%&gt;%</span></span>
<span id="cb8-36"><a href="#cb8-36"></a><span class="st">    </span>dplyr<span class="op">::</span><span class="kw">select</span>(psu,</span>
<span id="cb8-37"><a href="#cb8-37"></a>                  finwgt,</span>
<span id="cb8-38"><a href="#cb8-38"></a>                  stratum,</span>
<span id="cb8-39"><a href="#cb8-39"></a>                  Q1, <span class="co"># Age</span></span>
<span id="cb8-40"><a href="#cb8-40"></a>                  Q2, <span class="co"># Sex</span></span>
<span id="cb8-41"><a href="#cb8-41"></a>                  Q3, <span class="co"># Grade</span></span>
<span id="cb8-42"><a href="#cb8-42"></a>                  <span class="kw">starts_with</span>(<span class="st">&quot;E&quot;</span>,</span>
<span id="cb8-43"><a href="#cb8-43"></a>                              <span class="dt">ignore.case =</span> <span class="ot">FALSE</span>),</span>
<span id="cb8-44"><a href="#cb8-44"></a>                  <span class="kw">starts_with</span>(<span class="st">&quot;C&quot;</span>,</span>
<span id="cb8-45"><a href="#cb8-45"></a>                              <span class="dt">ignore.case =</span> <span class="ot">FALSE</span>),</span>
<span id="cb8-46"><a href="#cb8-46"></a>                  Q50A, <span class="co"># Menthol # What flavors of tobacco products have you used in the past 30 days? (Select one or more)</span></span>
<span id="cb8-47"><a href="#cb8-47"></a>                  Q50B, <span class="co"># Clove or spice</span></span>
<span id="cb8-48"><a href="#cb8-48"></a>                  Q50C, <span class="co"># Fruit</span></span>
<span id="cb8-49"><a href="#cb8-49"></a>                  Q50D, <span class="co"># Chocolate</span></span>
<span id="cb8-50"><a href="#cb8-50"></a>                  Q50E, <span class="co"># Alcoholic Drink</span></span>
<span id="cb8-51"><a href="#cb8-51"></a>                  Q50F, <span class="co"># Candy/Desserts/Other Sweets</span></span>
<span id="cb8-52"><a href="#cb8-52"></a>                  Q50G  <span class="co"># Some Other Flavor Not Listed Here</span></span>
<span id="cb8-53"><a href="#cb8-53"></a>                  )</span>
<span id="cb8-54"><a href="#cb8-54"></a></span>
<span id="cb8-55"><a href="#cb8-55"></a>tbl_files[[<span class="st">&quot;nyts2018&quot;</span>]] &lt;-<span class="st"> </span>tbl_files[[<span class="st">&quot;nyts2018&quot;</span>]] <span class="op">%&gt;%</span></span>
<span id="cb8-56"><a href="#cb8-56"></a><span class="st">    </span>dplyr<span class="op">::</span><span class="kw">select</span>(psu,</span>
<span id="cb8-57"><a href="#cb8-57"></a>                  finwgt,</span>
<span id="cb8-58"><a href="#cb8-58"></a>                  stratum,</span>
<span id="cb8-59"><a href="#cb8-59"></a>                  Q1, <span class="co"># Age</span></span>
<span id="cb8-60"><a href="#cb8-60"></a>                  Q2, <span class="co"># Sex</span></span>
<span id="cb8-61"><a href="#cb8-61"></a>                  Q3, <span class="co"># Grade</span></span>
<span id="cb8-62"><a href="#cb8-62"></a>                  <span class="kw">starts_with</span>(<span class="st">&quot;E&quot;</span>,</span>
<span id="cb8-63"><a href="#cb8-63"></a>                              <span class="dt">ignore.case =</span> <span class="ot">FALSE</span>),</span>
<span id="cb8-64"><a href="#cb8-64"></a>                  <span class="kw">starts_with</span>(<span class="st">&quot;C&quot;</span>,</span>
<span id="cb8-65"><a href="#cb8-65"></a>                              <span class="dt">ignore.case =</span> <span class="ot">FALSE</span>),</span>
<span id="cb8-66"><a href="#cb8-66"></a>                  Q50A, <span class="co"># Menthol #What flavors of tobacco products have you used in the past 30 days? (Select one or more)</span></span>
<span id="cb8-67"><a href="#cb8-67"></a>                  Q50B, <span class="co"># Clove or spice</span></span>
<span id="cb8-68"><a href="#cb8-68"></a>                  Q50C, <span class="co"># Fruit</span></span>
<span id="cb8-69"><a href="#cb8-69"></a>                  Q50D, <span class="co"># Chocolate</span></span>
<span id="cb8-70"><a href="#cb8-70"></a>                  Q50E, <span class="co"># Alcoholic Drink</span></span>
<span id="cb8-71"><a href="#cb8-71"></a>                  Q50F, <span class="co"># Candy/Desserts/Other Sweets</span></span>
<span id="cb8-72"><a href="#cb8-72"></a>                  Q50G  <span class="co"># Some Other Flavor Not Listed Here</span></span>
<span id="cb8-73"><a href="#cb8-73"></a>                  )</span>
<span id="cb8-74"><a href="#cb8-74"></a></span>
<span id="cb8-75"><a href="#cb8-75"></a>tbl_files[[<span class="st">&quot;nyts2019&quot;</span>]] &lt;-<span class="st"> </span>tbl_files[[<span class="st">&quot;nyts2019&quot;</span>]] <span class="op">%&gt;%</span></span>
<span id="cb8-76"><a href="#cb8-76"></a><span class="st">    </span>dplyr<span class="op">::</span><span class="kw">select</span>(psu,</span>
<span id="cb8-77"><a href="#cb8-77"></a>                  finwgt,</span>
<span id="cb8-78"><a href="#cb8-78"></a>                  stratum,</span>
<span id="cb8-79"><a href="#cb8-79"></a>                  Q1, <span class="co"># Age</span></span>
<span id="cb8-80"><a href="#cb8-80"></a>                  Q2, <span class="co"># Sex</span></span>
<span id="cb8-81"><a href="#cb8-81"></a>                  Q3, <span class="co"># Grade</span></span>
<span id="cb8-82"><a href="#cb8-82"></a>                  <span class="kw">starts_with</span>(<span class="st">&quot;E&quot;</span>,</span>
<span id="cb8-83"><a href="#cb8-83"></a>                              <span class="dt">ignore.case =</span> <span class="ot">FALSE</span>),</span>
<span id="cb8-84"><a href="#cb8-84"></a>                  <span class="kw">starts_with</span>(<span class="st">&quot;C&quot;</span>,</span>
<span id="cb8-85"><a href="#cb8-85"></a>                              <span class="dt">ignore.case =</span> <span class="ot">FALSE</span>),</span>
<span id="cb8-86"><a href="#cb8-86"></a>                  Q40, <span class="co"># Brand, e-cigarettes</span></span>
<span id="cb8-87"><a href="#cb8-87"></a>                  Q62A, <span class="co"># Menthol # What flavors of tobacco products have you used in the past 30 days? (Select one or more)</span></span>
<span id="cb8-88"><a href="#cb8-88"></a>                  Q62B, <span class="co"># Clove or spice</span></span>
<span id="cb8-89"><a href="#cb8-89"></a>                  Q62C, <span class="co"># Fruit</span></span>
<span id="cb8-90"><a href="#cb8-90"></a>                  Q62D, <span class="co"># Chocolate</span></span>
<span id="cb8-91"><a href="#cb8-91"></a>                  Q62E, <span class="co"># Alcoholic Drink</span></span>
<span id="cb8-92"><a href="#cb8-92"></a>                  Q62F, <span class="co"># Candy/Desserts/Other Sweets</span></span>
<span id="cb8-93"><a href="#cb8-93"></a>                  Q62G, <span class="co"># Some Other Flavor Not Listed Here</span></span>
<span id="cb8-94"><a href="#cb8-94"></a>                  )</span></code></pre></div>
<p>A directory called <code>data_reduced</code> was created for the new .csv files using the base <code>dir.create()</code> function. A csv file was created for each of the tibbles in the list using the <code>write_csv()</code> function of the <code>readr</code> package. This was done all at once using the <code>map()</code> function.</p>
<div class="sourceCode" id="section-cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="kw">dir.create</span>(<span class="st">&quot;data/data_reduced&quot;</span>)</span>
<span id="cb9-2"><a href="#cb9-2"></a></span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="kw">names</span>(tbl_files) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">map</span>(<span class="op">~</span><span class="st"> </span><span class="kw">write_csv</span>(tbl_files[[.]], </span>
<span id="cb9-4"><a href="#cb9-4"></a>                                     <span class="dt">path =</span> <span class="kw">paste0</span>(<span class="st">&quot;data/data_reduced/&quot;</span>, ., <span class="st">&quot;.csv&quot;</span>)))</span></code></pre></div>
</details>
<hr />
<p>Now we will show how to read in the data from the five csv files that were created from the five different Excel files.</p>
</div>
<div id="section-reading-in-the-csv-files" class="section level3">
<h3><strong>Reading in the CSV files</strong></h3>
<hr />
<p>Using the <code>here()</code> function of the <code>here</code> package, we looked in all the directories of the project. The <code>here</code> package automatically starts looking for files based on where you have a <code>.Rproj</code> file which is created when you start a new RStudio project.</p>
<hr />
<details>
<p><summary> Click here to see more about creating new projects in RStudio. </summary></p>
<p>You can create a project by going to the File menu of RStudio like so:</p>
<p><img src="www/img/New_project.png" width="60%" style="display: block; margin: auto;" /></p>
<p>You can also do so by clicking the project button:</p>
<p><img src="www/img/project_button.png" width="60%" style="display: block; margin: auto;" /></p>
<p>See <a href="https://support.rstudio.com/hc/en-us/articles/200526207-Using-Projects" target="_blank">here</a> to learn more about using RStudio projects.</p>
</details>
<hr />
<p>The <code>list.files()</code> function looked for all files with .csv within the sub-directories.</p>
<p>All the files were read using <code>read_csv()</code> of the <code>readr</code> package. Using the <code>map()</code> function of the <code>purrr</code> package this was done efficiently for all of the CSV files in the vector using one command. The <code>.</code> is used to indicate that we want to apply the <code>read_csv()</code> function to each element of the data that we just piped into the <code>map()</code> function. For more information about the <code>map()</code> function, see <a href="https://purrr.tidyverse.org/reference/map.html" target="_blank">here</a>.</p>
<p>Here we also used the <code>%&gt;%</code> pipe which can be used to pass the input from one function to another for later sequential steps.</p>
<div class="sourceCode" id="section-cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>nyts_data &lt;-<span class="st"> </span><span class="kw">list.files</span>(here<span class="op">::</span><span class="kw">here</span>(), <span class="dt">recursive =</span> <span class="ot">TRUE</span>,</span>
<span id="cb10-2"><a href="#cb10-2"></a>                        <span class="dt">pattern =</span> <span class="st">&quot;*.csv&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb10-3"><a href="#cb10-3"></a><span class="st">  </span><span class="kw">map</span>(<span class="op">~</span><span class="st"> </span><span class="kw">read_csv</span>(.))</span>
<span id="cb10-4"><a href="#cb10-4"></a></span>
<span id="cb10-5"><a href="#cb10-5"></a></span>
<span id="cb10-6"><a href="#cb10-6"></a>nyts_data_names &lt;-<span class="st"> </span><span class="kw">list.files</span>(<span class="dt">recursive =</span> <span class="ot">TRUE</span>,</span>
<span id="cb10-7"><a href="#cb10-7"></a>                              <span class="dt">pattern =</span> <span class="st">&quot;*.csv&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb10-8"><a href="#cb10-8"></a><span class="st">  </span><span class="kw">str_extract</span>(<span class="st">&quot;nyts201[5-9]&quot;</span>)</span>
<span id="cb10-9"><a href="#cb10-9"></a></span>
<span id="cb10-10"><a href="#cb10-10"></a><span class="kw">names</span>(nyts_data) &lt;-<span class="st"> </span>nyts_data_names</span></code></pre></div>
</div>
</div>
<div id="section-data-exploration-and-wrangling" class="section level2">
<h2><strong>Data Exploration and Wrangling</strong></h2>
<hr />
<p>Our goal in this section is to adjust or “wrangle” the data from each year into a common format so that we can combine the datasets across years for our analysis, and so that we have values in our variables that are correct and easy to interpret. We will need to understand what is the same and what is different across the data from different years, rename and recode the variables (e.g., by replacing the numbers 1 and 2 with the values “Male” and “Female” for the <code>Sex</code> variable), and combine the data. We will walk through these steps below.</p>
<p>First, let’s take a look at our data. We can get a good sense of it using the <code>glimpse()</code> function of the <code>dplyr</code> package.</p>
<div id="section-section-12" class="section level4 scrollable">
<h4></h4>
<div class="sourceCode" id="section-cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>dplyr<span class="op">::</span><span class="kw">glimpse</span>(nyts_data[[<span class="st">&quot;nyts2015&quot;</span>]])</span></code></pre></div>
<pre><code>Rows: 17,711
Columns: 29
$ psu        &lt;chr&gt; &quot;015438&quot;, &quot;015438&quot;, &quot;015438&quot;, &quot;015438&quot;, &quot;015438&quot;, &quot;01543...
$ finwgt     &lt;dbl&gt; 216.7268, 324.9620, 324.9620, 397.1552, 264.8745, 264.87...
$ stratum    &lt;chr&gt; &quot;BR3&quot;, &quot;BR3&quot;, &quot;BR3&quot;, &quot;BR3&quot;, &quot;BR3&quot;, &quot;BR3&quot;, &quot;BR3&quot;, &quot;BR3&quot;, ...
$ Qn1        &lt;dbl&gt; 10, 9, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 1...
$ Qn2        &lt;dbl&gt; 2, 1, 1, 1, 2, 2, 1, 2, 1, 2, 2, 2, 1, 2, 2, 1, 2, 2, 2,...
$ Qn3        &lt;dbl&gt; 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 5,...
$ ECIGT      &lt;dbl&gt; 2, 1, 2, 1, 2, 1, 1, 1, 2, 2, 2, 2, 1, 2, 2, 1, 2, 1, 2,...
$ ECIGAR     &lt;dbl&gt; 1, 1, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 1,...
$ ESLT       &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,...
$ EELCIGT    &lt;dbl&gt; 2, 1, 2, 1, 2, 1, 1, 1, 2, 2, 2, 1, 2, 2, 2, 1, 2, 2, 2,...
$ EROLLCIGTS &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 1, 2, 2, 2,...
$ EFLAVCIGTS &lt;dbl&gt; 2, 2, 2, 1, 2, 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,...
$ EBIDIS     &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,...
$ EFLAVCIGAR &lt;dbl&gt; 2, 1, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 1, 2, 1, 1,...
$ EHOOKAH    &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,...
$ EPIPE      &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,...
$ ESNUS      &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,...
$ EDISSOLV   &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,...
$ CCIGT      &lt;dbl&gt; 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,...
$ CCIGAR     &lt;dbl&gt; 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,...
$ CSLT       &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,...
$ CELCIGT    &lt;dbl&gt; 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,...
$ CROLLCIGTS &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,...
$ CFLAVCIGTS &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,...
$ CBIDIS     &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,...
$ CHOOKAH    &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,...
$ CPIPE      &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,...
$ CSNUS      &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,...
$ CDISSOLV   &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,...</code></pre>
</div>
<div id="section-section-13" class="section level4">
<h4></h4>
</div>
<div id="section-updating-the-set-of-variables-and-their-names" class="section level3">
<h3><strong>Updating the set of variables and their names</strong></h3>
<hr />
<p>The easiest way of making it so that the data from the different years can be combined is by making sure that the same type of data in different datasets share the same names. In addition, giving the columns informative names will help make our code more readable. Currently, it isn’t very clear what most of the variables indicate since the variable names are uninformative on their own, without the <a href="./docs/2019-nyts-dataset-and-codebook-microsoft-excel/2019-nyts-codebook-p.pdf" target="_blank">codebook</a>.</p>
<p>We want to rename variables like <code>Qn1</code> to something more meaningful like <code>Age</code>.</p>
<p>To do this we will use the <code>rename()</code> function of the <code>dplyr</code> package. The new name is always listed first before the <code>=</code>. This function will replace the old variable names with the new ones, i.e., after running the code below, there will no longer be a <code>Qn1</code> variable in the dataset, but there will be an <code>Age</code> variable instead. We will start working with the 2015 data, and then move on to the other years down below.</p>
<div class="sourceCode" id="section-cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>nyts_data[[<span class="st">&quot;nyts2015&quot;</span>]] &lt;-<span class="st"> </span>nyts_data[[<span class="st">&quot;nyts2015&quot;</span>]] <span class="op">%&gt;%</span></span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">rename</span>(<span class="dt">Age =</span> Qn1,</span>
<span id="cb13-3"><a href="#cb13-3"></a>                <span class="dt">Sex =</span> Qn2,</span>
<span id="cb13-4"><a href="#cb13-4"></a>                <span class="dt">Grade =</span> Qn3)</span></code></pre></div>
<p>Ultimately we will be combining the data from each year using the <code>bind_rows()</code> function of the <code>dplyr</code> package, which will fill in <code>NA</code> values for any columns that do not exist for one of the years.</p>
<p>The data for 2016-2018 have many common attributes, so we will want to write code that can be applied to all three datasets. To do this, we will use a <strong>function</strong> in R, which is basically a piece of code that can be applied to similar but different objects in R (e.g., the data tibbles from each of these three years). Recall that you are using functions from packages all the time, like the <code>rename()</code> function of the <code>dplyr</code> package. Now you are going to write your own function! For more information on functions, see <a href="https://r4ds.had.co.nz/functions.html" target="_blank">here</a>.</p>
<p>These next 3 years have the same structure for many of the questions we are interested in. For example, they all have flavor questions, but not a brand question. Moreover, their variable names are consistent across the years; for each year, we want to replace the vague question name <code>Q50A</code> with the value <code>menthol</code> in all three datasets, and the same is true for the other flavor variables.</p>
<p>Since we want to perform the same modifications on the data from all three years, rather than repeating the same somewhat messy piece of code three times, we can do this more efficiently if we create a function to do all of these steps at once. Then we can use the <code>map_at()</code> function of the <code>purrr</code> package, which is an extension of the <code>map()</code> function that we used in the [Data Import] (<a href="https://www.opencasestudies.org/ocs-bp-vaping-case-study/#Data_Import" class="uri">https://www.opencasestudies.org/ocs-bp-vaping-case-study/#Data_Import</a>){target="_blank"} section to apply the function we just created (for renaming variables etc.) specifically to the data from 2016-2018 within the <code>nyts_data</code>. By using <code>vars()</code> inside of the <code>map_at()</code> function we can specify what tibbles within our <code>nyts_data</code> list we want to include or exclude.</p>
<div id="section-functions" class="section level4">
<h4><strong>Functions</strong></h4>
<hr />
<p>So how do you create a function? You first need to specify that you are creating a function by using the <code>function()</code> base function. Yes, that’s right it is a function for creating functions called function!</p>
<p>First we specify our input within the parentheses of <code>function()</code>. Thus if our function will apply something to an input called <code>x</code> then we would use <code>function(x)</code>. Theoretically our input can be named whatever we want, but we we need to refer to it consistently within our function to indicate what we want done with the input data. We can actually have more than one input as well, we would indicate two inputs like this: <code>function(x, b)</code>. Here we would be using both <code>x</code> and <code>b</code> to do something in our function.</p>
<p>The next part of a function is defined within curly brackets <code>{}</code>. This is where we write what we want done to our inputs.</p>
<hr />
<details>
<p><summary> Click here to see a simple example </summary></p>
<p>Our function will be called <code>simple_function</code>, which will add 2 to our input. It will take the input <code>vector_data</code> (note that we usually want to use an informative input argument like <code>vector_data</code>).</p>
<div class="sourceCode" id="section-cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>simple_function &lt;-<span class="st"> </span><span class="cf">function</span>(vector_data) {</span>
<span id="cb14-2"><a href="#cb14-2"></a>  vector_data <span class="op">+</span><span class="st"> </span><span class="dv">2</span></span>
<span id="cb14-3"><a href="#cb14-3"></a>}</span></code></pre></div>
<p>We can use an input that is a vector called <code>x</code>.</p>
<div class="sourceCode" id="section-cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>x =<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>)</span>
<span id="cb15-2"><a href="#cb15-2"></a>x</span></code></pre></div>
<pre><code>[1] 1 2 3 4</code></pre>
<p>Now we specify using the argument <code>vector_data =</code> to indicate that <code>x</code> is our input that we want to perform the function on.</p>
<div class="sourceCode" id="section-cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="kw">simple_function</span>(<span class="dt">vector_data =</span> x)</span></code></pre></div>
<pre><code>[1] 3 4 5 6</code></pre>
<p>This function also works for other vector input. For example, vector <code>y</code> is now our input that we want to perform the function on.</p>
<div class="sourceCode" id="section-cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>y =<span class="st"> </span><span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">20</span>)</span>
<span id="cb19-2"><a href="#cb19-2"></a></span>
<span id="cb19-3"><a href="#cb19-3"></a><span class="kw">simple_function</span>(<span class="dt">vector_data =</span> y)</span></code></pre></div>
<pre><code>[1]  7 12 17 22</code></pre>
</details>
<hr />
<p>In our case we will be applying our function to the variable names for the dataset for each year. The output of our function is the result of renaming these variables for each year.</p>
<div class="sourceCode" id="section-cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>update_survey &lt;-<span class="st"> </span><span class="cf">function</span>(dataset) { dataset <span class="op">%&gt;%</span></span>
<span id="cb21-2"><a href="#cb21-2"></a><span class="st">           </span><span class="kw">rename</span>(<span class="dt">Age =</span> Q1,</span>
<span id="cb21-3"><a href="#cb21-3"></a>                  <span class="dt">Sex =</span> Q2,</span>
<span id="cb21-4"><a href="#cb21-4"></a>                <span class="dt">Grade =</span> Q3,</span>
<span id="cb21-5"><a href="#cb21-5"></a>              <span class="dt">menthol =</span> Q50A,</span>
<span id="cb21-6"><a href="#cb21-6"></a>          <span class="dt">clove_spice =</span> Q50B,</span>
<span id="cb21-7"><a href="#cb21-7"></a>                <span class="dt">fruit =</span> Q50C,</span>
<span id="cb21-8"><a href="#cb21-8"></a>            <span class="dt">chocolate =</span> Q50D,</span>
<span id="cb21-9"><a href="#cb21-9"></a>      <span class="dt">alcoholic_drink =</span> Q50E,</span>
<span id="cb21-10"><a href="#cb21-10"></a> <span class="dt">candy_dessert_sweets =</span> Q50F,</span>
<span id="cb21-11"><a href="#cb21-11"></a>                <span class="dt">other =</span> Q50G)</span>
<span id="cb21-12"><a href="#cb21-12"></a>}</span>
<span id="cb21-13"><a href="#cb21-13"></a></span>
<span id="cb21-14"><a href="#cb21-14"></a><span class="co"># options to apply the function to the data:</span></span>
<span id="cb21-15"><a href="#cb21-15"></a><span class="co"># nyts_data &lt;- nyts_data %&gt;% map_at(vars(nyts2016, nyts2017, nyts2018), Update_survey)</span></span>
<span id="cb21-16"><a href="#cb21-16"></a>nyts_data &lt;-<span class="st"> </span>nyts_data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">map_at</span>(<span class="kw">vars</span>(<span class="op">-</span>nyts2015, <span class="op">-</span>nyts2019), update_survey)</span></code></pre></div>
<p>The final year, 2019, has a slightly different data structure compared to these earlier datasets. It actually has a <code>brand_ecig</code> variable already and different question numbers correspond to our flavor questions of interest. So we will rename the variables in this dataset individually. We could also write this as a function, but since we are only applying this one time, there is no need to. Functions are really helpful for repeating the same task repeatedly using different data inputs.</p>
<div class="sourceCode" id="section-cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a>nyts_data[[<span class="st">&quot;nyts2019&quot;</span>]] &lt;-<span class="st"> </span>nyts_data[[<span class="st">&quot;nyts2019&quot;</span>]] <span class="op">%&gt;%</span></span>
<span id="cb22-2"><a href="#cb22-2"></a><span class="st">    </span><span class="kw">rename</span>(<span class="dt">brand_ecig =</span> Q40,</span>
<span id="cb22-3"><a href="#cb22-3"></a>                  <span class="dt">Age =</span> Q1,</span>
<span id="cb22-4"><a href="#cb22-4"></a>                  <span class="dt">Sex =</span> Q2,</span>
<span id="cb22-5"><a href="#cb22-5"></a>                <span class="dt">Grade =</span> Q3,</span>
<span id="cb22-6"><a href="#cb22-6"></a>              <span class="dt">menthol =</span> Q62A,</span>
<span id="cb22-7"><a href="#cb22-7"></a>          <span class="dt">clove_spice =</span> Q62B,</span>
<span id="cb22-8"><a href="#cb22-8"></a>                <span class="dt">fruit =</span> Q62C,</span>
<span id="cb22-9"><a href="#cb22-9"></a>            <span class="dt">chocolate =</span> Q62D,</span>
<span id="cb22-10"><a href="#cb22-10"></a>      <span class="dt">alcoholic_drink =</span> Q62E,</span>
<span id="cb22-11"><a href="#cb22-11"></a> <span class="dt">candy_dessert_sweets =</span> Q62F,</span>
<span id="cb22-12"><a href="#cb22-12"></a>                <span class="dt">other =</span> Q62G)</span></code></pre></div>
<p>Now let’s take a look at the variable names for each of the years using the <code>map</code> function from <code>purrr</code>.</p>
</div>
<div id="section-section-14" class="section level4 scrollable">
<h4></h4>
<div class="sourceCode" id="section-cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="kw">map</span>(nyts_data, names)</span></code></pre></div>
<pre><code>$nyts2015
 [1] &quot;psu&quot;        &quot;finwgt&quot;     &quot;stratum&quot;    &quot;Age&quot;        &quot;Sex&quot;       
 [6] &quot;Grade&quot;      &quot;ECIGT&quot;      &quot;ECIGAR&quot;     &quot;ESLT&quot;       &quot;EELCIGT&quot;   
[11] &quot;EROLLCIGTS&quot; &quot;EFLAVCIGTS&quot; &quot;EBIDIS&quot;     &quot;EFLAVCIGAR&quot; &quot;EHOOKAH&quot;   
[16] &quot;EPIPE&quot;      &quot;ESNUS&quot;      &quot;EDISSOLV&quot;   &quot;CCIGT&quot;      &quot;CCIGAR&quot;    
[21] &quot;CSLT&quot;       &quot;CELCIGT&quot;    &quot;CROLLCIGTS&quot; &quot;CFLAVCIGTS&quot; &quot;CBIDIS&quot;    
[26] &quot;CHOOKAH&quot;    &quot;CPIPE&quot;      &quot;CSNUS&quot;      &quot;CDISSOLV&quot;  

$nyts2016
 [1] &quot;psu&quot;                  &quot;finwgt&quot;               &quot;stratum&quot;             
 [4] &quot;Age&quot;                  &quot;Sex&quot;                  &quot;Grade&quot;               
 [7] &quot;ECIGT&quot;                &quot;ECIGAR&quot;               &quot;ESLT&quot;                
[10] &quot;EELCIGT&quot;              &quot;EHOOKAH&quot;              &quot;EROLLCIGTS&quot;          
[13] &quot;EFLAVCIGAR&quot;           &quot;EPIPE&quot;                &quot;ESNUS&quot;               
[16] &quot;EDISSOLV&quot;             &quot;EBIDIS&quot;               &quot;CCIGT&quot;               
[19] &quot;CCIGAR&quot;               &quot;CSLT&quot;                 &quot;CELCIGT&quot;             
[22] &quot;CHOOKAH&quot;              &quot;CROLLCIGTS&quot;           &quot;CPIPE&quot;               
[25] &quot;CSNUS&quot;                &quot;CDISSOLV&quot;             &quot;CBIDIS&quot;              
[28] &quot;menthol&quot;              &quot;clove_spice&quot;          &quot;fruit&quot;               
[31] &quot;chocolate&quot;            &quot;alcoholic_drink&quot;      &quot;candy_dessert_sweets&quot;
[34] &quot;other&quot;               

$nyts2017
 [1] &quot;psu&quot;                  &quot;finwgt&quot;               &quot;stratum&quot;             
 [4] &quot;Age&quot;                  &quot;Sex&quot;                  &quot;Grade&quot;               
 [7] &quot;ECIGT&quot;                &quot;ECIGAR&quot;               &quot;ESLT&quot;                
[10] &quot;EELCIGT&quot;              &quot;EHOOKAH&quot;              &quot;EROLLCIGTS&quot;          
[13] &quot;EPIPE&quot;                &quot;ESNUS&quot;                &quot;EDISSOLV&quot;            
[16] &quot;EBIDIS&quot;               &quot;CCIGT&quot;                &quot;CCIGAR&quot;              
[19] &quot;CSLT&quot;                 &quot;CELCIGT&quot;              &quot;CHOOKAH&quot;             
[22] &quot;CROLLCIGTS&quot;           &quot;CPIPE&quot;                &quot;CSNUS&quot;               
[25] &quot;CDISSOLV&quot;             &quot;CBIDIS&quot;               &quot;menthol&quot;             
[28] &quot;clove_spice&quot;          &quot;fruit&quot;                &quot;chocolate&quot;           
[31] &quot;alcoholic_drink&quot;      &quot;candy_dessert_sweets&quot; &quot;other&quot;               

$nyts2018
 [1] &quot;psu&quot;                  &quot;finwgt&quot;               &quot;stratum&quot;             
 [4] &quot;Age&quot;                  &quot;Sex&quot;                  &quot;Grade&quot;               
 [7] &quot;ECIGT&quot;                &quot;ECIGAR&quot;               &quot;ESLT&quot;                
[10] &quot;EELCIGT&quot;              &quot;EHOOKAH&quot;              &quot;EROLLCIGTS&quot;          
[13] &quot;EPIPE&quot;                &quot;ESNUS&quot;                &quot;EDISSOLV&quot;            
[16] &quot;EBIDIS&quot;               &quot;CCIGT&quot;                &quot;CCIGAR&quot;              
[19] &quot;CSLT&quot;                 &quot;CELCIGT&quot;              &quot;CHOOKAH&quot;             
[22] &quot;CROLLCIGTS&quot;           &quot;CPIPE&quot;                &quot;CSNUS&quot;               
[25] &quot;CDISSOLV&quot;             &quot;CBIDIS&quot;               &quot;menthol&quot;             
[28] &quot;clove_spice&quot;          &quot;fruit&quot;                &quot;chocolate&quot;           
[31] &quot;alcoholic_drink&quot;      &quot;candy_dessert_sweets&quot; &quot;other&quot;               

$nyts2019
 [1] &quot;psu&quot;                  &quot;finwgt&quot;               &quot;stratum&quot;             
 [4] &quot;Age&quot;                  &quot;Sex&quot;                  &quot;Grade&quot;               
 [7] &quot;ECIGT&quot;                &quot;ECIGAR&quot;               &quot;ESLT&quot;                
[10] &quot;EELCIGT&quot;              &quot;EHOOKAH&quot;              &quot;EROLLCIGTS&quot;          
[13] &quot;EPIPE&quot;                &quot;ESNUS&quot;                &quot;EDISSOLV&quot;            
[16] &quot;EBIDIS&quot;               &quot;EHTP&quot;                 &quot;CCIGT&quot;               
[19] &quot;CCIGAR&quot;               &quot;CSLT&quot;                 &quot;CELCIGT&quot;             
[22] &quot;CHOOKAH&quot;              &quot;CROLLCIGTS&quot;           &quot;CPIPE&quot;               
[25] &quot;CSNUS&quot;                &quot;CDISSOLV&quot;             &quot;CBIDIS&quot;              
[28] &quot;CHTP&quot;                 &quot;brand_ecig&quot;           &quot;menthol&quot;             
[31] &quot;clove_spice&quot;          &quot;fruit&quot;                &quot;chocolate&quot;           
[34] &quot;alcoholic_drink&quot;      &quot;candy_dessert_sweets&quot; &quot;other&quot;               </code></pre>
</div>
<div id="section-section-15" class="section level4">
<h4></h4>
<p>It’s looking better! The data that overlap across years have the same variable names.</p>
</div>
</div>
<div id="section-updating-values" class="section level3">
<h3><strong>Updating Values</strong></h3>
<hr />
<p>Now that we have made some progress on the selection and names of the variables themselves, we will work on the values contained in the different variables.</p>
<p>We can start with updating the values for <code>Age</code> and <code>Grade</code>, so that they are more understandable.</p>
<p>Recall from the codebook for this year’s dataset that <code>Age</code> isn’t listed in the way one might expect, i.e., it is not just a number of years, but a numerically valued categorical variable.</p>
<p><img src="www/img/qn1.png" width="600 px" style="display: block; margin: auto;" /></p>
<p>The same is true for <code>Grade</code>:</p>
<p><img src="www/img/grade.png" width="600 px" style="display: block; margin: auto;" /></p>
<p><strong>This is why it is so important to always check the codebook!!</strong></p>
<p>We also want to replace the value of <code>19</code> for <code>Age</code> to be <code>"&gt;18"</code> and the value of <code>13</code> for <code>Grade</code> to be replaced with <code>"Ungraded/Other"</code> Also according to the codebooks, numeric values of <code>1</code> indicate a survey answer of <code>FALSE</code>, while a value of <code>2</code> indicates <code>TRUE</code>. <code>Sex</code> also needs to be recoded. If we take a look at the codebooks carefully (make sure you look at the questions that we pulled, not the recoded values), we will see that males are indicated by <code>1</code> and females are indicated by <code>2</code>. Finally some values are indicated with <code>"*"</code> or<code>"**"</code> when they are missing. We want to replace these with <code>NA</code>.</p>
<p>Let’s create a function to make all these updates. We will use the <code>mutate</code> function of the <code>dplyr</code> package to modify these variables. This function can also be used to create new variables. We will also use the <code>recode()</code> function of the <code>dplyr</code> package to replace specific values of certain variables.</p>
<div class="sourceCode" id="section-cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a>update_values &lt;-<span class="st"> </span><span class="cf">function</span>(dataset) {</span>
<span id="cb25-2"><a href="#cb25-2"></a>  dataset <span class="op">%&gt;%</span></span>
<span id="cb25-3"><a href="#cb25-3"></a><span class="st">    </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">Age =</span> <span class="kw">as.numeric</span>(Age) <span class="op">+</span><span class="st"> </span><span class="dv">8</span>,</span>
<span id="cb25-4"><a href="#cb25-4"></a>                  <span class="dt">Grade =</span> <span class="kw">as.numeric</span>(Grade) <span class="op">+</span><span class="st"> </span><span class="dv">5</span>) <span class="op">%&gt;%</span></span>
<span id="cb25-5"><a href="#cb25-5"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">Age =</span> <span class="kw">as.factor</span>(Age),</span>
<span id="cb25-6"><a href="#cb25-6"></a>           <span class="dt">Grade =</span> <span class="kw">as.factor</span>(Grade),</span>
<span id="cb25-7"><a href="#cb25-7"></a>           <span class="dt">Sex =</span> <span class="kw">as.factor</span>(Sex)) <span class="op">%&gt;%</span></span>
<span id="cb25-8"><a href="#cb25-8"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">Sex =</span> <span class="kw">recode</span>(Sex,</span>
<span id="cb25-9"><a href="#cb25-9"></a>                        <span class="st">`</span><span class="dt">1</span><span class="st">`</span> =<span class="st"> &quot;male&quot;</span>,</span>
<span id="cb25-10"><a href="#cb25-10"></a>                        <span class="st">`</span><span class="dt">2</span><span class="st">`</span> =<span class="st"> &quot;female&quot;</span>)) <span class="op">%&gt;%</span></span>
<span id="cb25-11"><a href="#cb25-11"></a><span class="st">    </span>dplyr<span class="op">::</span><span class="kw">mutate_all</span>( <span class="op">~</span><span class="st"> </span><span class="kw">replace</span>(., . <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;*&quot;</span>, <span class="st">&quot;**&quot;</span>), <span class="ot">NA</span>)) <span class="op">%&gt;%</span></span>
<span id="cb25-12"><a href="#cb25-12"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">Age =</span> <span class="kw">recode</span>(Age,</span>
<span id="cb25-13"><a href="#cb25-13"></a>                        <span class="st">`</span><span class="dt">19</span><span class="st">`</span> =<span class="st"> &quot;&gt;18&quot;</span>),</span>
<span id="cb25-14"><a href="#cb25-14"></a>           <span class="dt">Grade =</span> <span class="kw">recode</span>(Grade,</span>
<span id="cb25-15"><a href="#cb25-15"></a>                          <span class="st">`</span><span class="dt">13</span><span class="st">`</span> =<span class="st"> &quot;Ungraded/Other&quot;</span>)) <span class="op">%&gt;%</span></span>
<span id="cb25-16"><a href="#cb25-16"></a><span class="st">    </span>dplyr<span class="op">::</span><span class="kw">mutate_at</span>(<span class="kw">vars</span>(</span>
<span id="cb25-17"><a href="#cb25-17"></a>      <span class="kw">starts_with</span>(<span class="st">&quot;E&quot;</span>, <span class="dt">ignore.case =</span> <span class="ot">FALSE</span>),</span>
<span id="cb25-18"><a href="#cb25-18"></a>      <span class="kw">starts_with</span>(<span class="st">&quot;C&quot;</span>, <span class="dt">ignore.case =</span> <span class="ot">FALSE</span>)</span>
<span id="cb25-19"><a href="#cb25-19"></a>    ),</span>
<span id="cb25-20"><a href="#cb25-20"></a>    <span class="kw">list</span>( <span class="op">~</span><span class="st"> </span><span class="kw">recode</span>(</span>
<span id="cb25-21"><a href="#cb25-21"></a>      .,</span>
<span id="cb25-22"><a href="#cb25-22"></a>      <span class="st">`</span><span class="dt">1</span><span class="st">`</span> =<span class="st"> </span><span class="ot">TRUE</span>,</span>
<span id="cb25-23"><a href="#cb25-23"></a>      <span class="st">`</span><span class="dt">2</span><span class="st">`</span> =<span class="st"> </span><span class="ot">FALSE</span>,</span>
<span id="cb25-24"><a href="#cb25-24"></a>      <span class="dt">.default =</span> <span class="ot">NA</span>,</span>
<span id="cb25-25"><a href="#cb25-25"></a>      <span class="dt">.missing =</span> <span class="ot">NA</span></span>
<span id="cb25-26"><a href="#cb25-26"></a>    )))</span>
<span id="cb25-27"><a href="#cb25-27"></a>}</span>
<span id="cb25-28"><a href="#cb25-28"></a></span>
<span id="cb25-29"><a href="#cb25-29"></a>nyts_data &lt;-<span class="st"> </span>nyts_data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">map</span>(., update_values)</span></code></pre></div>
<p>Now if we wanted to check that everything is expected we could do something like this to check the <code>Sex</code> variable using the <code>count()</code> function of the <code>dplyr</code> package. It is advisable to check your data frequently to make sure that it is as expected!</p>
<p>According to the codebook, we should have:</p>
<ol style="list-style-type: decimal">
<li>8,958 males in 2015<br />
</li>
<li>10,438 males in 2016<br />
</li>
<li>8,881 males in 2017<br />
</li>
<li>10,069 males in 2018<br />
</li>
<li>9,803 males in 2019</li>
</ol>
<div class="sourceCode" id="section-cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a>count_sex &lt;-<span class="st"> </span><span class="cf">function</span>(dataset) {dataset <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">count</span>(Sex)}</span>
<span id="cb26-2"><a href="#cb26-2"></a>nyts_data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">map</span>(., count_sex)</span></code></pre></div>
<pre><code>$nyts2015
# A tibble: 3 x 2
  Sex        n
  &lt;fct&gt;  &lt;int&gt;
1 male    8958
2 female  8622
3 &lt;NA&gt;     131

$nyts2016
# A tibble: 3 x 2
  Sex        n
  &lt;fct&gt;  &lt;int&gt;
1 male   10438
2 female 10082
3 &lt;NA&gt;     155

$nyts2017
# A tibble: 3 x 2
  Sex        n
  &lt;fct&gt;  &lt;int&gt;
1 male    8881
2 female  8815
3 &lt;NA&gt;     176

$nyts2018
# A tibble: 3 x 2
  Sex        n
  &lt;fct&gt;  &lt;int&gt;
1 male   10069
2 female  9920
3 &lt;NA&gt;     200

$nyts2019
# A tibble: 3 x 2
  Sex        n
  &lt;fct&gt;  &lt;int&gt;
1 .N       116
2 male    9803
3 female  9099</code></pre>
<p>Looks good!</p>
<p>The years (2016-2019) that have flavors also need the flavor data to be logical (meaning TRUE or FALSE):</p>
<p>In this case we also are setting missing values to <code>FALSE</code> because then the <code>TRUE</code> values will represent those who reported using a specific flavor out of all users, rather than those that used a specific flavor compared to those who used a different flavor.</p>
<div class="sourceCode" id="section-cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a>update_flavors &lt;-<span class="st"> </span><span class="cf">function</span>(dataset) {dataset <span class="op">%&gt;%</span></span>
<span id="cb28-2"><a href="#cb28-2"></a><span class="st">   </span><span class="kw">mutate_at</span>(<span class="kw">vars</span>(menthol<span class="op">:</span>other),</span>
<span id="cb28-3"><a href="#cb28-3"></a>              <span class="kw">list</span>(<span class="op">~</span><span class="st"> </span><span class="kw">recode</span>(.,</span>
<span id="cb28-4"><a href="#cb28-4"></a>                           <span class="st">`</span><span class="dt">1</span><span class="st">`</span> =<span class="st"> </span><span class="ot">TRUE</span>,</span>
<span id="cb28-5"><a href="#cb28-5"></a>                      <span class="dt">.default =</span> <span class="ot">FALSE</span>,</span>
<span id="cb28-6"><a href="#cb28-6"></a>                      <span class="dt">.missing =</span> <span class="ot">FALSE</span>))) }</span>
<span id="cb28-7"><a href="#cb28-7"></a></span>
<span id="cb28-8"><a href="#cb28-8"></a>nyts_data  &lt;-<span class="st"> </span>nyts_data  <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">map_at</span>(<span class="kw">vars</span>(<span class="op">-</span>nyts2015), update_flavors)</span></code></pre></div>
<p>Now there are just a few changes needed that are specific to 2019. Specifically, some of the 2019 questions use the values “.N”, “.S”, and “.Z” to indicate different types of missing data (see for example Q2 of the 2019 <a href="./docs/2019-nyts-dataset-and-codebook-microsoft-excel/2019-nyts-codebook-p.pdf" target="_blank">codebook</a>); we just want them to be replaced with <code>NA</code> values.</p>
<div class="sourceCode" id="section-cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a>nyts_data[[<span class="st">&quot;nyts2019&quot;</span>]] &lt;-<span class="st"> </span>nyts_data[[<span class="st">&quot;nyts2019&quot;</span>]] <span class="op">%&gt;%</span></span>
<span id="cb29-2"><a href="#cb29-2"></a><span class="st">  </span><span class="kw">mutate_all</span>(<span class="op">~</span><span class="st"> </span><span class="kw">replace</span>(., . <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;.N&quot;</span>, <span class="st">&quot;.S&quot;</span>, <span class="st">&quot;.Z&quot;</span>), <span class="ot">NA</span>)) <span class="op">%&gt;%</span></span>
<span id="cb29-3"><a href="#cb29-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">psu =</span> <span class="kw">as.character</span>(psu)) <span class="op">%&gt;%</span></span>
<span id="cb29-4"><a href="#cb29-4"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">brand_ecig =</span> <span class="kw">recode</span>(brand_ecig,</span>
<span id="cb29-5"><a href="#cb29-5"></a>                                             <span class="st">`</span><span class="dt">1</span><span class="st">`</span> =<span class="st"> &quot;Other&quot;</span>, <span class="co"># levels 1,8 combined to `Other`</span></span>
<span id="cb29-6"><a href="#cb29-6"></a>                                             <span class="st">`</span><span class="dt">2</span><span class="st">`</span> =<span class="st"> &quot;Blu&quot;</span>,</span>
<span id="cb29-7"><a href="#cb29-7"></a>                                             <span class="st">`</span><span class="dt">3</span><span class="st">`</span> =<span class="st"> &quot;JUUL&quot;</span>,</span>
<span id="cb29-8"><a href="#cb29-8"></a>                                             <span class="st">`</span><span class="dt">4</span><span class="st">`</span> =<span class="st"> &quot;Logic&quot;</span>,</span>
<span id="cb29-9"><a href="#cb29-9"></a>                                             <span class="st">`</span><span class="dt">5</span><span class="st">`</span> =<span class="st"> &quot;MarkTen&quot;</span>,</span>
<span id="cb29-10"><a href="#cb29-10"></a>                                             <span class="st">`</span><span class="dt">6</span><span class="st">`</span> =<span class="st"> &quot;NJOY&quot;</span>,</span>
<span id="cb29-11"><a href="#cb29-11"></a>                                             <span class="st">`</span><span class="dt">7</span><span class="st">`</span> =<span class="st"> &quot;Vuse&quot;</span>,</span>
<span id="cb29-12"><a href="#cb29-12"></a>                                             <span class="st">`</span><span class="dt">8</span><span class="st">`</span> =<span class="st"> &quot;Other&quot;</span>))</span></code></pre></div>
<p>Great! Now our values don’t need to be handled any differently for any of the years, thus we can combine the data across years.</p>
<p>Even though we have different numbers of variables for each year, we can coerce the data to be combined into one tibble by using the <code>bind_rows()</code> function of <code>dplyr</code>. Importantly, this function does not require that the columns be the same. This will create NA values for any variable that is not present in given data frame but is present in one of the other data frames that is being combined. Note that the <code>bind_cols()</code> function does expect that the rows match. The <code>.id</code> argument will create a new variable with values to link each row to its original data frame. For more information see <a href="https://dplyr.tidyverse.org/reference/bind.html">here</a>.</p>
<div class="sourceCode" id="section-cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a>nyts_data &lt;-<span class="st"> </span>nyts_data <span class="op">%&gt;%</span></span>
<span id="cb30-2"><a href="#cb30-2"></a><span class="st">  </span><span class="kw">map_df</span>(dplyr<span class="op">::</span>bind_rows, <span class="dt">.id =</span> <span class="st">&quot;year&quot;</span>)</span>
<span id="cb30-3"><a href="#cb30-3"></a></span>
<span id="cb30-4"><a href="#cb30-4"></a><span class="kw">glimpse</span>(nyts_data)</span></code></pre></div>
<pre><code>Rows: 95,465
Columns: 40
$ year                 &lt;chr&gt; &quot;nyts2015&quot;, &quot;nyts2015&quot;, &quot;nyts2015&quot;, &quot;nyts2015&quot;...
$ psu                  &lt;chr&gt; &quot;015438&quot;, &quot;015438&quot;, &quot;015438&quot;, &quot;015438&quot;, &quot;01543...
$ finwgt               &lt;dbl&gt; 216.7268, 324.9620, 324.9620, 397.1552, 264.87...
$ stratum              &lt;chr&gt; &quot;BR3&quot;, &quot;BR3&quot;, &quot;BR3&quot;, &quot;BR3&quot;, &quot;BR3&quot;, &quot;BR3&quot;, &quot;BR3...
$ Age                  &lt;fct&gt; 18, 17, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18...
$ Sex                  &lt;fct&gt; female, male, male, male, female, female, male...
$ Grade                &lt;fct&gt; 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12...
$ ECIGT                &lt;lgl&gt; FALSE, TRUE, FALSE, TRUE, FALSE, TRUE, TRUE, T...
$ ECIGAR               &lt;lgl&gt; TRUE, TRUE, FALSE, FALSE, FALSE, FALSE, TRUE, ...
$ ESLT                 &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, TRUE...
$ EELCIGT              &lt;lgl&gt; FALSE, TRUE, FALSE, TRUE, FALSE, TRUE, TRUE, T...
$ EROLLCIGTS           &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, TRUE...
$ EFLAVCIGTS           &lt;lgl&gt; FALSE, FALSE, FALSE, TRUE, FALSE, FALSE, TRUE,...
$ EBIDIS               &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALS...
$ EFLAVCIGAR           &lt;lgl&gt; FALSE, TRUE, FALSE, FALSE, FALSE, FALSE, TRUE,...
$ EHOOKAH              &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALS...
$ EPIPE                &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALS...
$ ESNUS                &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, TRUE...
$ EDISSOLV             &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALS...
$ CCIGT                &lt;lgl&gt; FALSE, TRUE, FALSE, FALSE, FALSE, FALSE, FALSE...
$ CCIGAR               &lt;lgl&gt; FALSE, TRUE, FALSE, FALSE, FALSE, FALSE, FALSE...
$ CSLT                 &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALS...
$ CELCIGT              &lt;lgl&gt; FALSE, FALSE, FALSE, TRUE, FALSE, FALSE, FALSE...
$ CROLLCIGTS           &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALS...
$ CFLAVCIGTS           &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALS...
$ CBIDIS               &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALS...
$ CHOOKAH              &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALS...
$ CPIPE                &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALS...
$ CSNUS                &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALS...
$ CDISSOLV             &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALS...
$ menthol              &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
$ clove_spice          &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
$ fruit                &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
$ chocolate            &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
$ alcoholic_drink      &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
$ candy_dessert_sweets &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
$ other                &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
$ EHTP                 &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
$ CHTP                 &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
$ brand_ecig           &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...</code></pre>
<p>We will want to do some of our analysis split by year, so we would like to be sure we have one variable that has the correct value for year. It looks like we just need to remove <code>"nyts"</code> from the year variable that we created from the names of the tibbles in our list and we should be all set. We will use another function from the <code>stringr</code> package to do this. The <code>str_remove()</code> function takes a string followed by a pattern and removes the pattern from the string.</p>
<div class="sourceCode" id="section-cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a>nyts_data &lt;-<span class="st"> </span>nyts_data <span class="op">%&gt;%</span></span>
<span id="cb32-2"><a href="#cb32-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">year =</span> <span class="kw">as.numeric</span>(<span class="kw">str_remove</span>(year, <span class="st">&quot;nyts&quot;</span>)))</span></code></pre></div>
<p>Here is our clean and wrangled data:</p>
<div id="section-section-16" class="section level4 scrollable">
<h4></h4>
<div class="sourceCode" id="section-cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a><span class="kw">glimpse</span>(nyts_data)</span></code></pre></div>
<pre><code>Rows: 95,465
Columns: 40
$ year                 &lt;dbl&gt; 2015, 2015, 2015, 2015, 2015, 2015, 2015, 2015...
$ psu                  &lt;chr&gt; &quot;015438&quot;, &quot;015438&quot;, &quot;015438&quot;, &quot;015438&quot;, &quot;01543...
$ finwgt               &lt;dbl&gt; 216.7268, 324.9620, 324.9620, 397.1552, 264.87...
$ stratum              &lt;chr&gt; &quot;BR3&quot;, &quot;BR3&quot;, &quot;BR3&quot;, &quot;BR3&quot;, &quot;BR3&quot;, &quot;BR3&quot;, &quot;BR3...
$ Age                  &lt;fct&gt; 18, 17, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18...
$ Sex                  &lt;fct&gt; female, male, male, male, female, female, male...
$ Grade                &lt;fct&gt; 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12...
$ ECIGT                &lt;lgl&gt; FALSE, TRUE, FALSE, TRUE, FALSE, TRUE, TRUE, T...
$ ECIGAR               &lt;lgl&gt; TRUE, TRUE, FALSE, FALSE, FALSE, FALSE, TRUE, ...
$ ESLT                 &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, TRUE...
$ EELCIGT              &lt;lgl&gt; FALSE, TRUE, FALSE, TRUE, FALSE, TRUE, TRUE, T...
$ EROLLCIGTS           &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, TRUE...
$ EFLAVCIGTS           &lt;lgl&gt; FALSE, FALSE, FALSE, TRUE, FALSE, FALSE, TRUE,...
$ EBIDIS               &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALS...
$ EFLAVCIGAR           &lt;lgl&gt; FALSE, TRUE, FALSE, FALSE, FALSE, FALSE, TRUE,...
$ EHOOKAH              &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALS...
$ EPIPE                &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALS...
$ ESNUS                &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, TRUE...
$ EDISSOLV             &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALS...
$ CCIGT                &lt;lgl&gt; FALSE, TRUE, FALSE, FALSE, FALSE, FALSE, FALSE...
$ CCIGAR               &lt;lgl&gt; FALSE, TRUE, FALSE, FALSE, FALSE, FALSE, FALSE...
$ CSLT                 &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALS...
$ CELCIGT              &lt;lgl&gt; FALSE, FALSE, FALSE, TRUE, FALSE, FALSE, FALSE...
$ CROLLCIGTS           &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALS...
$ CFLAVCIGTS           &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALS...
$ CBIDIS               &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALS...
$ CHOOKAH              &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALS...
$ CPIPE                &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALS...
$ CSNUS                &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALS...
$ CDISSOLV             &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALS...
$ menthol              &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
$ clove_spice          &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
$ fruit                &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
$ chocolate            &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
$ alcoholic_drink      &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
$ candy_dessert_sweets &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
$ other                &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
$ EHTP                 &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
$ CHTP                 &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
$ brand_ecig           &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...</code></pre>
</div>
<div id="section-section-17" class="section level4">
<h4></h4>
<p>Note that there are several variables where there are similar names, but with a <code>C</code> compared to an <code>E</code> in the variable name. Those starting with <code>C</code> are related to questions about current usage (last 30 days), while those with an <code>E</code> are related to usage across the student respondent’s whole life (“ever” usage). We will discuss these groups further below.</p>
</div>
</div>
<div id="section-variable-table" class="section level3">
<h3><strong>Variable Table</strong></h3>
<hr />
<details>
<p><summary> Click here to see a table about the final variables in our data set. </summary></p>
<table>
<colgroup>
<col width="43%" />
<col width="56%" />
</colgroup>
<thead>
<tr class="header">
<th>Variable</th>
<th>Details</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>year</strong></td>
<td>the year that the survey results from a particular student respondent were acquired</td>
</tr>
<tr class="even">
<td><strong>psu</strong></td>
<td>the primary sampling unit for the survey weighting</td>
</tr>
<tr class="odd">
<td><strong>finwgt</strong></td>
<td>the final analysis weight for the survey weighting</td>
</tr>
<tr class="even">
<td><strong>stratum</strong></td>
<td>the stratum used for variance estimation for the survey weighting</td>
</tr>
<tr class="odd">
<td><strong>Age</strong></td>
<td>the age of the student when they took the survey</td>
</tr>
<tr class="even">
<td><strong>Sex</strong></td>
<td>the sex of the student when they took the survey</td>
</tr>
<tr class="odd">
<td><strong>Grade</strong></td>
<td>the grade of the the student when the took the survey</td>
</tr>
<tr class="even">
<td><strong>ECIGT</strong></td>
<td>student reported having ever tried cigarette smoking, even one or two puffs</td>
</tr>
<tr class="odd">
<td><strong>ECIGAR</strong></td>
<td>student reported having ever tried cigar, cigarillo, or little cigar smoking, even one or two puffs</td>
</tr>
<tr class="even">
<td><strong>ESLT</strong></td>
<td>student reported having ever tried chewing tobacco, snuff, or dip</td>
</tr>
<tr class="odd">
<td><strong>EELCIGT</strong></td>
<td>student reported having ever tried e-cigarettes</td>
</tr>
<tr class="even">
<td><strong>EROLLCIGTS</strong></td>
<td>student reported having ever tried roll-your-own cigarettes</td>
</tr>
<tr class="odd">
<td><strong>EFLAVCIGTS</strong></td>
<td>(2015 only) based on answer to “Which of the following tobacco products that you used in the past 30 days were flavored?”</td>
</tr>
<tr class="even">
<td><strong>EBIDIS</strong></td>
<td>student reported having ever tried bidis (small brown cigarettes wrapped in a leaf)</td>
</tr>
<tr class="odd">
<td><strong>EFLAVCIGAR</strong></td>
<td>student reported having ever tried a flavored cigar (2015-2016)</td>
</tr>
<tr class="even">
<td><strong>EHOOKAH</strong></td>
<td>student reported having ever smoked tobacco from a hookah or a waterpipe</td>
</tr>
<tr class="odd">
<td><strong>EPIPE</strong></td>
<td>student reported having ever smoked tobacco from a pipe (not hookah)</td>
</tr>
<tr class="even">
<td><strong>ESNUS</strong></td>
<td>student reported having ever used snus, such as Camel or Malboro Snus</td>
</tr>
<tr class="odd">
<td><strong>EDISSOLV</strong></td>
<td>student reported having ever tried dissolvable tobacco products such as Ariva, Stonewall, Camel orbs, Camel sticks, Marlboro sticks, or Camel strips</td>
</tr>
<tr class="even">
<td><strong>CCIGT</strong></td>
<td>student reported they smoked cigarettes on &gt;= 1 of the past 30 days</td>
</tr>
<tr class="odd">
<td><strong>CCIGAR</strong></td>
<td>student reported they smoked cigars on &gt;= 1 of the past 30 days</td>
</tr>
<tr class="even">
<td><strong>CSLT</strong></td>
<td>student reported they used chewing tobacco, snuff, or dip on &gt;= 1 of the past 30 days</td>
</tr>
<tr class="odd">
<td><strong>CELCIGT</strong></td>
<td>student reported they used electronic cigarettes or e-cigarettes one or more days in the past 30</td>
</tr>
<tr class="even">
<td><strong>CROLLCIGTS</strong></td>
<td>student reported they smoked roll-your-own cigarettes during the past 30 days</td>
</tr>
<tr class="odd">
<td><strong>CFLAVCIGTS</strong></td>
<td>(2015 only) based on answer to “Which of the following tobacco products that you used in the past 30 days were flavored?”</td>
</tr>
<tr class="even">
<td><strong>CBIDIS</strong></td>
<td>student reported they smoked bidis during the past 30 days</td>
</tr>
<tr class="odd">
<td><strong>CHOOKAH</strong></td>
<td>student reported they smoked tobacco in a hookah on &gt;= 1 of the past 30 days</td>
</tr>
<tr class="even">
<td><strong>CPIPE</strong></td>
<td>student reported they smoked tobacco in a pipe (not hookah) during the past 30 days</td>
</tr>
<tr class="odd">
<td><strong>CSNUS</strong></td>
<td>student reported they used snus during the past 30 days</td>
</tr>
<tr class="even">
<td><strong>CDISSOLV</strong></td>
<td>student reported they used dissolvable tobacco products such as Ariva, Stonewall, Camel orbs, Camel sticks, Marlboro sticks, or Camel strips during the past 30 days</td>
</tr>
<tr class="odd">
<td><strong>brand_ecig</strong></td>
<td>student answer to “During the past 30 days, what brand of e-cigarettes did you usually use?”</td>
</tr>
<tr class="even">
<td><strong>menthol</strong></td>
<td>student selected Menthol or mint as the answer to “What flavors of tobacco products have you used in the past 30 days? (select one or more)”</td>
</tr>
<tr class="odd">
<td><strong>clove_spice</strong></td>
<td>student selected clove or spice as the answer to “What flavors of tobacco products have you used in the past 30 days? (select one or more)”</td>
</tr>
<tr class="even">
<td><strong>fruit</strong></td>
<td>student selected fruit as the answer to “What flavors of tobacco products have you used in the past 30 days? (select one or more)”</td>
</tr>
<tr class="odd">
<td><strong>chocolate</strong></td>
<td>student selected chocolate as the answer to “What flavors of tobacco products have you used in the past 30 days? (select one or more)”</td>
</tr>
<tr class="even">
<td><strong>alcoholic_drink</strong></td>
<td>student selected alcoholic drink (such as wine, cognac, margarita, or other cocktails) as the answer to “What flavors of tobacco products have you used in the past 30 days? (choose one or more)”</td>
</tr>
<tr class="odd">
<td><strong>candy_dessert_sweets</strong></td>
<td>student selected candy, desserts or other sweets as the answer to “What flavors of tobacco products have you used in the past 30 days? (choose one or more)”</td>
</tr>
<tr class="even">
<td><strong>other</strong></td>
<td>student selected some other flavor not listed as the answer to “What flavors of tobacco products have you used in the past 30 days? (choose one or more)”</td>
</tr>
<tr class="odd">
<td><strong>EHTP</strong></td>
<td>student reported having ever tried heated (also known as “heat-not-burn”) tobacco products</td>
</tr>
<tr class="even">
<td><strong>CHTP</strong></td>
<td>student reported they used heated tobacco products during the past 30 days</td>
</tr>
</tbody>
</table>
</details>
</div>
<div id="section-exercise" class="section level3">
<h3><strong>Exercise</strong></h3>
<hr />
<p><div class="panel-heading tutorial-quiz-title"></div><div class="panel panel-default">
<div data-label="DEW_Quiz-1" class="tutorial-question panel-body">
<div id="DEW_Quiz-1-answer_container" class="shiny-html-output"></div>
<div id="DEW_Quiz-1-message_container" class="shiny-html-output"></div>
<div id="DEW_Quiz-1-action_button_container" class="shiny-html-output"></div>
<script>if (Tutorial.triggerMathJax) Tutorial.triggerMathJax()</script>
</div>
</div><div class="panel panel-default">
<div data-label="DEW_Quiz-2" class="tutorial-question panel-body">
<div id="DEW_Quiz-2-answer_container" class="shiny-html-output"></div>
<div id="DEW_Quiz-2-message_container" class="shiny-html-output"></div>
<div id="DEW_Quiz-2-action_button_container" class="shiny-html-output"></div>
<script>if (Tutorial.triggerMathJax) Tutorial.triggerMathJax()</script>
</div>
</div></p>
<p>Suppose there is a list of datasets called <code>norm_data</code>. The first dataset in <code>norm_data</code> contains observations from a normal distribution with mean 0. The second contains observations from a normal distribution with mean 5. For both of them, the observations in the first column <code>var1</code> are from a distribution with variance 1. The observations in the second column <code>var2</code> are from a distribution with variance 4.</p>
<p>Write a function called <code>rename_sd</code> that renames the first column as “SD = 1”, and the second column as “SD = 2”. Then, apply this function to the list <code>norm_data</code>.</p>
<div class="tutorial-exercise" data-label="DEW_Exercise" data-completion="1" data-diagnostics="1" data-startover="1" data-lines="0">
<pre class="text"><code># write the function
rename_sd &lt;- function(){
  
}

# apply the function
norm_data &lt;- 
  
# view results
norm_data</code></pre>
<script type="application/json" data-ui-opts="1">{"engine":"r","has_checker":false,"caption":"R code"}</script>
</div>
<div class="tutorial-exercise-support" data-label="DEW_Exercise-hint-1" data-completion="1" data-diagnostics="1" data-startover="1" data-lines="0">
<pre class="text"><code># What input argument should the function take?
# What should the function do with the input argument?</code></pre>
</div>
<div class="tutorial-exercise-support" data-label="DEW_Exercise-hint-2" data-completion="1" data-diagnostics="1" data-startover="1" data-lines="0">
<pre class="text"><code># What input argument should the function take?
# What should the function do with the input argument?

# What function can be used to apply a function to each element in our list?</code></pre>
</div>
<div class="tutorial-exercise-support" data-label="DEW_Exercise-hint-3" data-completion="1" data-diagnostics="1" data-startover="1" data-lines="0">
<pre class="text"><code># write the function
rename_sd &lt;- function(dataset) {
  dataset %&gt;%
    rename(&quot;SD = 1&quot; = var1, &quot;SD = 2&quot; = var2)
}</code></pre>
</div>
<div class="tutorial-exercise-support" data-label="DEW_Exercise-solution" data-completion="1" data-diagnostics="1" data-startover="1" data-lines="0">
<pre class="text"><code># write the function
rename_sd &lt;- function(dataset) {
  dataset %&gt;%
    rename(&quot;SD = 1&quot; = var1, &quot;SD = 2&quot; = var2)
}

# apply the function
norm_data &lt;- norm_data %&gt;%
  map(., rename_sd)

# view results
norm_data</code></pre>
</div>
</div>
</div>
<div id="section-data-visualization" class="section level2">
<h2><strong>Data Visualization</strong></h2>
<hr />
<p>Recall that our main questions were:</p>
<ol style="list-style-type: decimal">
<li><p>How has tobacco and e-cigarette/vaping use by American youths changed since 2015?</p></li>
<li><p>How does e-cigarette use compare between males and females?</p></li>
<li><p>What vaping brands and flavors appear to be used the most frequently?<br />
We will base this on the following survey questions:<br />
&gt; “During the past 30 days, what brand of e-cigarettes did you usually use?”<br />
&gt; “What flavors of tobacco products have you used in the past 30 days?”</p></li>
<li><p>Is there a relationship between e-cigarette/vaping use and other tobacco use?</p></li>
</ol>
<p>We are now going to create data visualizations to explore each of these questions.</p>
<p>For many of these questions we will be interested in both <strong>current</strong> and <strong>ever</strong> users, so we will want to create a variable for labeling individuals who are current users of any tobacco product (or not, i.e., who do not currently use a tobacco product) and a variable for labeling individuals who are “ever users” of any tobacco product (or not, i.e., who have never used a tobacco product).</p>
<p>We define these two groups as follows:</p>
<ol style="list-style-type: decimal">
<li><strong>current</strong> = students who used a product for &gt;=1 day in the past 30 days<br />
</li>
<li><strong>ever</strong> = students who report having used or tried a product at any point in time</li>
</ol>
<p>All <strong>current</strong> users are therefore <strong>ever</strong> users but not all <strong>ever</strong> users are <strong>current</strong> users. Thus, <strong>current</strong> users are a subset of <strong>ever</strong> users.</p>
<p>To add these grouping variables to our data we will do a bit more wrangling using the <code>mutate()</code> function again of the <code>dplyr</code> package. As discussed above, our dataset contains a set of questions that relate to whether the student has ever used the particular tobacco product (questions that start with the letter “E”), and questions that relate to whether the student currently uses the particular tobacco product (questions that start with the letter “C”).</p>
<p>Here are some examples for these data entries:</p>
<ul>
<li>EPIPE: Students who reported they have smoked tobacco from a pipe (not hookah).<br />
</li>
<li>CPIPE: Students who reported they smoked tobacco in a pipe (not hookah) during the past 30 days.</li>
<li>EROLLCIGTS: Students who reported they have tried smoking roll-your-own cigarettes.</li>
<li>CROLLCIGTS: Students who reported they smoked roll-your-own cigarettes during the past 30 days.</li>
</ul>
<p>Based on many questions like this:</p>
<p>In the past 30 days, which of the following products have you used on at least one day? (Select one or more)<br />
A. Roll-your-own cigarettes<br />
B. Pipes filled with tobacco (not hookah or waterpipe)<br />
C. Snus, such as Camel, Marlboro, or General Snus<br />
D. Dissolvable tobacco products such as Ariva, Stonewall, Camel orbs, Camel sticks, Marlboro sticks, or Camel strips<br />
E. Bidis (small brown cigarettes wrapped in a leaf)<br />
F. I have not used any of the products listed above in the past 30 days</p>
<p>Which of the following tobacco products have you ever tried, even just one time? (Select one or more)<br />
A. Roll-your-own cigarettes<br />
B. Pipes filled with tobacco (not hookah or waterpipe)<br />
C. Snus, such as Camel, Marlboro, or General Snus<br />
D. Dissolvable tobacco products such as Ariva, Stonewall, Camel orbs, Camel sticks, Marlboro sticks, or Camel strips<br />
E. Bidis (small brown cigarettes wrapped in a leaf)<br />
F. I have never tried any of the products listed above</p>
<p>We will sum across the variables that relate to ever or current tobacco usage questions to determine if the student answered yes to any of the ever or current questions. To do this we will use the base <code>rowSums</code> function.</p>
<p>We will then use the <code>case_when()</code> function of the <code>dplyr</code> package to convert the sum values to <code>TRUE</code> or <code>FALSE</code> based on the threshold of zero. If the sum is greater than zero, then we know the student answered yes to at least one question.</p>
<div class="sourceCode" id="section-cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a>nyts_data <span class="op">%&lt;&gt;%</span></span>
<span id="cb40-2"><a href="#cb40-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">tobacco_sum_ever =</span> <span class="kw">rowSums</span>(<span class="kw">select</span>(., <span class="kw">starts_with</span>(<span class="st">&quot;E&quot;</span>, </span>
<span id="cb40-3"><a href="#cb40-3"></a>                                    <span class="dt">ignore.case =</span> <span class="ot">FALSE</span>)), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb40-4"><a href="#cb40-4"></a>      <span class="dt">tobacco_sum_current =</span> <span class="kw">rowSums</span>(<span class="kw">select</span>(., <span class="kw">starts_with</span>(<span class="st">&quot;C&quot;</span>, </span>
<span id="cb40-5"><a href="#cb40-5"></a>                                    <span class="dt">ignore.case =</span> <span class="ot">FALSE</span>)), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span></span>
<span id="cb40-6"><a href="#cb40-6"></a><span class="st">      </span><span class="kw">mutate</span>(<span class="dt">tobacco_ever =</span> <span class="kw">case_when</span>(tobacco_sum_ever <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">~</span><span class="st"> </span><span class="ot">TRUE</span>,</span>
<span id="cb40-7"><a href="#cb40-7"></a>                                      tobacco_sum_ever <span class="op">==</span><span class="st"> </span><span class="dv">0</span> <span class="op">~</span><span class="st"> </span><span class="ot">FALSE</span>),</span>
<span id="cb40-8"><a href="#cb40-8"></a>          <span class="dt">tobacco_current =</span> <span class="kw">case_when</span>(tobacco_sum_current <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">~</span><span class="st"> </span><span class="ot">TRUE</span>,</span>
<span id="cb40-9"><a href="#cb40-9"></a>                                      tobacco_sum_current <span class="op">==</span><span class="st"> </span><span class="dv">0</span> <span class="op">~</span><span class="st"> </span><span class="ot">FALSE</span>))</span></code></pre></div>
<div id="section-section-18" class="section level4 scrollable">
<h4></h4>
<div class="sourceCode" id="section-cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a><span class="kw">glimpse</span>(nyts_data)</span></code></pre></div>
<pre><code>Rows: 95,465
Columns: 44
$ year                 &lt;dbl&gt; 2015, 2015, 2015, 2015, 2015, 2015, 2015, 2015...
$ psu                  &lt;chr&gt; &quot;015438&quot;, &quot;015438&quot;, &quot;015438&quot;, &quot;015438&quot;, &quot;01543...
$ finwgt               &lt;dbl&gt; 216.7268, 324.9620, 324.9620, 397.1552, 264.87...
$ stratum              &lt;chr&gt; &quot;BR3&quot;, &quot;BR3&quot;, &quot;BR3&quot;, &quot;BR3&quot;, &quot;BR3&quot;, &quot;BR3&quot;, &quot;BR3...
$ Age                  &lt;fct&gt; 18, 17, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18...
$ Sex                  &lt;fct&gt; female, male, male, male, female, female, male...
$ Grade                &lt;fct&gt; 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12...
$ ECIGT                &lt;lgl&gt; FALSE, TRUE, FALSE, TRUE, FALSE, TRUE, TRUE, T...
$ ECIGAR               &lt;lgl&gt; TRUE, TRUE, FALSE, FALSE, FALSE, FALSE, TRUE, ...
$ ESLT                 &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, TRUE...
$ EELCIGT              &lt;lgl&gt; FALSE, TRUE, FALSE, TRUE, FALSE, TRUE, TRUE, T...
$ EROLLCIGTS           &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, TRUE...
$ EFLAVCIGTS           &lt;lgl&gt; FALSE, FALSE, FALSE, TRUE, FALSE, FALSE, TRUE,...
$ EBIDIS               &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALS...
$ EFLAVCIGAR           &lt;lgl&gt; FALSE, TRUE, FALSE, FALSE, FALSE, FALSE, TRUE,...
$ EHOOKAH              &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALS...
$ EPIPE                &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALS...
$ ESNUS                &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, TRUE...
$ EDISSOLV             &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALS...
$ CCIGT                &lt;lgl&gt; FALSE, TRUE, FALSE, FALSE, FALSE, FALSE, FALSE...
$ CCIGAR               &lt;lgl&gt; FALSE, TRUE, FALSE, FALSE, FALSE, FALSE, FALSE...
$ CSLT                 &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALS...
$ CELCIGT              &lt;lgl&gt; FALSE, FALSE, FALSE, TRUE, FALSE, FALSE, FALSE...
$ CROLLCIGTS           &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALS...
$ CFLAVCIGTS           &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALS...
$ CBIDIS               &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALS...
$ CHOOKAH              &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALS...
$ CPIPE                &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALS...
$ CSNUS                &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALS...
$ CDISSOLV             &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALS...
$ menthol              &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
$ clove_spice          &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
$ fruit                &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
$ chocolate            &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
$ alcoholic_drink      &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
$ candy_dessert_sweets &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
$ other                &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
$ EHTP                 &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
$ CHTP                 &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
$ brand_ecig           &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
$ tobacco_sum_ever     &lt;dbl&gt; 1, 4, 0, 3, 0, 2, 8, 4, 0, 0, 0, 1, 1, 0, 0, 4...
$ tobacco_sum_current  &lt;dbl&gt; 0, 2, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0...
$ tobacco_ever         &lt;lgl&gt; TRUE, TRUE, FALSE, TRUE, FALSE, TRUE, TRUE, TR...
$ tobacco_current      &lt;lgl&gt; FALSE, TRUE, FALSE, TRUE, FALSE, FALSE, FALSE,...</code></pre>
</div>
<div id="section-section-19" class="section level4">
<h4></h4>
<p>We are also interested in e-cigarette/vaping product usage compared to other tobacco products, so we will create some variables related to the sum of all e-cigarette usage question variables and the sum of all tobacco usage question variables excluding those that are about e-cigarettes. There is only one variable about e-cigarette usage ever (EELCIGT) and one about current usage (CELCIGT).</p>
<div class="sourceCode" id="section-cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a>nyts_data &lt;-<span class="st"> </span>nyts_data <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb43-2"><a href="#cb43-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">ecig_sum_ever =</span> <span class="kw">rowSums</span>(<span class="kw">select</span>(., EELCIGT), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb43-3"><a href="#cb43-3"></a>      <span class="dt">ecig_sum_current =</span> <span class="kw">rowSums</span>(<span class="kw">select</span>(., CELCIGT), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb43-4"><a href="#cb43-4"></a>     <span class="dt">non_ecig_sum_ever =</span> <span class="kw">rowSums</span>(<span class="kw">select</span>(., <span class="kw">starts_with</span>(<span class="st">&quot;E&quot;</span>, </span>
<span id="cb43-5"><a href="#cb43-5"></a>                                           <span class="dt">ignore.case =</span> <span class="ot">FALSE</span>), </span>
<span id="cb43-6"><a href="#cb43-6"></a>                                           <span class="op">-</span>EELCIGT), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb43-7"><a href="#cb43-7"></a>  <span class="dt">non_ecig_sum_current =</span> <span class="kw">rowSums</span>(<span class="kw">select</span>(., <span class="kw">starts_with</span>(<span class="st">&quot;C&quot;</span>,</span>
<span id="cb43-8"><a href="#cb43-8"></a>                                           <span class="dt">ignore.case =</span> <span class="ot">FALSE</span>), </span>
<span id="cb43-9"><a href="#cb43-9"></a>                                           <span class="op">-</span>CELCIGT), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span></span>
<span id="cb43-10"><a href="#cb43-10"></a><span class="st">      </span><span class="kw">mutate</span>(<span class="dt">ecig_ever =</span> <span class="kw">case_when</span>(ecig_sum_ever <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">~</span><span class="st"> </span><span class="ot">TRUE</span>,</span>
<span id="cb43-11"><a href="#cb43-11"></a>                                   ecig_sum_ever <span class="op">==</span><span class="st"> </span><span class="dv">0</span> <span class="op">~</span><span class="st"> </span><span class="ot">FALSE</span>),</span>
<span id="cb43-12"><a href="#cb43-12"></a>          <span class="dt">ecig_current =</span> <span class="kw">case_when</span>(ecig_sum_current <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">~</span><span class="st"> </span><span class="ot">TRUE</span>,</span>
<span id="cb43-13"><a href="#cb43-13"></a>                                   ecig_sum_current <span class="op">==</span><span class="st"> </span><span class="dv">0</span> <span class="op">~</span><span class="st"> </span><span class="ot">FALSE</span>),</span>
<span id="cb43-14"><a href="#cb43-14"></a>         <span class="dt">non_ecig_ever =</span> <span class="kw">case_when</span>(non_ecig_sum_ever <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">~</span><span class="st"> </span><span class="ot">TRUE</span>,</span>
<span id="cb43-15"><a href="#cb43-15"></a>                                   non_ecig_sum_ever <span class="op">==</span><span class="st"> </span><span class="dv">0</span> <span class="op">~</span><span class="st"> </span><span class="ot">FALSE</span>),</span>
<span id="cb43-16"><a href="#cb43-16"></a>      <span class="dt">non_ecig_current =</span> <span class="kw">case_when</span>(non_ecig_sum_current <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">~</span><span class="st"> </span><span class="ot">TRUE</span>,</span>
<span id="cb43-17"><a href="#cb43-17"></a>                                   non_ecig_sum_current <span class="op">==</span><span class="st"> </span><span class="dv">0</span> <span class="op">~</span><span class="st"> </span><span class="ot">FALSE</span>))</span></code></pre></div>
</div>
<div id="section-section-20" class="section level4 scrollable">
<h4></h4>
<div class="sourceCode" id="section-cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a><span class="kw">glimpse</span>(nyts_data)</span></code></pre></div>
<pre><code>Rows: 95,465
Columns: 52
$ year                 &lt;dbl&gt; 2015, 2015, 2015, 2015, 2015, 2015, 2015, 2015...
$ psu                  &lt;chr&gt; &quot;015438&quot;, &quot;015438&quot;, &quot;015438&quot;, &quot;015438&quot;, &quot;01543...
$ finwgt               &lt;dbl&gt; 216.7268, 324.9620, 324.9620, 397.1552, 264.87...
$ stratum              &lt;chr&gt; &quot;BR3&quot;, &quot;BR3&quot;, &quot;BR3&quot;, &quot;BR3&quot;, &quot;BR3&quot;, &quot;BR3&quot;, &quot;BR3...
$ Age                  &lt;fct&gt; 18, 17, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18...
$ Sex                  &lt;fct&gt; female, male, male, male, female, female, male...
$ Grade                &lt;fct&gt; 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12...
$ ECIGT                &lt;lgl&gt; FALSE, TRUE, FALSE, TRUE, FALSE, TRUE, TRUE, T...
$ ECIGAR               &lt;lgl&gt; TRUE, TRUE, FALSE, FALSE, FALSE, FALSE, TRUE, ...
$ ESLT                 &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, TRUE...
$ EELCIGT              &lt;lgl&gt; FALSE, TRUE, FALSE, TRUE, FALSE, TRUE, TRUE, T...
$ EROLLCIGTS           &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, TRUE...
$ EFLAVCIGTS           &lt;lgl&gt; FALSE, FALSE, FALSE, TRUE, FALSE, FALSE, TRUE,...
$ EBIDIS               &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALS...
$ EFLAVCIGAR           &lt;lgl&gt; FALSE, TRUE, FALSE, FALSE, FALSE, FALSE, TRUE,...
$ EHOOKAH              &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALS...
$ EPIPE                &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALS...
$ ESNUS                &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, TRUE...
$ EDISSOLV             &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALS...
$ CCIGT                &lt;lgl&gt; FALSE, TRUE, FALSE, FALSE, FALSE, FALSE, FALSE...
$ CCIGAR               &lt;lgl&gt; FALSE, TRUE, FALSE, FALSE, FALSE, FALSE, FALSE...
$ CSLT                 &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALS...
$ CELCIGT              &lt;lgl&gt; FALSE, FALSE, FALSE, TRUE, FALSE, FALSE, FALSE...
$ CROLLCIGTS           &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALS...
$ CFLAVCIGTS           &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALS...
$ CBIDIS               &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALS...
$ CHOOKAH              &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALS...
$ CPIPE                &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALS...
$ CSNUS                &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALS...
$ CDISSOLV             &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALS...
$ menthol              &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
$ clove_spice          &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
$ fruit                &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
$ chocolate            &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
$ alcoholic_drink      &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
$ candy_dessert_sweets &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
$ other                &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
$ EHTP                 &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
$ CHTP                 &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
$ brand_ecig           &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
$ tobacco_sum_ever     &lt;dbl&gt; 1, 4, 0, 3, 0, 2, 8, 4, 0, 0, 0, 1, 1, 0, 0, 4...
$ tobacco_sum_current  &lt;dbl&gt; 0, 2, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0...
$ tobacco_ever         &lt;lgl&gt; TRUE, TRUE, FALSE, TRUE, FALSE, TRUE, TRUE, TR...
$ tobacco_current      &lt;lgl&gt; FALSE, TRUE, FALSE, TRUE, FALSE, FALSE, FALSE,...
$ ecig_sum_ever        &lt;dbl&gt; 0, 1, 0, 1, 0, 1, 1, 1, 0, 0, 0, 1, 0, 0, 0, 1...
$ ecig_sum_current     &lt;dbl&gt; 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0...
$ non_ecig_sum_ever    &lt;dbl&gt; 1, 3, 0, 2, 0, 1, 7, 3, 0, 0, 0, 0, 1, 0, 0, 3...
$ non_ecig_sum_current &lt;dbl&gt; 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0...
$ ecig_ever            &lt;lgl&gt; FALSE, TRUE, FALSE, TRUE, FALSE, TRUE, TRUE, T...
$ ecig_current         &lt;lgl&gt; FALSE, FALSE, FALSE, TRUE, FALSE, FALSE, FALSE...
$ non_ecig_ever        &lt;lgl&gt; TRUE, TRUE, FALSE, TRUE, FALSE, TRUE, TRUE, TR...
$ non_ecig_current     &lt;lgl&gt; FALSE, TRUE, FALSE, FALSE, FALSE, FALSE, FALSE...</code></pre>
</div>
<div id="section-section-21" class="section level4">
<h4></h4>
<p>Finally, we are also interested in grouping students that only use e-cigarettes and those that only use other forms of tobacco.</p>
<p>Recall that current users are a subset of ever users, thus students would typically answer yes to having tried vaping products if they had used them one or more days in the past 30 days.</p>
<p>First we will make a small toy dataset called <code>test</code> to show what we will do with the larger dataset:</p>
<div class="sourceCode" id="section-cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a>test &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">ecig_ever =</span> <span class="kw">c</span>(<span class="st">&quot;TRUE&quot;</span>, <span class="st">&quot;TRUE&quot;</span>, <span class="st">&quot;TRUE&quot;</span>, <span class="st">&quot;TRUE&quot;</span>, <span class="st">&quot;FALSE&quot;</span>,</span>
<span id="cb46-2"><a href="#cb46-2"></a>                             <span class="st">&quot;FALSE&quot;</span>, <span class="st">&quot;TRUE&quot;</span>, <span class="st">&quot;FALSE&quot;</span>, <span class="st">&quot;FALSE&quot;</span>),</span>
<span id="cb46-3"><a href="#cb46-3"></a>               <span class="dt">non_ecig_ever =</span> <span class="kw">c</span>(<span class="st">&quot;TRUE&quot;</span>, <span class="st">&quot;FALSE&quot;</span>, <span class="st">&quot;FALSE&quot;</span>, <span class="st">&quot;FALSE&quot;</span>, <span class="st">&quot;FALSE&quot;</span>,</span>
<span id="cb46-4"><a href="#cb46-4"></a>                                 <span class="st">&quot;FALSE&quot;</span>, <span class="st">&quot;TRUE&quot;</span>, <span class="st">&quot;TRUE&quot;</span>, <span class="st">&quot;TRUE&quot;</span>),</span>
<span id="cb46-5"><a href="#cb46-5"></a>               <span class="dt">ecig_current =</span> <span class="kw">c</span>(<span class="st">&quot;TRUE&quot;</span>, <span class="st">&quot;FALSE&quot;</span>, <span class="st">&quot;FALSE&quot;</span>, <span class="st">&quot;TRUE&quot;</span>, <span class="st">&quot;TRUE&quot;</span>, </span>
<span id="cb46-6"><a href="#cb46-6"></a>                                <span class="st">&quot;FALSE&quot;</span>, <span class="st">&quot;FALSE&quot;</span>, <span class="st">&quot;FALSE&quot;</span>, <span class="st">&quot;FALSE&quot;</span>),</span>
<span id="cb46-7"><a href="#cb46-7"></a>               <span class="dt">non_ecig_current =</span> <span class="kw">c</span>(<span class="st">&quot;TRUE&quot;</span>, <span class="st">&quot;FALSE&quot;</span>, <span class="st">&quot;TRUE&quot;</span>, <span class="st">&quot;FALSE&quot;</span>, <span class="st">&quot;TRUE&quot;</span>,</span>
<span id="cb46-8"><a href="#cb46-8"></a>                                    <span class="st">&quot;FALSE&quot;</span>, <span class="st">&quot;FALSE&quot;</span>, <span class="st">&quot;FALSE&quot;</span>, <span class="st">&quot;TRUE&quot;</span>))</span>
<span id="cb46-9"><a href="#cb46-9"></a></span>
<span id="cb46-10"><a href="#cb46-10"></a>test</span></code></pre></div>
<pre><code># A tibble: 9 x 4
  ecig_ever non_ecig_ever ecig_current non_ecig_current
  &lt;chr&gt;     &lt;chr&gt;         &lt;chr&gt;        &lt;chr&gt;           
1 TRUE      TRUE          TRUE         TRUE            
2 TRUE      FALSE         FALSE        FALSE           
3 TRUE      FALSE         FALSE        TRUE            
4 TRUE      FALSE         TRUE         FALSE           
5 FALSE     FALSE         TRUE         TRUE            
6 FALSE     FALSE         FALSE        FALSE           
7 TRUE      TRUE          FALSE        FALSE           
8 FALSE     TRUE          FALSE        FALSE           
9 FALSE     TRUE          FALSE        TRUE            </code></pre>
<p>Now, let’s look at identifying students who have tried e-cigarettes, but are not current users, and who have never tried other tobacco products (and are therefore not current users). We will again use the <code>case_when()</code> and the <code>mutate</code> function to create new variables with specific values when certain conditions are met. In this case, we will specify that several conditions must be met by using the <code>&amp;</code> symbol. For a value of <code>TRUE</code> for the new <code>ecig_only_ever</code> variable, all of the conditions combined with <code>&amp;</code> must be met. If any of the conditions are not met then the <code>ecig_only_ever</code> value will be <code>FALSE</code> based on the last line <code>TRUE ~ FALSE</code>.</p>
<div class="sourceCode" id="section-cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a>test &lt;-<span class="st"> </span>test <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">ecig_only_ever =</span> <span class="kw">case_when</span>(ecig_ever <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span> <span class="op">&amp;</span></span>
<span id="cb48-2"><a href="#cb48-2"></a><span class="st">                                               </span>non_ecig_ever <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span></span>
<span id="cb48-3"><a href="#cb48-3"></a><span class="st">                                                </span>ecig_current <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span></span>
<span id="cb48-4"><a href="#cb48-4"></a><span class="st">                                            </span>non_ecig_current <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">~</span><span class="st"> </span><span class="ot">TRUE</span>,</span>
<span id="cb48-5"><a href="#cb48-5"></a>                                                         <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="ot">FALSE</span>))</span>
<span id="cb48-6"><a href="#cb48-6"></a>test</span></code></pre></div>
<pre><code># A tibble: 9 x 5
  ecig_ever non_ecig_ever ecig_current non_ecig_current ecig_only_ever
  &lt;chr&gt;     &lt;chr&gt;         &lt;chr&gt;        &lt;chr&gt;            &lt;lgl&gt;         
1 TRUE      TRUE          TRUE         TRUE             FALSE         
2 TRUE      FALSE         FALSE        FALSE            TRUE          
3 TRUE      FALSE         FALSE        TRUE             FALSE         
4 TRUE      FALSE         TRUE         FALSE            FALSE         
5 FALSE     FALSE         TRUE         TRUE             FALSE         
6 FALSE     FALSE         FALSE        FALSE            FALSE         
7 TRUE      TRUE          FALSE        FALSE            FALSE         
8 FALSE     TRUE          FALSE        FALSE            FALSE         
9 FALSE     TRUE          FALSE        TRUE             FALSE         </code></pre>
<p>We can see from the second row, that the <code>ecig_only_ever</code> is <code>TRUE</code> when we would expect it to be. We can also see from the fourth row, that even though the student reported yes to ever trying e-cigarettes, because they also reported yes to currently using e-cigarettes the value for only ever trying e-cigarettes is <code>FALSE</code>. Additionally we can see from the seventh row that similarly even though the student reported yes to ever trying e-cigarettes, they also reported yes to ever trying other products, and the value for only ever trying e-cigarettes is <code>FALSE</code>. Importantly, we can see from the 6th row, that if all responses are negative than the value is <code>FALSE</code>.</p>
<p>Now we will expand this to the other possible categories. In this case we note that since current users are a subset of ever users, it doesn’t matter if a user reports yes to ever trying e-cigarettes, they can still be a current user.</p>
<div class="sourceCode" id="section-cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a>test &lt;-<span class="st"> </span>test <span class="op">%&gt;%</span></span>
<span id="cb50-2"><a href="#cb50-2"></a><span class="st">         </span><span class="kw">mutate</span>(<span class="dt">ecig_only_ever =</span> <span class="kw">case_when</span>(ecig_ever <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span> <span class="op">&amp;</span></span>
<span id="cb50-3"><a href="#cb50-3"></a><span class="st">                                       </span>non_ecig_ever <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span></span>
<span id="cb50-4"><a href="#cb50-4"></a><span class="st">                                        </span>ecig_current <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span></span>
<span id="cb50-5"><a href="#cb50-5"></a><span class="st">                                    </span>non_ecig_current <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">~</span><span class="st"> </span><span class="ot">TRUE</span>,</span>
<span id="cb50-6"><a href="#cb50-6"></a>                                                        <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="ot">FALSE</span>),</span>
<span id="cb50-7"><a href="#cb50-7"></a>          <span class="dt">ecig_only_current =</span> <span class="kw">case_when</span>(ecig_current <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span> <span class="op">&amp;</span></span>
<span id="cb50-8"><a href="#cb50-8"></a><span class="st">                                       </span>non_ecig_ever <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span></span>
<span id="cb50-9"><a href="#cb50-9"></a><span class="st">                                    </span>non_ecig_current <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">~</span><span class="st"> </span><span class="ot">TRUE</span>,</span>
<span id="cb50-10"><a href="#cb50-10"></a>                                                        <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="ot">FALSE</span>),</span>
<span id="cb50-11"><a href="#cb50-11"></a>        <span class="dt">non_ecig_only_ever =</span> <span class="kw">case_when</span>(non_ecig_ever <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span> <span class="op">&amp;</span></span>
<span id="cb50-12"><a href="#cb50-12"></a><span class="st">                                           </span>ecig_ever <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span></span>
<span id="cb50-13"><a href="#cb50-13"></a><span class="st">                                        </span>ecig_current <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span></span>
<span id="cb50-14"><a href="#cb50-14"></a><span class="st">                                    </span>non_ecig_current <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">~</span><span class="st"> </span><span class="ot">TRUE</span>,</span>
<span id="cb50-15"><a href="#cb50-15"></a>                                                        <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="ot">FALSE</span>),</span>
<span id="cb50-16"><a href="#cb50-16"></a>  <span class="dt">non_ecig_only_current =</span> <span class="kw">case_when</span>(non_ecig_current <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span> <span class="op">&amp;</span></span>
<span id="cb50-17"><a href="#cb50-17"></a><span class="st">                                           </span>ecig_ever <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span></span>
<span id="cb50-18"><a href="#cb50-18"></a><span class="st">                                        </span>ecig_current <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">~</span><span class="st"> </span><span class="ot">TRUE</span>,</span>
<span id="cb50-19"><a href="#cb50-19"></a>                                                        <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="ot">FALSE</span>),</span>
<span id="cb50-20"><a href="#cb50-20"></a>                    <span class="dt">no_use =</span> <span class="kw">case_when</span>(non_ecig_ever <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span></span>
<span id="cb50-21"><a href="#cb50-21"></a><span class="st">                                           </span>ecig_ever <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span></span>
<span id="cb50-22"><a href="#cb50-22"></a><span class="st">                                        </span>ecig_current <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span></span>
<span id="cb50-23"><a href="#cb50-23"></a><span class="st">                                    </span>non_ecig_current <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">~</span><span class="st"> </span><span class="ot">TRUE</span>,</span>
<span id="cb50-24"><a href="#cb50-24"></a>                                                        <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="ot">FALSE</span>))</span>
<span id="cb50-25"><a href="#cb50-25"></a><span class="kw">glimpse</span>(test)</span></code></pre></div>
<pre><code>Rows: 9
Columns: 9
$ ecig_ever             &lt;chr&gt; &quot;TRUE&quot;, &quot;TRUE&quot;, &quot;TRUE&quot;, &quot;TRUE&quot;, &quot;FALSE&quot;, &quot;FAL...
$ non_ecig_ever         &lt;chr&gt; &quot;TRUE&quot;, &quot;FALSE&quot;, &quot;FALSE&quot;, &quot;FALSE&quot;, &quot;FALSE&quot;, &quot;...
$ ecig_current          &lt;chr&gt; &quot;TRUE&quot;, &quot;FALSE&quot;, &quot;FALSE&quot;, &quot;TRUE&quot;, &quot;TRUE&quot;, &quot;FA...
$ non_ecig_current      &lt;chr&gt; &quot;TRUE&quot;, &quot;FALSE&quot;, &quot;TRUE&quot;, &quot;FALSE&quot;, &quot;TRUE&quot;, &quot;FA...
$ ecig_only_ever        &lt;lgl&gt; FALSE, TRUE, FALSE, FALSE, FALSE, FALSE, FALS...
$ ecig_only_current     &lt;lgl&gt; FALSE, FALSE, FALSE, TRUE, FALSE, FALSE, FALS...
$ non_ecig_only_ever    &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FAL...
$ non_ecig_only_current &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FAL...
$ no_use                &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, TRUE, FALS...</code></pre>
<p>Take a minute to check that the values are what we would expect.</p>
<p>OK, now we are going to make a <code>Group</code> variable based on the new variables we just made to classify students into one of four mutually exclusive and exhaustive categories. In this case we will have a particular value based on one condition <strong>or</strong> another. This <strong>or</strong> conditional is specified by the <code>|</code> symbol. Only one of the conditions needs to exist for that particular value, whereas when we used the <code>&amp;</code> symbol, all of the conditions had to be met.</p>
<p>If a student has ever tried or currently uses e-cigarettes, but has never tried other tobacco products, the value will be <code>Only e-cigarettes</code>. If a student has ever tried or is a current user of other tobacco products, but has never tried e-cigarettes, the value will be <code>Only other products</code>. If the value of the <code>no_use</code> variable is simply <code>TRUE</code>, then the <code>Group</code> variable value will be <code>Neither</code>. Finally, if a student has tried or currently uses both e-cigarettes and other tobacco products the <code>Group</code> variable value will be <code>Combination of products</code>. Thus in this case the values for the usage of the variables based on <strong>only</strong> using e-cigarettes or <strong>only</strong> other products will all be <code>FALSE</code>.</p>
<div class="sourceCode" id="section-cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a>test &lt;-<span class="st"> </span>test <span class="op">%&gt;%</span></span>
<span id="cb52-2"><a href="#cb52-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Group =</span> <span class="kw">case_when</span>(ecig_only_ever <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span> <span class="op">|</span></span>
<span id="cb52-3"><a href="#cb52-3"></a><span class="st">                        </span>ecig_only_current <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;Only e-cigarettes&quot;</span>,</span>
<span id="cb52-4"><a href="#cb52-4"></a>                       non_ecig_only_ever <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span> <span class="op">|</span></span>
<span id="cb52-5"><a href="#cb52-5"></a><span class="st">                    </span>non_ecig_only_current <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;Only other products&quot;</span>,</span>
<span id="cb52-6"><a href="#cb52-6"></a>                                   no_use <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;Neither&quot;</span>,</span>
<span id="cb52-7"><a href="#cb52-7"></a>                           ecig_only_ever <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span></span>
<span id="cb52-8"><a href="#cb52-8"></a><span class="st">                        </span>ecig_only_current <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span></span>
<span id="cb52-9"><a href="#cb52-9"></a><span class="st">                       </span>non_ecig_only_ever <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span></span>
<span id="cb52-10"><a href="#cb52-10"></a><span class="st">                    </span>non_ecig_only_current <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span></span>
<span id="cb52-11"><a href="#cb52-11"></a><span class="st">                                   </span>no_use <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">~</span><span class="st"> &quot;Combination of products&quot;</span>))</span>
<span id="cb52-12"><a href="#cb52-12"></a></span>
<span id="cb52-13"><a href="#cb52-13"></a></span>
<span id="cb52-14"><a href="#cb52-14"></a>test <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">count</span>(Group)</span></code></pre></div>
<pre><code># A tibble: 4 x 2
  Group                       n
  &lt;chr&gt;                   &lt;int&gt;
1 Combination of products     4
2 Neither                     1
3 Only e-cigarettes           2
4 Only other products         2</code></pre>
<div class="sourceCode" id="section-cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1"></a><span class="kw">glimpse</span>(test)</span></code></pre></div>
<pre><code>Rows: 9
Columns: 10
$ ecig_ever             &lt;chr&gt; &quot;TRUE&quot;, &quot;TRUE&quot;, &quot;TRUE&quot;, &quot;TRUE&quot;, &quot;FALSE&quot;, &quot;FAL...
$ non_ecig_ever         &lt;chr&gt; &quot;TRUE&quot;, &quot;FALSE&quot;, &quot;FALSE&quot;, &quot;FALSE&quot;, &quot;FALSE&quot;, &quot;...
$ ecig_current          &lt;chr&gt; &quot;TRUE&quot;, &quot;FALSE&quot;, &quot;FALSE&quot;, &quot;TRUE&quot;, &quot;TRUE&quot;, &quot;FA...
$ non_ecig_current      &lt;chr&gt; &quot;TRUE&quot;, &quot;FALSE&quot;, &quot;TRUE&quot;, &quot;FALSE&quot;, &quot;TRUE&quot;, &quot;FA...
$ ecig_only_ever        &lt;lgl&gt; FALSE, TRUE, FALSE, FALSE, FALSE, FALSE, FALS...
$ ecig_only_current     &lt;lgl&gt; FALSE, FALSE, FALSE, TRUE, FALSE, FALSE, FALS...
$ non_ecig_only_ever    &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FAL...
$ non_ecig_only_current &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FAL...
$ no_use                &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, TRUE, FALS...
$ Group                 &lt;chr&gt; &quot;Combination of products&quot;, &quot;Only e-cigarettes...</code></pre>
<p>OK, now that we have seen how this works with our toy dataset, we will apply our code to our <code>nyts_data</code>.</p>
<div class="sourceCode" id="section-cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1"></a>nyts_data <span class="op">%&lt;&gt;%</span></span>
<span id="cb56-2"><a href="#cb56-2"></a><span class="st">             </span><span class="kw">mutate</span>(<span class="dt">ecig_only_ever =</span> <span class="kw">case_when</span>(ecig_ever <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span> <span class="op">&amp;</span></span>
<span id="cb56-3"><a href="#cb56-3"></a><span class="st">                                           </span>non_ecig_ever <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span></span>
<span id="cb56-4"><a href="#cb56-4"></a><span class="st">                                            </span>ecig_current <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span></span>
<span id="cb56-5"><a href="#cb56-5"></a><span class="st">                                        </span>non_ecig_current <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">~</span><span class="st"> </span><span class="ot">TRUE</span>,</span>
<span id="cb56-6"><a href="#cb56-6"></a>                                                             <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="ot">FALSE</span>),</span>
<span id="cb56-7"><a href="#cb56-7"></a>              <span class="dt">ecig_only_current =</span> <span class="kw">case_when</span>(ecig_current <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span> <span class="op">&amp;</span></span>
<span id="cb56-8"><a href="#cb56-8"></a><span class="st">                                           </span>non_ecig_ever <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span></span>
<span id="cb56-9"><a href="#cb56-9"></a><span class="st">                                        </span>non_ecig_current <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">~</span><span class="st"> </span><span class="ot">TRUE</span>,</span>
<span id="cb56-10"><a href="#cb56-10"></a>                                                            <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="ot">FALSE</span>),</span>
<span id="cb56-11"><a href="#cb56-11"></a>            <span class="dt">non_ecig_only_ever =</span> <span class="kw">case_when</span>(non_ecig_ever <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span> <span class="op">&amp;</span></span>
<span id="cb56-12"><a href="#cb56-12"></a><span class="st">                                               </span>ecig_ever <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span></span>
<span id="cb56-13"><a href="#cb56-13"></a><span class="st">                                            </span>ecig_current <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span></span>
<span id="cb56-14"><a href="#cb56-14"></a><span class="st">                                        </span>non_ecig_current <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">~</span><span class="st"> </span><span class="ot">TRUE</span>,</span>
<span id="cb56-15"><a href="#cb56-15"></a>                                                            <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="ot">FALSE</span>),</span>
<span id="cb56-16"><a href="#cb56-16"></a>      <span class="dt">non_ecig_only_current =</span> <span class="kw">case_when</span>(non_ecig_current <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span> <span class="op">&amp;</span></span>
<span id="cb56-17"><a href="#cb56-17"></a><span class="st">                                               </span>ecig_ever <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span></span>
<span id="cb56-18"><a href="#cb56-18"></a><span class="st">                                            </span>ecig_current <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">~</span><span class="st"> </span><span class="ot">TRUE</span>,</span>
<span id="cb56-19"><a href="#cb56-19"></a>                                                            <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="ot">FALSE</span>),</span>
<span id="cb56-20"><a href="#cb56-20"></a>                        <span class="dt">no_use =</span> <span class="kw">case_when</span>(non_ecig_ever <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span></span>
<span id="cb56-21"><a href="#cb56-21"></a><span class="st">                                               </span>ecig_ever <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span></span>
<span id="cb56-22"><a href="#cb56-22"></a><span class="st">                                            </span>ecig_current <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span></span>
<span id="cb56-23"><a href="#cb56-23"></a><span class="st">                                        </span>non_ecig_current <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">~</span><span class="st"> </span><span class="ot">TRUE</span>,</span>
<span id="cb56-24"><a href="#cb56-24"></a>                                                            <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="ot">FALSE</span>)) <span class="op">%&gt;%</span></span>
<span id="cb56-25"><a href="#cb56-25"></a><span class="st">                 </span><span class="kw">mutate</span>(<span class="dt">Group =</span> <span class="kw">case_when</span>(ecig_only_ever <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span> <span class="op">|</span></span>
<span id="cb56-26"><a href="#cb56-26"></a><span class="st">                                       </span>ecig_only_current <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;Only e-cigarettes&quot;</span>,</span>
<span id="cb56-27"><a href="#cb56-27"></a>                                      non_ecig_only_ever <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span> <span class="op">|</span></span>
<span id="cb56-28"><a href="#cb56-28"></a><span class="st">                                   </span>non_ecig_only_current <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;Only other products&quot;</span>,</span>
<span id="cb56-29"><a href="#cb56-29"></a>                                                  no_use <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;Neither&quot;</span>,</span>
<span id="cb56-30"><a href="#cb56-30"></a>                                          ecig_only_ever <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span></span>
<span id="cb56-31"><a href="#cb56-31"></a><span class="st">                                       </span>ecig_only_current <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span></span>
<span id="cb56-32"><a href="#cb56-32"></a><span class="st">                                      </span>non_ecig_only_ever <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span></span>
<span id="cb56-33"><a href="#cb56-33"></a><span class="st">                                   </span>non_ecig_only_current <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span></span>
<span id="cb56-34"><a href="#cb56-34"></a><span class="st">                                                  </span>no_use <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">~</span><span class="st"> &quot;Combination of products&quot;</span>))</span></code></pre></div>
<p>Lastly, it can be very helpful to have the total number of students surveyed each year. We can easily add a variable for this by using the <code>add_count()</code> function of the <code>dplyr</code> package. This will create a variable called <code>n</code> which will show the total number of survey responses for that year.</p>
<div class="sourceCode" id="section-cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1"></a>nyts_data <span class="op">%&lt;&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">add_count</span>(year)</span></code></pre></div>
</div>
<div id="section-section-22" class="section level4 scrollable">
<h4></h4>
<div class="sourceCode" id="section-cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a><span class="kw">glimpse</span>(nyts_data)</span></code></pre></div>
<pre><code>Rows: 95,465
Columns: 59
$ year                  &lt;dbl&gt; 2015, 2015, 2015, 2015, 2015, 2015, 2015, 201...
$ psu                   &lt;chr&gt; &quot;015438&quot;, &quot;015438&quot;, &quot;015438&quot;, &quot;015438&quot;, &quot;0154...
$ finwgt                &lt;dbl&gt; 216.7268, 324.9620, 324.9620, 397.1552, 264.8...
$ stratum               &lt;chr&gt; &quot;BR3&quot;, &quot;BR3&quot;, &quot;BR3&quot;, &quot;BR3&quot;, &quot;BR3&quot;, &quot;BR3&quot;, &quot;BR...
$ Age                   &lt;fct&gt; 18, 17, 18, 18, 18, 18, 18, 18, 18, 18, 18, 1...
$ Sex                   &lt;fct&gt; female, male, male, male, female, female, mal...
$ Grade                 &lt;fct&gt; 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 1...
$ ECIGT                 &lt;lgl&gt; FALSE, TRUE, FALSE, TRUE, FALSE, TRUE, TRUE, ...
$ ECIGAR                &lt;lgl&gt; TRUE, TRUE, FALSE, FALSE, FALSE, FALSE, TRUE,...
$ ESLT                  &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, TRU...
$ EELCIGT               &lt;lgl&gt; FALSE, TRUE, FALSE, TRUE, FALSE, TRUE, TRUE, ...
$ EROLLCIGTS            &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, TRU...
$ EFLAVCIGTS            &lt;lgl&gt; FALSE, FALSE, FALSE, TRUE, FALSE, FALSE, TRUE...
$ EBIDIS                &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FAL...
$ EFLAVCIGAR            &lt;lgl&gt; FALSE, TRUE, FALSE, FALSE, FALSE, FALSE, TRUE...
$ EHOOKAH               &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FAL...
$ EPIPE                 &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FAL...
$ ESNUS                 &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, TRU...
$ EDISSOLV              &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FAL...
$ CCIGT                 &lt;lgl&gt; FALSE, TRUE, FALSE, FALSE, FALSE, FALSE, FALS...
$ CCIGAR                &lt;lgl&gt; FALSE, TRUE, FALSE, FALSE, FALSE, FALSE, FALS...
$ CSLT                  &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FAL...
$ CELCIGT               &lt;lgl&gt; FALSE, FALSE, FALSE, TRUE, FALSE, FALSE, FALS...
$ CROLLCIGTS            &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FAL...
$ CFLAVCIGTS            &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FAL...
$ CBIDIS                &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FAL...
$ CHOOKAH               &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FAL...
$ CPIPE                 &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FAL...
$ CSNUS                 &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FAL...
$ CDISSOLV              &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FAL...
$ menthol               &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N...
$ clove_spice           &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N...
$ fruit                 &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N...
$ chocolate             &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N...
$ alcoholic_drink       &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N...
$ candy_dessert_sweets  &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N...
$ other                 &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N...
$ EHTP                  &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N...
$ CHTP                  &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N...
$ brand_ecig            &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N...
$ tobacco_sum_ever      &lt;dbl&gt; 1, 4, 0, 3, 0, 2, 8, 4, 0, 0, 0, 1, 1, 0, 0, ...
$ tobacco_sum_current   &lt;dbl&gt; 0, 2, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...
$ tobacco_ever          &lt;lgl&gt; TRUE, TRUE, FALSE, TRUE, FALSE, TRUE, TRUE, T...
$ tobacco_current       &lt;lgl&gt; FALSE, TRUE, FALSE, TRUE, FALSE, FALSE, FALSE...
$ ecig_sum_ever         &lt;dbl&gt; 0, 1, 0, 1, 0, 1, 1, 1, 0, 0, 0, 1, 0, 0, 0, ...
$ ecig_sum_current      &lt;dbl&gt; 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...
$ non_ecig_sum_ever     &lt;dbl&gt; 1, 3, 0, 2, 0, 1, 7, 3, 0, 0, 0, 0, 1, 0, 0, ...
$ non_ecig_sum_current  &lt;dbl&gt; 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...
$ ecig_ever             &lt;lgl&gt; FALSE, TRUE, FALSE, TRUE, FALSE, TRUE, TRUE, ...
$ ecig_current          &lt;lgl&gt; FALSE, FALSE, FALSE, TRUE, FALSE, FALSE, FALS...
$ non_ecig_ever         &lt;lgl&gt; TRUE, TRUE, FALSE, TRUE, FALSE, TRUE, TRUE, T...
$ non_ecig_current      &lt;lgl&gt; FALSE, TRUE, FALSE, FALSE, FALSE, FALSE, FALS...
$ ecig_only_ever        &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FAL...
$ ecig_only_current     &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FAL...
$ non_ecig_only_ever    &lt;lgl&gt; TRUE, FALSE, FALSE, FALSE, FALSE, FALSE, FALS...
$ non_ecig_only_current &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FAL...
$ no_use                &lt;lgl&gt; FALSE, FALSE, TRUE, FALSE, TRUE, FALSE, FALSE...
$ Group                 &lt;chr&gt; &quot;Only other products&quot;, &quot;Combination of produc...
$ n                     &lt;int&gt; 17711, 17711, 17711, 17711, 17711, 17711, 177...</code></pre>
</div>
<div id="section-question-1" class="section level3">
<h3><strong>Question 1</strong></h3>
<hr />
<p>Recall that we are interested in investigating how vaping product use has compared with other tobacco use over time. To answer this, we first want to get a sense of how tobacco use has changed in general since 2015.</p>
<p>To create a visualization of how tobacco usage has changed over time, we will first convert the usage data to a percent value for each year, telling us what percent of student respondents fall into a particular usage category. To do this we will use the <code>group_by()</code> and <code>summarize()</code> functions of the <code>dplyr</code> package. This will create new variables which we will name <code>Ever</code> and <code>Current</code> based on the percentages of <code>TRUE</code> values for <code>tobacco_ever</code> and <code>tobacco_current</code> for each year. In this case the <code>mean()</code> function is used to calculate the percentages based on an automatic conversion that R does where for TRUE/FALSE variables, <code>TRUE</code> is given a value of one and <code>FALSE</code> is given a value of zero. The mean of a 0-1 binary variable is just the percent of the time the value is 1. NA values do not contribute to the total count when we include the argument <code>na.rm = TRUE</code> to our function call.</p>
<hr />
<details>
<p><summary> Click here to see a toy example:</summary></p>
<div class="sourceCode" id="section-cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1"></a><span class="co"># the test data has 3 TRUE values and 7 FALSE values</span></span>
<span id="cb60-2"><a href="#cb60-2"></a>test &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="st">&quot;var1&quot;</span> =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;TRUE&quot;</span>, <span class="st">&quot;TRUE&quot;</span>, <span class="st">&quot;TRUE&quot;</span>, <span class="kw">rep</span>(<span class="st">&quot;FALSE&quot;</span>, <span class="dv">7</span>)))</span>
<span id="cb60-3"><a href="#cb60-3"></a>test <span class="op">%&lt;&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">var1 =</span> <span class="kw">as.logical</span>(var1))</span>
<span id="cb60-4"><a href="#cb60-4"></a>test</span></code></pre></div>
<pre><code># A tibble: 10 x 1
   var1 
   &lt;lgl&gt;
 1 TRUE 
 2 TRUE 
 3 TRUE 
 4 FALSE
 5 FALSE
 6 FALSE
 7 FALSE
 8 FALSE
 9 FALSE
10 FALSE</code></pre>
<div class="sourceCode" id="section-cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1"></a>test <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">Percentage =</span> <span class="kw">mean</span>(var1) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>)</span></code></pre></div>
<pre><code># A tibble: 1 x 1
  Percentage
       &lt;dbl&gt;
1         30</code></pre>
<div class="sourceCode" id="section-cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1"></a><span class="co"># the test data has 3 TRUE values, 3 FALSE values, and 4 NA value</span></span>
<span id="cb64-2"><a href="#cb64-2"></a>test &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="st">&quot;var1&quot;</span> =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;TRUE&quot;</span>, <span class="st">&quot;TRUE&quot;</span>, <span class="st">&quot;TRUE&quot;</span>, <span class="kw">rep</span>(<span class="st">&quot;FALSE&quot;</span>, <span class="dv">3</span>), <span class="kw">rep</span>(<span class="st">&quot;NA&quot;</span>, <span class="dv">4</span>)))</span>
<span id="cb64-3"><a href="#cb64-3"></a>test <span class="op">%&lt;&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">var1 =</span> <span class="kw">as.logical</span>(var1))</span>
<span id="cb64-4"><a href="#cb64-4"></a>test</span></code></pre></div>
<pre><code># A tibble: 10 x 1
   var1 
   &lt;lgl&gt;
 1 TRUE 
 2 TRUE 
 3 TRUE 
 4 FALSE
 5 FALSE
 6 FALSE
 7 NA   
 8 NA   
 9 NA   
10 NA   </code></pre>
<div class="sourceCode" id="section-cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1"></a>test <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">Percentage =</span> <span class="kw">mean</span>(var1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>)</span></code></pre></div>
<pre><code># A tibble: 1 x 1
  Percentage
       &lt;dbl&gt;
1         50</code></pre>
</details>
<hr />
<p>And now back to our data:</p>
<div class="sourceCode" id="section-cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1"></a>nyts_data <span class="op">%&gt;%</span></span>
<span id="cb68-2"><a href="#cb68-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(year) <span class="op">%&gt;%</span></span>
<span id="cb68-3"><a href="#cb68-3"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">summarize</span>(<span class="dt">Ever =</span> (<span class="kw">mean</span>(tobacco_ever, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>),</span>
<span id="cb68-4"><a href="#cb68-4"></a>                   <span class="dt">Current =</span> (<span class="kw">mean</span>(tobacco_current, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>))</span></code></pre></div>
<pre><code># A tibble: 5 x 3
   year  Ever Current
  &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;
1  2015  36.8    18.0
2  2016  33.4    14.0
3  2017  31.8    14.4
4  2018  34.7    18.7
5  2019  39.7    22.4</code></pre>
<p>We will use the <code>pivot_longer</code> function from the <code>tidyr</code> package to take all columns except year (in this case the <code>Ever</code> and <code>Current</code> columns), to create a column called <code>User</code> that will contain the current column name information and a column called <code>Percentage of students</code> which will contain the mean percentage values that we just calculated. This converts our data into a format called “long” format.</p>
<div class="sourceCode" id="section-cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1"></a>nyts_data <span class="op">%&gt;%</span></span>
<span id="cb70-2"><a href="#cb70-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(year) <span class="op">%&gt;%</span></span>
<span id="cb70-3"><a href="#cb70-3"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">summarize</span>(<span class="dt">Ever =</span> (<span class="kw">mean</span>(tobacco_ever, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>),</span>
<span id="cb70-4"><a href="#cb70-4"></a>                   <span class="dt">Current =</span> (<span class="kw">mean</span>(tobacco_current, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>)) <span class="op">%&gt;%</span></span>
<span id="cb70-5"><a href="#cb70-5"></a><span class="st">  </span>tidyr<span class="op">::</span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="op">-</span>year,</span>
<span id="cb70-6"><a href="#cb70-6"></a>                      <span class="dt">names_to =</span> <span class="st">&quot;User&quot;</span>,</span>
<span id="cb70-7"><a href="#cb70-7"></a>                      <span class="dt">values_to =</span> <span class="st">&quot;Percentage of students&quot;</span>)</span></code></pre></div>
<pre><code># A tibble: 10 x 3
    year User    `Percentage of students`
   &lt;dbl&gt; &lt;chr&gt;                      &lt;dbl&gt;
 1  2015 Ever                        36.8
 2  2015 Current                     18.0
 3  2016 Ever                        33.4
 4  2016 Current                     14.0
 5  2017 Ever                        31.8
 6  2017 Current                     14.4
 7  2018 Ever                        34.7
 8  2018 Current                     18.7
 9  2019 Ever                        39.7
10  2019 Current                     22.4</code></pre>
<p>You may have noticed that our data is longer than it used to be! Hence the name of the function <code>pivot_longer()</code>. Data is often easier to plot when it is in this format.</p>
<p>Now we will use this data to create a plot using the <code>ggplot2</code> package.</p>
<p>The first thing we do to create a plot is specify what data we are using for our x axis and y axis with the<code>aes()</code> argument of the <code>ggplot()</code> function. Then we add layers to our plot that specify what type of plot we would like to create. We can use the <code>geom_line()</code> function to create lines for each type of user. We specify that we want to use different line types for each user using <code>aes()</code>. We will also add points to our lines using the <code>geom_point()</code> function. We can add additional layers to specify colors and details about labels and legends etc.</p>
<div class="sourceCode" id="section-cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1"></a>plot1 &lt;-<span class="st"> </span>nyts_data <span class="op">%&gt;%</span></span>
<span id="cb72-2"><a href="#cb72-2"></a><span class="st">    </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(year) <span class="op">%&gt;%</span></span>
<span id="cb72-3"><a href="#cb72-3"></a><span class="st">    </span>dplyr<span class="op">::</span><span class="kw">summarize</span>(<span class="dt">Ever =</span> (<span class="kw">mean</span>(tobacco_ever, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>),</span>
<span id="cb72-4"><a href="#cb72-4"></a>                     <span class="dt">Current =</span> (<span class="kw">mean</span>(tobacco_current, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>)) <span class="op">%&gt;%</span></span>
<span id="cb72-5"><a href="#cb72-5"></a><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="op">-</span>year, <span class="dt">names_to =</span> <span class="st">&quot;User&quot;</span>, <span class="dt">values_to =</span> <span class="st">&quot;Percentage of students&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb72-6"><a href="#cb72-6"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> year, <span class="dt">y =</span> <span class="st">`</span><span class="dt">Percentage of students</span><span class="st">`</span>)) <span class="op">+</span></span>
<span id="cb72-7"><a href="#cb72-7"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">linetype =</span> User)) <span class="op">+</span></span>
<span id="cb72-8"><a href="#cb72-8"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">show.legend =</span> <span class="ot">FALSE</span>, <span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb72-9"><a href="#cb72-9"></a><span class="st">  </span><span class="co"># this allows us to choose what type of line we want for each line</span></span>
<span id="cb72-10"><a href="#cb72-10"></a><span class="st">  </span><span class="kw">scale_linetype_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">1</span>)) <span class="op">+</span></span>
<span id="cb72-11"><a href="#cb72-11"></a><span class="st">  </span><span class="co"># this allows us to specify how the y-axis should appear</span></span>
<span id="cb72-12"><a href="#cb72-12"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">70</span>, <span class="dt">by =</span> <span class="dv">10</span>),</span>
<span id="cb72-13"><a href="#cb72-13"></a>                     <span class="dt">labels =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">70</span>, <span class="dt">by =</span> <span class="dv">10</span>),</span>
<span id="cb72-14"><a href="#cb72-14"></a>                     <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">70</span>)) <span class="op">+</span></span>
<span id="cb72-15"><a href="#cb72-15"></a><span class="st">  </span><span class="co"># this adjusts the background style of the plot</span></span>
<span id="cb72-16"><a href="#cb72-16"></a><span class="st">    </span><span class="kw">theme_linedraw</span>() <span class="op">+</span></span>
<span id="cb72-17"><a href="#cb72-17"></a><span class="st">  </span><span class="co"># this moves the legend to the bottom of the plot and removes the x axis title</span></span>
<span id="cb72-18"><a href="#cb72-18"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb72-19"><a href="#cb72-19"></a>          <span class="dt">axis.title.x =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></span>
<span id="cb72-20"><a href="#cb72-20"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;How has tobacco use varied over the years?&quot;</span>,</span>
<span id="cb72-21"><a href="#cb72-21"></a>         <span class="dt">y =</span> <span class="st">&quot;% of students&quot;</span>)</span>
<span id="cb72-22"><a href="#cb72-22"></a></span>
<span id="cb72-23"><a href="#cb72-23"></a>plot1</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-59-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Nice! Now we can see how overall tobacco usage has changed since 2017. It appears that usage first decreased from 2015 to 2017 and then increased a bit since 2017, surpassing the levels in 2015.</p>
<p>What about e-cigarette use? How has the usage of e-cigarettes changed over time?</p>
<div class="sourceCode" id="section-cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1"></a>plot1a &lt;-<span class="st"> </span>nyts_data <span class="op">%&gt;%</span></span>
<span id="cb73-2"><a href="#cb73-2"></a><span class="st">    </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(year) <span class="op">%&gt;%</span></span>
<span id="cb73-3"><a href="#cb73-3"></a><span class="st">    </span>dplyr<span class="op">::</span><span class="kw">summarize</span>(<span class="dt">Ever =</span> (<span class="kw">mean</span>(ecig_ever, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>),</span>
<span id="cb73-4"><a href="#cb73-4"></a>                     <span class="dt">Current =</span> (<span class="kw">mean</span>(ecig_current, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>)) <span class="op">%&gt;%</span></span>
<span id="cb73-5"><a href="#cb73-5"></a><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="op">-</span>year, <span class="dt">names_to =</span> <span class="st">&quot;User&quot;</span>, <span class="dt">values_to =</span> <span class="st">&quot;Percentage of students&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb73-6"><a href="#cb73-6"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> year, <span class="dt">y =</span> <span class="st">`</span><span class="dt">Percentage of students</span><span class="st">`</span>)) <span class="op">+</span></span>
<span id="cb73-7"><a href="#cb73-7"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">linetype =</span> User)) <span class="op">+</span></span>
<span id="cb73-8"><a href="#cb73-8"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">show.legend =</span> <span class="ot">FALSE</span>, <span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb73-9"><a href="#cb73-9"></a><span class="st">  </span><span class="co"># this allows us to choose what type of line we want for each line</span></span>
<span id="cb73-10"><a href="#cb73-10"></a><span class="st">  </span><span class="kw">scale_linetype_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">1</span>)) <span class="op">+</span></span>
<span id="cb73-11"><a href="#cb73-11"></a><span class="st">  </span><span class="co"># this allows us to specify how the y-axis should appear</span></span>
<span id="cb73-12"><a href="#cb73-12"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">60</span>, <span class="dt">by =</span> <span class="dv">10</span>),</span>
<span id="cb73-13"><a href="#cb73-13"></a>                     <span class="dt">labels =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">60</span>, <span class="dt">by =</span> <span class="dv">10</span>),</span>
<span id="cb73-14"><a href="#cb73-14"></a>                     <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">60</span>)) <span class="op">+</span></span>
<span id="cb73-15"><a href="#cb73-15"></a><span class="st">  </span><span class="co"># this adjusts the background style of the plot</span></span>
<span id="cb73-16"><a href="#cb73-16"></a><span class="st">    </span><span class="kw">theme_linedraw</span>() <span class="op">+</span></span>
<span id="cb73-17"><a href="#cb73-17"></a><span class="st">  </span><span class="co"># this moves the legend to the bottom of the plot and removes the x axis title</span></span>
<span id="cb73-18"><a href="#cb73-18"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb73-19"><a href="#cb73-19"></a>          <span class="dt">axis.title.x =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></span>
<span id="cb73-20"><a href="#cb73-20"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;How has e-cigarette use varied over the years?&quot;</span>,</span>
<span id="cb73-21"><a href="#cb73-21"></a>         <span class="dt">y =</span> <span class="st">&quot;% of students&quot;</span>)</span>
<span id="cb73-22"><a href="#cb73-22"></a></span>
<span id="cb73-23"><a href="#cb73-23"></a>plot1a</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-60-1.png" width="90%" style="display: block; margin: auto;" /> It looks like the shape of the plot is very similar to tobacco usage overall. We see a downward trend until 2017 when the rate of both current and ever users increased. Recall that this is in agreement with the articles that we referenced earlier. We can see that the slope looks steeper for e-cigarette usage as compared to all tobacco products (including e-cigarettes).</p>
<p>Now let’s plot this data together on the same plot.</p>
<p>We will have four groups (e-cigarette ever users, e-cigarette current users, tobacco ever users, and tobacco current users) to plot, therefore, it would be useful to add color to our plot. Keep in mind that e-cigarette users are a subset of any tobacco product users.</p>
<p>One important thing to keep in mind when creating plots is that individuals with color blindness may have a difficult time distinguishing groups when certain color choices are used.</p>
<p>One great option is to use the <code>viridis</code> package, which offers color palettes with colors that are still distinguishable by individuals with most forms of color blindness.</p>
<p>We can choose which colors we want to use by using the <code>show_col()</code> function of the <code>scales</code> package.</p>
<p>Here are some color options:</p>
<div class="sourceCode" id="section-cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1"></a>scales<span class="op">::</span><span class="kw">show_col</span>(<span class="kw">viridis_pal</span>()(<span class="dv">6</span>))</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-61-1.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="section-cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1"></a>v_colors =<span class="st">  </span><span class="kw">viridis</span>(<span class="dv">6</span>)[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">4</span>)]</span></code></pre></div>
<p>We will select the first and fourth colors for our plot. To add these specific colors we will use the <code>scale_color_manual()</code> function of the <code>ggplot2</code> package.</p>
<p>We will calculate the mean ever and current usage percentages for students who used e-cigarettes or any tobacco products (including e-cigarettes) for each year again using the <code>group_by()</code> and <code>summarize()</code> functions. We will again use the <code>pivot_longer</code> function to convert our data to long format. We will also use the <code>separate()</code> function of the <code>tidyr</code> package to create two variables from one of the variables. This is done by separating by, in this case, an underscore.</p>
<div class="sourceCode" id="section-cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1"></a>nyts_data <span class="op">%&gt;%</span></span>
<span id="cb76-2"><a href="#cb76-2"></a><span class="st">    </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(year) <span class="op">%&gt;%</span></span>
<span id="cb76-3"><a href="#cb76-3"></a><span class="st">    </span>dplyr<span class="op">::</span><span class="kw">summarize</span>(<span class="st">&quot;Ever_Any Tobacco Product </span><span class="ch">\n</span><span class="st"> (including e-cigarettes)&quot;</span> =<span class="st"> </span></span>
<span id="cb76-4"><a href="#cb76-4"></a><span class="st">                       </span>(<span class="kw">mean</span>(tobacco_ever, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>),</span>
<span id="cb76-5"><a href="#cb76-5"></a>                     <span class="st">&quot;Current_Any Tobacco Product </span><span class="ch">\n</span><span class="st"> (including e-cigarettes)&quot;</span> =<span class="st">   </span></span>
<span id="cb76-6"><a href="#cb76-6"></a><span class="st">                       </span>(<span class="kw">mean</span>(tobacco_current, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>),</span>
<span id="cb76-7"><a href="#cb76-7"></a>                     <span class="st">&quot;Ever_E-cigarettes&quot;</span> =<span class="st"> </span></span>
<span id="cb76-8"><a href="#cb76-8"></a><span class="st">                       </span>(<span class="kw">mean</span>(ecig_ever, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>),</span>
<span id="cb76-9"><a href="#cb76-9"></a>                     <span class="st">&quot;Current_E-cigarettes&quot;</span> =<span class="st"> </span></span>
<span id="cb76-10"><a href="#cb76-10"></a><span class="st">                       </span>(<span class="kw">mean</span>(ecig_current, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>)) <span class="op">%&gt;%</span></span>
<span id="cb76-11"><a href="#cb76-11"></a><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="op">-</span>year, </span>
<span id="cb76-12"><a href="#cb76-12"></a>           <span class="dt">names_to =</span> <span class="st">&quot;User&quot;</span>, </span>
<span id="cb76-13"><a href="#cb76-13"></a>          <span class="dt">values_to =</span> <span class="st">&quot;Percentage of students&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb76-14"><a href="#cb76-14"></a><span class="st">  </span><span class="kw">separate</span>(User, <span class="dt">into =</span> <span class="kw">c</span>(<span class="st">&quot;User&quot;</span>, <span class="st">&quot;Product&quot;</span>), <span class="dt">sep =</span> <span class="st">&quot;_&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb76-15"><a href="#cb76-15"></a><span class="st">  </span><span class="kw">head</span>()</span></code></pre></div>
<pre><code># A tibble: 6 x 4
   year User    Product                                   `Percentage of studen~
  &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;                                                      &lt;dbl&gt;
1  2015 Ever    &quot;Any Tobacco Product \n (including e-cig~                   36.8
2  2015 Current &quot;Any Tobacco Product \n (including e-cig~                   18.0
3  2015 Ever    &quot;E-cigarettes&quot;                                              26.4
4  2015 Current &quot;E-cigarettes&quot;                                              11.0
5  2016 Ever    &quot;Any Tobacco Product \n (including e-cig~                   33.4
6  2016 Current &quot;Any Tobacco Product \n (including e-cig~                   14.0</code></pre>
<div class="sourceCode" id="section-cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1"></a>plot1t &lt;-<span class="st"> </span>nyts_data <span class="op">%&gt;%</span></span>
<span id="cb78-2"><a href="#cb78-2"></a><span class="st">    </span><span class="kw">group_by</span>(year) <span class="op">%&gt;%</span></span>
<span id="cb78-3"><a href="#cb78-3"></a><span class="st">    </span><span class="kw">summarize</span>(<span class="st">&quot;Ever_Any Tobacco Product </span><span class="ch">\n</span><span class="st"> (including e-cigarettes)&quot;</span> =<span class="st"> </span></span>
<span id="cb78-4"><a href="#cb78-4"></a><span class="st">                </span>(<span class="kw">mean</span>(tobacco_ever, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>),</span>
<span id="cb78-5"><a href="#cb78-5"></a>              <span class="st">&quot;Current_Any Tobacco Product </span><span class="ch">\n</span><span class="st"> (including e-cigarettes)&quot;</span> =<span class="st"> </span></span>
<span id="cb78-6"><a href="#cb78-6"></a><span class="st">                </span>(<span class="kw">mean</span>(tobacco_current, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>),</span>
<span id="cb78-7"><a href="#cb78-7"></a>              <span class="st">&quot;Ever_E-cigarettes&quot;</span> =<span class="st"> </span></span>
<span id="cb78-8"><a href="#cb78-8"></a><span class="st">                </span>(<span class="kw">mean</span>(ecig_ever, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>),</span>
<span id="cb78-9"><a href="#cb78-9"></a>               <span class="st">&quot;Current_E-cigarettes&quot;</span> =<span class="st"> </span></span>
<span id="cb78-10"><a href="#cb78-10"></a><span class="st">                </span>(<span class="kw">mean</span>(ecig_current, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>)) <span class="op">%&gt;%</span></span>
<span id="cb78-11"><a href="#cb78-11"></a><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="op">-</span>year, </span>
<span id="cb78-12"><a href="#cb78-12"></a>           <span class="dt">names_to =</span> <span class="st">&quot;User&quot;</span>, </span>
<span id="cb78-13"><a href="#cb78-13"></a>          <span class="dt">values_to =</span> <span class="st">&quot;Percentage of students&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb78-14"><a href="#cb78-14"></a><span class="st">  </span><span class="kw">separate</span>(User, </span>
<span id="cb78-15"><a href="#cb78-15"></a>           <span class="dt">into =</span> <span class="kw">c</span>(<span class="st">&quot;User&quot;</span>, <span class="st">&quot;Product&quot;</span>), </span>
<span id="cb78-16"><a href="#cb78-16"></a>            <span class="dt">sep =</span> <span class="st">&quot;_&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb78-17"><a href="#cb78-17"></a><span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> year, </span>
<span id="cb78-18"><a href="#cb78-18"></a>               <span class="dt">y =</span> <span class="st">`</span><span class="dt">Percentage of students</span><span class="st">`</span>,</span>
<span id="cb78-19"><a href="#cb78-19"></a>           <span class="dt">color =</span> Product)) <span class="op">+</span></span>
<span id="cb78-20"><a href="#cb78-20"></a><span class="st">    </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">linetype =</span> User)) <span class="op">+</span></span>
<span id="cb78-21"><a href="#cb78-21"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">show.legend =</span> <span class="ot">FALSE</span>, <span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb78-22"><a href="#cb78-22"></a><span class="st">  </span><span class="co"># this allows us to choose what type of line we want for each line</span></span>
<span id="cb78-23"><a href="#cb78-23"></a><span class="st">  </span><span class="kw">scale_linetype_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">1</span>)) <span class="op">+</span></span>
<span id="cb78-24"><a href="#cb78-24"></a><span class="st">  </span><span class="co"># we want purple associated with e-cigarettes to be consistent with later plots</span></span>
<span id="cb78-25"><a href="#cb78-25"></a><span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">rev</span>(v_colors)) <span class="op">+</span></span>
<span id="cb78-26"><a href="#cb78-26"></a><span class="st">  </span><span class="co"># this allows us to specify how the y-axis should appear</span></span>
<span id="cb78-27"><a href="#cb78-27"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">60</span>, <span class="dt">by =</span> <span class="dv">10</span>),</span>
<span id="cb78-28"><a href="#cb78-28"></a>                     <span class="dt">labels =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">60</span>, <span class="dt">by =</span> <span class="dv">10</span>),</span>
<span id="cb78-29"><a href="#cb78-29"></a>                     <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">60</span>)) <span class="op">+</span></span>
<span id="cb78-30"><a href="#cb78-30"></a><span class="st">  </span><span class="co"># this adjusts the background style of the plot</span></span>
<span id="cb78-31"><a href="#cb78-31"></a><span class="st">    </span><span class="kw">theme_linedraw</span>() <span class="op">+</span></span>
<span id="cb78-32"><a href="#cb78-32"></a><span class="st">  </span><span class="co"># this moves the legend to the bottom of the plot and removes the x axis title</span></span>
<span id="cb78-33"><a href="#cb78-33"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb78-34"><a href="#cb78-34"></a>          <span class="dt">axis.title.x =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></span>
<span id="cb78-35"><a href="#cb78-35"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;How has tobacco use varied over the years?&quot;</span>,</span>
<span id="cb78-36"><a href="#cb78-36"></a>         <span class="dt">y =</span> <span class="st">&quot;% of students&quot;</span>)</span>
<span id="cb78-37"><a href="#cb78-37"></a></span>
<span id="cb78-38"><a href="#cb78-38"></a>plot1t</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-62-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>We see an increase in all categories starting in 2017, but the rate of increase is higher for students using only e-cigarettes (current or ever users), as shown by the higher slope of the e-cigarette lines.</p>
<p>In the above plots, the “Any tobacco product” groups include individuals in the “E-cigarette only” groups. Now let’s plot students in two mutually exclusive groups on the same plot: those who reported either using only e-cigarettes or only other tobacco products (besides e-cigarettes), but not both.</p>
<p>We will calculate the mean ever and current usage percentages for students in these two mutually exclusive groups, again using the <code>group_by()</code> function and the <code>summarize()</code> function. We will again use the <code>pivot_longer</code> function to convert our data to long format. We will also again use the <code>separate()</code> function of the <code>tidyr</code> package to create two variables from one variable. This is done by separating by, in this case, a space.</p>
<div class="sourceCode" id="section-cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1"></a>nyts_data <span class="op">%&gt;%</span></span>
<span id="cb79-2"><a href="#cb79-2"></a><span class="st">    </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(year) <span class="op">%&gt;%</span></span>
<span id="cb79-3"><a href="#cb79-3"></a><span class="st">    </span>dplyr<span class="op">::</span><span class="kw">summarize</span>(<span class="st">&quot;Ever_E-cigarette&quot;</span> =<span class="st"> </span></span>
<span id="cb79-4"><a href="#cb79-4"></a><span class="st">                       </span>(<span class="kw">mean</span>(ecig_only_ever, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>),</span>
<span id="cb79-5"><a href="#cb79-5"></a>                     <span class="st">&quot;Current_E-cigarette&quot;</span> =<span class="st"> </span></span>
<span id="cb79-6"><a href="#cb79-6"></a><span class="st">                       </span>(<span class="kw">mean</span>(ecig_only_current, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>),</span>
<span id="cb79-7"><a href="#cb79-7"></a>                     <span class="st">&quot;Ever_Non-e-cigarette&quot;</span> =<span class="st"> </span></span>
<span id="cb79-8"><a href="#cb79-8"></a><span class="st">                       </span>(<span class="kw">mean</span>(non_ecig_only_ever, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>),</span>
<span id="cb79-9"><a href="#cb79-9"></a>                     <span class="st">&quot;Current_Non-e-cigarette&quot;</span> =<span class="st"> </span></span>
<span id="cb79-10"><a href="#cb79-10"></a><span class="st">                       </span>(<span class="kw">mean</span>(non_ecig_only_current, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>)) <span class="op">%&gt;%</span></span>
<span id="cb79-11"><a href="#cb79-11"></a><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="op">-</span>year, </span>
<span id="cb79-12"><a href="#cb79-12"></a>           <span class="dt">names_to =</span> <span class="st">&quot;User&quot;</span>, </span>
<span id="cb79-13"><a href="#cb79-13"></a>          <span class="dt">values_to =</span> <span class="st">&quot;Percentage of students&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb79-14"><a href="#cb79-14"></a><span class="st">  </span>tidyr<span class="op">::</span><span class="kw">separate</span>(User, <span class="dt">into =</span> <span class="kw">c</span>(<span class="st">&quot;User&quot;</span>, <span class="st">&quot;Product&quot;</span>), <span class="dt">sep =</span> <span class="st">&quot;_&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb79-15"><a href="#cb79-15"></a><span class="st">  </span><span class="kw">head</span>()</span></code></pre></div>
<pre><code># A tibble: 6 x 4
   year User    Product         `Percentage of students`
  &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;                              &lt;dbl&gt;
1  2015 Ever    E-cigarette                         4.36
2  2015 Current E-cigarette                         1.54
3  2015 Ever    Non-e-cigarette                     7.06
4  2015 Current Non-e-cigarette                     3.35
5  2016 Ever    E-cigarette                         4.54
6  2016 Current E-cigarette                         1.23</code></pre>
<div class="sourceCode" id="section-cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1"></a>plot1c &lt;-<span class="st"> </span>nyts_data <span class="op">%&gt;%</span></span>
<span id="cb81-2"><a href="#cb81-2"></a><span class="st">    </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(year) <span class="op">%&gt;%</span></span>
<span id="cb81-3"><a href="#cb81-3"></a><span class="st">    </span>dplyr<span class="op">::</span><span class="kw">summarize</span>(<span class="st">&quot;Ever_E-cigarette&quot;</span> =<span class="st"> </span></span>
<span id="cb81-4"><a href="#cb81-4"></a><span class="st">                       </span>(<span class="kw">mean</span>(ecig_only_ever, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>),</span>
<span id="cb81-5"><a href="#cb81-5"></a>                     <span class="st">&quot;Current_E-cigarette&quot;</span> =<span class="st"> </span></span>
<span id="cb81-6"><a href="#cb81-6"></a><span class="st">                       </span>(<span class="kw">mean</span>(ecig_only_current, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>),</span>
<span id="cb81-7"><a href="#cb81-7"></a>                     <span class="st">&quot;Ever_Non-e-cigarette&quot;</span> =<span class="st"> </span></span>
<span id="cb81-8"><a href="#cb81-8"></a><span class="st">                       </span>(<span class="kw">mean</span>(non_ecig_only_ever, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>),</span>
<span id="cb81-9"><a href="#cb81-9"></a>                     <span class="st">&quot;Current_Non-e-cigarette&quot;</span> =<span class="st"> </span></span>
<span id="cb81-10"><a href="#cb81-10"></a><span class="st">                       </span>(<span class="kw">mean</span>(non_ecig_only_current, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>)) <span class="op">%&gt;%</span></span>
<span id="cb81-11"><a href="#cb81-11"></a><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="op">-</span>year, </span>
<span id="cb81-12"><a href="#cb81-12"></a>           <span class="dt">names_to =</span> <span class="st">&quot;User&quot;</span>, </span>
<span id="cb81-13"><a href="#cb81-13"></a>          <span class="dt">values_to =</span> <span class="st">&quot;Percentage of students&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb81-14"><a href="#cb81-14"></a><span class="st">  </span><span class="kw">separate</span>(User, <span class="dt">into =</span> <span class="kw">c</span>(<span class="st">&quot;User&quot;</span>, <span class="st">&quot;Product&quot;</span>), <span class="dt">sep =</span> <span class="st">&quot;_&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb81-15"><a href="#cb81-15"></a><span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> year, <span class="dt">y =</span> <span class="st">`</span><span class="dt">Percentage of students</span><span class="st">`</span>, <span class="dt">color =</span> Product)) <span class="op">+</span></span>
<span id="cb81-16"><a href="#cb81-16"></a><span class="st">    </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">linetype =</span> User)) <span class="op">+</span></span>
<span id="cb81-17"><a href="#cb81-17"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">show.legend =</span> <span class="ot">FALSE</span>, <span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb81-18"><a href="#cb81-18"></a><span class="st">  </span><span class="co"># this allows us to choose what type of line we want for each line</span></span>
<span id="cb81-19"><a href="#cb81-19"></a><span class="st">  </span><span class="kw">scale_linetype_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">1</span>)) <span class="op">+</span></span>
<span id="cb81-20"><a href="#cb81-20"></a><span class="st">  </span><span class="co"># this allows us to specify how the y-axis should appear</span></span>
<span id="cb81-21"><a href="#cb81-21"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">30</span>, <span class="dt">by =</span> <span class="dv">10</span>),</span>
<span id="cb81-22"><a href="#cb81-22"></a>                     <span class="dt">labels =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">30</span>, <span class="dt">by =</span> <span class="dv">10</span>),</span>
<span id="cb81-23"><a href="#cb81-23"></a>                     <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">30</span>)) <span class="op">+</span></span>
<span id="cb81-24"><a href="#cb81-24"></a><span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> v_colors) <span class="op">+</span></span>
<span id="cb81-25"><a href="#cb81-25"></a><span class="st">  </span><span class="co"># this adjusts the background style of the plot</span></span>
<span id="cb81-26"><a href="#cb81-26"></a><span class="st">    </span><span class="kw">theme_linedraw</span>() <span class="op">+</span></span>
<span id="cb81-27"><a href="#cb81-27"></a><span class="st">  </span><span class="co"># this moves the legend to the bottom of the plot and removes the x axis title</span></span>
<span id="cb81-28"><a href="#cb81-28"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb81-29"><a href="#cb81-29"></a>          <span class="dt">axis.title.x =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></span>
<span id="cb81-30"><a href="#cb81-30"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;How has use of only e-cigarettes and</span></span>
<span id="cb81-31"><a href="#cb81-31"></a><span class="st">only tobacco products besides e-cigarettes varied over time?&quot;</span>,</span>
<span id="cb81-32"><a href="#cb81-32"></a>         <span class="dt">y =</span> <span class="st">&quot;% of students&quot;</span>)</span>
<span id="cb81-33"><a href="#cb81-33"></a></span>
<span id="cb81-34"><a href="#cb81-34"></a>plot1c</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-63-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Very interesting! We can see from this plot that the percentage of students who had currently used (or ever tried) only e-cigarettes greatly increased starting in 2017, while in contrast the percentage of students who had ever tried only non-e-cigarette tobacco products actually diminished over time. In fact, we can see that in 2019 the percentage of students who were current e-cigarette users surpassed the percentage that had tried a non-e-cigarette product even just once.</p>
<p>Recall that we made a variable called <code>Group</code> that identified students who used either just e-cigarette products, just other tobacco products (besides e-cigarettes), or students who used both e-cigarettes and some other type of tobacco product.</p>
<div class="sourceCode" id="section-cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1"></a>nyts_data <span class="op">%&gt;%</span></span>
<span id="cb82-2"><a href="#cb82-2"></a><span class="st">  </span><span class="kw">count</span>(Group)</span></code></pre></div>
<pre><code># A tibble: 4 x 2
  Group                       n
  &lt;chr&gt;                   &lt;int&gt;
1 Combination of products 16517
2 Neither                 61738
3 Only e-cigarettes        7866
4 Only other products      9344</code></pre>
<p>We will now make a plot over time of each of these groups. Since we will have 4 total groups, we will use 4 of the viridis colors. Notice, that in this case we are grouping by three variables by simply separating the variables that we want to group by with a comma in our <code>group_by()</code> function like this: <code>group_by(Group, year, n)</code>.</p>
<div class="sourceCode" id="section-cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1"></a>nyts_data <span class="op">%&gt;%</span></span>
<span id="cb84-2"><a href="#cb84-2"></a><span class="st">  </span><span class="kw">group_by</span>(Group, year, n) <span class="op">%&gt;%</span></span>
<span id="cb84-3"><a href="#cb84-3"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">group_count =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span></span>
<span id="cb84-4"><a href="#cb84-4"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="st">&quot;Percentage of students&quot;</span> =<span class="st"> </span>group_count <span class="op">/</span><span class="st"> </span>n <span class="op">*</span><span class="st"> </span><span class="dv">100</span>) <span class="op">%&gt;%</span></span>
<span id="cb84-5"><a href="#cb84-5"></a><span class="st">  </span><span class="kw">head</span>()</span></code></pre></div>
<pre><code># A tibble: 6 x 5
# Groups:   Group, year [6]
  Group                    year     n group_count `Percentage of students`
  &lt;chr&gt;                   &lt;dbl&gt; &lt;int&gt;       &lt;int&gt;                    &lt;dbl&gt;
1 Combination of products  2015 17711        3634                     20.5
2 Combination of products  2016 20675        3297                     15.9
3 Combination of products  2017 17872        2623                     14.7
4 Combination of products  2018 20189        3321                     16.4
5 Combination of products  2019 19018        3642                     19.2
6 Neither                  2015 17711       11188                     63.2</code></pre>
<div class="sourceCode" id="section-cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1"></a>v_colors =<span class="st">  </span><span class="kw">viridis</span>(<span class="dv">5</span>)[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>]</span>
<span id="cb86-2"><a href="#cb86-2"></a></span>
<span id="cb86-3"><a href="#cb86-3"></a>nyts_data <span class="op">%&gt;%</span></span>
<span id="cb86-4"><a href="#cb86-4"></a><span class="st">  </span><span class="kw">group_by</span>(Group, year, n) <span class="op">%&gt;%</span></span>
<span id="cb86-5"><a href="#cb86-5"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">group_count =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span></span>
<span id="cb86-6"><a href="#cb86-6"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="st">&quot;Percentage of students&quot;</span> =<span class="st"> </span>group_count <span class="op">/</span><span class="st"> </span>n <span class="op">*</span><span class="st"> </span><span class="dv">100</span>) <span class="op">%&gt;%</span></span>
<span id="cb86-7"><a href="#cb86-7"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> year, <span class="dt">y =</span> <span class="st">`</span><span class="dt">Percentage of students</span><span class="st">`</span>, <span class="dt">color =</span> Group)) <span class="op">+</span></span>
<span id="cb86-8"><a href="#cb86-8"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb86-9"><a href="#cb86-9"></a><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></span>
<span id="cb86-10"><a href="#cb86-10"></a><span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> v_colors) <span class="op">+</span></span>
<span id="cb86-11"><a href="#cb86-11"></a><span class="st">  </span><span class="kw">theme_linedraw</span>() <span class="op">+</span></span>
<span id="cb86-12"><a href="#cb86-12"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Year&quot;</span>)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-65-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>We can see that the majority of students did not report using any tobacco products. Of the students that did report using tobacco products, the majority of the students used both e-cigarettes and some other tobacco product. Again, a much larger percentage reported using only e-cigarettes rather than only other tobacco products in 2019.</p>
<p>We will further explore the relationship between e-cigarette usage and other tobacco products a bit later in the case study.</p>
</div>
<div id="section-question-2" class="section level3">
<h3><strong>Question 2</strong></h3>
<hr />
<p>Now we want to look how e-cigarette smoking rates compare between males and females across time.</p>
<p>We will calculate the percent ever and current e-cigarette users for each year and sex category again using the <code>group_by()</code> function and the <code>summarize()</code> function. We will again use the <code>pivot_longer</code> function to convert our data to long format.</p>
<p>As discussed above, we acknowledge that while <a href="https://www.genderspectrum.org/quick-links/understanding-gender/" target="_blank">gender</a> and <a href="https://www.who.int/genomics/gender/en/index1.html" target="_blank">sex</a> are not actually binary, the data used in this analysis only contain information for groups of individuals who answered the survey questions as male or female. For individuals that have NA values, it is unclear if the question was not answered or if the individual identifies as non-binary. Because of this uncertainty, we will filter these individuals out.</p>
<div class="sourceCode" id="section-cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1"></a>v_colors =<span class="st">  </span><span class="kw">viridis</span>(<span class="dv">6</span>)[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">4</span>)]</span>
<span id="cb87-2"><a href="#cb87-2"></a></span>
<span id="cb87-3"><a href="#cb87-3"></a>nyts_data <span class="op">%&gt;%</span></span>
<span id="cb87-4"><a href="#cb87-4"></a><span class="st">     </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(Sex)) <span class="op">%&gt;%</span></span>
<span id="cb87-5"><a href="#cb87-5"></a><span class="st">     </span><span class="kw">group_by</span>(year, Sex) <span class="op">%&gt;%</span></span>
<span id="cb87-6"><a href="#cb87-6"></a><span class="st">     </span><span class="kw">summarize</span>(<span class="dt">Ever =</span> (<span class="kw">mean</span>(EELCIGT, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>),</span>
<span id="cb87-7"><a href="#cb87-7"></a>               <span class="dt">Current =</span> (<span class="kw">mean</span>(CELCIGT, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>)) <span class="op">%&gt;%</span></span>
<span id="cb87-8"><a href="#cb87-8"></a><span class="st">     </span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> Ever<span class="op">:</span>Current,</span>
<span id="cb87-9"><a href="#cb87-9"></a>                  <span class="dt">names_to =</span> <span class="st">&quot;User&quot;</span>,</span>
<span id="cb87-10"><a href="#cb87-10"></a>                  <span class="dt">values_to =</span> <span class="st">&quot;Percentage of students&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb87-11"><a href="#cb87-11"></a><span class="st">     </span><span class="kw">head</span>()</span></code></pre></div>
<pre><code># A tibble: 6 x 4
# Groups:   year [2]
   year Sex    User    `Percentage of students`
  &lt;dbl&gt; &lt;fct&gt;  &lt;chr&gt;                      &lt;dbl&gt;
1  2015 male   Ever                       29.3 
2  2015 male   Current                    13.3 
3  2015 female Ever                       24.3 
4  2015 female Current                     9.05
5  2016 male   Ever                       24.1 
6  2016 male   Current                     8.72</code></pre>
<div class="sourceCode" id="section-cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1"></a>plot2 &lt;-<span class="st"> </span>nyts_data <span class="op">%&gt;%</span></span>
<span id="cb89-2"><a href="#cb89-2"></a><span class="st">     </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(Sex)) <span class="op">%&gt;%</span></span>
<span id="cb89-3"><a href="#cb89-3"></a><span class="st">     </span><span class="kw">group_by</span>(year, Sex) <span class="op">%&gt;%</span></span>
<span id="cb89-4"><a href="#cb89-4"></a><span class="st">     </span><span class="kw">summarize</span>(<span class="dt">Ever =</span> (<span class="kw">mean</span>(EELCIGT, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>),</span>
<span id="cb89-5"><a href="#cb89-5"></a>               <span class="dt">Current =</span> (<span class="kw">mean</span>(CELCIGT, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>)) <span class="op">%&gt;%</span></span>
<span id="cb89-6"><a href="#cb89-6"></a><span class="st">     </span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> Ever<span class="op">:</span>Current,</span>
<span id="cb89-7"><a href="#cb89-7"></a>                  <span class="dt">names_to =</span> <span class="st">&quot;User&quot;</span>,</span>
<span id="cb89-8"><a href="#cb89-8"></a>                  <span class="dt">values_to =</span> <span class="st">&quot;Percentage of students&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb89-9"><a href="#cb89-9"></a><span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> year, <span class="dt">y =</span> <span class="st">`</span><span class="dt">Percentage of students</span><span class="st">`</span>, <span class="dt">color =</span> Sex)) <span class="op">+</span></span>
<span id="cb89-10"><a href="#cb89-10"></a><span class="st">    </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">linetype =</span> User)) <span class="op">+</span></span>
<span id="cb89-11"><a href="#cb89-11"></a><span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">show.legend =</span> <span class="ot">FALSE</span>, <span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb89-12"><a href="#cb89-12"></a><span class="st">    </span><span class="kw">scale_linetype_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">1</span>)) <span class="op">+</span></span>
<span id="cb89-13"><a href="#cb89-13"></a><span class="st">    </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> v_colors) <span class="op">+</span></span>
<span id="cb89-14"><a href="#cb89-14"></a><span class="st">    </span><span class="kw">theme_linedraw</span>() <span class="op">+</span></span>
<span id="cb89-15"><a href="#cb89-15"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb89-16"><a href="#cb89-16"></a>          <span class="dt">axis.title.x =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></span>
<span id="cb89-17"><a href="#cb89-17"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;How does e-cigarette usage compare between males and females?&quot;</span>,</span>
<span id="cb89-18"><a href="#cb89-18"></a>         <span class="dt">subtitle =</span> <span class="st">&quot;Current and ever users by sex&quot;</span>,</span>
<span id="cb89-19"><a href="#cb89-19"></a>         <span class="dt">y =</span> <span class="st">&quot;% of students&quot;</span>)</span>
<span id="cb89-20"><a href="#cb89-20"></a></span>
<span id="cb89-21"><a href="#cb89-21"></a>plot2</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-66-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>It looks like the rates are fairly similar between the sexes, however the rate for males appears to be consistently higher across time.</p>
</div>
<div id="section-question-3" class="section level3">
<h3><strong>Question 3</strong></h3>
<hr />
<p>We are also interested in what vaping brands and flavors appear to be used the most frequently. Only the 2019 dataset has this information. Therefore, we will filter for just this year using the <code>filter()</code> function of the <code>dplyr</code> package. We will use the <code>summarize()</code> function slightly differently this time, to calculate the total number of students using each brand using the <code>n()</code> function and the <code>sum()</code> function to calculate the percent for each brand based on the counts. We will also reorder the factor levels for the brand names so that they are in descending order of percent use, using the <code>fct_reorder()</code> function from <code>dplyr</code>. This will make them appear in decreasing order of percent use on the plot.</p>
<p>We will make a bar plot this time by using <code>geom_bar</code>. Importantly we assign the <code>stat</code> argument to <code>identity</code>, so that we are using the percentages that we calculated not the counts which is what is used by default. When color in specified outside of the <code>aes()</code> argument, this determines the border color of the bars, which in this case will be black.</p>
<div class="sourceCode" id="section-cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1"></a>nyts_data <span class="op">%&gt;%</span></span>
<span id="cb90-2"><a href="#cb90-2"></a><span class="st">  </span><span class="kw">filter</span>(year <span class="op">==</span><span class="st"> </span><span class="dv">2019</span>) <span class="op">%&gt;%</span></span>
<span id="cb90-3"><a href="#cb90-3"></a><span class="st">  </span><span class="kw">group_by</span>(brand_ecig) <span class="op">%&gt;%</span></span>
<span id="cb90-4"><a href="#cb90-4"></a><span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(brand_ecig)) <span class="op">%&gt;%</span></span>
<span id="cb90-5"><a href="#cb90-5"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">n =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span></span>
<span id="cb90-6"><a href="#cb90-6"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">total =</span> <span class="kw">sum</span>(n),</span>
<span id="cb90-7"><a href="#cb90-7"></a>         <span class="dt">Percent =</span> n <span class="op">*</span><span class="st"> </span><span class="dv">100</span> <span class="op">/</span><span class="st"> </span>total) <span class="op">%&gt;%</span></span>
<span id="cb90-8"><a href="#cb90-8"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">brand_ecig =</span> <span class="kw">fct_reorder</span>(brand_ecig, <span class="kw">desc</span>(Percent)))</span></code></pre></div>
<pre><code># A tibble: 7 x 4
  brand_ecig     n total Percent
  &lt;fct&gt;      &lt;int&gt; &lt;int&gt;   &lt;dbl&gt;
1 Blu          111  3604   3.08 
2 JUUL        2028  3604  56.3  
3 Logic         36  3604   0.999
4 MarkTen       32  3604   0.888
5 NJOY          44  3604   1.22 
6 Other       1253  3604  34.8  
7 Vuse         100  3604   2.77 </code></pre>
<div class="sourceCode" id="section-cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1"></a>plot3 &lt;-<span class="st"> </span>nyts_data <span class="op">%&gt;%</span></span>
<span id="cb92-2"><a href="#cb92-2"></a><span class="st">  </span><span class="kw">filter</span>(year <span class="op">==</span><span class="st"> </span><span class="dv">2019</span>) <span class="op">%&gt;%</span></span>
<span id="cb92-3"><a href="#cb92-3"></a><span class="st">  </span><span class="kw">group_by</span>(brand_ecig) <span class="op">%&gt;%</span></span>
<span id="cb92-4"><a href="#cb92-4"></a><span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(brand_ecig)) <span class="op">%&gt;%</span></span>
<span id="cb92-5"><a href="#cb92-5"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">n =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span></span>
<span id="cb92-6"><a href="#cb92-6"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">total =</span> <span class="kw">sum</span>(n),</span>
<span id="cb92-7"><a href="#cb92-7"></a>         <span class="dt">Percent =</span> n <span class="op">*</span><span class="st"> </span><span class="dv">100</span> <span class="op">/</span><span class="st"> </span>total) <span class="op">%&gt;%</span></span>
<span id="cb92-8"><a href="#cb92-8"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">brand_ecig =</span> <span class="kw">fct_reorder</span>(brand_ecig, <span class="kw">desc</span>(Percent))) <span class="op">%&gt;%</span></span>
<span id="cb92-9"><a href="#cb92-9"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> brand_ecig, <span class="dt">y =</span> Percent, <span class="dt">fill =</span> brand_ecig)) <span class="op">+</span></span>
<span id="cb92-10"><a href="#cb92-10"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></span>
<span id="cb92-11"><a href="#cb92-11"></a><span class="st">  </span><span class="kw">theme_linedraw</span>() <span class="op">+</span></span>
<span id="cb92-12"><a href="#cb92-12"></a><span class="st">  </span><span class="kw">theme</span>(</span>
<span id="cb92-13"><a href="#cb92-13"></a>    <span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb92-14"><a href="#cb92-14"></a>    <span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>),</span>
<span id="cb92-15"><a href="#cb92-15"></a>    <span class="dt">axis.title.x =</span> <span class="kw">element_blank</span>()</span>
<span id="cb92-16"><a href="#cb92-16"></a>  ) <span class="op">+</span></span>
<span id="cb92-17"><a href="#cb92-17"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;What vaping brands appear to be used the most frequently?&quot;</span>,</span>
<span id="cb92-18"><a href="#cb92-18"></a>       <span class="dt">subtitle =</span> <span class="st">&quot;Brand of e-cigarette most frequently used in the last 30 days (2019)&quot;</span>,</span>
<span id="cb92-19"><a href="#cb92-19"></a>       <span class="dt">y =</span> <span class="st">&quot;% of e-cigarette users responding&quot;</span>)</span>
<span id="cb92-20"><a href="#cb92-20"></a></span>
<span id="cb92-21"><a href="#cb92-21"></a>plot3</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-68-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Juul appears to be the most widely used brand. This is in agreement with a recent <a href="https://tobaccocontrol.bmj.com/content/tobaccocontrol/28/2/146.full.pdf">article</a>, whose most recent data was from 2017:</p>
<div class="figure" style="text-align: center">
<img src="www/img/HuangJ_DuanZ_KwokJ_et_al_TobaccoControl_Figure1.png" alt="Huang J, Duan Z, Kwok J, et al. Tob Control 2019;28:146–151." width="100%" />
<p class="caption">
Huang J, Duan Z, Kwok J, et al. Tob Control 2019;28:146–151.
</p>
</div>
<p>We are also interested in how the usage of different flavors has changed over time.</p>
<p>To evaluate this we will calculate the percentage of students using each flavor each year - this includes usage of any type of flavored tobacco product. We will exclude 2015 data, as no specific flavor questions were asked at that time.</p>
<p>Recall that <code>NA</code> values are not included in calculating the total count for our percentages. However all of these flavor questions had complete reporting and did not have <code>NA</code> values. Therefore, these values reflect the percentage of students reporting using a particular favor out of all students surveyed (including those that did not use any tobacco products). Also students were allowed to select more than one flavor. You can see whether these variables had complete reporting by checking the <code>NA</code> values using the base <code>summary</code> function. Alternatively you can create a visual representation using the <code>vis_miss()</code> function of the <code>naniar</code> package.</p>
<div id="section-section-23" class="section level4 scrollable">
<h4></h4>
<div class="sourceCode" id="section-cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1"></a><span class="co"># Scroll through the output!</span></span>
<span id="cb93-2"><a href="#cb93-2"></a>nyts_data <span class="op">%&gt;%</span></span>
<span id="cb93-3"><a href="#cb93-3"></a><span class="st">  </span><span class="kw">filter</span>(year <span class="op">!=</span><span class="st"> </span><span class="dv">2015</span>) <span class="op">%&gt;%</span></span>
<span id="cb93-4"><a href="#cb93-4"></a><span class="st">  </span><span class="kw">summary</span>()</span></code></pre></div>
<pre><code>      year          psu                finwgt          stratum         
 Min.   :2016   Length:77754       Min.   :  11.15   Length:77754      
 1st Qu.:2016   Class :character   1st Qu.: 681.08   Class :character  
 Median :2018   Mode  :character   Median :1113.83   Mode  :character  
 Mean   :2017                      Mean   :1394.51                     
 3rd Qu.:2018                      3rd Qu.:1748.80                     
 Max.   :2019                      Max.   :6505.08                     
                                                                       
      Age            Sex            Grade         ECIGT           ECIGAR       
 13     :11781   male  :39191   7      :11978   Mode :logical   Mode :logical  
 14     :11301   female:37916   6      :11606   FALSE:63138     FALSE:65345    
 12     :11045   .N    :    0   8      :11528   TRUE :13463     TRUE :11066    
 15     :10963   NA&#39;s  :  647   9      :11049   NA&#39;s :1153      NA&#39;s :1343     
 16     :10765                  10     :10609                                  
 (Other):21551                  (Other):20597                                  
 NA&#39;s   :  348                  NA&#39;s   :  387                                  
    ESLT          EELCIGT        EROLLCIGTS      EFLAVCIGTS       EBIDIS       
 Mode :logical   Mode :logical   Mode :logical   Mode:logical   Mode :logical  
 FALSE:71048     FALSE:56690     FALSE:71966     NA&#39;s:77754     FALSE:74618    
 TRUE :5202      TRUE :19660     TRUE :3574                     TRUE :911      
 NA&#39;s :1504      NA&#39;s :1404      NA&#39;s :2214                     NA&#39;s :2225     
                                                                               
                                                                               
                                                                               
 EFLAVCIGAR       EHOOKAH          EPIPE           ESNUS        
 Mode :logical   Mode :logical   Mode :logical   Mode :logical  
 FALSE:18012     FALSE:69763     FALSE:73760     FALSE:72777    
 TRUE :1889      TRUE :6318      TRUE :1768      TRUE :2751     
 NA&#39;s :57853     NA&#39;s :1673      NA&#39;s :2226      NA&#39;s :2226     
                                                                
                                                                
                                                                
  EDISSOLV         CCIGT           CCIGAR           CSLT        
 Mode :logical   Mode :logical   Mode :logical   Mode :logical  
 FALSE:74560     FALSE:72481     FALSE:72261     FALSE:73719    
 TRUE :970       TRUE :3797      TRUE :4017      TRUE :2190     
 NA&#39;s :2224      NA&#39;s :1476      NA&#39;s :1476      NA&#39;s :1845     
                                                                
                                                                
                                                                
  CELCIGT        CROLLCIGTS      CFLAVCIGTS       CBIDIS         CHOOKAH       
 Mode :logical   Mode :logical   Mode:logical   Mode :logical   Mode :logical  
 FALSE:67314     FALSE:73864     NA&#39;s:77754     FALSE:75102     FALSE:73573    
 TRUE :9205      TRUE :1608                     TRUE :381       TRUE :2282     
 NA&#39;s :1235      NA&#39;s :2282                     NA&#39;s :2271      NA&#39;s :1899     
                                                                               
                                                                               
                                                                               
   CPIPE           CSNUS          CDISSOLV        menthol       
 Mode :logical   Mode :logical   Mode :logical   Mode :logical  
 FALSE:74796     FALSE:74402     FALSE:75048     FALSE:73305    
 TRUE :664       TRUE :1066      TRUE :423       TRUE :4449     
 NA&#39;s :2294      NA&#39;s :2286      NA&#39;s :2283                     
                                                                
                                                                
                                                                
 clove_spice       fruit         chocolate       alcoholic_drink
 Mode :logical   Mode :logical   Mode :logical   Mode :logical  
 FALSE:77360     FALSE:71945     FALSE:76875     FALSE:76510    
 TRUE :394       TRUE :5809      TRUE :879       TRUE :1244     
                                                                
                                                                
                                                                
                                                                
 candy_dessert_sweets   other            EHTP            CHTP        
 Mode :logical        Mode :logical   Mode :logical   Mode :logical  
 FALSE:74188          FALSE:75675     FALSE:16633     FALSE:18582    
 TRUE :3566           TRUE :2079      TRUE :398       TRUE :291      
                                      NA&#39;s :60723     NA&#39;s :58881    
                                                                     
                                                                     
                                                                     
  brand_ecig        tobacco_sum_ever  tobacco_sum_current tobacco_ever   
 Length:77754       Min.   : 0.0000   Min.   : 0.0000     Mode :logical  
 Class :character   1st Qu.: 0.0000   1st Qu.: 0.0000     FALSE:50602    
 Mode  :character   Median : 0.0000   Median : 0.0000     TRUE :27152    
                    Mean   : 0.8742   Mean   : 0.3334                    
                    3rd Qu.: 1.0000   3rd Qu.: 0.0000                    
                    Max.   :11.0000   Max.   :11.0000                    
                                                                         
 tobacco_current ecig_sum_ever    ecig_sum_current non_ecig_sum_ever
 Mode :logical   Min.   :0.0000   Min.   :0.0000   Min.   : 0.0000  
 FALSE:64229     1st Qu.:0.0000   1st Qu.:0.0000   1st Qu.: 0.0000  
 TRUE :13525     Median :0.0000   Median :0.0000   Median : 0.0000  
                 Mean   :0.2528   Mean   :0.1184   Mean   : 0.6213  
                 3rd Qu.:1.0000   3rd Qu.:0.0000   3rd Qu.: 1.0000  
                 Max.   :1.0000   Max.   :1.0000   Max.   :10.0000  
                                                                    
 non_ecig_sum_current ecig_ever       ecig_current    non_ecig_ever  
 Min.   : 0.000       Mode :logical   Mode :logical   Mode :logical  
 1st Qu.: 0.000       FALSE:58094     FALSE:68549     FALSE:57436    
 Median : 0.000       TRUE :19660     TRUE :9205      TRUE :20318    
 Mean   : 0.215                                                      
 3rd Qu.: 0.000                                                      
 Max.   :10.000                                                      
                                                                     
 non_ecig_current ecig_only_ever  ecig_only_current non_ecig_only_ever
 Mode :logical    Mode :logical   Mode :logical     Mode :logical     
 FALSE:69182      FALSE:73369     FALSE:75318       FALSE:72687       
 TRUE :8572       TRUE :4385      TRUE :2436        TRUE :5067        
                                                                      
                                                                      
                                                                      
                                                                      
 non_ecig_only_current   no_use           Group                 n        
 Mode :logical         Mode :logical   Length:77754       Min.   :17872  
 FALSE:75321           FALSE:27204     Class :character   1st Qu.:19018  
 TRUE :2433            TRUE :50550     Mode  :character   Median :20189  
                                                          Mean   :19499  
                                                          3rd Qu.:20675  
                                                          Max.   :20675  
                                                                         </code></pre>
</div>
<div id="section-section-24" class="section level4">
<h4></h4>
<div class="sourceCode" id="section-cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1"></a>nyts_data <span class="op">%&gt;%</span></span>
<span id="cb95-2"><a href="#cb95-2"></a><span class="st">  </span><span class="kw">filter</span>(year <span class="op">!=</span><span class="st"> </span><span class="dv">2015</span>) <span class="op">%&gt;%</span></span>
<span id="cb95-3"><a href="#cb95-3"></a><span class="st">  </span><span class="kw">select</span>(menthol<span class="op">:</span>alcoholic_drink) <span class="op">%&gt;%</span></span>
<span id="cb95-4"><a href="#cb95-4"></a><span class="st">  </span><span class="kw">vis_miss</span>()</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-71-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>The plot above confirms that these variables have no <code>NA</code> values (because all fields indicate 100% of data is present).</p>
<div class="sourceCode" id="section-cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1"></a>plot4 &lt;-<span class="st"> </span>nyts_data <span class="op">%&gt;%</span></span>
<span id="cb96-2"><a href="#cb96-2"></a><span class="st">  </span><span class="kw">filter</span>(year <span class="op">!=</span><span class="st"> </span><span class="dv">2015</span>) <span class="op">%&gt;%</span></span>
<span id="cb96-3"><a href="#cb96-3"></a><span class="st">  </span><span class="kw">group_by</span>(year) <span class="op">%&gt;%</span></span>
<span id="cb96-4"><a href="#cb96-4"></a><span class="st">      </span><span class="kw">summarize</span>(<span class="dt">Menthol =</span> (<span class="kw">mean</span>(menthol) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>),</span>
<span id="cb96-5"><a href="#cb96-5"></a>       <span class="st">`</span><span class="dt">Clove or Spice</span><span class="st">`</span> =<span class="st"> </span>(<span class="kw">mean</span>(clove_spice) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>),</span>
<span id="cb96-6"><a href="#cb96-6"></a>                  <span class="dt">Fruit =</span> (<span class="kw">mean</span>(fruit) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>),</span>
<span id="cb96-7"><a href="#cb96-7"></a>              <span class="dt">Chocolate =</span> (<span class="kw">mean</span>(chocolate) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>),</span>
<span id="cb96-8"><a href="#cb96-8"></a>      <span class="st">`</span><span class="dt">Alcoholic Drink</span><span class="st">`</span> =<span class="st"> </span>(<span class="kw">mean</span>(alcoholic_drink) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>),</span>
<span id="cb96-9"><a href="#cb96-9"></a><span class="st">`</span><span class="dt">Candy/Desserts/Sweets</span><span class="st">`</span> =<span class="st"> </span>(<span class="kw">mean</span>(candy_dessert_sweets) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>),</span>
<span id="cb96-10"><a href="#cb96-10"></a>                  <span class="dt">Other =</span> (<span class="kw">mean</span>(other) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>)) <span class="op">%&gt;%</span></span>
<span id="cb96-11"><a href="#cb96-11"></a><span class="st">      </span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="op">-</span>year, </span>
<span id="cb96-12"><a href="#cb96-12"></a>               <span class="dt">names_to =</span> <span class="st">&quot;Flavor&quot;</span>,</span>
<span id="cb96-13"><a href="#cb96-13"></a>              <span class="dt">values_to =</span> <span class="st">&quot;Percentage of students&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb96-14"><a href="#cb96-14"></a><span class="st">  </span><span class="kw">rename</span>(<span class="dt">Year =</span> year) <span class="op">%&gt;%</span></span>
<span id="cb96-15"><a href="#cb96-15"></a></span>
<span id="cb96-16"><a href="#cb96-16"></a><span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">y =</span> <span class="st">`</span><span class="dt">Percentage of students</span><span class="st">`</span>,</span>
<span id="cb96-17"><a href="#cb96-17"></a>            <span class="dt">x =</span> Year,</span>
<span id="cb96-18"><a href="#cb96-18"></a>            <span class="dt">fill =</span> <span class="kw">reorder</span>(Flavor, <span class="st">`</span><span class="dt">Percentage of students</span><span class="st">`</span>))) <span class="op">+</span></span>
<span id="cb96-19"><a href="#cb96-19"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>,</span>
<span id="cb96-20"><a href="#cb96-20"></a>           <span class="dt">position =</span> <span class="st">&quot;dodge&quot;</span>,</span>
<span id="cb96-21"><a href="#cb96-21"></a>           <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></span>
<span id="cb96-22"><a href="#cb96-22"></a><span class="st">  </span><span class="kw">scale_fill_viridis</span>(<span class="dt">discrete =</span> <span class="ot">TRUE</span>) <span class="op">+</span></span>
<span id="cb96-23"><a href="#cb96-23"></a><span class="st">  </span><span class="kw">theme_linedraw</span>() <span class="op">+</span></span>
<span id="cb96-24"><a href="#cb96-24"></a><span class="st">  </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="kw">guide_legend</span>(<span class="st">&quot;Flavor&quot;</span>)) <span class="op">+</span></span>
<span id="cb96-25"><a href="#cb96-25"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;What flavors appear to be used the most frequently?&quot;</span>,</span>
<span id="cb96-26"><a href="#cb96-26"></a>       <span class="dt">subtitle =</span> <span class="st">&quot;Flavors of tobacco products used in the past 30 days&quot;</span>)</span>
<span id="cb96-27"><a href="#cb96-27"></a></span>
<span id="cb96-28"><a href="#cb96-28"></a>plot4</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-72-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>From this plot, we can see that fruit flavors are the most widely used products, followed by menthol or mint flavored products. We can also see that there was a general increase in the usage of flavored products over time.</p>
<p>We will now look specifically at the usage of flavored e-cigarette products vs other flavored tobacco products.</p>
<p>Recall that we made a variable called <code>Group</code> that identified students who used either just e-cigarette/vaping products, just other tobacco products (besides e-cigarettes), or students who used both e-cigarettes and some other type of tobacco product. We will compare the usage of these flavors for these different groups. We also perform some data summaries to decide how to order the panels (flavors) for display.</p>
<div class="sourceCode" id="section-cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1"></a>v_colors =<span class="st">  </span><span class="kw">viridis</span>(<span class="dv">5</span>)[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>]</span>
<span id="cb97-2"><a href="#cb97-2"></a></span>
<span id="cb97-3"><a href="#cb97-3"></a>plot5 &lt;-<span class="st"> </span>nyts_data <span class="op">%&gt;%</span></span>
<span id="cb97-4"><a href="#cb97-4"></a><span class="st">  </span><span class="kw">filter</span>(year <span class="op">!=</span><span class="st"> </span><span class="dv">2015</span>) <span class="op">%&gt;%</span></span>
<span id="cb97-5"><a href="#cb97-5"></a><span class="st">  </span><span class="kw">group_by</span>(year, Group) <span class="op">%&gt;%</span></span>
<span id="cb97-6"><a href="#cb97-6"></a><span class="st">        </span><span class="kw">summarize</span>(<span class="dt">Menthol =</span> (<span class="kw">mean</span>(menthol) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>),</span>
<span id="cb97-7"><a href="#cb97-7"></a>         <span class="st">`</span><span class="dt">Clove or Spice</span><span class="st">`</span> =<span class="st"> </span>(<span class="kw">mean</span>(clove_spice) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>),</span>
<span id="cb97-8"><a href="#cb97-8"></a>                    <span class="dt">Fruit =</span> (<span class="kw">mean</span>(fruit) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>),</span>
<span id="cb97-9"><a href="#cb97-9"></a>                <span class="dt">Chocolate =</span> (<span class="kw">mean</span>(chocolate) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>),</span>
<span id="cb97-10"><a href="#cb97-10"></a>        <span class="st">`</span><span class="dt">Alcoholic Drink</span><span class="st">`</span> =<span class="st"> </span>(<span class="kw">mean</span>(alcoholic_drink) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>),</span>
<span id="cb97-11"><a href="#cb97-11"></a><span class="st">`</span><span class="dt">Candy/Desserts/</span><span class="ch">\n</span><span class="dt">Sweets</span><span class="st">`</span> =<span class="st"> </span>(<span class="kw">mean</span>(candy_dessert_sweets) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>),</span>
<span id="cb97-12"><a href="#cb97-12"></a>                    <span class="dt">Other =</span> (<span class="kw">mean</span>(other) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>),</span>
<span id="cb97-13"><a href="#cb97-13"></a>              <span class="dt">Respondents =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span></span>
<span id="cb97-14"><a href="#cb97-14"></a><span class="st">  </span><span class="co"># converting columns between and including Menthol and Other to one column called Flavor</span></span>
<span id="cb97-15"><a href="#cb97-15"></a><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> Menthol<span class="op">:</span>Other, </span>
<span id="cb97-16"><a href="#cb97-16"></a>           <span class="dt">names_to =</span> <span class="st">&quot;Flavor&quot;</span>, </span>
<span id="cb97-17"><a href="#cb97-17"></a>          <span class="dt">values_to =</span> <span class="st">&quot;Percentage of students&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb97-18"><a href="#cb97-18"></a><span class="st">  </span><span class="kw">group_by</span>(Flavor) <span class="op">%&gt;%</span></span>
<span id="cb97-19"><a href="#cb97-19"></a><span class="st">  </span><span class="co"># calculate the count of students in the year/group combination who used that flavor</span></span>
<span id="cb97-20"><a href="#cb97-20"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">affirmative =</span> (Respondents <span class="op">*</span><span class="st"> `</span><span class="dt">Percentage of students</span><span class="st">`</span>) <span class="op">/</span><span class="st"> </span><span class="dv">100</span>) <span class="op">%&gt;%</span></span>
<span id="cb97-21"><a href="#cb97-21"></a><span class="st">  </span><span class="co"># calculate the fraction of total respondents who used that flavor</span></span>
<span id="cb97-22"><a href="#cb97-22"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">flavor_mean =</span> <span class="kw">sum</span>(affirmative) <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(Respondents)) <span class="op">%&gt;%</span></span>
<span id="cb97-23"><a href="#cb97-23"></a><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span></span>
<span id="cb97-24"><a href="#cb97-24"></a><span class="st">  </span><span class="co"># reorder the levels of Flavor to be in increasing order of percent of students</span></span>
<span id="cb97-25"><a href="#cb97-25"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">flavor_mean_rank =</span> <span class="kw">dense_rank</span>(flavor_mean),</span>
<span id="cb97-26"><a href="#cb97-26"></a>         <span class="dt">Flavor =</span> <span class="kw">fct_reorder</span>(Flavor, flavor_mean_rank)) <span class="op">%&gt;%</span></span>
<span id="cb97-27"><a href="#cb97-27"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> year, </span>
<span id="cb97-28"><a href="#cb97-28"></a>             <span class="dt">y =</span> <span class="st">`</span><span class="dt">Percentage of students</span><span class="st">`</span>, </span>
<span id="cb97-29"><a href="#cb97-29"></a>         <span class="dt">color =</span> Group)) <span class="op">+</span></span>
<span id="cb97-30"><a href="#cb97-30"></a><span class="st">  </span><span class="kw">facet_grid</span>(<span class="op">~</span>Flavor) <span class="op">+</span></span>
<span id="cb97-31"><a href="#cb97-31"></a><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></span>
<span id="cb97-32"><a href="#cb97-32"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">show.legend =</span> <span class="ot">FALSE</span>, <span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb97-33"><a href="#cb97-33"></a><span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> v_colors) <span class="op">+</span></span>
<span id="cb97-34"><a href="#cb97-34"></a><span class="st">  </span><span class="kw">theme_linedraw</span>() <span class="op">+</span></span>
<span id="cb97-35"><a href="#cb97-35"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb97-36"><a href="#cb97-36"></a>        <span class="dt">axis.title.x =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb97-37"><a href="#cb97-37"></a>        <span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>),</span>
<span id="cb97-38"><a href="#cb97-38"></a>        <span class="dt">strip.text.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>)) <span class="op">+</span></span>
<span id="cb97-39"><a href="#cb97-39"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Among different product users, what flavors are most frequently used?&quot;</span>)</span>
<span id="cb97-40"><a href="#cb97-40"></a></span>
<span id="cb97-41"><a href="#cb97-41"></a>plot5</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-73-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>We can see from this plot that there has been an increase in the number of students reporting using flavored tobacco products. Users who use both e-cigarettes and other tobacco products appear to report using flavored products the most, followed by users who only use e-cigarettes.</p>
</div>
</div>
<div id="section-question-4" class="section level3">
<h3><strong>Question 4</strong></h3>
<hr />
<p>Is there a relationship between e-cigarette use and tobacco use? Now we will investigate the usage of e-cigarettes compared to other tobacco products in greater depth.</p>
<p>First let’s take a look at how e-cigarette usage and cigarette usage compare. We will select the data that specifically has to do with these products.</p>
<div class="sourceCode" id="section-cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1"></a>v_colors =<span class="st">  </span><span class="kw">viridis</span>(<span class="dv">6</span>)[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">4</span>)]</span>
<span id="cb98-2"><a href="#cb98-2"></a></span>
<span id="cb98-3"><a href="#cb98-3"></a>nyts_data <span class="op">%&gt;%</span></span>
<span id="cb98-4"><a href="#cb98-4"></a><span class="st">    </span><span class="kw">group_by</span>(year) <span class="op">%&gt;%</span></span>
<span id="cb98-5"><a href="#cb98-5"></a><span class="st">    </span><span class="kw">summarize</span>(<span class="st">&quot;Cigarettes, Ever&quot;</span> =<span class="st"> </span>(<span class="kw">mean</span>(ECIGT, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>),</span>
<span id="cb98-6"><a href="#cb98-6"></a>            <span class="st">&quot;E-cigarettes, Ever&quot;</span> =<span class="st"> </span>(<span class="kw">mean</span>(EELCIGT, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>),</span>
<span id="cb98-7"><a href="#cb98-7"></a>           <span class="st">&quot;Cigarettes, Current&quot;</span> =<span class="st"> </span>(<span class="kw">mean</span>(CCIGT, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>),</span>
<span id="cb98-8"><a href="#cb98-8"></a>         <span class="st">&quot;E-cigarettes, Current&quot;</span> =<span class="st"> </span>(<span class="kw">mean</span>(CELCIGT, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>)) <span class="op">%&gt;%</span></span>
<span id="cb98-9"><a href="#cb98-9"></a><span class="st">    </span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="op">-</span><span class="st"> </span>year, </span>
<span id="cb98-10"><a href="#cb98-10"></a>             <span class="dt">names_to =</span> <span class="st">&quot;Category&quot;</span>, </span>
<span id="cb98-11"><a href="#cb98-11"></a>            <span class="dt">values_to =</span> <span class="st">&quot;Percentage of students&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb98-12"><a href="#cb98-12"></a><span class="st">    </span><span class="kw">separate</span>(Category, <span class="dt">into =</span> <span class="kw">c</span>(<span class="st">&quot;Product&quot;</span>, <span class="st">&quot;User&quot;</span>), <span class="dt">sep =</span> <span class="st">&quot;, &quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb98-13"><a href="#cb98-13"></a><span class="st">    </span><span class="kw">head</span>()</span></code></pre></div>
<pre><code># A tibble: 6 x 4
   year Product      User    `Percentage of students`
  &lt;dbl&gt; &lt;chr&gt;        &lt;chr&gt;                      &lt;dbl&gt;
1  2015 Cigarettes   Ever                       21.3 
2  2015 E-cigarettes Ever                       26.9 
3  2015 Cigarettes   Current                     6.23
4  2015 E-cigarettes Current                    11.2 
5  2016 Cigarettes   Ever                       19.1 
6  2016 E-cigarettes Ever                       22.1 </code></pre>
<div class="sourceCode" id="section-cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1"></a>plot6 &lt;-<span class="st"> </span>nyts_data <span class="op">%&gt;%</span></span>
<span id="cb100-2"><a href="#cb100-2"></a><span class="st">  </span><span class="kw">group_by</span>(year) <span class="op">%&gt;%</span></span>
<span id="cb100-3"><a href="#cb100-3"></a><span class="st">  </span><span class="kw">summarize</span>(</span>
<span id="cb100-4"><a href="#cb100-4"></a>    <span class="st">&quot;Cigarettes, Ever&quot;</span> =<span class="st"> </span>(<span class="kw">mean</span>(ECIGT, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>),</span>
<span id="cb100-5"><a href="#cb100-5"></a>    <span class="st">&quot;E-cigarettes, Ever&quot;</span> =<span class="st"> </span>(<span class="kw">mean</span>(EELCIGT, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>),</span>
<span id="cb100-6"><a href="#cb100-6"></a>    <span class="st">&quot;Cigarettes, Current&quot;</span> =<span class="st"> </span>(<span class="kw">mean</span>(CCIGT, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>),</span>
<span id="cb100-7"><a href="#cb100-7"></a>    <span class="st">&quot;E-cigarettes, Current&quot;</span> =<span class="st"> </span>(<span class="kw">mean</span>(CELCIGT, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>)</span>
<span id="cb100-8"><a href="#cb100-8"></a>  ) <span class="op">%&gt;%</span></span>
<span id="cb100-9"><a href="#cb100-9"></a><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="op">-</span>year,</span>
<span id="cb100-10"><a href="#cb100-10"></a>               <span class="dt">names_to =</span> <span class="st">&quot;Category&quot;</span>,</span>
<span id="cb100-11"><a href="#cb100-11"></a>               <span class="dt">values_to =</span> <span class="st">&quot;Percentage of students&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb100-12"><a href="#cb100-12"></a><span class="st">  </span><span class="kw">separate</span>(Category, <span class="dt">into =</span> <span class="kw">c</span>(<span class="st">&quot;Product&quot;</span>, <span class="st">&quot;User&quot;</span>), <span class="dt">sep =</span> <span class="st">&quot;, &quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb100-13"><a href="#cb100-13"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(</span>
<span id="cb100-14"><a href="#cb100-14"></a>    <span class="dt">x =</span> year,</span>
<span id="cb100-15"><a href="#cb100-15"></a>    <span class="dt">y =</span> <span class="st">`</span><span class="dt">Percentage of students</span><span class="st">`</span>,</span>
<span id="cb100-16"><a href="#cb100-16"></a>    <span class="dt">color =</span> Product,</span>
<span id="cb100-17"><a href="#cb100-17"></a>    <span class="dt">linetype =</span> User</span>
<span id="cb100-18"><a href="#cb100-18"></a>  )) <span class="op">+</span></span>
<span id="cb100-19"><a href="#cb100-19"></a><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></span>
<span id="cb100-20"><a href="#cb100-20"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">show.legend =</span> <span class="ot">FALSE</span>, <span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb100-21"><a href="#cb100-21"></a><span class="st">  </span><span class="kw">scale_linetype_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">1</span>)) <span class="op">+</span></span>
<span id="cb100-22"><a href="#cb100-22"></a><span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> v_colors) <span class="op">+</span></span>
<span id="cb100-23"><a href="#cb100-23"></a><span class="st">  </span><span class="kw">theme_linedraw</span>() <span class="op">+</span></span>
<span id="cb100-24"><a href="#cb100-24"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb100-25"><a href="#cb100-25"></a>        <span class="dt">axis.title.x =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></span>
<span id="cb100-26"><a href="#cb100-26"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;How does e-cigarette use compare to cigarette use?&quot;</span>,</span>
<span id="cb100-27"><a href="#cb100-27"></a>       <span class="dt">subtitle =</span> <span class="st">&quot;Current and ever users of e-cigarettes and cigarettes&quot;</span>,</span>
<span id="cb100-28"><a href="#cb100-28"></a>       <span class="dt">y =</span> <span class="st">&quot;% of students&quot;</span>)</span>
<span id="cb100-29"><a href="#cb100-29"></a></span>
<span id="cb100-30"><a href="#cb100-30"></a>plot6</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-74-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Interesting! we can see that in 2019 the percentage of students that reported currently using e-cigarettes had surpassed those that ever tried (even just once) a cigarette. Overall cigarette usage appears to be declining over time. This is not the case for e-cigarettes.</p>
<p>Now we will look at students who reported that they had ever tried e-cigarettes or non-cigarette products. In this case we will not separate out users who specifically only used one or the other. Therefore, the students included in this plot who reported as having ever tried e-cigarettes might also be current users of non-e-cigarette products or may have at least tried non-e-cigarette products.</p>
<div class="sourceCode" id="section-cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1"></a>v_colors =<span class="st">  </span><span class="kw">viridis</span>(<span class="dv">6</span>)[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">4</span>)]</span>
<span id="cb101-2"><a href="#cb101-2"></a></span>
<span id="cb101-3"><a href="#cb101-3"></a>plot7 &lt;-<span class="st"> </span>nyts_data <span class="op">%&gt;%</span></span>
<span id="cb101-4"><a href="#cb101-4"></a><span class="st">  </span><span class="kw">group_by</span>(year) <span class="op">%&gt;%</span></span>
<span id="cb101-5"><a href="#cb101-5"></a><span class="st">  </span><span class="kw">summarize</span>(</span>
<span id="cb101-6"><a href="#cb101-6"></a>    <span class="st">`</span><span class="dt">e-cigarette_ever</span><span class="st">`</span> =<span class="st"> </span>(<span class="kw">mean</span>(ecig_ever, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>),</span>
<span id="cb101-7"><a href="#cb101-7"></a>    <span class="st">`</span><span class="dt">non-e-cigarette_ever</span><span class="st">`</span> =<span class="st"> </span>(<span class="kw">mean</span>(non_ecig_ever, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>)</span>
<span id="cb101-8"><a href="#cb101-8"></a>  ) <span class="op">%&gt;%</span></span>
<span id="cb101-9"><a href="#cb101-9"></a><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="op">-</span>year,</span>
<span id="cb101-10"><a href="#cb101-10"></a>               <span class="dt">names_to =</span> <span class="st">&quot;Category&quot;</span>,</span>
<span id="cb101-11"><a href="#cb101-11"></a>               <span class="dt">values_to =</span> <span class="st">&quot;Percentage of students&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb101-12"><a href="#cb101-12"></a><span class="st">  </span><span class="kw">separate</span>(Category, <span class="dt">into =</span> <span class="kw">c</span>(<span class="st">&quot;Product&quot;</span>, <span class="st">&quot;User&quot;</span>), <span class="dt">sep =</span> <span class="st">&quot;_&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb101-13"><a href="#cb101-13"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> year,</span>
<span id="cb101-14"><a href="#cb101-14"></a>             <span class="dt">y =</span> <span class="st">`</span><span class="dt">Percentage of students</span><span class="st">`</span>,</span>
<span id="cb101-15"><a href="#cb101-15"></a>             <span class="dt">color =</span> Product)) <span class="op">+</span></span>
<span id="cb101-16"><a href="#cb101-16"></a><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></span>
<span id="cb101-17"><a href="#cb101-17"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">show.legend =</span> <span class="ot">FALSE</span>, <span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb101-18"><a href="#cb101-18"></a><span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> v_colors) <span class="op">+</span></span>
<span id="cb101-19"><a href="#cb101-19"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">60</span>, <span class="dt">by =</span> <span class="dv">10</span>), <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">60</span>)) <span class="op">+</span></span>
<span id="cb101-20"><a href="#cb101-20"></a><span class="st">  </span><span class="kw">theme_linedraw</span>() <span class="op">+</span></span>
<span id="cb101-21"><a href="#cb101-21"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb101-22"><a href="#cb101-22"></a>        <span class="dt">axis.title.x =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></span>
<span id="cb101-23"><a href="#cb101-23"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;How does the rate of ever trying e-cigarettes</span></span>
<span id="cb101-24"><a href="#cb101-24"></a><span class="st">compare to ever trying other products over time?&quot;</span>,</span>
<span id="cb101-25"><a href="#cb101-25"></a><span class="dt">y =</span> <span class="st">&quot;% of students&quot;</span>)</span>
<span id="cb101-26"><a href="#cb101-26"></a></span>
<span id="cb101-27"><a href="#cb101-27"></a>plot7</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-75-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Now we will do the same, but for students who reported currently using e-cigarettes or non-e-cigarette products.</p>
<div class="sourceCode" id="section-cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1"></a>v_colors =<span class="st">  </span><span class="kw">viridis</span>(<span class="dv">6</span>)[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">4</span>)]</span>
<span id="cb102-2"><a href="#cb102-2"></a></span>
<span id="cb102-3"><a href="#cb102-3"></a>plot8 &lt;-<span class="st"> </span>nyts_data <span class="op">%&gt;%</span></span>
<span id="cb102-4"><a href="#cb102-4"></a><span class="st">  </span><span class="kw">group_by</span>(year) <span class="op">%&gt;%</span></span>
<span id="cb102-5"><a href="#cb102-5"></a><span class="st">  </span><span class="kw">summarize</span>(</span>
<span id="cb102-6"><a href="#cb102-6"></a>    <span class="st">`</span><span class="dt">e-cigarette_current</span><span class="st">`</span> =<span class="st"> </span>(<span class="kw">mean</span>(ecig_current, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>),</span>
<span id="cb102-7"><a href="#cb102-7"></a>    <span class="st">`</span><span class="dt">non-e-cigarette_current</span><span class="st">`</span> =<span class="st"> </span>(<span class="kw">mean</span>(non_ecig_current, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>)</span>
<span id="cb102-8"><a href="#cb102-8"></a>  ) <span class="op">%&gt;%</span></span>
<span id="cb102-9"><a href="#cb102-9"></a><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="op">-</span>year,</span>
<span id="cb102-10"><a href="#cb102-10"></a>               <span class="dt">names_to =</span> <span class="st">&quot;Category&quot;</span>,</span>
<span id="cb102-11"><a href="#cb102-11"></a>               <span class="dt">values_to =</span> <span class="st">&quot;Percentage of students&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb102-12"><a href="#cb102-12"></a><span class="st">  </span><span class="kw">separate</span>(Category, <span class="dt">into =</span> <span class="kw">c</span>(<span class="st">&quot;Product&quot;</span>, <span class="st">&quot;User&quot;</span>), <span class="dt">sep =</span> <span class="st">&quot;_&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb102-13"><a href="#cb102-13"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> year, <span class="dt">y =</span> <span class="st">`</span><span class="dt">Percentage of students</span><span class="st">`</span>, <span class="dt">color =</span> Product)) <span class="op">+</span></span>
<span id="cb102-14"><a href="#cb102-14"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="op">+</span></span>
<span id="cb102-15"><a href="#cb102-15"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">show.legend =</span> <span class="ot">FALSE</span>, <span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb102-16"><a href="#cb102-16"></a><span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> v_colors) <span class="op">+</span></span>
<span id="cb102-17"><a href="#cb102-17"></a><span class="st">  </span><span class="kw">scale_linetype_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">1</span>)) <span class="op">+</span></span>
<span id="cb102-18"><a href="#cb102-18"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">60</span>, <span class="dt">by =</span> <span class="dv">10</span>), <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">60</span>)) <span class="op">+</span></span>
<span id="cb102-19"><a href="#cb102-19"></a><span class="st">  </span><span class="kw">theme_linedraw</span>() <span class="op">+</span></span>
<span id="cb102-20"><a href="#cb102-20"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb102-21"><a href="#cb102-21"></a>        <span class="dt">axis.title.x =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></span>
<span id="cb102-22"><a href="#cb102-22"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;How does the rate of currently using e-cigarettes</span></span>
<span id="cb102-23"><a href="#cb102-23"></a><span class="st">compare to currently using other products over time?&quot;</span>,</span>
<span id="cb102-24"><a href="#cb102-24"></a>       <span class="dt">y =</span> <span class="st">&quot;% of students&quot;</span>)</span>
<span id="cb102-25"><a href="#cb102-25"></a></span>
<span id="cb102-26"><a href="#cb102-26"></a>plot8</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-76-1.png" width="90%" style="display: block; margin: auto;" /></p>
</div>
<div id="section-putting-plots-together" class="section level3">
<h3><strong>Putting plots together</strong></h3>
<hr />
<p>Now we will put these plots together using the <code>plot_grid()</code> function of the <code>cowplot</code> package. We will also modify the labels using the <code>ggdraw()</code> function, which is also part of the <code>cowplot</code> package.</p>
<div class="sourceCode" id="section-cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1"></a>plotA_uw &lt;-<span class="st"> </span>plot1 <span class="op">+</span></span>
<span id="cb103-2"><a href="#cb103-2"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb103-3"><a href="#cb103-3"></a>        <span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span></span>
<span id="cb103-4"><a href="#cb103-4"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Tobacco product users more prevalent after 2017&quot;</span>,</span>
<span id="cb103-5"><a href="#cb103-5"></a>       <span class="dt">subtitle =</span> <span class="ot">NULL</span>,</span>
<span id="cb103-6"><a href="#cb103-6"></a>       <span class="dt">y =</span> <span class="st">&quot;% of students&quot;</span>)</span>
<span id="cb103-7"><a href="#cb103-7"></a></span>
<span id="cb103-8"><a href="#cb103-8"></a>plotB_uw &lt;-<span class="st"> </span>plot7 <span class="op">+</span></span>
<span id="cb103-9"><a href="#cb103-9"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb103-10"><a href="#cb103-10"></a>        <span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span></span>
<span id="cb103-11"><a href="#cb103-11"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;% Ever trying e-cigarettes increases &amp;</span></span>
<span id="cb103-12"><a href="#cb103-12"></a><span class="st">% Ever trying other products decreases&quot;</span>,</span>
<span id="cb103-13"><a href="#cb103-13"></a>         <span class="dt">subtitle =</span> <span class="ot">NULL</span>,</span>
<span id="cb103-14"><a href="#cb103-14"></a>         <span class="dt">y =</span> <span class="st">&quot;% of students&quot;</span>)</span>
<span id="cb103-15"><a href="#cb103-15"></a></span>
<span id="cb103-16"><a href="#cb103-16"></a>plotC_uw &lt;-<span class="st"> </span>plot8 <span class="op">+</span></span>
<span id="cb103-17"><a href="#cb103-17"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb103-18"><a href="#cb103-18"></a>        <span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span></span>
<span id="cb103-19"><a href="#cb103-19"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;% Currently using e-cigarettes increases &amp;</span></span>
<span id="cb103-20"><a href="#cb103-20"></a><span class="st">% Currently using other products decreases&quot;</span>,</span>
<span id="cb103-21"><a href="#cb103-21"></a>         <span class="dt">subtitle =</span> <span class="ot">NULL</span>,</span>
<span id="cb103-22"><a href="#cb103-22"></a>         <span class="dt">y =</span> <span class="st">&quot;% of students&quot;</span>)</span>
<span id="cb103-23"><a href="#cb103-23"></a></span>
<span id="cb103-24"><a href="#cb103-24"></a>title_uw &lt;-<span class="st"> </span><span class="kw">ggdraw</span>() <span class="op">+</span></span>
<span id="cb103-25"><a href="#cb103-25"></a><span class="st">  </span><span class="kw">draw_label</span>(</span>
<span id="cb103-26"><a href="#cb103-26"></a>    <span class="st">&quot;Is there a relationship between e-cigarette use and tobacco use?&quot;</span>,</span>
<span id="cb103-27"><a href="#cb103-27"></a>    <span class="dt">fontface =</span> <span class="st">&#39;bold&#39;</span>,</span>
<span id="cb103-28"><a href="#cb103-28"></a>    <span class="dt">size =</span> <span class="dv">14</span>,</span>
<span id="cb103-29"><a href="#cb103-29"></a>    <span class="dt">x =</span> <span class="dv">0</span>,</span>
<span id="cb103-30"><a href="#cb103-30"></a>    <span class="dt">hjust =</span> <span class="dv">0</span></span>
<span id="cb103-31"><a href="#cb103-31"></a>  ) <span class="op">+</span></span>
<span id="cb103-32"><a href="#cb103-32"></a><span class="st">  </span><span class="kw">theme</span>(</span>
<span id="cb103-33"><a href="#cb103-33"></a>    <span class="dt">plot.margin =</span> <span class="kw">margin</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb103-34"><a href="#cb103-34"></a>  )</span>
<span id="cb103-35"><a href="#cb103-35"></a></span>
<span id="cb103-36"><a href="#cb103-36"></a>plotsA_uw &lt;-<span class="st"> </span><span class="kw">plot_grid</span>(plotA_uw,</span>
<span id="cb103-37"><a href="#cb103-37"></a>                     <span class="dt">rel_widths =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb103-38"><a href="#cb103-38"></a>plotsBC_uw &lt;-<span class="st"> </span><span class="kw">plot_grid</span>(plotB_uw,</span>
<span id="cb103-39"><a href="#cb103-39"></a>                        plotC_uw,</span>
<span id="cb103-40"><a href="#cb103-40"></a>                        <span class="dt">rel_widths =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb103-41"><a href="#cb103-41"></a></span>
<span id="cb103-42"><a href="#cb103-42"></a><span class="co"># this will take the legend from plot1c to use as the legend for the plot we are creating</span></span>
<span id="cb103-43"><a href="#cb103-43"></a>legend_uw &lt;-<span class="st"> </span><span class="kw">get_legend</span>(plot1c <span class="op">+</span></span>
<span id="cb103-44"><a href="#cb103-44"></a><span class="st">                       </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb103-45"><a href="#cb103-45"></a>                             <span class="dt">legend.direction =</span> <span class="st">&quot;horizontal&quot;</span>))</span>
<span id="cb103-46"><a href="#cb103-46"></a></span>
<span id="cb103-47"><a href="#cb103-47"></a>figure_uw &lt;-<span class="st"> </span><span class="kw">plot_grid</span>(title_uw,</span>
<span id="cb103-48"><a href="#cb103-48"></a>                       plotsA_uw,</span>
<span id="cb103-49"><a href="#cb103-49"></a>                       plotsBC_uw,</span>
<span id="cb103-50"><a href="#cb103-50"></a>                       legend_uw,</span>
<span id="cb103-51"><a href="#cb103-51"></a>                       <span class="dt">ncol =</span> <span class="dv">1</span>,</span>
<span id="cb103-52"><a href="#cb103-52"></a>                       <span class="dt">rel_heights =</span> <span class="kw">c</span>(<span class="fl">0.1</span>,</span>
<span id="cb103-53"><a href="#cb103-53"></a>                                       <span class="dv">1</span>,</span>
<span id="cb103-54"><a href="#cb103-54"></a>                                       <span class="dv">1</span>,</span>
<span id="cb103-55"><a href="#cb103-55"></a>                                       <span class="fl">0.1</span>),</span>
<span id="cb103-56"><a href="#cb103-56"></a>                       <span class="dt">scale =</span> <span class="fl">1.0</span>)</span>
<span id="cb103-57"><a href="#cb103-57"></a></span>
<span id="cb103-58"><a href="#cb103-58"></a>figure_uw</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-77-1.png" width="90%" style="display: block; margin: auto;" /></p>
</div>
<div id="section-survey-weighting" class="section level3">
<h3><strong>Survey Weighting</strong></h3>
<hr />
<p>It turns out that our analysis thus far has been brushing an important statistical concept under the rug, related to how our data were collected. Our data come from responses to a survey, which may have a particular sampling scheme to capture data about the population we are interested in. For example, the survey may be designed to capture a set of individuals who reflect the characteristics of the population that we are interested in drawing conclusions about. However, only a fraction of the individuals who were contacted about taking the survey may have completed it, and this fraction of individuals may no longer be representative of the population. Or the survey may be designed to over-sample a particular group of interest so that individuals from that group show up more often as survey respondents than are present in the population overall. In order to account for the fact that the survey respondents may not reflect the composition of the population we want to generalize to, we can employ a technique called <a href="http://www.applied-survey-methods.com/weight.html" target="_blank">survey weighting</a>.</p>
<p>Survey weighting is a common technique used in survey data analysis because often the individuals that take a survey are not necessarily representative of the population that we are trying to gather information about. For example, we may have more females that respond to the survey than males because perhaps female students were more willing to participate. In this case, the proportion of data values in our data will be smaller for the males than the proportion of actual male students and larger for the females than the true proportion of actual female students. To get a better estimate of overall e-cigarette smoking rates, the data from the males can be weighted based on the true proportion of male students to amplify the contribution of the responses from the males that did participate. Conversely, the female data can be weighted to diminish the contribution if their responses to the overall picture. We will see if using survey weighting changes the general trends that we see in our data.</p>
<p>Calculating survey weights involves making a weight based on the ratio of the proportion of survey respondents from a particular group and the actual proportion of that group in the population. For example, let’s say that females account for 50% of the population and males account for 50 % of the population. Let’s also say that 75% of the respondents to the survey were female and only 25% were males.</p>
<p>Then we could calculate survey weights using this formula:</p>
<p><span class="math display">\[ \frac{\text{actual proportion of group in the population}}{\text{ proportion of group in the respondents}}\]</span></p>
<p>Thus the weight for the females would be calculated as:</p>
<p><span class="math display">\[ \frac{.5}{.75} = .67\]</span></p>
<p>The weight for the males would be calculated as:</p>
<p><span class="math display">\[ \frac{.5}{.25} = 2\]</span></p>
<p>Therefore each male response value would be multiplied by a factor of 2 and would have twice the contribution, while the female response values would have only about 70% of the contribution that they would have had without weighting.</p>
<p>Note that survey weights are in reality corrected for other aspects - for example the response rate to individual questions.</p>
<p>We do not need to calculate survey weights for our data as they were already supplied in the dataset, as described in the codebooks.</p>
<div id="section-srvyr-package-and-survey-design" class="section level4">
<h4><code>srvyr</code> package and survey design</h4>
<hr />
<p>We will now use the <code>srvyr</code> package to evaluate our data using survey weights that were provided in the data for each year, as described in the respective codebooks. This package contains functions that allow the user to easily perform calculations from the data that take the survey design into account, without having to work out the math by hand.</p>
<p>Within the data you will see that we have three variables related to the survey sampling scheme: <code>psu</code>, <code>finwgt</code>, and <code>stratum</code>. Details about these variables are available, for example, in the <a href="./docs/2019-nyts-dataset-and-codebook-microsoft-excel/2019-nyts-methodology-report-p.pdf" target="_blank">2019 Methodology Report</a>.</p>
<p>In brief they represent:</p>
<ol style="list-style-type: decimal">
<li><p><code>psu</code>: Surveys like the one used to create the data we are using often sample people based on strata. This is done to ensure that the responses are representative of the population of interest. Thus, often people first think about ensuring that surveys are conducted in a variety of geographical areas. This is often called the <strong>primary sampling unit</strong> or <strong>PSU</strong>. In <a href="https://web.sph.harvard.edu/mch-data-connect/results/national-youth-tobacco-survey-nyts/" target="_blank">this survey</a>, the county where the student’s school was located was used as the PSU.</p></li>
<li><p><code>stratum</code>: A categorical variable that indicates subsets of the data that include respondents from different <em>PSUs</em>. In our case, strata are determined by the predominant minority in the PSU (Non-Hispanic Black or Hispanic), whether the PSU is urban or non-urban, and what percent of the students in the PSU fall into the predominant minority group. PSUs are allocated across the 16 possible strata according to the sampling scheme. These strata values allow estimates based on the survey responses to be calculated using different strata allowing for improved precision of the response estimates.</p></li>
<li><p><code>finwgt</code>: The survey weight which was calculated based on a variety of factors.</p></li>
</ol>
<p>This <a href="https://web.sph.harvard.edu/mch-data-connect/results/national-youth-tobacco-survey-nyts/" target="_blank">link</a> and this <a href="https://osf.io/n7r32" target="_blank">link</a> have more information about the study design of the data that we are using.</p>
<p>For detailed information on such survey designs in general see <a href="http://www.asasrms.org/Proceedings/y2008/Files/301835.pdf" target="_blank">here</a> and <a href="http://ocw.jhsph.edu/courses/StatMethodsForSampleSurveys/PDFs/Lecture5.pdf" target="_blank">here</a>.</p>
<p>We will use the <code>as_survey_design()</code> function of the <code>srvyr</code>package to create a survey object with a specified survey design. This is a special R object that includes information about how the survey was conducted that can be taken into account in the analysis.</p>
<p>There are several arguments to pay attention to:</p>
<ol style="list-style-type: decimal">
<li>The <code>strata</code> argument is used to specify the variable(s) that defined strata in the data. In this case, we will use the <code>stratum</code> variable.</li>
<li>The <code>ids</code> argument is used to define cluster ids within the data. In this case we will use the <code>psu</code> variable.</li>
<li>The <code>weight</code> argument is the used to define which variable(s) are the survey weights.</li>
<li>The <code>nest = TRUE</code> argument, forces cluster ids (in this case the PSU) to be nested within the strata.</li>
</ol>
<p>We can then use the <code>survey_mean()</code> function to calculate percentages of students who report using tobacco for each year while accounting for the survey design and weights. We will specify that we want <a href="https://en.wikipedia.org/wiki/Confidence_interval" target="_blank">confidence interval</a> estimates by using the <code>vartype = "ci"</code> argument. The confidence intervals in our case give a range of possible values for the true population mean based on the data observed in the survey. We will multiply these values by 100 to get percentages. (Note: We could also have calculated confidence intervals for the unweighted results above by computing them by hand; we leave this as a potential exercise.)</p>
<p>Since the survey weights are specific to a single year of the survey results, we need to create survey design objects for each year separately. We will use <code>group_by</code> and <code>group_modify</code>, which is also from the <code>dplyr</code> package, to do this. We first write the function that we want to call on each group.</p>
<p>This function takes an input called <code>currYear</code>, which will be one set of survey responses for a specific year, and then creates a survey design based on the <code>stratum</code> and <code>finwgt</code> values specific to that year. It then calculates the percent of student respondents who have ever tried any tobacco products or who are a current user of any tobacco products accounting for the survey design and weights using <code>survey_mean()</code> as was just described. The function then wrangles the data to convert the means to percentages and reformat the data in long form for plotting.</p>
<p>One technical note: since some years have strata with a single PSU, we need to tell the survey weighting package how to handle estimating within strata variances. The line <code>options(survey.lonely.psu = "adjust")</code> tells R to center the stratum with the single PSU on the sample grand mean, a conservative approach to solving the problem. See further information <a href="https://r-survey.r-forge.r-project.org/survey/exmample-lonely.html" target="_blank">here</a> and <a href="http://r-survey.r-forge.r-project.org/survey/html/surveyoptions.html" target="_blank">here</a>.</p>
</div>
</div>
<div id="section-weighted-sample" class="section level3">
<h3><strong>Weighted Sample</strong></h3>
<hr />
<p>First, we show the basic output of the <code>survey_mean</code> function by year. Since we include the argument <code>vartype = "ci"</code>, we get a mean and upper and lower confidence interval bounds for the mean.</p>
<div class="sourceCode" id="section-cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1"></a>surveyMeanA &lt;-<span class="st"> </span><span class="cf">function</span>(currYear) {</span>
<span id="cb104-2"><a href="#cb104-2"></a>  <span class="kw">options</span>(<span class="dt">survey.lonely.psu =</span> <span class="st">&quot;adjust&quot;</span>)</span>
<span id="cb104-3"><a href="#cb104-3"></a>  currYear <span class="op">%&gt;%</span></span>
<span id="cb104-4"><a href="#cb104-4"></a><span class="st">  </span><span class="kw">as_survey_design</span>(<span class="dt">strata =</span> stratum,</span>
<span id="cb104-5"><a href="#cb104-5"></a>                      <span class="dt">ids =</span> psu,</span>
<span id="cb104-6"><a href="#cb104-6"></a>                  <span class="dt">weight  =</span> finwgt,</span>
<span id="cb104-7"><a href="#cb104-7"></a>                     <span class="dt">nest =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></span>
<span id="cb104-8"><a href="#cb104-8"></a><span class="st">   </span><span class="kw">summarize</span>(<span class="dt">tobacco_ever =</span> <span class="kw">survey_mean</span>(tobacco_ever,</span>
<span id="cb104-9"><a href="#cb104-9"></a>                                        <span class="dt">vartype =</span> <span class="st">&quot;ci&quot;</span>,</span>
<span id="cb104-10"><a href="#cb104-10"></a>                                        <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb104-11"><a href="#cb104-11"></a>          <span class="dt">tobacco_current =</span> <span class="kw">survey_mean</span>(tobacco_current,</span>
<span id="cb104-12"><a href="#cb104-12"></a>                                        <span class="dt">vartype =</span> <span class="st">&quot;ci&quot;</span>,</span>
<span id="cb104-13"><a href="#cb104-13"></a>                                        <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) }</span>
<span id="cb104-14"><a href="#cb104-14"></a></span>
<span id="cb104-15"><a href="#cb104-15"></a></span>
<span id="cb104-16"><a href="#cb104-16"></a>nyts_data <span class="op">%&gt;%</span></span>
<span id="cb104-17"><a href="#cb104-17"></a><span class="st">  </span><span class="kw">group_by</span>(year) <span class="op">%&gt;%</span></span>
<span id="cb104-18"><a href="#cb104-18"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">group_modify</span>(<span class="op">~</span><span class="st"> </span><span class="kw">surveyMeanA</span>(.x)) <span class="op">%&gt;%</span></span>
<span id="cb104-19"><a href="#cb104-19"></a><span class="st">  </span><span class="kw">head</span>()</span></code></pre></div>
<pre><code># A tibble: 5 x 7
# Groups:   year [5]
   year tobacco_ever tobacco_ever_low tobacco_ever_upp tobacco_current
  &lt;dbl&gt;        &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;           &lt;dbl&gt;
1  2015        0.372            0.344            0.400           0.180
2  2016        0.338            0.319            0.358           0.148
3  2017        0.307            0.284            0.330           0.139
4  2018        0.339            0.318            0.360           0.185
5  2019        0.408            0.384            0.432           0.233
# ... with 2 more variables: tobacco_current_low &lt;dbl&gt;,
#   tobacco_current_upp &lt;dbl&gt;</code></pre>
<p>Now let’s make the function wrangle the output in a more usable form too:</p>
<div class="sourceCode" id="section-cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1"></a>surveyMeanA &lt;-<span class="st"> </span><span class="cf">function</span>(currYear) {</span>
<span id="cb106-2"><a href="#cb106-2"></a>  <span class="kw">options</span>(<span class="dt">survey.lonely.psu =</span> <span class="st">&quot;adjust&quot;</span>)</span>
<span id="cb106-3"><a href="#cb106-3"></a>  currYear <span class="op">%&gt;%</span></span>
<span id="cb106-4"><a href="#cb106-4"></a><span class="st">  </span><span class="kw">as_survey_design</span>(<span class="dt">strata =</span> stratum,</span>
<span id="cb106-5"><a href="#cb106-5"></a>                      <span class="dt">ids =</span> psu,</span>
<span id="cb106-6"><a href="#cb106-6"></a>                  <span class="dt">weight  =</span> finwgt,</span>
<span id="cb106-7"><a href="#cb106-7"></a>                     <span class="dt">nest =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></span>
<span id="cb106-8"><a href="#cb106-8"></a><span class="st">   </span><span class="kw">summarize</span>(<span class="dt">tobacco_ever =</span> <span class="kw">survey_mean</span>(tobacco_ever,</span>
<span id="cb106-9"><a href="#cb106-9"></a>                                        <span class="dt">vartype =</span> <span class="st">&quot;ci&quot;</span>,</span>
<span id="cb106-10"><a href="#cb106-10"></a>                                        <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb106-11"><a href="#cb106-11"></a>          <span class="dt">tobacco_current =</span> <span class="kw">survey_mean</span>(tobacco_current,</span>
<span id="cb106-12"><a href="#cb106-12"></a>                                        <span class="dt">vartype =</span> <span class="st">&quot;ci&quot;</span>,</span>
<span id="cb106-13"><a href="#cb106-13"></a>                                        <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))  <span class="op">%&gt;%</span></span>
<span id="cb106-14"><a href="#cb106-14"></a><span class="st">  </span><span class="kw">mutate_all</span>(<span class="st">&quot;*&quot;</span>, <span class="dv">100</span>) <span class="op">%&gt;%</span></span>
<span id="cb106-15"><a href="#cb106-15"></a><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="kw">everything</span>(),</span>
<span id="cb106-16"><a href="#cb106-16"></a>               <span class="dt">names_to =</span> <span class="st">&quot;Type&quot;</span>,</span>
<span id="cb106-17"><a href="#cb106-17"></a>               <span class="dt">values_to =</span> <span class="st">&quot;Percentage of students&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb106-18"><a href="#cb106-18"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Estimate =</span> <span class="kw">case_when</span>(<span class="kw">str_detect</span>(Type, <span class="st">&quot;_low&quot;</span>) <span class="op">~</span><span class="st"> &quot;Lower&quot;</span>,</span>
<span id="cb106-19"><a href="#cb106-19"></a>                              <span class="kw">str_detect</span>(Type, <span class="st">&quot;_upp&quot;</span>) <span class="op">~</span><span class="st"> &quot;Upper&quot;</span>,</span>
<span id="cb106-20"><a href="#cb106-20"></a>                          <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;Mean&quot;</span>),</span>
<span id="cb106-21"><a href="#cb106-21"></a>         <span class="dt">User =</span> <span class="kw">case_when</span>(<span class="kw">str_detect</span>(Type, <span class="st">&quot;ever&quot;</span>) <span class="op">~</span><span class="st"> &quot;Ever&quot;</span>,</span>
<span id="cb106-22"><a href="#cb106-22"></a>                          <span class="kw">str_detect</span>(Type, <span class="st">&quot;current&quot;</span>) <span class="op">~</span><span class="st"> &quot;Current&quot;</span>,</span>
<span id="cb106-23"><a href="#cb106-23"></a>                          <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;Mean&quot;</span>))}</span>
<span id="cb106-24"><a href="#cb106-24"></a></span>
<span id="cb106-25"><a href="#cb106-25"></a>nyts_data <span class="op">%&gt;%</span></span>
<span id="cb106-26"><a href="#cb106-26"></a><span class="st">  </span><span class="kw">group_by</span>(year) <span class="op">%&gt;%</span></span>
<span id="cb106-27"><a href="#cb106-27"></a><span class="st">  </span><span class="kw">group_modify</span>(<span class="op">~</span><span class="st"> </span><span class="kw">surveyMeanA</span>(.x))</span></code></pre></div>
<pre><code># A tibble: 30 x 5
# Groups:   year [5]
    year Type                `Percentage of students` Estimate User   
   &lt;dbl&gt; &lt;chr&gt;                                  &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;  
 1  2015 tobacco_ever                            37.2 Mean     Ever   
 2  2015 tobacco_ever_low                        34.4 Lower    Ever   
 3  2015 tobacco_ever_upp                        40.0 Upper    Ever   
 4  2015 tobacco_current                         18.0 Mean     Current
 5  2015 tobacco_current_low                     16.2 Lower    Current
 6  2015 tobacco_current_upp                     19.9 Upper    Current
 7  2016 tobacco_ever                            33.8 Mean     Ever   
 8  2016 tobacco_ever_low                        31.9 Lower    Ever   
 9  2016 tobacco_ever_upp                        35.8 Upper    Ever   
10  2016 tobacco_current                         14.8 Mean     Current
# ... with 20 more rows</code></pre>
<p>We will now make a plot using this data. The confidence intervals are included using the <code>geom_linerange()</code> function of the <code>ggplot2</code> package.</p>
<div class="sourceCode" id="section-cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1"></a>plotA_w &lt;-<span class="st"> </span>nyts_data <span class="op">%&gt;%</span></span>
<span id="cb108-2"><a href="#cb108-2"></a><span class="st">  </span><span class="kw">group_by</span>(year) <span class="op">%&gt;%</span></span>
<span id="cb108-3"><a href="#cb108-3"></a><span class="st">  </span><span class="kw">group_modify</span>(<span class="op">~</span><span class="st"> </span><span class="kw">surveyMeanA</span>(.x)) <span class="op">%&gt;%</span></span>
<span id="cb108-4"><a href="#cb108-4"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>Type) <span class="op">%&gt;%</span></span>
<span id="cb108-5"><a href="#cb108-5"></a><span class="st">  </span><span class="kw">pivot_wider</span>(<span class="dt">names_from =</span> Estimate,</span>
<span id="cb108-6"><a href="#cb108-6"></a>             <span class="dt">values_from =</span> <span class="st">`</span><span class="dt">Percentage of students</span><span class="st">`</span>) <span class="op">%&gt;%</span></span>
<span id="cb108-7"><a href="#cb108-7"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> year, <span class="dt">y =</span> Mean)) <span class="op">+</span></span>
<span id="cb108-8"><a href="#cb108-8"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">linetype =</span> User)) <span class="op">+</span></span>
<span id="cb108-9"><a href="#cb108-9"></a><span class="st">  </span><span class="kw">geom_linerange</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> Lower,</span>
<span id="cb108-10"><a href="#cb108-10"></a>                     <span class="dt">ymax =</span> Upper), </span>
<span id="cb108-11"><a href="#cb108-11"></a>                     <span class="dt">size =</span> <span class="dv">1</span>, </span>
<span id="cb108-12"><a href="#cb108-12"></a>              <span class="dt">show.legend =</span> <span class="ot">FALSE</span>) <span class="op">+</span></span>
<span id="cb108-13"><a href="#cb108-13"></a><span class="st">  </span><span class="kw">scale_linetype_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">1</span>)) <span class="op">+</span></span>
<span id="cb108-14"><a href="#cb108-14"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">70</span>, <span class="dt">by =</span> <span class="dv">10</span>),</span>
<span id="cb108-15"><a href="#cb108-15"></a>                     <span class="dt">labels =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">70</span>, <span class="dt">by =</span> <span class="dv">10</span>),</span>
<span id="cb108-16"><a href="#cb108-16"></a>                     <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">70</span>)) <span class="op">+</span></span>
<span id="cb108-17"><a href="#cb108-17"></a><span class="st">    </span><span class="kw">theme_linedraw</span>() <span class="op">+</span></span>
<span id="cb108-18"><a href="#cb108-18"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb108-19"><a href="#cb108-19"></a>          <span class="dt">axis.title.x =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></span>
<span id="cb108-20"><a href="#cb108-20"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Tobacco product users more prevalent after 2017&quot;</span>,</span>
<span id="cb108-21"><a href="#cb108-21"></a>         <span class="dt">y =</span> <span class="st">&quot;% of students&quot;</span>)</span>
<span id="cb108-22"><a href="#cb108-22"></a>plotA_w</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-81-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Now we can see that we have confidence interval ranges plotted for each value.</p>
<p>We will make a similar plot for students who reported ever trying or who currently use e-cigarettes as opposed to tobacco in general.</p>
<div class="sourceCode" id="section-cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1"></a>v_colors =<span class="st">  </span><span class="kw">viridis</span>(<span class="dv">6</span>)[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">4</span>)]</span>
<span id="cb109-2"><a href="#cb109-2"></a></span>
<span id="cb109-3"><a href="#cb109-3"></a>surveyMeanB &lt;-<span class="st"> </span><span class="cf">function</span>(currYear) {</span>
<span id="cb109-4"><a href="#cb109-4"></a>  <span class="kw">options</span>(<span class="dt">survey.lonely.psu =</span> <span class="st">&quot;adjust&quot;</span>)</span>
<span id="cb109-5"><a href="#cb109-5"></a>  currYear <span class="op">%&gt;%</span></span>
<span id="cb109-6"><a href="#cb109-6"></a><span class="st">  </span><span class="kw">as_survey_design</span>(<span class="dt">strata =</span> stratum,</span>
<span id="cb109-7"><a href="#cb109-7"></a>                      <span class="dt">ids =</span> psu,</span>
<span id="cb109-8"><a href="#cb109-8"></a>                  <span class="dt">weight  =</span> finwgt,</span>
<span id="cb109-9"><a href="#cb109-9"></a>                     <span class="dt">nest =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></span>
<span id="cb109-10"><a href="#cb109-10"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">ecig_ever_year =</span> <span class="kw">survey_mean</span>(ecig_ever, </span>
<span id="cb109-11"><a href="#cb109-11"></a>                                         <span class="dt">vartype =</span> <span class="st">&quot;ci&quot;</span>, </span>
<span id="cb109-12"><a href="#cb109-12"></a>                                         <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb109-13"><a href="#cb109-13"></a>        <span class="dt">non_ecig_ever_year =</span> <span class="kw">survey_mean</span>(non_ecig_ever, </span>
<span id="cb109-14"><a href="#cb109-14"></a>                                         <span class="dt">vartype =</span> <span class="st">&quot;ci&quot;</span>, </span>
<span id="cb109-15"><a href="#cb109-15"></a>                                         <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span></span>
<span id="cb109-16"><a href="#cb109-16"></a><span class="st">  </span><span class="kw">mutate_all</span>(<span class="st">&quot;*&quot;</span>, <span class="dv">100</span>) <span class="op">%&gt;%</span></span>
<span id="cb109-17"><a href="#cb109-17"></a><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="kw">everything</span>(),</span>
<span id="cb109-18"><a href="#cb109-18"></a>           <span class="dt">names_to =</span> <span class="st">&quot;Category&quot;</span>,</span>
<span id="cb109-19"><a href="#cb109-19"></a>          <span class="dt">values_to =</span> <span class="st">&quot;Percentage of students&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb109-20"><a href="#cb109-20"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Estimate =</span> <span class="kw">case_when</span>(<span class="kw">str_detect</span>(Category, <span class="st">&quot;_low&quot;</span>) <span class="op">~</span><span class="st"> &quot;Lower&quot;</span>,</span>
<span id="cb109-21"><a href="#cb109-21"></a>                              <span class="kw">str_detect</span>(Category, <span class="st">&quot;_upp&quot;</span>) <span class="op">~</span><span class="st"> &quot;Upper&quot;</span>,</span>
<span id="cb109-22"><a href="#cb109-22"></a>                                                      <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;Mean&quot;</span>),</span>
<span id="cb109-23"><a href="#cb109-23"></a>             <span class="dt">User =</span> <span class="kw">case_when</span>(<span class="kw">str_detect</span>(Category, <span class="st">&quot;ever&quot;</span>) <span class="op">~</span><span class="st"> &quot;Ever&quot;</span>,</span>
<span id="cb109-24"><a href="#cb109-24"></a>                           <span class="kw">str_detect</span>(Category, <span class="st">&quot;current&quot;</span>) <span class="op">~</span><span class="st"> &quot;Current&quot;</span>),</span>
<span id="cb109-25"><a href="#cb109-25"></a>      <span class="dt">Product =</span> <span class="kw">case_when</span>(<span class="kw">str_detect</span>(Category, <span class="st">&quot;non_ecig&quot;</span>) <span class="op">~</span><span class="st"> &quot;Other products&quot;</span>,</span>
<span id="cb109-26"><a href="#cb109-26"></a>                                                      <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;E-cigarettes&quot;</span>)) <span class="op">%&gt;%</span></span>
<span id="cb109-27"><a href="#cb109-27"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>Category) <span class="op">%&gt;%</span></span>
<span id="cb109-28"><a href="#cb109-28"></a><span class="st">  </span><span class="kw">pivot_wider</span>(<span class="dt">names_from =</span> Estimate,</span>
<span id="cb109-29"><a href="#cb109-29"></a>              <span class="dt">values_from =</span> <span class="st">`</span><span class="dt">Percentage of students</span><span class="st">`</span>)}</span>
<span id="cb109-30"><a href="#cb109-30"></a></span>
<span id="cb109-31"><a href="#cb109-31"></a>nyts_data <span class="op">%&gt;%</span></span>
<span id="cb109-32"><a href="#cb109-32"></a><span class="st">  </span><span class="kw">group_by</span>(year) <span class="op">%&gt;%</span></span>
<span id="cb109-33"><a href="#cb109-33"></a><span class="st">  </span><span class="kw">group_modify</span>( <span class="op">~</span><span class="st"> </span><span class="kw">surveyMeanB</span>(.x)) <span class="op">%&gt;%</span></span>
<span id="cb109-34"><a href="#cb109-34"></a><span class="st">  </span><span class="kw">head</span>()</span></code></pre></div>
<pre><code># A tibble: 6 x 6
# Groups:   year [3]
   year User  Product         Mean Lower Upper
  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;          &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1  2015 Ever  E-cigarettes    26.6  24.3  29.0
2  2015 Ever  Other products  31.3  28.7  33.8
3  2016 Ever  E-cigarettes    22.6  21.0  24.3
4  2016 Ever  Other products  28.2  26.2  30.2
5  2017 Ever  E-cigarettes    21.1  19.1  23.2
6  2017 Ever  Other products  24.3  22.2  26.4</code></pre>
<div class="sourceCode" id="section-cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1"></a>plotB_w &lt;-<span class="st"> </span>nyts_data <span class="op">%&gt;%</span></span>
<span id="cb111-2"><a href="#cb111-2"></a><span class="st">  </span><span class="kw">group_by</span>(year) <span class="op">%&gt;%</span></span>
<span id="cb111-3"><a href="#cb111-3"></a><span class="st">  </span><span class="kw">group_modify</span>( <span class="op">~</span><span class="st"> </span><span class="kw">surveyMeanB</span>(.x)) <span class="op">%&gt;%</span></span>
<span id="cb111-4"><a href="#cb111-4"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> year, <span class="dt">y =</span> Mean, <span class="dt">color =</span> Product)) <span class="op">+</span></span>
<span id="cb111-5"><a href="#cb111-5"></a><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></span>
<span id="cb111-6"><a href="#cb111-6"></a><span class="st">  </span><span class="kw">geom_linerange</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> Lower, <span class="dt">ymax =</span> Upper),</span>
<span id="cb111-7"><a href="#cb111-7"></a>                 <span class="dt">size =</span> <span class="dv">1</span>,</span>
<span id="cb111-8"><a href="#cb111-8"></a>                 <span class="dt">show.legend =</span> <span class="ot">FALSE</span>) <span class="op">+</span></span>
<span id="cb111-9"><a href="#cb111-9"></a><span class="st">  </span><span class="kw">scale_linetype_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">1</span>)) <span class="op">+</span></span>
<span id="cb111-10"><a href="#cb111-10"></a><span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> v_colors) <span class="op">+</span></span>
<span id="cb111-11"><a href="#cb111-11"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(</span>
<span id="cb111-12"><a href="#cb111-12"></a>    <span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">60</span>, <span class="dt">by =</span> <span class="dv">10</span>),</span>
<span id="cb111-13"><a href="#cb111-13"></a>    <span class="dt">labels =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">60</span>, <span class="dt">by =</span> <span class="dv">10</span>),</span>
<span id="cb111-14"><a href="#cb111-14"></a>    <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">60</span>)</span>
<span id="cb111-15"><a href="#cb111-15"></a>  ) <span class="op">+</span></span>
<span id="cb111-16"><a href="#cb111-16"></a><span class="st">  </span><span class="kw">theme_linedraw</span>() <span class="op">+</span></span>
<span id="cb111-17"><a href="#cb111-17"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb111-18"><a href="#cb111-18"></a>        <span class="dt">axis.title.x =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></span>
<span id="cb111-19"><a href="#cb111-19"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;% Ever trying e-cigarettes increases &amp;</span></span>
<span id="cb111-20"><a href="#cb111-20"></a><span class="st">% Ever trying other products decreases&quot;</span>,</span>
<span id="cb111-21"><a href="#cb111-21"></a>       <span class="dt">y =</span> <span class="st">&quot;% of students&quot;</span>)</span>
<span id="cb111-22"><a href="#cb111-22"></a></span>
<span id="cb111-23"><a href="#cb111-23"></a>plotB_w</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-82-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Now we will do the same but for current users:</p>
<div class="sourceCode" id="section-cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1"></a>surveyMeanC &lt;-<span class="st"> </span><span class="cf">function</span>(currYear) {</span>
<span id="cb112-2"><a href="#cb112-2"></a>  <span class="kw">options</span>(<span class="dt">survey.lonely.psu =</span> <span class="st">&quot;adjust&quot;</span>)</span>
<span id="cb112-3"><a href="#cb112-3"></a>  currYear <span class="op">%&gt;%</span></span>
<span id="cb112-4"><a href="#cb112-4"></a><span class="st">  </span><span class="kw">as_survey_design</span>(<span class="dt">strata =</span> stratum,</span>
<span id="cb112-5"><a href="#cb112-5"></a>                      <span class="dt">ids =</span> psu,</span>
<span id="cb112-6"><a href="#cb112-6"></a>                  <span class="dt">weight  =</span> finwgt,</span>
<span id="cb112-7"><a href="#cb112-7"></a>                     <span class="dt">nest =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></span>
<span id="cb112-8"><a href="#cb112-8"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">ecig_current_year =</span> <span class="kw">survey_mean</span>(ecig_current, </span>
<span id="cb112-9"><a href="#cb112-9"></a>                                            <span class="dt">vartype =</span> <span class="st">&quot;ci&quot;</span>, </span>
<span id="cb112-10"><a href="#cb112-10"></a>                                            <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb112-11"><a href="#cb112-11"></a>        <span class="dt">non_ecig_current_year =</span> <span class="kw">survey_mean</span>(non_ecig_current, </span>
<span id="cb112-12"><a href="#cb112-12"></a>                                            <span class="dt">vartype =</span> <span class="st">&quot;ci&quot;</span>, </span>
<span id="cb112-13"><a href="#cb112-13"></a>                                            <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span></span>
<span id="cb112-14"><a href="#cb112-14"></a><span class="st">  </span><span class="kw">mutate_all</span>(<span class="st">&quot;*&quot;</span>, <span class="dv">100</span>) <span class="op">%&gt;%</span></span>
<span id="cb112-15"><a href="#cb112-15"></a><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="kw">everything</span>(),</span>
<span id="cb112-16"><a href="#cb112-16"></a>           <span class="dt">names_to =</span> <span class="st">&quot;Category&quot;</span>,</span>
<span id="cb112-17"><a href="#cb112-17"></a>          <span class="dt">values_to =</span> <span class="st">&quot;Percentage of students&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb112-18"><a href="#cb112-18"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Estimate =</span> <span class="kw">case_when</span>(<span class="kw">str_detect</span>(Category, <span class="st">&quot;_low&quot;</span>) <span class="op">~</span><span class="st"> &quot;Lower&quot;</span>,</span>
<span id="cb112-19"><a href="#cb112-19"></a>                              <span class="kw">str_detect</span>(Category, <span class="st">&quot;_upp&quot;</span>) <span class="op">~</span><span class="st"> &quot;Upper&quot;</span>,</span>
<span id="cb112-20"><a href="#cb112-20"></a>                                                      <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;Mean&quot;</span>),</span>
<span id="cb112-21"><a href="#cb112-21"></a>             <span class="dt">User =</span> <span class="kw">case_when</span>(<span class="kw">str_detect</span>(Category, <span class="st">&quot;ever&quot;</span>) <span class="op">~</span><span class="st"> &quot;Ever&quot;</span>,</span>
<span id="cb112-22"><a href="#cb112-22"></a>                           <span class="kw">str_detect</span>(Category, <span class="st">&quot;current&quot;</span>) <span class="op">~</span><span class="st"> &quot;Current&quot;</span>),</span>
<span id="cb112-23"><a href="#cb112-23"></a>      <span class="dt">Product =</span> <span class="kw">case_when</span>(<span class="kw">str_detect</span>(Category, <span class="st">&quot;non_ecig&quot;</span>) <span class="op">~</span><span class="st"> &quot;Other products&quot;</span>,</span>
<span id="cb112-24"><a href="#cb112-24"></a>                                                      <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;E-cigarettes&quot;</span>)) <span class="op">%&gt;%</span></span>
<span id="cb112-25"><a href="#cb112-25"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>Category) <span class="op">%&gt;%</span></span>
<span id="cb112-26"><a href="#cb112-26"></a><span class="st">  </span><span class="kw">pivot_wider</span>(<span class="dt">names_from =</span> Estimate,</span>
<span id="cb112-27"><a href="#cb112-27"></a>              <span class="dt">values_from =</span> <span class="st">`</span><span class="dt">Percentage of students</span><span class="st">`</span>)}</span>
<span id="cb112-28"><a href="#cb112-28"></a></span>
<span id="cb112-29"><a href="#cb112-29"></a></span>
<span id="cb112-30"><a href="#cb112-30"></a>plotC_w &lt;-<span class="st"> </span>nyts_data <span class="op">%&gt;%</span></span>
<span id="cb112-31"><a href="#cb112-31"></a><span class="st">  </span><span class="kw">group_by</span>(year) <span class="op">%&gt;%</span></span>
<span id="cb112-32"><a href="#cb112-32"></a><span class="st">  </span><span class="kw">group_modify</span>( <span class="op">~</span><span class="st"> </span><span class="kw">surveyMeanC</span>(.x)) <span class="op">%&gt;%</span></span>
<span id="cb112-33"><a href="#cb112-33"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> year, <span class="dt">y =</span> Mean, <span class="dt">color =</span> Product)) <span class="op">+</span></span>
<span id="cb112-34"><a href="#cb112-34"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>)) <span class="op">+</span></span>
<span id="cb112-35"><a href="#cb112-35"></a><span class="st">  </span><span class="kw">geom_linerange</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> Lower, <span class="dt">ymax =</span> Upper),</span>
<span id="cb112-36"><a href="#cb112-36"></a>                 <span class="dt">size =</span> <span class="dv">1</span>,</span>
<span id="cb112-37"><a href="#cb112-37"></a>                 <span class="dt">show.legend =</span> <span class="ot">FALSE</span>) <span class="op">+</span></span>
<span id="cb112-38"><a href="#cb112-38"></a><span class="st">  </span><span class="kw">scale_linetype_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">1</span>)) <span class="op">+</span></span>
<span id="cb112-39"><a href="#cb112-39"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">60</span>, <span class="dt">by =</span> <span class="dv">10</span>), <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">60</span>)) <span class="op">+</span></span>
<span id="cb112-40"><a href="#cb112-40"></a><span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> v_colors) <span class="op">+</span></span>
<span id="cb112-41"><a href="#cb112-41"></a><span class="st">  </span><span class="kw">theme_linedraw</span>() <span class="op">+</span></span>
<span id="cb112-42"><a href="#cb112-42"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb112-43"><a href="#cb112-43"></a>        <span class="dt">axis.title.x =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></span>
<span id="cb112-44"><a href="#cb112-44"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;% Currently using e-cigarettes increases &amp;</span></span>
<span id="cb112-45"><a href="#cb112-45"></a><span class="st">% Currently using other products decreases&quot;</span>,</span>
<span id="cb112-46"><a href="#cb112-46"></a>        <span class="dt">y =</span> <span class="st">&quot;% of students&quot;</span>)</span>
<span id="cb112-47"><a href="#cb112-47"></a>plotC_w</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-83-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Now we will put these plots together again using the <code>cowplot</code> package:</p>
<div class="sourceCode" id="section-cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1"></a>title_w &lt;-<span class="st"> </span><span class="kw">ggdraw</span>() <span class="op">+</span></span>
<span id="cb113-2"><a href="#cb113-2"></a><span class="st">  </span><span class="kw">draw_label</span>(</span>
<span id="cb113-3"><a href="#cb113-3"></a>    <span class="kw">expression</span>(<span class="st">&quot;What is the relationship between e-cigarette use and tobacco use?&quot;</span>),</span>
<span id="cb113-4"><a href="#cb113-4"></a>    <span class="dt">fontface =</span> <span class="st">&#39;bold&#39;</span>,</span>
<span id="cb113-5"><a href="#cb113-5"></a>    <span class="dt">size =</span> <span class="dv">14</span>,</span>
<span id="cb113-6"><a href="#cb113-6"></a>    <span class="dt">x =</span> <span class="dv">0</span>,</span>
<span id="cb113-7"><a href="#cb113-7"></a>    <span class="dt">hjust =</span> <span class="dv">0</span></span>
<span id="cb113-8"><a href="#cb113-8"></a>  ) <span class="op">+</span></span>
<span id="cb113-9"><a href="#cb113-9"></a><span class="st">  </span><span class="kw">theme</span>(</span>
<span id="cb113-10"><a href="#cb113-10"></a>    <span class="dt">plot.margin =</span> <span class="kw">margin</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb113-11"><a href="#cb113-11"></a>  )</span>
<span id="cb113-12"><a href="#cb113-12"></a></span>
<span id="cb113-13"><a href="#cb113-13"></a>plotsA_w &lt;-<span class="st"> </span><span class="kw">plot_grid</span>(plotA_w,</span>
<span id="cb113-14"><a href="#cb113-14"></a>                     <span class="dt">rel_widths =</span> <span class="kw">c</span>(<span class="dv">1</span>),</span>
<span id="cb113-15"><a href="#cb113-15"></a>                     <span class="dt">align =</span> <span class="st">&quot;v&quot;</span>,</span>
<span id="cb113-16"><a href="#cb113-16"></a>                     <span class="dt">axis =</span> <span class="st">&quot;bt&quot;</span>)</span>
<span id="cb113-17"><a href="#cb113-17"></a>plotsBC_w &lt;-<span class="st"> </span><span class="kw">plot_grid</span>(plotB_w,</span>
<span id="cb113-18"><a href="#cb113-18"></a>                     plotC_w,</span>
<span id="cb113-19"><a href="#cb113-19"></a>                     <span class="dt">rel_widths =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb113-20"><a href="#cb113-20"></a>                     <span class="dt">align =</span> <span class="st">&quot;v&quot;</span>,</span>
<span id="cb113-21"><a href="#cb113-21"></a>                     <span class="dt">axis =</span> <span class="st">&quot;bt&quot;</span>)</span>
<span id="cb113-22"><a href="#cb113-22"></a></span>
<span id="cb113-23"><a href="#cb113-23"></a>legend_w &lt;-<span class="st"> </span><span class="kw">get_legend</span>(plot1c <span class="op">+</span></span>
<span id="cb113-24"><a href="#cb113-24"></a><span class="st">                       </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb113-25"><a href="#cb113-25"></a>                             <span class="dt">legend.direction =</span> <span class="st">&quot;horizontal&quot;</span>))</span>
<span id="cb113-26"><a href="#cb113-26"></a></span>
<span id="cb113-27"><a href="#cb113-27"></a>figure_w &lt;-<span class="st"> </span><span class="kw">plot_grid</span>(title_w,</span>
<span id="cb113-28"><a href="#cb113-28"></a>                      plotsA_w,</span>
<span id="cb113-29"><a href="#cb113-29"></a>                      plotsBC_w,</span>
<span id="cb113-30"><a href="#cb113-30"></a>                      legend_w,</span>
<span id="cb113-31"><a href="#cb113-31"></a>                      <span class="dt">ncol =</span> <span class="dv">1</span>,</span>
<span id="cb113-32"><a href="#cb113-32"></a>                      <span class="dt">rel_heights =</span> <span class="kw">c</span>(<span class="fl">0.1</span>,</span>
<span id="cb113-33"><a href="#cb113-33"></a>                                      <span class="dv">1</span>,</span>
<span id="cb113-34"><a href="#cb113-34"></a>                                      <span class="dv">1</span>,</span>
<span id="cb113-35"><a href="#cb113-35"></a>                                      <span class="fl">0.1</span>),</span>
<span id="cb113-36"><a href="#cb113-36"></a>                      <span class="dt">scale =</span> <span class="fl">1.0</span>)</span>
<span id="cb113-37"><a href="#cb113-37"></a></span>
<span id="cb113-38"><a href="#cb113-38"></a>figure_w</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-85-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>We can see that these figures look quite similar to the ones generated without using the survey weights.</p>
</div>
<div id="section-artificial-cohort" class="section level3">
<h3><strong>Artificial Cohort</strong></h3>
<hr />
<p>Although the survey design does not allow specific individuals to be followed over time, we will use certain subsets of the data from each year to construct an artificial cohort where we follow students of the same age group as they get older. This will allow us to look at how tobacco usage changed for students who were in 8th grade in 2015 as they aged.</p>
<p>All of the data so far has included all 6th-12th graders every year. Now we will look at just the data for students expected to graduate in 2019. These are the students who were in 8th grade in 2015, most of whom were 9th graders in 2016, 10th graders in 2017 and so on. We will filter the data to just the students expected to be in the graduating class of 2019.</p>
<div class="sourceCode" id="section-cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1"></a>surveyMeanCohort &lt;-<span class="st"> </span><span class="cf">function</span>(currYear) {</span>
<span id="cb114-2"><a href="#cb114-2"></a>  <span class="kw">options</span>(<span class="dt">survey.lonely.psu =</span> <span class="st">&quot;adjust&quot;</span>)</span>
<span id="cb114-3"><a href="#cb114-3"></a>  currYear <span class="op">%&gt;%</span></span>
<span id="cb114-4"><a href="#cb114-4"></a><span class="st">  </span><span class="kw">as_survey_design</span>(<span class="dt">strata =</span> stratum,</span>
<span id="cb114-5"><a href="#cb114-5"></a>                      <span class="dt">ids =</span> psu,</span>
<span id="cb114-6"><a href="#cb114-6"></a>                  <span class="dt">weight  =</span> finwgt,</span>
<span id="cb114-7"><a href="#cb114-7"></a>                     <span class="dt">nest =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></span>
<span id="cb114-8"><a href="#cb114-8"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">ecig_ever_year =</span> </span>
<span id="cb114-9"><a href="#cb114-9"></a>              <span class="kw">survey_mean</span>(ecig_ever, <span class="dt">vartype =</span> <span class="st">&quot;ci&quot;</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb114-10"><a href="#cb114-10"></a>            <span class="dt">ecig_current_year =</span> </span>
<span id="cb114-11"><a href="#cb114-11"></a>              <span class="kw">survey_mean</span>(ecig_current, <span class="dt">vartype =</span> <span class="st">&quot;ci&quot;</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb114-12"><a href="#cb114-12"></a>            <span class="dt">non_ecig_ever_year =</span> </span>
<span id="cb114-13"><a href="#cb114-13"></a>              <span class="kw">survey_mean</span>(non_ecig_ever, <span class="dt">vartype =</span> <span class="st">&quot;ci&quot;</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb114-14"><a href="#cb114-14"></a>            <span class="dt">non_ecig_current_year =</span> </span>
<span id="cb114-15"><a href="#cb114-15"></a>              <span class="kw">survey_mean</span>(non_ecig_current, <span class="dt">vartype =</span> <span class="st">&quot;ci&quot;</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb114-16"><a href="#cb114-16"></a>            <span class="dt">tobacco_ever_year =</span> </span>
<span id="cb114-17"><a href="#cb114-17"></a>              <span class="kw">survey_mean</span>(tobacco_ever, <span class="dt">vartype =</span> <span class="st">&quot;ci&quot;</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb114-18"><a href="#cb114-18"></a>            <span class="dt">tobacco_current_year =</span> </span>
<span id="cb114-19"><a href="#cb114-19"></a>              <span class="kw">survey_mean</span>(tobacco_current, <span class="dt">vartype =</span> <span class="st">&quot;ci&quot;</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span></span>
<span id="cb114-20"><a href="#cb114-20"></a><span class="st">  </span><span class="kw">mutate_all</span>(<span class="st">&quot;*&quot;</span>, <span class="dv">100</span>) <span class="op">%&gt;%</span></span>
<span id="cb114-21"><a href="#cb114-21"></a><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="kw">everything</span>(),</span>
<span id="cb114-22"><a href="#cb114-22"></a>               <span class="dt">names_to =</span> <span class="st">&quot;Category&quot;</span>,</span>
<span id="cb114-23"><a href="#cb114-23"></a>               <span class="dt">values_to =</span> <span class="st">&quot;Percentage of students&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb114-24"><a href="#cb114-24"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Estimate =</span> <span class="kw">case_when</span>(<span class="kw">str_detect</span>(Category, <span class="st">&quot;_low&quot;</span>) <span class="op">~</span><span class="st"> &quot;Lower&quot;</span>,</span>
<span id="cb114-25"><a href="#cb114-25"></a>                              <span class="kw">str_detect</span>(Category, <span class="st">&quot;_upp&quot;</span>) <span class="op">~</span><span class="st"> &quot;Upper&quot;</span>,</span>
<span id="cb114-26"><a href="#cb114-26"></a>                                                      <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;Mean&quot;</span>),</span>
<span id="cb114-27"><a href="#cb114-27"></a>             <span class="dt">User =</span> <span class="kw">case_when</span>(<span class="kw">str_detect</span>(Category, <span class="st">&quot;ever&quot;</span>) <span class="op">~</span><span class="st"> &quot;Ever&quot;</span>,</span>
<span id="cb114-28"><a href="#cb114-28"></a>                           <span class="kw">str_detect</span>(Category, <span class="st">&quot;current&quot;</span>) <span class="op">~</span><span class="st"> &quot;Current&quot;</span>),</span>
<span id="cb114-29"><a href="#cb114-29"></a>      <span class="dt">Product =</span> <span class="kw">case_when</span>(<span class="kw">str_detect</span>(Category, <span class="st">&quot;non_ecig&quot;</span>) <span class="op">~</span><span class="st"> &quot;Other products&quot;</span>,</span>
<span id="cb114-30"><a href="#cb114-30"></a>                           <span class="kw">str_detect</span>(Category, <span class="st">&quot;tobacco&quot;</span>) <span class="op">~</span><span class="st"> &quot;Any tobacco product&quot;</span>,</span>
<span id="cb114-31"><a href="#cb114-31"></a>                                                      <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;E-cigarettes&quot;</span>)) <span class="op">%&gt;%</span></span>
<span id="cb114-32"><a href="#cb114-32"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>Category) <span class="op">%&gt;%</span></span>
<span id="cb114-33"><a href="#cb114-33"></a><span class="st">  </span><span class="kw">pivot_wider</span>(<span class="dt">names_from =</span> Estimate,</span>
<span id="cb114-34"><a href="#cb114-34"></a>              <span class="dt">values_from =</span> <span class="st">`</span><span class="dt">Percentage of students</span><span class="st">`</span>)}</span>
<span id="cb114-35"><a href="#cb114-35"></a></span>
<span id="cb114-36"><a href="#cb114-36"></a></span>
<span id="cb114-37"><a href="#cb114-37"></a>Cohort_data &lt;-<span class="st"> </span>nyts_data <span class="op">%&gt;%</span></span>
<span id="cb114-38"><a href="#cb114-38"></a><span class="st">  </span><span class="kw">filter</span>((Grade <span class="op">==</span><span class="st"> &quot;8&quot;</span> <span class="op">&amp;</span><span class="st"> </span>year <span class="op">==</span><span class="st"> </span><span class="dv">2015</span>) <span class="op">|</span></span>
<span id="cb114-39"><a href="#cb114-39"></a><span class="st">         </span>(Grade <span class="op">==</span><span class="st"> &quot;9&quot;</span> <span class="op">&amp;</span><span class="st"> </span>year <span class="op">==</span><span class="st"> </span><span class="dv">2016</span>) <span class="op">|</span></span>
<span id="cb114-40"><a href="#cb114-40"></a><span class="st">         </span>(Grade <span class="op">==</span><span class="st"> &quot;10&quot;</span> <span class="op">&amp;</span><span class="st"> </span>year <span class="op">==</span><span class="st"> </span><span class="dv">2017</span>) <span class="op">|</span></span>
<span id="cb114-41"><a href="#cb114-41"></a><span class="st">         </span>(Grade <span class="op">==</span><span class="st"> &quot;11&quot;</span> <span class="op">&amp;</span><span class="st"> </span>year <span class="op">==</span><span class="st"> </span><span class="dv">2018</span>) <span class="op">|</span></span>
<span id="cb114-42"><a href="#cb114-42"></a><span class="st">         </span>(Grade <span class="op">==</span><span class="st"> &quot;12&quot;</span> <span class="op">&amp;</span><span class="st"> </span>year <span class="op">==</span><span class="st"> </span><span class="dv">2019</span>)</span>
<span id="cb114-43"><a href="#cb114-43"></a>         ) <span class="op">%&gt;%</span></span>
<span id="cb114-44"><a href="#cb114-44"></a><span class="st">  </span><span class="kw">group_by</span>(year) <span class="op">%&gt;%</span></span>
<span id="cb114-45"><a href="#cb114-45"></a><span class="st">  </span><span class="kw">group_modify</span>(<span class="op">~</span><span class="st"> </span><span class="kw">surveyMeanCohort</span>(.x))</span>
<span id="cb114-46"><a href="#cb114-46"></a></span>
<span id="cb114-47"><a href="#cb114-47"></a><span class="kw">head</span>(Cohort_data)</span></code></pre></div>
<pre><code># A tibble: 6 x 6
# Groups:   year [1]
   year User    Product              Mean Lower Upper
  &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;               &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1  2015 Ever    E-cigarettes        20.1  17.0  23.1 
2  2015 Current E-cigarettes         8.12  6.74  9.50
3  2015 Ever    Other products      20.7  17.7  23.7 
4  2015 Current Other products       7.06  5.63  8.49
5  2015 Ever    Any tobacco product 26.9  23.3  30.4 
6  2015 Current Any tobacco product 10.9   9.13 12.6 </code></pre>
<p>We will now make similar plots to those above for this subset of the data:</p>
<div class="sourceCode" id="section-cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1"></a>plotA_w_<span class="dv">8</span> &lt;-<span class="st"> </span>Cohort_data <span class="op">%&gt;%</span></span>
<span id="cb116-2"><a href="#cb116-2"></a><span class="st">  </span><span class="kw">filter</span>(Product <span class="op">==</span><span class="st"> &quot;Any tobacco product&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb116-3"><a href="#cb116-3"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> year, <span class="dt">y =</span> Mean)) <span class="op">+</span></span>
<span id="cb116-4"><a href="#cb116-4"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">linetype =</span> User)) <span class="op">+</span></span>
<span id="cb116-5"><a href="#cb116-5"></a><span class="st">  </span><span class="kw">geom_linerange</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> Lower, <span class="dt">ymax =</span> Upper), <span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb116-6"><a href="#cb116-6"></a><span class="st">  </span><span class="kw">scale_linetype_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">1</span>)) <span class="op">+</span></span>
<span id="cb116-7"><a href="#cb116-7"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">70</span>, <span class="dt">by =</span> <span class="dv">10</span>),</span>
<span id="cb116-8"><a href="#cb116-8"></a>                     <span class="dt">labels =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">70</span>, <span class="dt">by =</span> <span class="dv">10</span>),</span>
<span id="cb116-9"><a href="#cb116-9"></a>                     <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">70</span>)) <span class="op">+</span></span>
<span id="cb116-10"><a href="#cb116-10"></a><span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> v_colors) <span class="op">+</span></span>
<span id="cb116-11"><a href="#cb116-11"></a><span class="st">  </span><span class="kw">theme_linedraw</span>() <span class="op">+</span></span>
<span id="cb116-12"><a href="#cb116-12"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb116-13"><a href="#cb116-13"></a>        <span class="dt">axis.title.x =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></span>
<span id="cb116-14"><a href="#cb116-14"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Tobacco product use became increasingly prevalent&quot;</span>,</span>
<span id="cb116-15"><a href="#cb116-15"></a>       <span class="dt">y =</span> <span class="st">&quot;% of students&quot;</span>)</span>
<span id="cb116-16"><a href="#cb116-16"></a></span>
<span id="cb116-17"><a href="#cb116-17"></a>plotB_w_<span class="dv">8</span> &lt;-<span class="st"> </span>Cohort_data <span class="op">%&gt;%</span></span>
<span id="cb116-18"><a href="#cb116-18"></a><span class="st">  </span><span class="kw">filter</span>(Product <span class="op">!=</span><span class="st"> &quot;Any tobacco product&quot;</span>, User <span class="op">==</span><span class="st"> &quot;Ever&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb116-19"><a href="#cb116-19"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> year, <span class="dt">y =</span> Mean, <span class="dt">color =</span> Product)) <span class="op">+</span></span>
<span id="cb116-20"><a href="#cb116-20"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">linetype =</span> <span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb116-21"><a href="#cb116-21"></a><span class="st">  </span><span class="kw">geom_linerange</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> Lower, <span class="dt">ymax =</span> Upper), <span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb116-22"><a href="#cb116-22"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">10</span>, <span class="dv">60</span>, <span class="dt">by =</span> <span class="dv">10</span>), <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">60</span>)) <span class="op">+</span></span>
<span id="cb116-23"><a href="#cb116-23"></a><span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> v_colors) <span class="op">+</span></span>
<span id="cb116-24"><a href="#cb116-24"></a><span class="st">  </span><span class="kw">theme_linedraw</span>() <span class="op">+</span></span>
<span id="cb116-25"><a href="#cb116-25"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb116-26"><a href="#cb116-26"></a>        <span class="dt">axis.title.x =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></span>
<span id="cb116-27"><a href="#cb116-27"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;% ever trying tobacco products increases&quot;</span>,</span>
<span id="cb116-28"><a href="#cb116-28"></a>       <span class="dt">y =</span> <span class="st">&quot;% of students&quot;</span>)</span>
<span id="cb116-29"><a href="#cb116-29"></a></span>
<span id="cb116-30"><a href="#cb116-30"></a>plotC_w_<span class="dv">8</span> &lt;-<span class="st"> </span>Cohort_data <span class="op">%&gt;%</span></span>
<span id="cb116-31"><a href="#cb116-31"></a><span class="st">  </span><span class="kw">filter</span>(Product <span class="op">!=</span><span class="st"> &quot;Any tobacco product&quot;</span>, User <span class="op">==</span><span class="st"> &quot;Current&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb116-32"><a href="#cb116-32"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> year, <span class="dt">y =</span> Mean, <span class="dt">color =</span> Product)) <span class="op">+</span></span>
<span id="cb116-33"><a href="#cb116-33"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">linetype =</span> User)) <span class="op">+</span></span>
<span id="cb116-34"><a href="#cb116-34"></a><span class="st">  </span><span class="kw">geom_linerange</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> Lower, <span class="dt">ymax =</span> Upper), <span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb116-35"><a href="#cb116-35"></a><span class="st">  </span><span class="kw">scale_linetype_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">1</span>)) <span class="op">+</span></span>
<span id="cb116-36"><a href="#cb116-36"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">60</span>, <span class="dt">by =</span> <span class="dv">10</span>), <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">60</span>)) <span class="op">+</span></span>
<span id="cb116-37"><a href="#cb116-37"></a><span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> v_colors) <span class="op">+</span></span>
<span id="cb116-38"><a href="#cb116-38"></a><span class="st">  </span><span class="kw">theme_linedraw</span>() <span class="op">+</span></span>
<span id="cb116-39"><a href="#cb116-39"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb116-40"><a href="#cb116-40"></a>        <span class="dt">axis.title.x =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></span>
<span id="cb116-41"><a href="#cb116-41"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;E-cigarette use surpasses use of other products&quot;</span>,</span>
<span id="cb116-42"><a href="#cb116-42"></a>       <span class="dt">y =</span> <span class="st">&quot;% of students&quot;</span>)</span>
<span id="cb116-43"><a href="#cb116-43"></a></span>
<span id="cb116-44"><a href="#cb116-44"></a>title_w_<span class="dv">8</span> &lt;-<span class="st"> </span><span class="kw">ggdraw</span>() <span class="op">+</span></span>
<span id="cb116-45"><a href="#cb116-45"></a><span class="st">  </span><span class="kw">draw_label</span>(</span>
<span id="cb116-46"><a href="#cb116-46"></a>  <span class="kw">expression</span>(<span class="st">&quot;For students in the 2019 graduating class, how are vaping and tobacco use related?&quot;</span>),</span>
<span id="cb116-47"><a href="#cb116-47"></a>    <span class="dt">fontface =</span> <span class="st">&#39;bold&#39;</span>,</span>
<span id="cb116-48"><a href="#cb116-48"></a>    <span class="dt">size =</span> <span class="dv">14</span>,</span>
<span id="cb116-49"><a href="#cb116-49"></a>    <span class="dt">x =</span> <span class="dv">0</span>,</span>
<span id="cb116-50"><a href="#cb116-50"></a>    <span class="dt">hjust =</span> <span class="dv">0</span></span>
<span id="cb116-51"><a href="#cb116-51"></a>  ) <span class="op">+</span></span>
<span id="cb116-52"><a href="#cb116-52"></a><span class="st">  </span><span class="kw">theme</span>(</span>
<span id="cb116-53"><a href="#cb116-53"></a>    <span class="dt">plot.margin =</span> <span class="kw">margin</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb116-54"><a href="#cb116-54"></a>  )</span>
<span id="cb116-55"><a href="#cb116-55"></a></span>
<span id="cb116-56"><a href="#cb116-56"></a>plotsA_w_<span class="dv">8</span> &lt;-<span class="st"> </span><span class="kw">plot_grid</span>(plotA_w_<span class="dv">8</span>,</span>
<span id="cb116-57"><a href="#cb116-57"></a>                        <span class="dt">rel_widths =</span> <span class="kw">c</span>(<span class="dv">1</span>),</span>
<span id="cb116-58"><a href="#cb116-58"></a>                        <span class="dt">align =</span> <span class="st">&quot;v&quot;</span>,</span>
<span id="cb116-59"><a href="#cb116-59"></a>                        <span class="dt">axis =</span> <span class="st">&quot;bt&quot;</span>)</span>
<span id="cb116-60"><a href="#cb116-60"></a></span>
<span id="cb116-61"><a href="#cb116-61"></a>plotsBC_w_<span class="dv">8</span> &lt;-<span class="st"> </span><span class="kw">plot_grid</span>(plotB_w_<span class="dv">8</span>,</span>
<span id="cb116-62"><a href="#cb116-62"></a>                         plotC_w_<span class="dv">8</span>,</span>
<span id="cb116-63"><a href="#cb116-63"></a>                         <span class="dt">rel_widths =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb116-64"><a href="#cb116-64"></a>                         <span class="dt">axis =</span> <span class="st">&quot;bt&quot;</span>)</span>
<span id="cb116-65"><a href="#cb116-65"></a></span>
<span id="cb116-66"><a href="#cb116-66"></a>legend_w_<span class="dv">8</span> &lt;-<span class="st"> </span><span class="kw">get_legend</span>(plot1c <span class="op">+</span></span>
<span id="cb116-67"><a href="#cb116-67"></a><span class="st">                       </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb116-68"><a href="#cb116-68"></a>                             <span class="dt">legend.direction =</span> <span class="st">&quot;horizontal&quot;</span>))</span>
<span id="cb116-69"><a href="#cb116-69"></a></span>
<span id="cb116-70"><a href="#cb116-70"></a>figure_w_<span class="dv">8</span> &lt;-<span class="st"> </span><span class="kw">plot_grid</span>(title_w_<span class="dv">8</span>,</span>
<span id="cb116-71"><a href="#cb116-71"></a>                        plotsA_w_<span class="dv">8</span>,</span>
<span id="cb116-72"><a href="#cb116-72"></a>                        plotsBC_w_<span class="dv">8</span>,</span>
<span id="cb116-73"><a href="#cb116-73"></a>                        legend_w_<span class="dv">8</span>,</span>
<span id="cb116-74"><a href="#cb116-74"></a>                        <span class="dt">ncol =</span> <span class="dv">1</span>,</span>
<span id="cb116-75"><a href="#cb116-75"></a>                        <span class="dt">rel_heights =</span> <span class="kw">c</span>(<span class="fl">0.1</span>,</span>
<span id="cb116-76"><a href="#cb116-76"></a>                                      <span class="dv">1</span>,</span>
<span id="cb116-77"><a href="#cb116-77"></a>                                      <span class="dv">1</span>,</span>
<span id="cb116-78"><a href="#cb116-78"></a>                                      <span class="fl">0.1</span>),</span>
<span id="cb116-79"><a href="#cb116-79"></a>                        <span class="dt">scale =</span> <span class="fl">1.0</span></span>
<span id="cb116-80"><a href="#cb116-80"></a>)</span>
<span id="cb116-81"><a href="#cb116-81"></a></span>
<span id="cb116-82"><a href="#cb116-82"></a>figure_w_<span class="dv">8</span></span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-87-1.png" width="90%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="section-data-analysis" class="section level2">
<h2><strong>Data Analysis</strong></h2>
<hr />
<p>As an extension, we will include some material here on <a href="https://en.wikipedia.org/wiki/Logistic_regression" target="_blank">logistic regression</a> and survey-weighted logistic regression that would be appropriate for answering Question 2 (“How does e-cigarette use compare between males and females?”) for a single year using statistical inference, rather than just data visualizations.</p>
<p>We can look at the final figure in the section on Question 2 and see that among both current and ever users of e-cigarettes, a higher percentage of males than females use or have used e-cigarettes.’</p>
<p><img src="www/img/plot2.png" width="800 px" style="display: block; margin: auto;" /></p>
<p>But what if we wanted to quantify this effect and assess whether this difference can be considered statistically significant? This is where the tool of logistic regression can come in handy.</p>
<div id="section-logistic-regression-motivation" class="section level3">
<h3><strong>Logistic regression motivation</strong></h3>
<hr />
<p>Here, we will approach the topic of <a href="https://en.wikipedia.org/wiki/Logistic_regression" target="_blank">logistic regression</a> assuming some prior knowledge of simple and multiple linear regression. These have been covered in <a href="https://opencasestudies.github.io/ocs-bp-diet/">another case study</a>.</p>
<p>As a brief reminder, a <a href="https://en.wikipedia.org/wiki/Linear_regression" target="_blank">linear regression model</a> allows us to estimate the relationship between an outcome variable, call it <span class="math inline">\(Y\)</span>, and a set of one or more input variables, <span class="math inline">\(X_1, X_2, ..., X_n\)</span>. We can write a simple linear regression model as:</p>
<p><span class="math display">\[ E(Y) = \beta_0 + \beta_1 X_1\]</span></p>
<p>where the <span class="math inline">\(E(Y)\)</span> means the expected value of <span class="math inline">\(Y\)</span>, i.e., our model gives us an estimate of the mean value of <span class="math inline">\(Y\)</span> given a particular input <span class="math inline">\(X_1\)</span>. Here, <span class="math inline">\(\beta_1\)</span> quantifies the expected difference in <span class="math inline">\(Y\)</span> comparing two individuals who are one unit apart in <span class="math inline">\(X_1\)</span>.</p>
<p>Similarly, we can include more than one predictor so that our equation might look like:</p>
<p><span class="math display">\[ E(Y) = \beta_0 + \beta_1 X_1 + \beta_2 X_2\]</span></p>
<p>Here, <span class="math inline">\(\beta_1\)</span> quantifies the expected difference in <span class="math inline">\(Y\)</span> comparing two individuals who are one unit apart in <span class="math inline">\(X_1\)</span>, holding <span class="math inline">\(X_2\)</span> at a fixed value. This material is covered in more detail <a href="https://rafalab.github.io/dsbook/linear-models.html#linear-regression-in-the-tidyverse" target="_blank">elsewhere</a> and in <a href="https://opencasestudies.github.io/ocs-bp-diet/" target="_blank">another case study</a>.</p>
<p>In the case of our question of interest for this case study, however, our outcome variable is of a particular type: it is a Yes-No or <em>binary</em> outcome, since each student respondent either is or is not a current user of e-cigarettes. This means in our setting <span class="math inline">\(Y\)</span> only takes on two values: TRUE or FALSE, which we can also think of as 1 and 0. For this kind of outcome variable, we need a special kind of regression, called <em>logistic regression</em>. And instead of using a linear model to estimate <span class="math inline">\(Y\)</span> itself for a given set of input variables, we will use a linear model to estimate the <em>log odds that Y=1</em> for a given set of input variables.</p>
<p>If we define <span class="math inline">\(p=P(Y=1)=E(Y)\)</span>, the standard simple logistic regression equation can be written as:</p>
<p><span class="math display">\[logit(p)= log_e (\frac{p}{1-p})= \beta_0 + \beta_1 X\]</span></p>
<p>In our case, we would define <span class="math inline">\(p\)</span> as the probability that a student respondent is a current e-cigarette user, since <span class="math inline">\(Y\)</span> is the binary variable that is 1 when a student respondent is a current e-cigarette user and 0 if not. The value <span class="math inline">\(\frac{p}{1-p}\)</span> is called the <em>odds</em> that <span class="math inline">\(Y\)</span> is equal to 1.</p>
<p>This <em>logit</em> function is short for <em>log odds</em>.</p>
<p>While it may feel strange working with the log odds that our outcome variable is equal to 1, there are some intuitive reasons why it makes sense to do this from the point of view of fitting a line to our data and interpreting the results. The <a href="https://en.wikipedia.org/wiki/Logit" target="_blank">log odds</a> can take any value on the real number line, allowing us to estimate our model parameters with no constraints. If we instead tried to use say <span class="math inline">\(p\)</span> as the outcome variable, we would somehow need to constrain <span class="math inline">\(\beta_0 + \beta_1 X\)</span> to be between 0 and 1, since this is the only possible range of values for a <a href="https://en.wikipedia.org/wiki/Probability" target="_blank">probability</a>. A second, more technical reason is that working on the log odds scale gives us a nice formulation of our <em>likelihood</em>, i.e., a function of our unknown parameters that incorporates our observed data. We use this <a href="https://en.wikipedia.org/wiki/Likelihood_function" target="_blank">likelihood function</a> to estimate our unknown parameters (here, <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>) and this formulation gives us a nice way to calculate the <a href="https://en.wikipedia.org/wiki/Maximum_likelihood_estimation" target="_blank">maximum likelihood estimates</a> of these parameters.</p>
<p>The intuitive explanation of logistic regression then is that we are fitting a line to the log odds of <span class="math inline">\(Y\)</span>, as it varies with different values of <span class="math inline">\(X\)</span>. We will work through an example below to illustrate and hopefully clarify this.</p>
</div>
<div id="section-logistic-regression-by-hand-and-by-model" class="section level3">
<h3><strong>Logistic regression “by hand” and by model</strong></h3>
<hr />
<p>For simplicity, we will consider just the set of current users of e-cigarettes in 2015. How much more likely is a male student to be a current e-cigarette user than a female student?</p>
<p>We can get a first look at the answer by calculating the percent of females and percent of males who are current e-cigarette users or not:</p>
<div class="sourceCode" id="section-cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1"></a>nyts_data <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb117-2"><a href="#cb117-2"></a><span class="st">  </span><span class="kw">filter</span>(year <span class="op">==</span><span class="st"> </span><span class="dv">2015</span>, <span class="op">!</span><span class="kw">is.na</span>(Sex)) <span class="op">%&gt;%</span></span>
<span id="cb117-3"><a href="#cb117-3"></a><span class="st">  </span><span class="kw">group_by</span>(Sex, ecig_current) <span class="op">%&gt;%</span></span>
<span id="cb117-4"><a href="#cb117-4"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">n =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span></span>
<span id="cb117-5"><a href="#cb117-5"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">pct =</span> n <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(n))</span></code></pre></div>
<pre><code># A tibble: 4 x 4
# Groups:   Sex [2]
  Sex    ecig_current     n    pct
  &lt;fct&gt;  &lt;lgl&gt;        &lt;int&gt;  &lt;dbl&gt;
1 male   FALSE         7787 0.869 
2 male   TRUE          1171 0.131 
3 female FALSE         7850 0.910 
4 female TRUE           772 0.0895</code></pre>
<p>We can see that the percentage is lower for females than for males. Another way of organizing this data would be to make a <a href="https://en.wikipedia.org/wiki/Contingency_table" target="_blank">2x2 table</a>, a data summarization frequently used in public health settings.</p>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Male</th>
<th align="right">Female</th>
<th align="right">Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Current e-cigarette user</td>
<td align="right">1171</td>
<td align="right">772</td>
<td align="right">1943</td>
</tr>
<tr class="even">
<td align="left">Not current e-cigarette user</td>
<td align="right">7787</td>
<td align="right">7850</td>
<td align="right">15637</td>
</tr>
<tr class="odd">
<td align="left">Total</td>
<td align="right">8958</td>
<td align="right">8622</td>
<td align="right">17580</td>
</tr>
</tbody>
</table>
<p>As discussed above, one important ingredient in understanding the output of logistic regression is understanding the concept of an odds and an odds ratio. We can ask, among males who responded to the survey in 2015, what are the odds of being a current e-cigarette user? How about for females? How do these odds compare? The <a href="https://en.wikipedia.org/wiki/Odds_ratio" target="_blank">odds ratio</a> is a tool frequently used in public health to compare the odds between two groups.</p>
<p>In this case:</p>
<ul>
<li>Odds of current e-cigarette use for males: 1171 / 7787 = 0.150</li>
<li>Odds of current e-cigarette use for females: 772 / 7850 = 0.098</li>
<li>Odds ratio of e-cigarette use for females as compared to males: <span class="math display">\[OR = \frac{odds \ for \ females}{odds \ for \ males} = \frac{772 / 7850}{1171 / 7787} = 0.65\]</span></li>
<li>Log odds ratio: <span class="math inline">\(log_e(OR) = log(1.53) = -0.42\)</span></li>
</ul>
<p>We would interpret these values by saying that the odds of being a current e-cigarette user for women are around 0.65 times the odds of being a current e-cigarette user for men, or 35% lower for women. This matches what we can see in our data visualizations for Question 2.</p>
<p><img src="www/img/plot2.png" width="800 px" style="display: block; margin: auto;" /></p>
<p>We could also answer this question using logistic regression:</p>
<p><span class="math display">\[log(odds \ of \ current \ e-cigarette \ use) = \beta_0 + \beta_1 \cdot Sex\]</span></p>
<p>Here is how we would fit our logistic regression model, using the <code>glm</code> function from base R. We also use the <code>tidy</code> function from the <code>broom</code> package to create a tibble of the model output.</p>
<div class="sourceCode" id="section-cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1"></a>dat2015 &lt;-<span class="st"> </span>nyts_data <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb119-2"><a href="#cb119-2"></a><span class="st">  </span><span class="kw">filter</span>(year <span class="op">==</span><span class="st"> </span><span class="dv">2015</span>, <span class="op">!</span><span class="kw">is.na</span>(Sex))</span>
<span id="cb119-3"><a href="#cb119-3"></a></span>
<span id="cb119-4"><a href="#cb119-4"></a>currEcigSex &lt;-<span class="st"> </span><span class="kw">glm</span>(ecig_current <span class="op">~</span><span class="st"> </span>Sex, <span class="dt">data =</span> dat2015, <span class="dt">family =</span> <span class="kw">binomial</span>(<span class="dt">link =</span> <span class="st">&quot;logit&quot;</span>))</span>
<span id="cb119-5"><a href="#cb119-5"></a>currEcigSexTidy &lt;-<span class="st"> </span>broom<span class="op">::</span><span class="kw">tidy</span>(currEcigSex)</span>
<span id="cb119-6"><a href="#cb119-6"></a>currEcigSexTidy</span></code></pre></div>
<pre><code># A tibble: 2 x 5
  term        estimate std.error statistic  p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)   -1.89     0.0313    -60.4  0.      
2 Sexfemale     -0.425    0.0490     -8.66 4.73e-18</code></pre>
<p>Looking at this output, our estimated logistic regression equation is:</p>
<p><span class="math display">\[log(odds \ of \ current \ e-cigarette \ use) = \beta_0 + \beta_1 \cdot Sex = -1.89 - 0.425 \cdot (Sex == female)\]</span></p>
<p>Our <span class="math inline">\(\beta_1\)</span> parameter tells us that the log odds of being a current e-cigarette user are 0.425 lower for females compared to males, i.e., the difference in log odds of being a current e-cigarette user for females compared to males is -0.425. And we can notice that this value matches the log odds ratio that we calculated by hand from the 2x2 table above. This is because a difference in log odds is the same as a log odds ratio – remember your <a href="https://www.rapidtables.com/math/algebra/Logarithm.html#log-rules" target="_blank">rules of logs</a>!</p>
<p>We can interpret this output as follows:</p>
<ul>
<li><span class="math inline">\(-0.425 = \beta_1 = \log(OR)\)</span></li>
<li>The log odds of being a current e-cigarette user is 0.425 lower for females compared to males</li>
<li><span class="math inline">\(0.65 = e^{-0.425} = e^{\beta_1} = OR\)</span></li>
<li>The odds of being a current e-cigarette user for females is 0.65 times the odds for males.</li>
<li>The odds of being a current e-cigarette user for females is 35% lower than the odds for males.</li>
</ul>
<p>We can also look at the other columns of the model output to assess whether our data indicate that <span class="math inline">\(\beta_1\)</span> is statistically significantly different from 0. The p-value for the <code>Sex</code> variable in our model is 4.73e-18. Since this value is &lt; 0.05, we would reject the null hypothesis that <span class="math inline">\(\beta_1 = 0\)</span> based on our model output.</p>
<p>Simple logistic regression can be extended to include additional variables in the model, for example to adjust for potential confounding variables such as <code>Age</code> or <code>Grade</code>. For example, suppose we want to estimate the effect of <code>Sex</code> on current e-cigarette use, holding <code>Age</code> constant. We could fit the model:</p>
<p><span class="math display">\[log(odds \ of \ current \ e-cigarette \ use) = \beta_0 + \beta_1 \cdot Sex + \beta_2 \cdot Age\]</span></p>
<div class="sourceCode" id="section-cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1"></a>currEcigSexAge &lt;-<span class="st"> </span><span class="kw">glm</span>(ecig_current <span class="op">~</span><span class="st"> </span>Sex <span class="op">+</span><span class="st"> </span>Age, </span>
<span id="cb121-2"><a href="#cb121-2"></a>                      <span class="dt">data =</span> dat2015, </span>
<span id="cb121-3"><a href="#cb121-3"></a>                      <span class="dt">family =</span> <span class="kw">binomial</span>(<span class="dt">link =</span> <span class="st">&quot;logit&quot;</span>))</span>
<span id="cb121-4"><a href="#cb121-4"></a><span class="kw">tidy</span>(currEcigSexAge)</span></code></pre></div>
<pre><code># A tibble: 12 x 5
   term        estimate std.error statistic  p.value
   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
 1 (Intercept)  -0.0872    0.451    -0.193  8.47e- 1
 2 Sexfemale    -0.385     0.0500   -7.70   1.39e-14
 3 Age10       -12.4     162.       -0.0765 9.39e- 1
 4 Age11        -3.30      0.495    -6.67   2.52e-11
 5 Age12        -3.05      0.464    -6.56   5.49e-11
 6 Age13        -2.57      0.459    -5.59   2.22e- 8
 7 Age14        -1.96      0.456    -4.30   1.74e- 5
 8 Age15        -1.67      0.455    -3.67   2.43e- 4
 9 Age16        -1.43      0.455    -3.14   1.70e- 3
10 Age17        -1.29      0.455    -2.84   4.45e- 3
11 Age18        -1.07      0.456    -2.35   1.89e- 2
12 Age&gt;18       -0.924     0.495    -1.87   6.20e- 2</code></pre>
<p>Now our <span class="math inline">\(\beta_1\)</span> parameter tells us that the log odds of being an current e-cigarette user are 0.385 lower for females compared to males, within an age group, or holding <code>Age</code> constant.</p>
</div>
<div id="section-survey-weighted-logistic-regression" class="section level3">
<h3><strong>Survey weighted logistic regression</strong></h3>
<hr />
<p>As discussed elsewhere in this case study, our data come from a survey, where individuals were not necessarily sampled in direct proportion to their population representation, so it is necessary to incorporate survey weights into our analysis to perform inference about the population of interest. Luckily, there are implementations of survey-weighted logistic regression in R that can do this for us.</p>
<p>We first create our survey design object using the <code>as_survey_design</code> function from the <code>srvyr</code> package, and then use the <code>svyglm</code> function from the <code>survey</code> package to fit our logistic regression model.</p>
<div class="sourceCode" id="section-cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1"></a>dat2015_survey_design &lt;-<span class="st"> </span>dat2015 <span class="op">%&gt;%</span></span>
<span id="cb123-2"><a href="#cb123-2"></a><span class="st">                          </span><span class="kw">as_survey_design</span>(<span class="dt">strata =</span> stratum,</span>
<span id="cb123-3"><a href="#cb123-3"></a>                                            <span class="dt">ids =</span> psu,</span>
<span id="cb123-4"><a href="#cb123-4"></a>                                            <span class="dt">weight  =</span> finwgt,</span>
<span id="cb123-5"><a href="#cb123-5"></a>                                            <span class="dt">nest =</span> <span class="ot">TRUE</span>)</span>
<span id="cb123-6"><a href="#cb123-6"></a></span>
<span id="cb123-7"><a href="#cb123-7"></a></span>
<span id="cb123-8"><a href="#cb123-8"></a>currEcigSex_svy &lt;-<span class="st"> </span>survey<span class="op">::</span><span class="kw">svyglm</span>(ecig_current <span class="op">~</span><span class="st"> </span>Sex,</span>
<span id="cb123-9"><a href="#cb123-9"></a>                                  <span class="dt">family =</span> <span class="kw">quasibinomial</span>(<span class="dt">link =</span> <span class="st">&#39;logit&#39;</span>),</span>
<span id="cb123-10"><a href="#cb123-10"></a>                                  <span class="dt">design =</span> dat2015_survey_design)</span>
<span id="cb123-11"><a href="#cb123-11"></a><span class="kw">tidy</span>(currEcigSex_svy)</span></code></pre></div>
<pre><code># A tibble: 2 x 5
  term        estimate std.error statistic  p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)   -1.90     0.0788    -24.1  3.95e-34
2 Sexfemale     -0.383    0.0700     -5.48 7.52e- 7</code></pre>
<p>Note that in this case, we use the <a href="https://en.wikipedia.org/wiki/Quasi-likelihood" target="_blank">quasi</a>-binomial family rather than the binomial family, which allows the data to not necessarily look like a sample from a <a href="https://en.wikipedia.org/wiki/Binomial_distribution" target="_blank">binomial distribution</a>. This is because by incorporating our survey weights, it is as if each individual does not have a 0 or 1 as their outcome variable, so we get a warning if we do not use this value for family.</p>
<p>From this model output, we can see that the estimate incorporating survey weights is a little different. The interpretation is as follows:</p>
<ul>
<li><span class="math inline">\(-0.383 = \beta_1 = \log(OR)\)</span></li>
<li>The log odds of being a current e-cigarette user is 0.383 lower for females than for males, taking survey weights into account.</li>
<li><span class="math inline">\(0.68 = e^{-0.383} = e^{\beta_1} = OR\)</span></li>
<li>The odds of being a current e-cigarette user for females is 0.68 times the odds for males, taking survey weights into account.</li>
<li>The odds of being a current e-cigarette user for females is 32% lower than the odds for males, taking survey weights into account.</li>
</ul>
<p>As above, we can also fit a more complicated model with additional covariates.</p>
<div class="sourceCode" id="section-cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1"></a>currEcigSexAge_svy &lt;-<span class="st"> </span>survey<span class="op">::</span><span class="kw">svyglm</span>(ecig_current <span class="op">~</span><span class="st"> </span>Sex <span class="op">+</span><span class="st"> </span>Age,</span>
<span id="cb125-2"><a href="#cb125-2"></a>                      <span class="dt">family =</span> <span class="kw">quasibinomial</span>(<span class="dt">link =</span> <span class="st">&#39;logit&#39;</span>), </span>
<span id="cb125-3"><a href="#cb125-3"></a>                      <span class="dt">design =</span> dat2015_survey_design)</span>
<span id="cb125-4"><a href="#cb125-4"></a><span class="kw">tidy</span>(currEcigSexAge_svy)</span></code></pre></div>
<pre><code># A tibble: 12 x 5
   term        estimate std.error statistic  p.value
   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
 1 (Intercept)    0.387    0.462      0.838 4.06e- 1
 2 Sexfemale     -0.380    0.0775    -4.90  8.84e- 6
 3 Age10        -11.9      0.766    -15.5   8.83e-22
 4 Age11         -3.72     0.555     -6.71  1.13e- 8
 5 Age12         -3.66     0.515     -7.11  2.49e- 9
 6 Age13         -3.20     0.480     -6.66  1.38e- 8
 7 Age14         -2.46     0.455     -5.41  1.41e- 6
 8 Age15         -2.10     0.480     -4.37  5.47e- 5
 9 Age16         -1.89     0.490     -3.86  3.03e- 4
10 Age17         -1.75     0.490     -3.58  7.37e- 4
11 Age18         -1.57     0.469     -3.35  1.48e- 3
12 Age&gt;18        -1.49     0.534     -2.78  7.39e- 3</code></pre>
<p>In this case, we can see that our estimated difference in log odds for females compared to males, -0.380, is not much different whether we are holding <code>Age</code> constant or not.</p>
</div>
</div>
<div id="section-summary" class="section level2">
<h2><strong>Summary</strong></h2>
<hr />
<div id="section-summary-plot" class="section level3">
<h3><strong>Summary Plot</strong></h3>
<hr />
<p>Finally we will put our plots together to create a plot that describes the relationship between e-cigarette usage and overall tobacco use, combining both our first set of unweighted results, and those calculated using the <code>srvyr</code> package.</p>
<div class="sourceCode" id="section-cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1"></a>title_final &lt;-<span class="st"> </span><span class="kw">ggdraw</span>() <span class="op">+</span></span>
<span id="cb127-2"><a href="#cb127-2"></a><span class="st">  </span><span class="kw">draw_label</span>(</span>
<span id="cb127-3"><a href="#cb127-3"></a>    <span class="kw">expression</span>(<span class="st">&quot;What is the relationship between e-cigarette use and tobacco use?&quot;</span>),</span>
<span id="cb127-4"><a href="#cb127-4"></a>    <span class="dt">fontface =</span> <span class="st">&#39;bold&#39;</span>,</span>
<span id="cb127-5"><a href="#cb127-5"></a>    <span class="dt">size =</span> <span class="dv">16</span>,</span>
<span id="cb127-6"><a href="#cb127-6"></a>    <span class="dt">x =</span> <span class="fl">0.5</span>) <span class="op">+</span></span>
<span id="cb127-7"><a href="#cb127-7"></a><span class="st">  </span><span class="kw">theme</span>(</span>
<span id="cb127-8"><a href="#cb127-8"></a>    <span class="dt">plot.margin =</span> <span class="kw">margin</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb127-9"><a href="#cb127-9"></a>  )</span>
<span id="cb127-10"><a href="#cb127-10"></a></span>
<span id="cb127-11"><a href="#cb127-11"></a>subtitle_uw_final &lt;-<span class="st"> </span><span class="kw">ggdraw</span>() <span class="op">+</span></span>
<span id="cb127-12"><a href="#cb127-12"></a><span class="st">  </span><span class="kw">draw_label</span>(</span>
<span id="cb127-13"><a href="#cb127-13"></a>    <span class="kw">expression</span>(<span class="op">~</span><span class="st"> </span><span class="dv">6</span><span class="op">^</span>th <span class="op">~</span><span class="st"> &quot;-&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">12</span><span class="op">^</span>th <span class="op">~</span><span class="st"> &quot;graders, unweighted&quot;</span>),</span>
<span id="cb127-14"><a href="#cb127-14"></a>    <span class="dt">size =</span> <span class="dv">12</span>,</span>
<span id="cb127-15"><a href="#cb127-15"></a>    <span class="dt">x =</span> <span class="fl">0.5</span>) <span class="op">+</span></span>
<span id="cb127-16"><a href="#cb127-16"></a><span class="st">  </span><span class="kw">theme</span>(</span>
<span id="cb127-17"><a href="#cb127-17"></a>    <span class="dt">plot.margin =</span> <span class="kw">margin</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb127-18"><a href="#cb127-18"></a>  )</span>
<span id="cb127-19"><a href="#cb127-19"></a></span>
<span id="cb127-20"><a href="#cb127-20"></a>subtitle_w_final &lt;-<span class="st"> </span><span class="kw">ggdraw</span>() <span class="op">+</span></span>
<span id="cb127-21"><a href="#cb127-21"></a><span class="st">  </span><span class="kw">draw_label</span>(</span>
<span id="cb127-22"><a href="#cb127-22"></a>    <span class="kw">expression</span>(<span class="op">~</span><span class="st"> </span><span class="dv">6</span><span class="op">^</span>th <span class="op">~</span><span class="st"> &quot;-&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">12</span><span class="op">^</span>th <span class="op">~</span><span class="st"> &quot;graders, weighted&quot;</span>),</span>
<span id="cb127-23"><a href="#cb127-23"></a>    <span class="dt">fontface =</span> <span class="st">&#39;bold&#39;</span>,</span>
<span id="cb127-24"><a href="#cb127-24"></a>    <span class="dt">size =</span> <span class="dv">12</span>,</span>
<span id="cb127-25"><a href="#cb127-25"></a>    <span class="dt">x =</span> <span class="fl">0.5</span>) <span class="op">+</span></span>
<span id="cb127-26"><a href="#cb127-26"></a><span class="st">  </span><span class="kw">theme</span>(</span>
<span id="cb127-27"><a href="#cb127-27"></a>    <span class="dt">plot.margin =</span> <span class="kw">margin</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb127-28"><a href="#cb127-28"></a>  )</span>
<span id="cb127-29"><a href="#cb127-29"></a></span>
<span id="cb127-30"><a href="#cb127-30"></a>subtitle_w_<span class="dv">8</span>_final &lt;-<span class="st"> </span><span class="kw">ggdraw</span>() <span class="op">+</span></span>
<span id="cb127-31"><a href="#cb127-31"></a><span class="st">  </span><span class="kw">draw_label</span>(</span>
<span id="cb127-32"><a href="#cb127-32"></a>    <span class="kw">expression</span>(<span class="st">&quot;Approximate graduating </span><span class="ch">\n</span><span class="st"> class of 2019, weighted&quot;</span>),</span>
<span id="cb127-33"><a href="#cb127-33"></a>    <span class="dt">fontface =</span> <span class="st">&#39;bold&#39;</span>,</span>
<span id="cb127-34"><a href="#cb127-34"></a>    <span class="dt">size =</span> <span class="dv">12</span>,</span>
<span id="cb127-35"><a href="#cb127-35"></a>    <span class="dt">x =</span> <span class="fl">0.5</span>) <span class="op">+</span></span>
<span id="cb127-36"><a href="#cb127-36"></a><span class="st">  </span><span class="kw">theme</span>(</span>
<span id="cb127-37"><a href="#cb127-37"></a>    <span class="dt">plot.margin =</span> <span class="kw">margin</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb127-38"><a href="#cb127-38"></a>  )</span>
<span id="cb127-39"><a href="#cb127-39"></a></span>
<span id="cb127-40"><a href="#cb127-40"></a>subtitle_final &lt;-<span class="st"> </span><span class="kw">plot_grid</span>(subtitle_uw_final,</span>
<span id="cb127-41"><a href="#cb127-41"></a>                            subtitle_w_final,</span>
<span id="cb127-42"><a href="#cb127-42"></a>                            subtitle_w_<span class="dv">8</span>_final,</span>
<span id="cb127-43"><a href="#cb127-43"></a>                            <span class="dt">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb127-44"><a href="#cb127-44"></a></span>
<span id="cb127-45"><a href="#cb127-45"></a>plotsA_title_final &lt;-<span class="st"> </span><span class="kw">ggdraw</span>() <span class="op">+</span></span>
<span id="cb127-46"><a href="#cb127-46"></a><span class="st">  </span><span class="kw">draw_label</span>(</span>
<span id="cb127-47"><a href="#cb127-47"></a>    <span class="kw">expression</span>(<span class="st">&quot;Prevalence of any tobacco product use by user type&quot;</span>),</span>
<span id="cb127-48"><a href="#cb127-48"></a>    <span class="dt">size =</span> <span class="dv">14</span>,</span>
<span id="cb127-49"><a href="#cb127-49"></a>    <span class="dt">x =</span> <span class="fl">0.5</span>) <span class="op">+</span></span>
<span id="cb127-50"><a href="#cb127-50"></a><span class="st">  </span><span class="kw">theme</span>(</span>
<span id="cb127-51"><a href="#cb127-51"></a>    <span class="dt">plot.margin =</span> <span class="kw">margin</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb127-52"><a href="#cb127-52"></a>  )</span>
<span id="cb127-53"><a href="#cb127-53"></a></span>
<span id="cb127-54"><a href="#cb127-54"></a>plotsA_final &lt;-<span class="st"> </span><span class="kw">plot_grid</span>(plotA_uw <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_blank</span>()),</span>
<span id="cb127-55"><a href="#cb127-55"></a>                          plotA_w <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_blank</span>()),</span>
<span id="cb127-56"><a href="#cb127-56"></a>                          plotA_w_<span class="dv">8</span> <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_blank</span>()),</span>
<span id="cb127-57"><a href="#cb127-57"></a>                          <span class="dt">ncol =</span> <span class="dv">3</span>,</span>
<span id="cb127-58"><a href="#cb127-58"></a>                          <span class="dt">align =</span> <span class="st">&quot;v&quot;</span>,</span>
<span id="cb127-59"><a href="#cb127-59"></a>                          <span class="dt">axis =</span> <span class="st">&quot;bt&quot;</span>)</span>
<span id="cb127-60"><a href="#cb127-60"></a></span>
<span id="cb127-61"><a href="#cb127-61"></a>plotsB_title_final &lt;-<span class="st"> </span><span class="kw">ggdraw</span>() <span class="op">+</span></span>
<span id="cb127-62"><a href="#cb127-62"></a><span class="st">  </span><span class="kw">draw_label</span>(</span>
<span id="cb127-63"><a href="#cb127-63"></a>    <span class="kw">expression</span>(<span class="st">&quot;Prevalence of ever trying by product type&quot;</span>),</span>
<span id="cb127-64"><a href="#cb127-64"></a>    <span class="dt">size =</span> <span class="dv">14</span>,</span>
<span id="cb127-65"><a href="#cb127-65"></a>    <span class="dt">x =</span> <span class="fl">0.5</span>) <span class="op">+</span></span>
<span id="cb127-66"><a href="#cb127-66"></a><span class="st">  </span><span class="kw">theme</span>(</span>
<span id="cb127-67"><a href="#cb127-67"></a>    <span class="dt">plot.margin =</span> <span class="kw">margin</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb127-68"><a href="#cb127-68"></a>  )</span>
<span id="cb127-69"><a href="#cb127-69"></a></span>
<span id="cb127-70"><a href="#cb127-70"></a>plotsB_final &lt;-<span class="st"> </span><span class="kw">plot_grid</span>(plotB_uw <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_blank</span>()),</span>
<span id="cb127-71"><a href="#cb127-71"></a>                          plotB_w <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_blank</span>()),</span>
<span id="cb127-72"><a href="#cb127-72"></a>                          plotB_w_<span class="dv">8</span> <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_blank</span>()),</span>
<span id="cb127-73"><a href="#cb127-73"></a>                          <span class="dt">ncol =</span> <span class="dv">3</span>,</span>
<span id="cb127-74"><a href="#cb127-74"></a>                          <span class="dt">align =</span> <span class="st">&quot;v&quot;</span>,</span>
<span id="cb127-75"><a href="#cb127-75"></a>                          <span class="dt">axis =</span> <span class="st">&quot;bt&quot;</span>)</span>
<span id="cb127-76"><a href="#cb127-76"></a></span>
<span id="cb127-77"><a href="#cb127-77"></a>plotsC_title_final &lt;-<span class="st"> </span><span class="kw">ggdraw</span>() <span class="op">+</span></span>
<span id="cb127-78"><a href="#cb127-78"></a><span class="st">  </span><span class="kw">draw_label</span>(</span>
<span id="cb127-79"><a href="#cb127-79"></a>    <span class="kw">expression</span>(<span class="st">&quot;Prevalence of current use by product type&quot;</span>),</span>
<span id="cb127-80"><a href="#cb127-80"></a>    <span class="dt">size =</span> <span class="dv">14</span>,</span>
<span id="cb127-81"><a href="#cb127-81"></a>    <span class="dt">x =</span> <span class="fl">0.5</span>) <span class="op">+</span></span>
<span id="cb127-82"><a href="#cb127-82"></a><span class="st">  </span><span class="kw">theme</span>(</span>
<span id="cb127-83"><a href="#cb127-83"></a>    <span class="dt">plot.margin =</span> <span class="kw">margin</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb127-84"><a href="#cb127-84"></a>  )</span>
<span id="cb127-85"><a href="#cb127-85"></a></span>
<span id="cb127-86"><a href="#cb127-86"></a>plotsC_final &lt;-<span class="st"> </span><span class="kw">plot_grid</span>(plotC_uw <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_blank</span>()),</span>
<span id="cb127-87"><a href="#cb127-87"></a>                          plotC_w <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_blank</span>()),</span>
<span id="cb127-88"><a href="#cb127-88"></a>                          plotC_w_<span class="dv">8</span> <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_blank</span>()),</span>
<span id="cb127-89"><a href="#cb127-89"></a>                          <span class="dt">ncol =</span> <span class="dv">3</span>,</span>
<span id="cb127-90"><a href="#cb127-90"></a>                          <span class="dt">align =</span> <span class="st">&quot;v&quot;</span>,</span>
<span id="cb127-91"><a href="#cb127-91"></a>                          <span class="dt">axis =</span> <span class="st">&quot;bt&quot;</span>)</span>
<span id="cb127-92"><a href="#cb127-92"></a></span>
<span id="cb127-93"><a href="#cb127-93"></a>legend_final &lt;-<span class="st"> </span><span class="kw">get_legend</span>(plot1c <span class="op">+</span></span>
<span id="cb127-94"><a href="#cb127-94"></a><span class="st">                             </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb127-95"><a href="#cb127-95"></a>                                   <span class="dt">legend.direction =</span> <span class="st">&quot;horizontal&quot;</span>))</span>
<span id="cb127-96"><a href="#cb127-96"></a></span>
<span id="cb127-97"><a href="#cb127-97"></a>final_plot &lt;-<span class="st"> </span><span class="kw">plot_grid</span>(title_final,</span>
<span id="cb127-98"><a href="#cb127-98"></a>          plotsA_title_final,</span>
<span id="cb127-99"><a href="#cb127-99"></a>          subtitle_final,</span>
<span id="cb127-100"><a href="#cb127-100"></a>          plotsA_final,</span>
<span id="cb127-101"><a href="#cb127-101"></a>          plotsB_title_final,</span>
<span id="cb127-102"><a href="#cb127-102"></a>          subtitle_final,</span>
<span id="cb127-103"><a href="#cb127-103"></a>          plotsB_final,</span>
<span id="cb127-104"><a href="#cb127-104"></a>          plotsC_title_final,</span>
<span id="cb127-105"><a href="#cb127-105"></a>          subtitle_final,</span>
<span id="cb127-106"><a href="#cb127-106"></a>          plotsC_final,</span>
<span id="cb127-107"><a href="#cb127-107"></a>          legend_final,</span>
<span id="cb127-108"><a href="#cb127-108"></a>          <span class="dt">ncol =</span> <span class="dv">1</span>,</span>
<span id="cb127-109"><a href="#cb127-109"></a>          <span class="dt">rel_heights =</span> <span class="kw">c</span>(<span class="fl">0.2</span>,</span>
<span id="cb127-110"><a href="#cb127-110"></a>                          <span class="fl">0.2</span>,</span>
<span id="cb127-111"><a href="#cb127-111"></a>                          <span class="fl">0.1</span>,</span>
<span id="cb127-112"><a href="#cb127-112"></a>                          <span class="dv">1</span>,</span>
<span id="cb127-113"><a href="#cb127-113"></a>                          <span class="fl">0.2</span>,</span>
<span id="cb127-114"><a href="#cb127-114"></a>                          <span class="fl">0.1</span>,</span>
<span id="cb127-115"><a href="#cb127-115"></a>                          <span class="dv">1</span>,</span>
<span id="cb127-116"><a href="#cb127-116"></a>                          <span class="fl">0.2</span>,</span>
<span id="cb127-117"><a href="#cb127-117"></a>                          <span class="fl">0.1</span>,</span>
<span id="cb127-118"><a href="#cb127-118"></a>                          <span class="dv">1</span>,</span>
<span id="cb127-119"><a href="#cb127-119"></a>                          <span class="fl">0.1</span>))</span>
<span id="cb127-120"><a href="#cb127-120"></a></span>
<span id="cb127-121"><a href="#cb127-121"></a>final_plot</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-96-1.png" width="90%" style="display: block; margin: auto;" /></p>
</div>
<div id="section-synopsis" class="section level3">
<h3><strong>Synopsis</strong></h3>
<hr />
<p>In this case study, we used data from the <a href="https://www.cdc.gov/tobacco/data_statistics/surveys/nyts/index.htm" target="_blank">National Youth Tobacco Survey (NYTS)</a>, an annual survey that asks students in high school and middle school (grades 6-12) about tobacco usage in the United States of America. We used data from <strong>2015-2019</strong> due to the fact that these years are the most recent that asked questions regarding e-cigarette usage.</p>
<p>We used this data to answer these questions:</p>
<ol style="list-style-type: decimal">
<li><p>How has tobacco and e-cigarette/vaping use by American youths changed since 2015?</p></li>
<li><p>How does e-cigarette use compare between males and females?</p></li>
<li><p>What vaping brands and flavors appear to be used the most frequently?<br />
We will base this on the following survey questions:<br />
&gt; “During the past 30 days, what brand of e-cigarettes did you usually use?”<br />
&gt; “What flavors of tobacco products have you used in the past 30 days?”</p></li>
<li><p>Is there a relationship between e-cigarette/vaping use and other tobacco use?</p></li>
</ol>
<p>We showed how to work with the data in the format provided (Excel), how to to use the codebooks to decide what variables to use to answer our questions and how to clean and recode the data from the survey for our visualizations and analysis. We made visualizations of our summary statistics over time, to illustrate the trends present in the data for different products and groups of student respondents.</p>
<p>In answer to our questions, we found that tobacco use has gone up slightly overall between 2015 and 2019, with little difference in rates of change comparing males to females. This slight increase is the result of a large increase in e-cigarette/vaping use, coupled with a decrease in use of other tobacco products. The most used brand of e-cigarette/vaping products is Juul, and fruit, menthol and candy/desserts/sweets are the most commonly used flavors.</p>
<p>We then introduced the statistical concept of survey weighting, illustrating how to calculate usage percentages using survey-weighted means, and compare the results in the weighted and unweighted cases. We also introduced the topic of logistic regression and we performed a survey-weighted logistic regression analysis to compare the vaping rates of male and female students.</p>
</div>
</div>
<div id="section-suggested-homework" class="section level2">
<h2><strong>Suggested Homework</strong></h2>
<hr />
<style>
div.blue { background-color:#e6f0ff; border-radius: 5px; padding: 20px;}
</style>
<div class="blue">
<ul>
<li>Calculate confidence intervals for the unweighted estimates and add the appropriate error bars to the main figures.</li>
<li>Apply survey weights to one of the figures produced in this case study in which weighted estimates were not produced. Include error bars in the updated figure.
<ul>
<li>Does the figure change after the application of survey weights?</li>
<li>If so, describe how.</li>
</ul></li>
<li>Reproduce <code>final_plot</code> above for a different cohort of your choice.</li>
<li>Focusing on a single year of data, explore demographic factors that contribute to tobacco use of some kind. Compare results of unweighted and weighted analysis (for example, using the <code>svyglm</code> function to calculate survey-weighted logistic regression estimates).</li>
</ul>
</div>
</div>
<div id="section-additional-information" class="section level2">
<h2><strong>Additional Information</strong></h2>
<hr />
<div id="section-helpful-links" class="section level3">
<h3><strong>Helpful Links</strong></h3>
<hr />
<p><a href="https://www.tidyverse.org/" target="_blank">Tidyverse</a><br />
<a href="https://r4ds.had.co.nz/functions.html" target="_blank">Writing functions</a><br />
<a href="https://www.lib.ncsu.edu/data/icpsrfaq#whatare" target="_blank">Codebooks</a><br />
<a href="https://www.bmj.com/about-bmj/resources-readers/publications/epidemiology-uninitiated/7-longitudinal-studies" target="_blank">Longitudinal studies</a><br />
<a href="https://en.wikipedia.org/wiki/Panel_data" target="_blank">Panel data</a><br />
<a href="https://en.wikipedia.org/wiki/Cross-sectional_data" target="_blank">Cross-sectional data</a><br />
<a href="http://www.applied-survey-methods.com/weight.html" target="_blank">Survey weighting</a><br />
<a href="https://en.wikipedia.org/wiki/Confidence_interval" target="_blank">Confidence intervals</a><br />
<a href="https://www.mathsisfun.com/algebra/logarithms.html" target="_blank">Introduction to Logarithms</a><br />
<a href="https://en.wikipedia.org/wiki/Logarithm" target="_blank">Logarithm</a> <a href="https://www.rapidtables.com/math/algebra/Logarithm.html#log-rules" target="_blank">Rules of logs</a> <a href="https://en.wikipedia.org/wiki/Odds_ratio" target="_blank">Odds ratio</a><br />
<a href="https://en.wikipedia.org/wiki/Logit" target="_blank">Log odds</a><br />
<a href="https://en.wikipedia.org/wiki/Contingency_table" target="_blank">2x2 table</a><br />
<a href="https://en.wikipedia.org/wiki/Probability" target="_blank">Probability</a><br />
<a href="https://en.wikipedia.org/wiki/Likelihood_function" target="_blank">Likelihood function</a><br />
<a href="https://en.wikipedia.org/wiki/Maximum_likelihood_estimation" target="_blank">Maximum likelihood estimates</a><br />
<a href="https://en.wikipedia.org/wiki/Linear_regression" target="_blank">Linear regression model</a><br />
<a href="https://en.wikipedia.org/wiki/Logistic_regression" target="_blank">Logistic regression</a><br />
<a href="https://en.wikipedia.org/wiki/Quasi-likelihood" target="_blank">Quasi-likelihood</a><br />
<a href="https://en.wikipedia.org/wiki/Binomial_distribution" target="_blank">Binomial distribution</a></p>
<p>For more information on linear regression see this <a href="https://rafalab.github.io/dsbook/linear-models.html#linear-regression-in-the-tidyverse" target="_blank">book</a> and this <a href="https://opencasestudies.github.io/ocs-bp-diet/" target="_blank">case study</a>.</p>
<p>For more information on survey designs see <a href="http://www.asasrms.org/Proceedings/y2008/Files/301835.pdf" target="_blank">here</a> and <a href="http://ocw.jhsph.edu/courses/StatMethodsForSampleSurveys/PDFs/Lecture5.pdf" target="_blank">here</a>.</p>
<p>For more information on survey analysis in R <a href="https://r-survey.r-forge.r-project.org/survey/exmample-lonely.html" target="_blank">here</a> and <a href="http://r-survey.r-forge.r-project.org/survey/html/surveyoptions.html" target="_blank">here</a>.</p>
<p>If you are interested in an info-graphic summary of the 2019 findings, and links to many more resources about this topic and dataset, see the FDA’s website <a href="https://www.fda.gov/tobacco-products/youth-and-tobacco/youth-tobacco-use-results-national-youth-tobacco-survey" target="_blank">here</a>.</p>
<p><u><strong>Packages used in this case study:</strong></u></p>
<table>
<colgroup>
<col width="43%" />
<col width="56%" />
</colgroup>
<thead>
<tr class="header">
<th>Package</th>
<th>Use in this case study</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="https://github.com/jennybc/here_here" target="_blank">here</a></td>
<td>to easily load and save data</td>
</tr>
<tr class="even">
<td><a href="https://readxl.tidyverse.org/" target="_blank">readxl</a></td>
<td>to import the data in the excel files</td>
</tr>
<tr class="odd">
<td><a href="https://cran.r-project.org/web/packages/magrittr/vignettes/magrittr.html" target="_blank">magrittr</a></td>
<td>to use the compound assignment pipe operator <code>%&lt;&gt;%</code></td>
</tr>
<tr class="even">
<td><a href="https://stringr.tidyverse.org/articles/stringr.html" target="_blank">stringr</a></td>
<td>to manipulate the character strings within the data</td>
</tr>
<tr class="odd">
<td><a href="https://purrr.tidyverse.org/" target="_blank">purrr</a></td>
<td>to import the data in all the different excel and csv files efficiently</td>
</tr>
<tr class="even">
<td><a href="https://dplyr.tidyverse.org/" target="_blank">dplyr</a></td>
<td>to arrange/filter/select/compare specific subsets of the data</td>
</tr>
<tr class="odd">
<td><a href="https://readr.tidyverse.org/" target="_blank">readr</a></td>
<td>to import the CSV file data</td>
</tr>
<tr class="even">
<td><a href="https://tidyr.tidyverse.org/" target="_blank">tidyr</a></td>
<td>to rearrange data in wide and long formats</td>
</tr>
<tr class="odd">
<td><a href="https://ggplot2.tidyverse.org/" target="_blank">ggplot2</a></td>
<td>to make visualizations with multiple layers</td>
</tr>
<tr class="even">
<td><a href="https://cran.r-project.org/web/packages/scales/scales.pdf" target="_blank">scales</a></td>
<td>to allow us to look at the colors within the viridis package</td>
</tr>
<tr class="odd">
<td><a href="https://cran.r-project.org/web/packages/viridis/vignettes/intro-to-viridis.html" target="_blank">viridis</a></td>
<td>to make plots with a color palette that is compatible with color blindness</td>
</tr>
<tr class="even">
<td><a href="https://forcats.tidyverse.org/" target="_blank">forcats</a></td>
<td>to allow for reordering of factors in plots</td>
</tr>
<tr class="odd">
<td><a href="https://cran.r-project.org/web/packages/naniar/vignettes/getting-started-w-naniar.html" target="_blank">naniar</a></td>
<td>to make a visualization of missing data</td>
</tr>
<tr class="even">
<td><a href="https://cran.r-project.org/web/packages/srvyr/srvyr.pdf" target="_blank">syrvr</a></td>
<td>to use survey weights</td>
</tr>
<tr class="odd">
<td><a href="https://cran.r-project.org/web/packages/cowplot/vignettes/introduction.html" target="_blank">cowplot</a></td>
<td>to allow plots to be combined</td>
</tr>
<tr class="even">
<td><a href="https://cran.r-project.org/web/packages/broom/vignettes/broom.html" target="_blank">broom</a></td>
<td>to create nicely formatted model output</td>
</tr>
<tr class="odd">
<td><a href="http://r-survey.r-forge.r-project.org/survey/index.html" target="_blank">survey</a></td>
<td>to fit survey-weighted logistic regression</td>
</tr>
</tbody>
</table>
</div>
<div id="section-session-info" class="section level3">
<h3><strong>Session info</strong></h3>
<hr />
<div class="sourceCode" id="section-cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1"></a><span class="kw">sessionInfo</span>()</span></code></pre></div>
<pre><code>R version 4.0.2 (2020-06-22)
Platform: x86_64-w64-mingw32/x64 (64-bit)
Running under: Windows 10 x64 (build 19041)

Matrix products: default

locale:
[1] LC_COLLATE=English_United States.1252 
[2] LC_CTYPE=English_United States.1252   
[3] LC_MONETARY=English_United States.1252
[4] LC_NUMERIC=C                          
[5] LC_TIME=English_United States.1252    

attached base packages:
[1] grid      stats     graphics  grDevices utils     datasets  methods  
[8] base     

other attached packages:
 [1] survey_4.0         survival_3.1-12    Matrix_1.2-18      broom_0.7.3       
 [5] cowplot_1.1.0      srvyr_1.0.1        naniar_0.6.0       forcats_0.5.0     
 [9] viridis_0.5.1      viridisLite_0.3.0  scales_1.1.1       ggplot2_3.3.2     
[13] tidyr_1.1.2        readr_1.3.1        dplyr_1.0.2        purrr_0.3.4       
[17] stringr_1.4.0      magrittr_2.0.1     readxl_1.3.1       here_0.1          
[21] learnr_0.10.1.9006 knitr_1.30         shiny_1.5.0       

loaded via a namespace (and not attached):
 [1] Rcpp_1.0.5        lattice_0.20-41   utf8_1.1.4        assertthat_0.2.1 
 [5] rprojroot_2.0.2   digest_0.6.27     mime_0.9          R6_2.5.0         
 [9] cellranger_1.1.0  backports_1.2.0   visdat_0.5.3      evaluate_0.14    
[13] highr_0.8         pillar_1.4.6      rlang_0.4.10      curl_4.3         
[17] checkmate_2.0.0   rmarkdown_2.6     labeling_0.4.2    splines_4.0.2    
[21] htmlwidgets_1.5.3 munsell_0.5.0     compiler_4.0.2    httpuv_1.5.4     
[25] xfun_0.19         pkgconfig_2.0.3   htmltools_0.5.0   mitools_2.4      
[29] tidyselect_1.1.0  tibble_3.0.6      gridExtra_2.3     fansi_0.4.2      
[33] crayon_1.3.4      withr_2.4.1       later_1.1.0.1     jsonlite_1.7.2   
[37] xtable_1.8-4      gtable_0.3.0      lifecycle_1.0.0   DBI_1.1.0        
[41] cli_2.2.0         stringi_1.5.3     farver_2.0.3      promises_1.1.1   
[45] ellipsis_0.3.1    generics_0.1.0    vctrs_0.3.6       tools_4.0.2      
[49] glue_1.4.2        markdown_1.1      hms_0.5.3         fastmap_1.0.1    
[53] yaml_2.2.1        colorspace_2.0-0 </code></pre>
</div>
<div id="section-acknowledgments" class="section level3">
<h3><strong>Acknowledgments</strong></h3>
<hr />
<p>We would like to acknowledge <a href="https://www.jhsph.edu/faculty/directory/profile/2848/renee-m-johnson">Renee Johnson</a> for assisting in framing the major direction of the case study and for reviewing the case study for subject matter content.</p>
<p>We would also like to acknowledge the <a href="https://americanhealth.jhu.edu/">Bloomberg American Health Initiative</a> for funding this work.</p>
<script type='text/javascript' id='clustrmaps' src='//cdn.clustrmaps.com/map_v2.js?cl=080808&w=a&t=tt&d=tygDY_TbG7XE2HVUC6Eox6Z74i2E5MUBqCA83PgJ9SY&co=ffffff&cmo=3acc3a&cmn=ff5353&ct=808080'></script>

<script type="application/shiny-prerendered" data-context="server-start">
knitr::opts_chunk$set(include = TRUE, comment = NA, echo = TRUE,
                      message = FALSE, warning = FALSE, cache = FALSE,
                      fig.align = "center", out.width = '90%')
library(knitr)
library(learnr)
library(here)
</script>
 
<script type="application/shiny-prerendered" data-context="server">
learnr:::register_http_handlers(session, metadata = NULL)
</script>
 
<script type="application/shiny-prerendered" data-context="server">
learnr:::clear_exercise_setup_chunks()
</script>
 
<script type="application/shiny-prerendered" data-context="server">
session$onSessionEnded(function() {
        learnr:::event_trigger(session, "session_stop")
      })
</script>
 
<script type="application/shiny-prerendered" data-context="server">
learnr:::store_exercise_setup_chunk("__setup__", c("knitr::opts_chunk$set(include = TRUE, comment = NA, echo = TRUE,", 
"                      message = FALSE, warning = FALSE, cache = FALSE,", 
"                      fig.align = \"center\", out.width = '90%')", 
"library(knitr)", "library(learnr)", "library(here)"), overwrite = FALSE)
</script>
 
<script type="application/shiny-prerendered" data-context="server">
learnr:::store_exercise_setup_chunk("__setup__", c("knitr::opts_chunk$set(include = TRUE, comment = NA, echo = TRUE,", 
"                      message = FALSE, warning = FALSE, cache = FALSE,", 
"                      fig.align = \"center\", out.width = '90%')", 
"library(knitr)", "library(learnr)", "library(here)"), overwrite = FALSE)
</script>
 
<script type="application/shiny-prerendered" data-context="server">
learnr:::question_prerendered_chunk(structure(list(type = "learnr_radio", label = "DEW_Quiz-1", question = structure("Suppose that we want to change value &quot;a&quot; in a column(variable) of a dataset to value &quot;b&quot; , which one of the following functions of the <code>dplyr<\u002fcode> package should be used?", html = TRUE, class = c("html", 
"character")), answers = list(structure(list(id = "lnr_ans_42bc4e8", 
    option = "`rename()`", value = "`rename()`", label = structure("<code>rename()<\u002fcode>", html = TRUE, class = c("html", 
    "character")), correct = FALSE, message = structure("<code>rename()<\u002fcode> renames a column, not a value in that column.", html = TRUE, class = c("html", 
    "character"))), class = c("tutorial_question_answer", "tutorial_quiz_answer"
)), structure(list(id = "lnr_ans_a482de5", option = "`recode()`", 
    value = "`recode()`", label = structure("<code>recode()<\u002fcode>", html = TRUE, class = c("html", 
    "character")), correct = TRUE, message = NULL), class = c("tutorial_question_answer", 
"tutorial_quiz_answer"))), button_labels = list(submit = structure("Submit Answer", html = TRUE, class = c("html", 
"character")), try_again = structure("Try Again", html = TRUE, class = c("html", 
"character"))), messages = list(correct = structure("Correct!", html = TRUE, class = c("html", 
"character")), try_again = structure("Incorrect", html = TRUE, class = c("html", 
"character")), incorrect = structure("Incorrect", html = TRUE, class = c("html", 
"character")), message = NULL, post_message = NULL), ids = list(
    answer = "DEW_Quiz-1-answer", question = "DEW_Quiz-1"), loading = structure("<strong>Loading:<\u002fstrong> \nSuppose that we want to change value &quot;a&quot; in a column(variable) of a dataset to value &quot;b&quot; , which one of the following functions of the <code>dplyr<\u002fcode> package should be used?\n<br/><br/><br/>", html = TRUE, class = c("html", 
"character")), random_answer_order = TRUE, allow_retry = TRUE, 
    seed = 1710876959.70331, options = list()), class = c("learnr_radio", 
"tutorial_question")))
</script>
 
<script type="application/shiny-prerendered" data-context="server">
learnr:::question_prerendered_chunk(structure(list(type = "learnr_checkbox", label = "DEW_Quiz-2", 
    question = structure("Which of the following can the <code>mutate()<\u002fcode> function in the <code>dplyr<\u002fcode> package do? (check all that apply)", html = TRUE, class = c("html", 
    "character")), answers = list(structure(list(id = "lnr_ans_ec65bc0", 
        option = "Select certain variables(columns) of the data.", 
        value = "Select certain variables(columns) of the data.", 
        label = structure("Select certain variables(columns) of the data.", html = TRUE, class = c("html", 
        "character")), correct = FALSE, message = structure("Selecting certain variables(columns) of the data is the function of the <code>select()<\u002fcode> function.", html = TRUE, class = c("html", 
        "character"))), class = c("tutorial_question_answer", 
    "tutorial_quiz_answer")), structure(list(id = "lnr_ans_e049b7", 
        option = "Rename a variable.", value = "Rename a variable.", 
        label = structure("Rename a variable.", html = TRUE, class = c("html", 
        "character")), correct = FALSE, message = structure("Renaming a variable is the function of the <code>rename()<\u002fcode> function.", html = TRUE, class = c("html", 
        "character"))), class = c("tutorial_question_answer", 
    "tutorial_quiz_answer")), structure(list(id = "lnr_ans_917afea", 
        option = "Create a new variable.", value = "Create a new variable.", 
        label = structure("Create a new variable.", html = TRUE, class = c("html", 
        "character")), correct = TRUE, message = NULL), class = c("tutorial_question_answer", 
    "tutorial_quiz_answer")), structure(list(id = "lnr_ans_ba7e11a", 
        option = "Modify an existing variable.", value = "Modify an existing variable.", 
        label = structure("Modify an existing variable.", html = TRUE, class = c("html", 
        "character")), correct = TRUE, message = NULL), class = c("tutorial_question_answer", 
    "tutorial_quiz_answer"))), button_labels = list(submit = structure("Submit Answer", html = TRUE, class = c("html", 
    "character")), try_again = structure("Try Again", html = TRUE, class = c("html", 
    "character"))), messages = list(correct = structure("Correct!", html = TRUE, class = c("html", 
    "character")), try_again = structure("Incorrect", html = TRUE, class = c("html", 
    "character")), incorrect = structure("Incorrect", html = TRUE, class = c("html", 
    "character")), message = NULL, post_message = NULL), ids = list(
        answer = "DEW_Quiz-2-answer", question = "DEW_Quiz-2"), 
    loading = structure("<strong>Loading:<\u002fstrong> \nWhich of the following can the <code>mutate()<\u002fcode> function in the <code>dplyr<\u002fcode> package do? (check all that apply)\n<br/><br/><br/>", html = TRUE, class = c("html", 
    "character")), random_answer_order = TRUE, allow_retry = TRUE, 
    seed = 506251451.764258, options = list()), class = c("learnr_checkbox", 
"tutorial_question")))
</script>
 
<script type="application/shiny-prerendered" data-context="server">
`tutorial-exercise-DEW_Exercise-result` <- learnr:::setup_exercise_handler(reactive(req(input$`tutorial-exercise-DEW_Exercise-code-editor`)), session)
output$`tutorial-exercise-DEW_Exercise-output` <- renderUI({
  `tutorial-exercise-DEW_Exercise-result`()
})
</script>
 
<script type="application/shiny-prerendered" data-context="server">
learnr:::store_exercise_cache("DEW_Exercise", list(setup = "set.seed(100)\nvar1 <- rnorm(5, 0, 1)\nvar2 <- rnorm(5, 0, 2)\nmean0 <- data.frame(var1, var2)\nvar1 <- rnorm(5, 5, 1)\nvar2 <- rnorm(5, 5, 2)\nmean5 <- data.frame(var1, var2)\n\nnorm_data <- list(mean0, mean5)\nnames(norm_data) <- c(\"norm with mean = 0\", \"norm with mean = 5\")", 
    chunks = list(list(label = "DEW_Exercise-setup", code = "set.seed(100)\nvar1 <- rnorm(5, 0, 1)\nvar2 <- rnorm(5, 0, 2)\nmean0 <- data.frame(var1, var2)\nvar1 <- rnorm(5, 5, 1)\nvar2 <- rnorm(5, 5, 2)\nmean5 <- data.frame(var1, var2)\n\nnorm_data <- list(mean0, mean5)\nnames(norm_data) <- c(\"norm with mean = 0\", \"norm with mean = 5\")", 
        opts = list(label = "\"DEW_Exercise-setup\""), engine = "r"), 
        list(label = "DEW_Exercise", code = "# write the function\nrename_sd <- function(){\n  \n}\n\n# apply the function\nnorm_data <- \n  \n# view results\nnorm_data", 
            opts = list(label = "\"DEW_Exercise\"", exercise = "TRUE"), 
            engine = "r")), code_check = NULL, error_check = NULL, 
    check = NULL, solution = structure(c("# write the function", 
    "rename_sd <- function(dataset) {", "  dataset %>%", "    rename(\"SD = 1\" = var1, \"SD = 2\" = var2)", 
    "}", "", "# apply the function", "norm_data <- norm_data %>%", 
    "  map(., rename_sd)", "", "# view results", "norm_data"), chunk_opts = list(
        label = "DEW_Exercise-solution")), options = list(eval = FALSE, 
        echo = TRUE, results = "markup", tidy = FALSE, tidy.opts = NULL, 
        collapse = FALSE, prompt = FALSE, comment = NA, highlight = FALSE, 
        strip.white = TRUE, size = "normalsize", background = "#F7F7F7", 
        cache = 0, cache.path = "index_cache/html/", cache.vars = NULL, 
        cache.lazy = TRUE, dependson = NULL, autodep = FALSE, 
        cache.rebuild = FALSE, fig.keep = "high", fig.show = "asis", 
        fig.align = "center", fig.path = "index_files/figure-html/", 
        dev = "png", dev.args = NULL, dpi = 600, fig.ext = "png", 
        fig.width = 10, fig.height = 8, fig.env = "figure", fig.cap = NULL, 
        fig.scap = NULL, fig.lp = "fig:", fig.subcap = NULL, 
        fig.pos = "", out.width = "90%", out.height = NULL, out.extra = NULL, 
        fig.retina = 2, external = TRUE, sanitize = FALSE, interval = 1, 
        aniopts = "controls,loop", warning = FALSE, error = FALSE, 
        message = FALSE, render = NULL, ref.label = NULL, child = NULL, 
        engine = "r", split = FALSE, include = TRUE, purl = TRUE, 
        tutorial = TRUE, label = "DEW_Exercise", exercise = TRUE, 
        code = c("# write the function", "rename_sd <- function(){", 
        "  ", "}", "", "# apply the function", "norm_data <- ", 
        "  ", "# view results", "norm_data"), out.width.px = "90%", 
        out.height.px = 2400, params.src = "DEW_Exercise, exercise = TRUE", 
        fig.num = 0, exercise.df_print = "default", exercise.checker = "NULL"), 
    engine = "r"))
</script>
 <!--html_preserve-->
<script type="application/shiny-prerendered" data-context="dependencies">
{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["jquery"]},{"type":"character","attributes":{},"value":["1.11.3"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/jquery"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquery.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.6"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["bootstrap"]},{"type":"character","attributes":{},"value":["3.3.5"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/bootstrap"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["viewport"]}},"value":[{"type":"character","attributes":{},"value":["width=device-width, initial-scale=1"]}]},{"type":"character","attributes":{},"value":["js/bootstrap.min.js","shim/html5shiv.min.js","shim/respond.min.js"]},{"type":"character","attributes":{},"value":["css/cosmo.min.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.6"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["jquery"]},{"type":"character","attributes":{},"value":["1.11.3"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/jquery"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquery.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.6"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["jqueryui"]},{"type":"character","attributes":{},"value":["1.11.4"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/jqueryui"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquery-ui.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.6"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["tocify"]},{"type":"character","attributes":{},"value":["1.9.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/tocify"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquery.tocify.js"]},{"type":"character","attributes":{},"value":["jquery.tocify.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.6"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["jquery"]},{"type":"character","attributes":{},"value":["1.11.3"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/jquery"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquery.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.6"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["navigation"]},{"type":"character","attributes":{},"value":["1.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/navigation-1.1"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tabsets.js","codefolding.js","sourceembed.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.6"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["accessible-code-block"]},{"type":"character","attributes":{},"value":["0.0.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/accessibility"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["empty-anchor.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.6"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["jquery"]},{"type":"character","attributes":{},"value":["1.11.3"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/jquery"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquery.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.6"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["font-awesome"]},{"type":"character","attributes":{},"value":["5.1.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/fontawesome"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["css/all.css","css/v4-shims.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.6"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["bootbox"]},{"type":"character","attributes":{},"value":["4.4.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/bootbox"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["bootbox.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1.9006"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["idb-keyvalue"]},{"type":"character","attributes":{},"value":["3.2.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/idb-keyval"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["idb-keyval-iife-compat.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["0.10.1.9006"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["tutorial"]},{"type":"character","attributes":{},"value":["0.10.1.9006"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/tutorial"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tutorial.js"]},{"type":"character","attributes":{},"value":["tutorial.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1.9006"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["tutorial-autocompletion"]},{"type":"character","attributes":{},"value":["0.10.1.9006"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/tutorial"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tutorial-autocompletion.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1.9006"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["tutorial-diagnostics"]},{"type":"character","attributes":{},"value":["0.10.1.9006"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/tutorial"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tutorial-diagnostics.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1.9006"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ace"]},{"type":"character","attributes":{},"value":["1.2.6"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/ace"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["ace.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1.9006"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["clipboardjs"]},{"type":"character","attributes":{},"value":["1.5.15"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/clipboardjs"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["clipboard.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1.9006"]}]}]}
</script>
<!--/html_preserve-->
<!--html_preserve-->
<script type="application/shiny-prerendered" data-context="execution_dependencies">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["packages"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["packages","version"]},"class":{"type":"character","attributes":{},"value":["data.frame"]},"row.names":{"type":"integer","attributes":{},"value":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85]}},"value":[{"type":"character","attributes":{},"value":["assertthat","backports","base","broom","cellranger","checkmate","cli","colorspace","compiler","cowplot","crayon","curl","datasets","DBI","digest","dplyr","ellipsis","evaluate","fansi","farver","fastmap","forcats","generics","ggplot2","glue","graphics","grDevices","grid","gridExtra","gtable","here","highr","hms","htmltools","htmlwidgets","httpuv","jsonlite","knitr","labeling","later","lattice","learnr","lifecycle","magrittr","markdown","Matrix","methods","mime","mitools","munsell","naniar","pillar","pkgconfig","promises","purrr","R6","Rcpp","readr","readxl","rlang","rmarkdown","rprojroot","scales","shiny","splines","srvyr","stats","stringi","stringr","survey","survival","tibble","tidyr","tidyselect","tools","utf8","utils","vctrs","viridis","viridisLite","visdat","withr","xfun","xtable","yaml"]},{"type":"character","attributes":{},"value":["0.2.1","1.2.0","4.0.2","0.7.3","1.1.0","2.0.0","2.2.0","2.0-0","4.0.2","1.1.0","1.3.4","4.3","4.0.2","1.1.0","0.6.27","1.0.2","0.3.1","0.14","0.4.2","2.0.3","1.0.1","0.5.0","0.1.0","3.3.2","1.4.2","4.0.2","4.0.2","4.0.2","2.3","0.3.0","0.1","0.8","0.5.3","0.5.0","1.5.3","1.5.4","1.7.2","1.30","0.4.2","1.1.0.1","0.20-41","0.10.1.9006","1.0.0","2.0.1","1.1","1.2-18","4.0.2","0.9","2.4","0.5.0","0.6.0","1.4.6","2.0.3","1.1.1","0.3.4","2.5.0","1.0.5","1.3.1","1.3.1","0.4.10","2.6","2.0.2","1.1.1","1.5.0","4.0.2","1.0.1","4.0.2","1.5.3","1.4.0","4.0","3.1-12","3.0.6","1.1.2","1.1.0","4.0.2","1.1.4","4.0.2","0.3.6","0.5.1","0.3.0","0.5.3","2.4.1","0.19","1.8-4","2.2.1"]}]}]}
</script>
<!--/html_preserve-->
</div>
</div>

<div id="rmd-source-code">LS0tDQp0aXRsZTogfA0KICAhW10oaHR0cHM6Ly9vcGVuY2FzZXN0dWRpZXMuZ2l0aHViLmlvL2ltZy9pY29uLWJhaGkucG5nKXt3aWR0aD0xNDBweCBhbGlnbj1sZWZ0fSAgIA0KICBWYXBpbmcgQmVoYXZpb3JzIGluIEFtZXJpY2FuIFlvdXRoDQpjc3M6IHd3dy9zdHlsZS5jc3MNCm91dHB1dDoNCiAgaHRtbF9kb2N1bWVudDoNCiAgICBpbmNsdWRlczoNCiAgICAgIGluX2hlYWRlcjogR0FfU2NyaXB0LlJodG1sDQogICAgc2VsZl9jb250YWluZWQ6IHllcw0KICAgIGNvZGVfZG93bmxvYWQ6IHllcw0KICAgIGhpZ2hsaWdodDogdGFuZ28NCiAgICBudW1iZXJfc2VjdGlvbnM6IG5vDQogICAgdGhlbWU6IGNvc21vDQogICAgdG9jOiB5ZXMNCiAgICB0b2NfZmxvYXQ6IHllcw0KICBwZGZfZG9jdW1lbnQ6DQogICAgdG9jOiB5ZXMNCiAgd29yZF9kb2N1bWVudDoNCiAgICB0b2M6IHllcw0KcnVudGltZTogc2hpbnlfcHJlcmVuZGVyZWQNCi0tLQ0KDQoNCmBgYHtyLCBlY2hvPUZBTFNFfQ0Ka25pdF90aW1lX3N0YXJ0IDwtIFN5cy50aW1lKCkNCmBgYA0KDQpgYGB7ciwgZWNobz1GQUxTRX0NCmtuaXRyOjpvcHRzX2NodW5rJHNldChmaWcud2lkdGggPSAxMCwgZmlnLmhlaWdodCA9IDgsIGRwaSA9IDMwMCkNCmBgYA0KDQpgYGB7ciBzZXR1cCwgaW5jbHVkZT1GQUxTRX0NCmtuaXRyOjpvcHRzX2NodW5rJHNldChpbmNsdWRlID0gVFJVRSwgY29tbWVudCA9IE5BLCBlY2hvID0gVFJVRSwNCiAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlID0gRkFMU0UsIHdhcm5pbmcgPSBGQUxTRSwgY2FjaGUgPSBGQUxTRSwNCiAgICAgICAgICAgICAgICAgICAgICBmaWcuYWxpZ24gPSAiY2VudGVyIiwgb3V0LndpZHRoID0gJzkwJScpDQpsaWJyYXJ5KGtuaXRyKQ0KbGlicmFyeShsZWFybnIpDQpsaWJyYXJ5KGhlcmUpDQpgYGANCg0KPHA+Jm5ic3A7PC9wPg0KDQojIyMjIHsub3V0bGluZSB9DQoNCmBgYHtyLCBlY2hvID0gRkFMU0UsIG91dC53aWR0aCA9ICI4MDAgcHgifQ0Ka25pdHI6OmluY2x1ZGVfZ3JhcGhpY3MoInd3dy9pbWcvZmluYWxfcGxvdC5wbmciKQ0KYGBgDQoNCiMjIyMNCg0KDQoNCg0KIyMjIyB7LmRpc2NsYWltZXJfYmxvY2t9DQoNCg0KKipEaXNjbGFpbWVyKio6IFRoZSBwdXJwb3NlIG9mIHRoZSBbT3BlbiBDYXNlIFN0dWRpZXNdKGh0dHBzOi8vb3BlbmNhc2VzdHVkaWVzLmdpdGh1Yi5pbyl7dGFyZ2V0PSJfYmxhbmsifSBwcm9qZWN0IGlzICoqdG8gZGVtb25zdHJhdGUgdGhlIHVzZSBvZiB2YXJpb3VzIGRhdGEgc2NpZW5jZSBtZXRob2RzLCB0b29scywgYW5kIHNvZnR3YXJlIGluIHRoZSBjb250ZXh0IG9mIG1lc3N5LCByZWFsLXdvcmxkIGRhdGEqKi4gQSBnaXZlbiBjYXNlIHN0dWR5IGRvZXMgbm90IGNvdmVyIGFsbCBhc3BlY3RzIG9mIHRoZSByZXNlYXJjaCBwcm9jZXNzLCBpcyBub3QgY2xhaW1pbmcgdG8gYmUgdGhlIG1vc3QgYXBwcm9wcmlhdGUgd2F5IHRvIGFuYWx5emUgYSBnaXZlbiBkYXRhIHNldCwgYW5kIHNob3VsZCBub3QgYmUgdXNlZCBpbiB0aGUgY29udGV4dCBvZiBtYWtpbmcgcG9saWN5IGRlY2lzaW9ucyB3aXRob3V0IGV4dGVybmFsIGNvbnN1bHRhdGlvbiBmcm9tIHNjaWVudGlmaWMgZXhwZXJ0cy4gDQoNCiMjIyMNCg0KDQojIyMjIHsubGljZW5zZV9ibG9ja30NCg0KVGhpcyB3b3JrIGlzIGxpY2Vuc2VkIHVuZGVyIHRoZSBDcmVhdGl2ZSBDb21tb25zIEF0dHJpYnV0aW9uLU5vbkNvbW1lcmNpYWwgMy4wIFsoQ0MgQlktTkMgMy4wKV0oaHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLzMuMC91cy8pe3RhcmdldD0iX2JsYW5rIn0gIFVuaXRlZCBTdGF0ZXMgTGljZW5zZS4NCg0KIyMjIyANCg0KIyMjIyB7LnJlZmVyZW5jZV9ibG9ja30NCg0KVG8gY2l0ZSB0aGlzIGNhc2Ugc3R1ZHkgcGxlYXNlIHVzZToNCg0KV3JpZ2h0LCBDYXJyaWUgYW5kIE9udGl2ZXJvcywgTWljaGFlbCBhbmQgSmFnZXIsIExlYWggYW5kIFRhdWIsIE1hcmdhcmV0IGFuZCBIaWNrcywgU3RlcGhhbmllLiAoMjAyMCkuIGh0dHBzOi8vZ2l0aHViLmNvbS9vcGVuY2FzZXN0dWRpZXMvb2NzLWJwLXZhcGluZy1jYXNlLXN0dWR5LiBWYXBpbmcgQmVoYXZpb3JzIGluIEFtZXJpY2FuIFlvdXRoIChWZXJzaW9uIHYxLjAuMCkuDQoNCiMjIyMNCg0KVG8gYWNjZXNzIHRoZSBHaXRIdWIgUmVwb3NpdG9yeSBmb3IgdGhpcyBjYXNlIHN0dWR5IHNlZSBoZXJlOiBodHRwczovL2dpdGh1Yi5jb20vb3BlbmNhc2VzdHVkaWVzL29jcy1icC12YXBpbmctY2FzZS1zdHVkeQ0KDQpUaGlzIGNhc2Ugc3R1ZHkgaXMgcGFydCBvZiBhIHNlcmllcyBvZiBwdWJsaWMgaGVhbHRoIGNhc2Ugc3R1ZGllcyBmb3IgdGhlIFtCbG9vbWJlcmcgQW1lcmljYW4gSGVhbHRoICBJbml0aWF0aXZlXShodHRwczovL2FtZXJpY2FuaGVhbHRoLmpodS5lZHUvb3Blbi1jYXNlLXN0dWRpZXMpLg0KDQojIyAqKk1vdGl2YXRpb24qKg0KKioqIA0KDQpJbiB0aGUgVW5pdGVkIFN0YXRlcywgdGhlcmUgaGF2ZSBiZWVuIHNpZ25pZmljYW50IGFuZCBoaXN0b3JpY2FsIGRlY2xpbmVzIGluIGNpZ2FyZXR0ZSBzbW9raW5nLiBJbiB0aGUgMTk3MHMsIDc1JSBvZiBoaWdoIHNjaG9vbCBzZW5pb3JzIHdlcmUgc21va2luZywgdGhhdCBudW1iZXIgaXMgYmVsb3cgMTAlIG5vdy4gVGhpcyBwcm9ncmVzcyBpcyBsYXJnZWx5IGR1ZSB0byB0aGUgdG9iYWNjbyBjb250cm9sIG1vdmVtZW50IGFuZCB0aGVpciBmb2N1cyBvbiBpbml0aWF0aXZlcyBsaWtlIGVuZGluZyBhZHZlcnRpc2luZyB0byBjaGlsZHJlbiAobGlrZSBKb2UgQ2FtZWwpLCBwYXNzaW5nIGluZG9vciBzbW9raW5nIGxhd3MsIGhlYWx0aCBjb21tdW5pY2F0aW9uLCBldGMuIA0KDQpBY2NvcmRpbmcgdG8gYSByZWNlbnQgW3JlcG9ydF0oaHR0cHM6Ly93d3cuY2RjLmdvdi9tbXdyL3ZvbHVtZXMvNjgvd3IvbW02ODA2ZTEuaHRtP3NfY2lkPW1tNjgwNmUxX3cpe3RhcmdldD0iX2JsYW5rIn0sIG92ZXJhbGwgdG9iYWNjbyB1c2UgKippbmNyZWFzZWQqKiBpbiB5b3V0aHMgKG1pZGRsZSBzY2hvb2wgYW5kIGhpZ2ggc2Nob29sIHN0dWRlbnRzKSBpbiB0aGUgVW5pdGVkIFN0YXRlcyBpbiAyMDE3IGFuZCAyMDE4LCBkZXNwaXRlIHByZXZpb3VzIHllYXJzIG9mIGRlY2xpbmluZyB1c2UuDQoNClRoaXMgbWFqb3IgaW5jcmVhc2UgaXMgYXR0cmlidXRlZCB0byBhbiBpbmNyZWFzZSBpbiB0aGUgdXNlIG9mIGVsZWN0cm9uaWMgY2lnYXJldHRlIChlLWNpZ2FyZXR0ZSkgcHJvZHVjdHMuDQoNCkUtY2lnYXJldHRlcyBhcmUgcmVmZXJyZWQgdG8gYnkgbWFueSBkaWZmZXJlbnQgbmFtZXMsIGluY2x1ZGluZyBidXQgbm90IGxpbWl0ZWQgdG86DQoNCjEpIEVsZWN0cm9uaWMgbmljb3RpbmUgZGVsaXZlcnkgc3lzdGVtcyAoRU5EUykNCjIpIFZhcGVzDQozKSBlLWhvb2thaHMNCjQpIHZhcGUgcGVucw0KNSkgdGFua3MNCjYpIG1vZHMNCg0KVGhlIGRldmljZXMgdmFyeSBncmVhdGx5Og0KDQpgYGB7ciwgZWNobyA9IEZBTFNFLCBmaWcuYWxpZ24gPSJjZW50ZXIifQ0KDQppbmNsdWRlX2dyYXBoaWNzKCJodHRwczovL3d3dy5sdW5nLm9yZy9nZXRtZWRpYS84YWM4YWI4Yy1lN2ZjLTQ5N2ItODM4NC00NDE2MTVmNTBmZjAvZWNpZ3NfSy5qcGcuanBnIikNCmBgYA0KDQojIyMjIyBbW3NvdXJjZV0oaHR0cHM6Ly93d3cubHVuZy5vcmcvcXVpdC1zbW9raW5nL2UtY2lnYXJldHRlcy12YXBpbmcvbHVuZy1oZWFsdGgpXQ0KDQpTZWUgdGhpcyBbQ0RDIGd1aWRlXShodHRwczovL3d3dy5jZGMuZ292L3RvYmFjY28vYmFzaWNfaW5mb3JtYXRpb24vZS1jaWdhcmV0dGVzL3BkZnMvZWNpZ2FyZXR0ZS1vci12YXBpbmctcHJvZHVjdHMtdmlzdWFsLWRpY3Rpb25hcnktNTA4LnBkZil7dGFyZ2V0PSJfYmxhbmsifSBhbmQgdGhlIFtBbWVyaWNhbiBMdW5nIEFzc29jaWF0aW9uIHdlYnNpdGVdKGh0dHBzOi8vd3d3Lmx1bmcub3JnL3F1aXQtc21va2luZy9lLWNpZ2FyZXR0ZXMtdmFwaW5nL2x1bmctaGVhbHRoKXt0YXJnZXQ9Il9ibGFuayJ9IGZvciBtb3JlIGluZm9ybWF0aW9uLiANCg0KVGhlIHJlcG9ydCBmb3VuZCB0aGF0Og0KDQo+IER1cmluZyAyMDE34oCTMjAxOCwgY3VycmVudCB1c2Ugb2YgYW55IHRvYmFjY28gcHJvZHVjdCAqKmluY3JlYXNlZCAzOC4zJSoqIChmcm9tIDE5LjYlIHRvIDI3LjElKSBhbW9uZyBoaWdoIHNjaG9vbCBzdHVkZW50cyBhbmQgKioyOC42JSoqIChmcm9tIDUuNiUgdG8gNy4yJSkgYW1vbmcgbWlkZGxlIHNjaG9vbCBzdHVkZW50czsgZS1jaWdhcmV0dGUgdXNlICoqaW5jcmVhc2VkIDc3LjglKiogKGZyb20gMTEuNyUgdG8gMjAuOCUpIGFtb25nIGhpZ2ggc2Nob29sIHN0dWRlbnRzIGFuZCAqKjQ4LjUlKiogKGZyb20gMy4zJSB0byA0LjklKSBhbW9uZyBtaWRkbGUgc2Nob29sIHN0dWRlbnRzLg0KDQoNCkluIDIwMTgsIHRoZSBbRmVkZXJhbCBEcnVnIEFkbWluaXN0cmF0aW9uIChGREEpIGluIHRoZSBVbml0ZWQgU3RhdGVzXShodHRwczovL2Fjc2pvdXJuYWxzLm9ubGluZWxpYnJhcnkud2lsZXkuY29tL2RvaS9mdWxsLzEwLjEwMDIvY25jci4zMTg2OCl7dGFyZ2V0PSJfYmxhbmsifSBzdGF0ZWQgdGhhdCBlLWNpZ2FyZXR0ZSB1c2FnZSB1c2UgYW1vbmcgeW91dGggcmVhY2hlZDogIA0KDQo+IOKAnG5vdGhpbmcgc2hvcnQgb2YgYW4gKiplcGlkZW1pYyBwcm9wb3J0aW9uIG9mIGdyb3d0aCoq4oCdDQoNCg0KSW4gdGhpcyBjYXNlIHN0dWR5LCB3ZSB3aWxsIGJlIGludmVzdGlnYXRpbmcgdGhlIHNhbWUgZGF0YSB1c2VkIGluIHRoZSByZXBvcnQgdGhhdCBnZW5lcmF0ZWQgdGhlIGFib3ZlIGZpbmRpbmdzLiBUaGlzIGRhdGEgY29tZXMgZnJvbSB0aGUgW1RoZSBOYXRpb25hbCBZb3V0aCBUb2JhY2NvIFN1cnZleSAoTllUUyldKGh0dHBzOi8vd3d3LmNkYy5nb3YvdG9iYWNjby9kYXRhX3N0YXRpc3RpY3Mvc3VydmV5cy9ueXRzL2luZGV4Lmh0bSl7dGFyZ2V0PSJfYmxhbmsifS4NCg0KIyMjIyB7LnJlZmVyZW5jZV9ibG9ja30NCg0KR2VudHprZSwgQW5kcmVhIFMuLCBNZWxpc2EgQ3JlYW1lciwgS2FyZW4gQS4gQ3VsbGVuLCBCcmlkZ2V0IEsuIEFtYnJvc2UsIEdvcmRvbiBXaWxsaXMsIEFobWVkIEphbWFsLCBhbmQgQnJpYW4gQS4gS2luZy4gIOKAnFZpdGFsIFNpZ25zOiBUb2JhY2NvIFByb2R1Y3QgVXNlIEFtb25nIE1pZGRsZSBhbmQgSGlnaCBTY2hvb2wgU3R1ZGVudHMgLSBVbml0ZWQgU3RhdGVzLCAyMDExLTIwMTgu4oCdICoqTU1XUi4gTW9yYmlkaXR5IGFuZCBNb3J0YWxpdHkgV2Vla2x5IFJlcG9ydCoqIDY4ICg2KTogMTU34oCTNjQgKDIwMTkpLg0KDQojIyMjDQoNCg0KIyMgKipNYWluIFF1ZXN0aW9ucyoqDQoqKiogDQoNCiMjIyMgey5tYWluX3F1ZXN0aW9uX2Jsb2NrfQ0KPGI+PHU+IE91ciBtYWluIHF1ZXN0aW9uOiA8L3U+PC9iPg0KDQoxKSBIb3cgaGFzIHRvYmFjY28gYW5kIGUtY2lnYXJldHRlL3ZhcGluZyB1c2UgYnkgQW1lcmljYW4geW91dGhzIGNoYW5nZWQgc2luY2UgMjAxNT8NCjIpIEhvdyBkb2VzIGUtY2lnYXJldHRlIHVzZSBjb21wYXJlIGJldHdlZW4gbWFsZXMgYW5kIGZlbWFsZXM/DQozKSBXaGF0IHZhcGluZyBicmFuZHMgYW5kIGZsYXZvcnMgYXBwZWFyIHRvIGJlIHVzZWQgdGhlIG1vc3QgZnJlcXVlbnRseT8gIA0KV2Ugd2lsbCBiYXNlIHRoaXMgb24gdGhlIGZvbGxvd2luZyBzdXJ2ZXkgcXVlc3Rpb25zOiAgIA0KDQo+ICJEdXJpbmcgdGhlIHBhc3QgMzAgZGF5cywgd2hhdCBicmFuZCBvZiBlLWNpZ2FyZXR0ZXMgZGlkIHlvdSB1c3VhbGx5IHVzZT8iICAgDQo+ICJXaGF0IGZsYXZvcnMgb2YgdG9iYWNjbyBwcm9kdWN0cyBoYXZlIHlvdSB1c2VkIGluIHRoZSBwYXN0DQozMCBkYXlzPyIgDQoNCjQpIElzIHRoZXJlIGEgcmVsYXRpb25zaGlwIGJldHdlZW4gZS1jaWdhcmV0dGUvdmFwaW5nIHVzZSBhbmQgb3RoZXIgdG9iYWNjbyB1c2U/DQoNCiMjIyMNCg0KIyMgKipMZWFybmluZyBPYmplY3RpdmVzKiogDQoqKiogDQoNCkluIHRoaXMgY2FzZSBzdHVkeSwgd2Ugd2lsbCBjb3ZlciBob3cgdG8gaW1wb3J0IGRhdGEgZnJvbSBtdWx0aXBsZSBmaWxlcyBlZmZpY2llbnRseSwgaG93IHRvIGltcG9ydCBkYXRhIGZyb20gZXhjZWwgZmlsZXMsIGFuZCBob3cgdG8gbWFrZSBhIHZhcmlldHkgb2YgdmlzdWFsaXphdGlvbnMgdG8gY29tcGFyZSBtdWx0aXBsZSBncm91cHMgYWNyb3NzIHRpbWUuIFdlIHdpbGwgYWxzbyBkZW1vbnN0cmF0ZSBob3cgdG8gd29yayB3aXRoIGNvZGVib29rcy4gV2Ugd2lsbCBjb3ZlciB0aGUgY29uY2VwdCBvZiBzdXJ2ZXkgd2VpZ2h0aW5nIGFuZCBpbnRyb2R1Y2UgdGhlIGBzcnZ5cmAgcGFja2FnZS4gV2Ugd2lsbCBkaXNjdXNzIHRoZSBkaWZmZXJlbmNlIGJldHdlZW4gcG9vbGVkIGNyb3NzLXNlY3Rpb25hbCBkYXRhIGFuZCBwYW5lbCBkYXRhLiBXZSB3aWxsIGVzcGVjaWFsbHkgZm9jdXMgb24gdXNpbmcgcGFja2FnZXMgYW5kIGZ1bmN0aW9ucyBmcm9tIHRoZSBbYFRpZHl2ZXJzZWBdKGh0dHBzOi8vd3d3LnRpZHl2ZXJzZS5vcmcvKXt0YXJnZXQ9Il9ibGFuayJ9IGZvciB3cmFuZ2xpbmcgZGF0YSwgc3VjaCBhcyBgdGlkeXJgIGFuZCBgZHBseXJgIGFuZCBmb3IgdmlzdWFsaXphdGlvbiwgc3VjaCBhcyBhcyBgZ2dwbG90MmAuIFRoZSBUaWR5dmVyc2UgaXMgYSBsaWJyYXJ5IG9mIHBhY2thZ2VzIGNyZWF0ZWQgYnkgUlN0dWRpby4gV2hpbGUgc29tZSBzdHVkZW50cyBtYXkgYmUgZmFtaWxpYXIgd2l0aCBwcmV2aW91cyBSIHByb2dyYW1taW5nIHBhY2thZ2VzLCB0aGVzZSBwYWNrYWdlcyBtYWtlIGRhdGEgc2NpZW5jZSBpbiBSIGVzcGVjaWFsbHkgZWZmaWNpZW50Lg0KDQpgYGB7ciwgb3V0LndpZHRoID0gIjIwJSIsIGVjaG8gPSBGQUxTRSwgZmlnLmFsaWduID0iY2VudGVyIn0NCg0KaW5jbHVkZV9ncmFwaGljcygiaHR0cHM6Ly90aWR5dmVyc2UudGlkeXZlcnNlLm9yZy9sb2dvLnBuZyIpDQpgYGANCg0KDQpUaGUgc2tpbGxzLCBtZXRob2RzLCBhbmQgY29uY2VwdHMgdGhhdCBzdHVkZW50cyB3aWxsIGJlIGZhbWlsaWFyIHdpdGggYnkgdGhlIGVuZCBvZiB0aGlzIGNhc2Ugc3R1ZHkgYXJlOg0KDQo8dT4qKkRhdGEgU2NpZW5jZSBMZWFybmluZyBPYmplY3RpdmVzOioqPC91Pg0KDQoxLiBJbXBvcnQgZGF0YSBmcm9tIEV4Y2VsIGZpbGVzDQoyLiBNZXJnZSBkYXRhIGZyb20gbXVsdGlwbGUgc2ltaWxhciBidXQgbm90IGlkZW50aWNhbCBkYXRhIHN0cnVjdHVyZXMNCjMuIENyZWF0ZSBlZmZlY3RpdmUgbG9uZ2l0dWRpbmFsIGRhdGEgdmlzdWFsaXphdGlvbnMNCjQuIFdyaXRlIGZ1bmN0aW9ucyBpbiBSDQo1LiBBcHBseSBmdW5jdGlvbnMgYWNyb3NzIGRhdGEgc3Vic2V0cyB1c2luZyBgcHVycnJgIGFuZCBgZHBseXJgIGZ1bmN0aW9uYWxpdHkuDQoNCjx1PioqU3RhdGlzdGljYWwgTGVhcm5pbmcgT2JqZWN0aXZlczoqKjwvdT4gDQoNCjEuIFVuZGVyc3RhbmRpbmcgb2YgZGlmZmVyZW50IHR5cGVzIG9mIGxvbmdpdHVkaW5hbCBkYXRhIA0KMi4gVXNhZ2Ugb2YgY29kZWJvb2tzDQozLiBDb25jZXB0dWFsIHVuZGVyc3RhbmRpbmcgb2Ygc3VydmV5IHdlaWdodGluZw0KNC4gSW1wbGVtZW50aW5nIGxvZ2lzdGljIHJlZ3Jlc3Npb24gd2l0aCBzdXJ2ZXkgd2VpZ2h0aW5nDQoNCg0KKioqIA0KDQoNCldlIHdpbGwgYmVnaW4gYnkgbG9hZGluZyB0aGUgcGFja2FnZXMgdGhhdCB3ZSB3aWxsIG5lZWQ6DQoNCmBgYHtyfQ0KbGlicmFyeShoZXJlKQ0KbGlicmFyeShyZWFkeGwpDQpsaWJyYXJ5KG1hZ3JpdHRyKQ0KbGlicmFyeShzdHJpbmdyKQ0KbGlicmFyeShwdXJycikNCmxpYnJhcnkoZHBseXIpDQpsaWJyYXJ5KHJlYWRyKQ0KbGlicmFyeSh0aWR5cikNCmxpYnJhcnkoZ2dwbG90MikNCmxpYnJhcnkoc2NhbGVzKQ0KbGlicmFyeSh2aXJpZGlzKQ0KbGlicmFyeShmb3JjYXRzKQ0KbGlicmFyeShuYW5pYXIpDQpsaWJyYXJ5KHNydnlyKQ0KbGlicmFyeShjb3dwbG90KQ0KbGlicmFyeShicm9vbSkNCmxpYnJhcnkoc3VydmV5KQ0KYGBgDQoNCjx1PioqUGFja2FnZXMgdXNlZCBpbiB0aGlzIGNhc2Ugc3R1ZHk6Kio8L3U+DQoNCiBQYWNrYWdlICAgfCBVc2UgaW4gdGhpcyBjYXNlIHN0dWR5ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgDQotLS0tLS0tLS0tIHwtLS0tLS0tLS0tLS0tDQpbaGVyZV0oaHR0cHM6Ly9naXRodWIuY29tL2plbm55YmMvaGVyZV9oZXJlKXt0YXJnZXQ9Il9ibGFuayJ9ICAgICAgIHwgdG8gZWFzaWx5IGxvYWQgYW5kIHNhdmUgZGF0YSAgDQpbcmVhZHhsXShodHRwczovL3JlYWR4bC50aWR5dmVyc2Uub3JnLyl7dGFyZ2V0PSJfYmxhbmsifSAgICAgIHwgdG8gaW1wb3J0IHRoZSBkYXRhIGluIHRoZSBleGNlbCBmaWxlcyANClttYWdyaXR0cl0oaHR0cHM6Ly9jcmFuLnItcHJvamVjdC5vcmcvd2ViL3BhY2thZ2VzL21hZ3JpdHRyL3ZpZ25ldHRlcy9tYWdyaXR0ci5odG1sKXt0YXJnZXQ9Il9ibGFuayJ9IHwgdG8gdXNlIHRoZSBjb21wb3VuZCBhc3NpZ25tZW50IHBpcGUgb3BlcmF0b3IgYCU8PiVgDQpbc3RyaW5ncl0oaHR0cHM6Ly9zdHJpbmdyLnRpZHl2ZXJzZS5vcmcvYXJ0aWNsZXMvc3RyaW5nci5odG1sKXt0YXJnZXQ9Il9ibGFuayJ9ICAgIHwgdG8gbWFuaXB1bGF0ZSB0aGUgY2hhcmFjdGVyIHN0cmluZ3Mgd2l0aGluIHRoZSBkYXRhICANCltwdXJycl0oaHR0cHM6Ly9wdXJyci50aWR5dmVyc2Uub3JnLyl7dGFyZ2V0PSJfYmxhbmsifSAgIHwgdG8gaW1wb3J0IHRoZSBkYXRhIGluIGFsbCB0aGUgZGlmZmVyZW50IGV4Y2VsIGFuZCBjc3YgZmlsZXMgZWZmaWNpZW50bHkNCltkcGx5cl0oaHR0cHM6Ly9kcGx5ci50aWR5dmVyc2Uub3JnLyl7dGFyZ2V0PSJfYmxhbmsifSAgICAgIHwgdG8gYXJyYW5nZS9maWx0ZXIvc2VsZWN0L2NvbXBhcmUgc3BlY2lmaWMgc3Vic2V0cyBvZiB0aGUgZGF0YSAgDQpbcmVhZHJdKGh0dHBzOi8vcmVhZHIudGlkeXZlcnNlLm9yZy8pe3RhcmdldD0iX2JsYW5rIn0gICAgICB8IHRvIGltcG9ydCB0aGUgQ1NWIGZpbGUgZGF0YQ0KW3RpZHlyXShodHRwczovL3RpZHlyLnRpZHl2ZXJzZS5vcmcvKXt0YXJnZXQ9Il9ibGFuayJ9ICAgICAgfCB0byByZWFycmFuZ2UgZGF0YSBpbiB3aWRlIGFuZCBsb25nIGZvcm1hdHMgDQpbZ2dwbG90Ml0oaHR0cHM6Ly9nZ3Bsb3QyLnRpZHl2ZXJzZS5vcmcvKXt0YXJnZXQ9Il9ibGFuayJ9ICAgIHwgdG8gbWFrZSB2aXN1YWxpemF0aW9ucyB3aXRoIG11bHRpcGxlIGxheWVycw0KW3NjYWxlc10oaHR0cHM6Ly9jcmFuLnItcHJvamVjdC5vcmcvd2ViL3BhY2thZ2VzL3NjYWxlcy9zY2FsZXMucGRmKXt0YXJnZXQ9Il9ibGFuayJ9ICAgIHwgdG8gYWxsb3cgdXMgdG8gbG9vayBhdCB0aGUgY29sb3JzIHdpdGhpbiB0aGUgdmlyaWRpcyBwYWNrYWdlDQpbdmlyaWRpc10oaHR0cHM6Ly9jcmFuLnItcHJvamVjdC5vcmcvd2ViL3BhY2thZ2VzL3ZpcmlkaXMvdmlnbmV0dGVzL2ludHJvLXRvLXZpcmlkaXMuaHRtbCl7dGFyZ2V0PSJfYmxhbmsifSAgICB8IHRvIG1ha2UgcGxvdHMgd2l0aCBhIGNvbG9yIHBhbGV0dGUgdGhhdCBpcyBjb21wYXRpYmxlIHdpdGggY29sb3IgYmxpbmRuZXNzDQpbZm9yY2F0c10oaHR0cHM6Ly9mb3JjYXRzLnRpZHl2ZXJzZS5vcmcvKXt0YXJnZXQ9Il9ibGFuayJ9ICAgIHwgdG8gYWxsb3cgZm9yIHJlb3JkZXJpbmcgb2YgZmFjdG9ycyBpbiBwbG90cw0KW25hbmlhcl0oaHR0cHM6Ly9jcmFuLnItcHJvamVjdC5vcmcvd2ViL3BhY2thZ2VzL25hbmlhci92aWduZXR0ZXMvZ2V0dGluZy1zdGFydGVkLXctbmFuaWFyLmh0bWwpe3RhcmdldD0iX2JsYW5rIn0gIHwgdG8gbWFrZSBhIHZpc3VhbGl6YXRpb24gb2YgbWlzc2luZyBkYXRhDQpbc3lydnJdKGh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9zcnZ5ci9zcnZ5ci5wZGYpe3RhcmdldD0iX2JsYW5rIn0gfCB0byB1c2Ugc3VydmV5IHdlaWdodHMNCltjb3dwbG90XShodHRwczovL2NyYW4uci1wcm9qZWN0Lm9yZy93ZWIvcGFja2FnZXMvY293cGxvdC92aWduZXR0ZXMvaW50cm9kdWN0aW9uLmh0bWwpe3RhcmdldD0iX2JsYW5rIn0gfCB0byBhbGxvdyBwbG90cyB0byBiZSBjb21iaW5lZCANClticm9vbV0oaHR0cHM6Ly9jcmFuLnItcHJvamVjdC5vcmcvd2ViL3BhY2thZ2VzL2Jyb29tL3ZpZ25ldHRlcy9icm9vbS5odG1sKXt0YXJnZXQ9Il9ibGFuayJ9IHwgdG8gY3JlYXRlIG5pY2VseSBmb3JtYXR0ZWQgbW9kZWwgb3V0cHV0DQpbc3VydmV5XShodHRwOi8vci1zdXJ2ZXkuci1mb3JnZS5yLXByb2plY3Qub3JnL3N1cnZleS9pbmRleC5odG1sKXt0YXJnZXQ9Il9ibGFuayJ9IHwgdG8gZml0IHN1cnZleS13ZWlnaHRlZCBsb2dpc3RpYyByZWdyZXNzaW9uDQoNCg0KVGhlIGZpcnN0IHRpbWUgd2UgdXNlIGEgZnVuY3Rpb24sIHdlIHdpbGwgdXNlIHRoZSBgOjpgIHRvIGluZGljYXRlIHdoaWNoIHBhY2thZ2Ugd2UgYXJlIHVzaW5nLiBVbmxlc3Mgd2UgaGF2ZSBvdmVybGFwcGluZyBmdW5jdGlvbiBuYW1lcywgdGhpcyBpcyBub3QgbmVjZXNzYXJ5LCBidXQgd2Ugd2lsbCBpbmNsdWRlIGl0IGhlcmUgdG8gYmUgaW5mb3JtYXRpdmUgYWJvdXQgd2hlcmUgdGhlIGZ1bmN0aW9ucyB3ZSB3aWxsIHVzZSBjb21lIGZyb20uDQoNCg0KIyMgKipDb250ZXh0KioNCioqKiANCg0KQWNjb3JkaW5nIHRvIHRoZSBjaXRlZCBbTW9yYmlkaXR5IGFuZCBNb3J0YWxpdHkgV2Vla2x5IFJlcG9ydF0oaHR0cHM6Ly93d3cuY2RjLmdvdi9tbXdyL3ZvbHVtZXMvNjgvd3IvbW02ODA2ZTEuaHRtP3NfY2lkPW1tNjgwNmUxX3cpIHRoaXMgd2FzIHdoYXQgd2FzIGFscmVhZHkga25vd24gYWJvdXQgdGhpcyB0b3BpYyBhbmQgdGhlIGltcGxpY2F0aW9ucyBvZiB0aGlzIHN0dWR5Og0KDQpgYGB7ciwgZWNobyA9IEZBTFNFLCBmaWcuYWxpZ24gPSJjZW50ZXIiLCBvdXQud2lkdGggPSAiODAwIHB4In0NCg0Ka25pdHI6OmluY2x1ZGVfZ3JhcGhpY3MoInd3dy9pbWcvY29udGV4dC5wbmciKQ0KYGBgDQoNCiMjIyMgW1tzb3VyY2VdKGh0dHBzOi8vd3d3LmNkYy5nb3YvbW13ci92b2x1bWVzLzY4L3dyL21tNjgwNmUxLmh0bT9zX2NpZD1tbTY4MDZlMV93KV17dGFyZ2V0PSJfYmxhbmsifSANCg0KDQpJbXBvcnRhbnRseSwgdGhlIHZhcG9ycyB1c2VkIGluIGUtY2lnYXJldHRlcyBjb250YWluIGhhcm1mdWwgY2hlbWljYWxzOg0KDQpgYGB7ciwgZWNobyA9IEZBTFNFLCBmaWcuYWxpZ24gPSJjZW50ZXIifQ0KaW5jbHVkZV9ncmFwaGljcygid3d3L2ltZy9lLWNpZ2FyZXR0ZS1hZXJvc29sLWNhbi1jb250YWluLWhhcm1mdWwtaW5ncmVkaWVudHMuanBnIikNCmBgYA0KDQojIyMjIFtbc291cmNlXShodHRwczovL3d3dy5jZGMuZ292L3RvYmFjY28vYmFzaWNfaW5mb3JtYXRpb24vZS1jaWdhcmV0dGVzL2ltYWdlcy9lLWNpZ2FyZXR0ZS1hZXJvc29sLWNhbi1jb250YWluLWhhcm1mdWwtaW5ncmVkaWVudHMtZGVza3RvcC03MDAuanBnKV17dGFyZ2V0PSJfYmxhbmsifSANCg0KRS1jaWdhcmV0dGUgdXNhZ2UgaGFzIGFsc28gYmVlbiBhc3NvY2lhdGVkIHdpdGggW2x1bmcgaW5qdXJ5XSgoaHR0cHM6Ly93d3cuZnJvbnRpZXJzaW4ub3JnL2FydGljbGVzLzEwLjMzODkvZnBoYXIuMjAxOS4wMTYxOS9mdWxsKSl7dGFyZ2V0PSJfYmxhbmsifToNCg0KYGBge3IsIGVjaG8gPSBGQUxTRSwgZmlnLmFsaWduID0iY2VudGVyIiwgb3V0LndpZHRoID0gIjgwMCBweCJ9DQoNCmtuaXRyOjppbmNsdWRlX2dyYXBoaWNzKCJ3d3cvaW1nL2x1bmcucG5nIikNCmBgYA0KDQojIyMjIFtbc291cmNlXShodHRwczovL3d3dy5mcm9udGllcnNpbi5vcmcvYXJ0aWNsZXMvMTAuMzM4OS9mcGhhci4yMDE5LjAxNjE5L2Z1bGwpXXt0YXJnZXQ9Il9ibGFuayJ9IA0KDQpTZWUgW2hlcmVdKGh0dHBzOi8vd3d3LmNkYy5nb3YvdG9iYWNjby9iYXNpY19pbmZvcm1hdGlvbi9lLWNpZ2FyZXR0ZXMvUXVpY2stRmFjdHMtb24tdGhlLVJpc2tzLW9mLUUtY2lnYXJldHRlcy1mb3ItS2lkcy1UZWVucy1hbmQtWW91bmctQWR1bHRzLmh0bWwpe3RhcmdldD0iX2JsYW5rIn0gZm9yIGFkZGl0aW9uYWwgaW5mb3JtYXRpb24gYWJvdXQgdGhlIHBvdGVudGlhbCBoZWFsdGggZWZmZWN0cyBvZiBlLWNpZ2FyZXR0ZXMgaW4gdGVlbnMgYW5kIHlvdW5nIGFkdWx0cy4NCg0KIyMgKipMaW1pdGF0aW9ucyoqDQoqKiogDQpUaGVyZSBhcmUgc29tZSBpbXBvcnRhbnQgY29uc2lkZXJhdGlvbnMgcmVnYXJkaW5nIHRoaXMgZGF0YSBhbmFseXNpcyB0byBrZWVwIGluIG1pbmQ6IA0KDQoxKSBUaGUgW05hdGlvbmFsIFlvdXRoIFRvYmFjY28gU3VydmV5IChOWVRTKV0oaHR0cHM6Ly93d3cuY2RjLmdvdi90b2JhY2NvL2RhdGFfc3RhdGlzdGljcy9zdXJ2ZXlzL255dHMvaW5kZXguaHRtKXt0YXJnZXQ9Il9ibGFuayJ9IGRvZXMgbm90IGZvbGxvdyB0aGUgc2FtZSBpbmRpdmlkdWFsIHN0dWRlbnQgcmVzcG9uZGVudHMgb3ZlciB0aW1lLiAgQSBbbG9uZ2l0dWRpbmFsIHN0dWR5XShodHRwczovL3d3dy5ibWouY29tL2Fib3V0LWJtai9yZXNvdXJjZXMtcmVhZGVycy9wdWJsaWNhdGlvbnMvZXBpZGVtaW9sb2d5LXVuaW5pdGlhdGVkLzctbG9uZ2l0dWRpbmFsLXN0dWRpZXMpe3RhcmdldD0iX2JsYW5rIn0gdGhhdCBkb2VzIGZvbGxvdyB0aGUgc2FtZSBpbmRpdmlkdWFscyBvdmVyIHRpbWUgY29sbGVjdHMgZGF0YSBjYWxsZWQgW3BhbmVsIGRhdGFdKGh0dHBzOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL1BhbmVsX2RhdGEpe3RhcmdldD0iX2JsYW5rIn0uIFRoZSBkYXRhIGluIHRoaXMgc3R1ZHkgaXMgY2FsbGVkIHBvb2xlZCBbY3Jvc3Mtc2VjdGlvbmFsIGRhdGFdKGh0dHBzOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL0Nyb3NzLXNlY3Rpb25hbF9kYXRhKXt0YXJnZXQ9Il9ibGFuayJ9LCBhbmQgaXMgb2J0YWluZWQgZnJvbSByYW5kb20gY29sbGVjdGlvbiBvZiBvYnNlcnZhdGlvbnMgYWNyb3NzIHRpbWUuDQoNCkFjY29yZGluZyB0byBXaWtpcGVkaWE6DQoNCj4gUGFuZWwgZGF0YSBkaWZmZXJzIGZyb20gcG9vbGVkIGNyb3NzLXNlY3Rpb25hbCBkYXRhIGFjcm9zcyB0aW1lLCBiZWNhdXNlIGl0IGRlYWxzIHdpdGggdGhlIG9ic2VydmF0aW9ucyBvbiB0aGUgc2FtZSBzdWJqZWN0cyBpbiBkaWZmZXJlbnQgdGltZXMgd2hlcmVhcyB0aGUgbGF0dGVyIG9ic2VydmVzIGRpZmZlcmVudCBzdWJqZWN0cyBpbiBkaWZmZXJlbnQgdGltZSBwZXJpb2RzDQoNCjIpIFRoZSBkYXRhIGluY2x1ZGUgcGVyY2VudGFnZXMgb2Ygc3R1ZGVudCByZXNwb25kZW50cyByZXBvcnRpbmcgdXNlIG9mIGVhY2ggcGFydGljdWxhciB0b2JhY2NvIHByb2R1Y3QsIGJ1dCB0aGUgc3VydmV5IHF1ZXN0aW9ucyBkaWQgbm90IGFzayB0aGUgcmVsYXRpdmUgYW1vdW50IG9mIHVzZSBvZiBvbmUgcHJvZHVjdCBjb21wYXJlZCB0byBhbm90aGVyLiBGb3IgZXhhbXBsZSwgdGhlIHN1cnZleSBpbmNsdWRlZCBxdWVzdGlvbnMgbGlrZToiV2hhdCBmbGF2b3JzIG9mIHRvYmFjY28gcHJvZHVjdHMgaGF2ZSB5b3UgdXNlZCBpbiB0aGUgcGFzdCAzMCBkYXlzPyIgYnV0IGRpZCBub3QgYXNrIGhvdyBvZnRlbiBvbmUgZmxhdm9yIHdhcyB1c2VkIGJ5IHRoZSBzYW1lIGluZGl2aWR1YWwgb3ZlciBhbm90aGVyLg0KDQpXaGlsZSBbZ2VuZGVyXShodHRwczovL3d3dy5nZW5kZXJzcGVjdHJ1bS5vcmcvcXVpY2stbGlua3MvdW5kZXJzdGFuZGluZy1nZW5kZXIvKXt0YXJnZXQ9Il9ibGFuayJ9IGFuZCBbc2V4XShodHRwczovL3d3dy53aG8uaW50L2dlbm9taWNzL2dlbmRlci9lbi9pbmRleDEuaHRtbCl7dGFyZ2V0PSJfYmxhbmsifSBhcmUgbm90IGFjdHVhbGx5IGJpbmFyeSwgdGhlIGRhdGEgdXNlZCBpbiB0aGlzIGFuYWx5c2lzIG9ubHkgY29udGFpbiBpbmZvcm1hdGlvbiBmb3IgZ3JvdXBzIG9mIGluZGl2aWR1YWxzIHdobyBhbnN3ZXJlZCB0aGUgc3VydmV5IHF1ZXN0aW9ucyBhcyBtYWxlIG9yIGZlbWFsZS4gDQoNCiMjICoqV2hhdCBhcmUgdGhlIGRhdGE/KioNCioqKiANCiANClRoZSBkYXRhIGluIHRoaXMgY2FzZSBzdHVkeSBjb21lcyBmcm9tIHRoZSBbTmF0aW9uYWwgWW91dGggVG9iYWNjbyBTdXJ2ZXkgKE5ZVFMpXShodHRwczovL3d3dy5jZGMuZ292L3RvYmFjY28vZGF0YV9zdGF0aXN0aWNzL3N1cnZleXMvbnl0cy9pbmRleC5odG0pe3RhcmdldD0iX2JsYW5rIn0gd2hpY2ggaXMgYW4gYW5udWFsIHN1cnZleSB0aGF0IGFza3Mgc3R1ZGVudHMgaW4gaGlnaCBzY2hvb2wgYW5kIG1pZGRsZSBzY2hvb2wgKGdyYWRlcyA2LTEyKSBhYm91dCB0b2JhY2NvIHVzYWdlIGluIHRoZSBVbml0ZWQgU3RhdGVzIG9mIEFtZXJpY2EuDQoNClRoZSBkYXRhIGZvciB0aGlzIHN1cnZleSBpcyBmcmVlbHkgYXZhaWxhYmxlIG9ubGluZSBhdCB0aGlzIFt3ZWJzaXRlXShodHRwczovL3d3dy5jZGMuZ292L3RvYmFjY28vZGF0YV9zdGF0aXN0aWNzL3N1cnZleXMvbnl0cy9kYXRhL2luZGV4Lmh0bWwpe3RhcmdldD0iX2JsYW5rIn0gd2l0aCBkYXRhIGZyb20gMTk5OSwgMjAwMCwgMjAwMiwgMjAwNCwgMjAwNiwgMjAwOSwgIGFuZCAyMDExLTIwMTkuIFdlIHdpbGwgYmUgdXNpbmcgZGF0YSBmcm9tICoqMjAxNS0yMDE5KiogZHVlIHRvIHRoZSBmYWN0IHRoYXQgdGhlc2UgeWVhcnMgYXJlIHRoZSBtb3N0IHJlY2VudCB0aGF0IGFza2VkIHF1ZXN0aW9ucyByZWdhcmRpbmcgZS1jaWdhcmV0dGUgdXNhZ2UuDQoNCkVhY2ggeWVhciBpbmNsdWRlcyBkb2N1bWVudGF0aW9uLCBzdWNoIGFzIGEgW2NvZGVib29rXShodHRwczovL3d3dy5saWIubmNzdS5lZHUvZGF0YS9pY3BzcmZhcSN3aGF0YXJlKXt0YXJnZXQ9Il9ibGFuayJ9IGFuZCBhbiBleGNlbCBmaWxlIGNvbnRhaW5pbmcgdGhlIGRhdGE6DQoNCmBgYHtyLCBlY2hvID0gRkFMU0UsIGZpZy5hbGlnbiA9ImNlbnRlciIsIG91dC53aWR0aCA9ICI2MDAgcHgifQ0KDQprbml0cjo6aW5jbHVkZV9ncmFwaGljcygid3d3L2ltZy9kYXRhLnBuZyIpDQpgYGANClRoZXJlZm9yZSwgc2luY2Ugd2UgYXJlIHVzaW5nIGRhdGEgZnJvbSAqKjIwMTUtMjAxOSoqLCB0aGUgZGF0YSB3ZSBhcmUgaW50ZXJlc3RlZCBpbiBhcmUgbG9jYXRlZCBpbiA1IGRpZmZlcmVudCBleGNlbCBmaWxlcywgb25lIGZvciBlYWNoIHllYXIsIGVhY2ggd2l0aCBpdHMgb3duIFtjb2RlYm9va10oLi9kb2NzLzIwMTktbnl0cy1kYXRhc2V0LWFuZC1jb2RlYm9vay1taWNyb3NvZnQtZXhjZWwvMjAxOS1ueXRzLWNvZGVib29rLXAucGRmKXt0YXJnZXQ9Il9ibGFuayJ9ICh0aGlzIGlzIHRoZSBvbmUgZm9yIDIwMTkpLg0KDQpUaGUgW2NvZGVib29rXShodHRwczovL3d3dy5pY3Bzci51bWljaC5lZHUvaWNwc3J3ZWIvY29udGVudC9zaGFyZWQvSUNQU1IvZmFxcy93aGF0LWlzLWEtY29kZWJvb2suaHRtbCl7dGFyZ2V0PSJfYmxhbmsifSBjb250YWlucyBpbmZvcm1hdGlvbiBkZXNjcmliaW5nIHRoZSBkYXRhIHdpdGhpbiB0aGUgZXhjZWwgZmlsZS4gDQoNCkFzIHlvdSBjYW4gc2VlIHRoZSBleGNlbCBmaWxlIGNvbnRhaW5zIHZlcnkgc2hvcnQgdmFyaWFibGUgbmFtZXMgYW5kIG51bWVyaWMgdmFsdWVzLCBhbmQgaXQgaXMgbm90IGNsZWFyIHdoYXQgdGhleSBtZWFuIHdpdGhvdXQgdGhlIGNvZGVib29rOg0KDQpgYGB7ciwgZWNobyA9IEZBTFNFLCBmaWcuYWxpZ24gPSJjZW50ZXIiLCBvdXQud2lkdGggPSAiNjAwIHB4In0NCg0Ka25pdHI6OmluY2x1ZGVfZ3JhcGhpY3MoInd3dy9pbWcvZXhjZWwucG5nIikNCmBgYA0KDQpUaGUgY29kZWJvb2sgZXhwbGFpbnMgd2hhdCB0aGUgdmFyaWFibGVzICh0aGUgY29sdW1ucykgYXJlOg0KYGBge3IsIGVjaG8gPSBGQUxTRSwgZmlnLmFsaWduID0iY2VudGVyIiwgb3V0LndpZHRoID0gIjYwMCBweCJ9DQoNCmtuaXRyOjppbmNsdWRlX2dyYXBoaWNzKCJ3d3cvaW1nL3ZhcmlhYmxlcy5wbmciKQ0KYGBgDQoNCkFuZCB0aGUgY29kZWJvb2sgZXhwbGFpbnMgd2hhdCB0aGUgdmFsdWVzIGZvciBlYWNoIHZhcmlhYmxlIGFyZToNCg0KYGBge3IsIGVjaG8gPSBGQUxTRSwgZmlnLmFsaWduID0iY2VudGVyIiwgb3V0LndpZHRoID0gIjYwMCBweCJ9DQoNCmtuaXRyOjppbmNsdWRlX2dyYXBoaWNzKCJ3d3cvaW1nL3FuMS5wbmciKQ0KYGBgDQoNCldlIHdpbGwgZXhwbGFpbiBtb3JlIGxhdGVyIGFib3V0IHdoYXQgdGhlIHZhbHVlcyBvbiB0aGUgcmlnaHQgaW5kaWNhdGUuDQoNClRoZSByZWFzb24gdGhhdCB0aGVyZSBhcmUgY29kZWJvb2tzIGZvciBlYWNoIHllYXIgaXMgYmVjYXVzZSB0aGUgcXVlc3Rpb25zIGFza2VkIGVhY2ggeWVhciB2YXJpZWQgc2xpZ2h0bHkuDQoNCg0KVGhlIGRhdGEgaW4gdGhpcyBzdXJ2ZXkgYXJlIHBvb2xlZCBjcm9zcy1zZWN0aW9uYWwgZGF0YS4gSW4gdGhpcyBzdHVkeSBkZXNpZ24sIGRpZmZlcmVudCBzdWJzZXRzIG9mIHN0dWRlbnQgcmVzcG9uZGVudHMgYXJlIHN1cnZleWVkIGVhY2ggeWVhciBhbmQgaXQgaXMgbm90IGNsZWFyIHdoaWNoLCBpZiBhbnksIGluZGl2aWR1YWxzIHBhcnRpY2lwYXRlIG1vcmUgdGhhbiBvbmNlIGZyb20gb25lIHllYXIgdG8gdGhlIG5leHQuDQoNCiMjICoqRGF0YSBJbXBvcnQqKg0KKioqIA0KDQojIyMgKipSZWFkaW5nIGluIHRoZSBleGNlbCBmaWxlcyoqDQoqKioNCg0KU2luY2UgdGhlc2UgZXhjZWwgZmlsZXMgYXJlIHNvIGxhcmdlIChlYWNoIGhhcyByb3VnaGx5IDIwLDAwMCByb3dzKSwgaXQgdGFrZXMgYSBiaXQgb2YgdGltZSBmb3IgdGhlIGRhdGEgdG8gbG9hZC4gVG8gbWFrZSB0aGUgcHJvY2VzcyBmYXN0ZXIsIHdlIHByZXZpb3VzbHkgaW1wb3J0ZWQgdGhlc2UgZmlsZXMsIHNlbGVjdGVkIG9ubHkgdGhlIGNvbHVtbnMgcmVsZXZhbnQgdG8gb3VyIHF1ZXN0aW9ucyBvZiBpbnRlcmVzdCwgYW5kIHNhdmVkIHRoZXNlIGRhdGEgc3Vic2V0cyBhcyBjb21tYS1zZXBhcmF0ZWQgKC5jc3YpIGZpbGVzLiANCg0KSWYgeW91IGhhdmUgdHJvdWJsZSBhY2Nlc3NpbmcgdGhlIEdpdEh1YiBSZXBvc2l0b3J5LCB0aGVzZSBDU1YgZmlsZXMgY2FuIGJlIGRvd25sb2FkZWQgZnJvbSBbaGVyZV0oaHR0cHM6Ly9naXRodWIuY29tL29wZW5jYXNlc3R1ZGllcy9vY3MtYnAtdmFwaW5nLWNhc2Utc3R1ZHkvdHJlZS9tYXN0ZXIvZGF0YS9kYXRhX3JlZHVjZWQpe3RhcmdldD0iX2JsYW5rIn0uDQoNCioqKg0KDQo8ZGV0YWlscz48c3VtbWFyeT4gQ2xpY2sgaGVyZSBmb3IgZGV0YWlscyBvbiBob3cgdGhlIGRhdGEgd2VyZSBvcmlnaW5hbGx5IGltcG9ydGVkIDwvc3VtbWFyeT4NCg0KSWYgeW91IGhhdmUgdHJvdWJsZSBhY2Nlc3NpbmcgdGhlIEdpdEh1YiBSZXBvc2l0b3J5LCB5b3UgY2FuIGZvbGxvdyB0aGUgbGlua3MgdG8gZG93bmxvYWQgdGhlIGV4Y2VsIGZpbGVzIGZvciBbMjAxNV0oaHR0cHM6Ly9naXRodWIuY29tL29wZW5jYXNlc3R1ZGllcy9vY3MtYnAtdmFwaW5nLWNhc2Utc3R1ZHkvYmxvYi9tYXN0ZXIvZG9jcy8yMDE1LW55dHMtZGF0YXNldC1hbmQtY29kZWJvb2stbWljcm9zb2Z0LWV4Y2VsL255dHMyMDE1Lnhsc3gpe3RhcmdldD0iX2JsYW5rIn0sIFsyMDE2XShodHRwczovL2dpdGh1Yi5jb20vb3BlbmNhc2VzdHVkaWVzL29jcy1icC12YXBpbmctY2FzZS1zdHVkeS9ibG9iL21hc3Rlci9kb2NzLzIwMTYtbnl0cy1kYXRhc2V0LWFuZC1jb2RlYm9vay1taWNyb3NvZnQtZXhjZWwvbnl0czIwMTYueGxzeCl7dGFyZ2V0PSJfYmxhbmsifSwgWzIwMTddKGh0dHBzOi8vZ2l0aHViLmNvbS9vcGVuY2FzZXN0dWRpZXMvb2NzLWJwLXZhcGluZy1jYXNlLXN0dWR5L2Jsb2IvbWFzdGVyL2RvY3MvMjAxNy1ueXRzLWRhdGFzZXQtYW5kLWNvZGVib29rLW1pY3Jvc29mdC1leGNlbC9ueXRzMjAxNy54bHN4KXt0YXJnZXQ9Il9ibGFuayJ9LCBbMjAxOF0oaHR0cHM6Ly9naXRodWIuY29tL29wZW5jYXNlc3R1ZGllcy9vY3MtYnAtdmFwaW5nLWNhc2Utc3R1ZHkvYmxvYi9tYXN0ZXIvZG9jcy8yMDE4LW55dHMtZGF0YXNldC1hbmQtY29kZWJvb2stbWljcm9zb2Z0LWV4Y2VsL255dHMyMDE4Lnhsc3gpe3RhcmdldD0iX2JsYW5rIn0sIGFuZCBbMjAxOV0oaHR0cHM6Ly9naXRodWIuY29tL29wZW5jYXNlc3R1ZGllcy9vY3MtYnAtdmFwaW5nLWNhc2Utc3R1ZHkvYmxvYi9tYXN0ZXIvZG9jcy8yMDE5LW55dHMtZGF0YXNldC1hbmQtY29kZWJvb2stbWljcm9zb2Z0LWV4Y2VsL255dHMyMDE5Lnhsc3gpe3RhcmdldD0iX2JsYW5rIn0uDQoNCkZpcnN0IHdlIGNyZWF0ZWQgYSB2ZWN0b3Igb2YgZmlsZSBuYW1lcyBvZiBhbGwgdGhlIGRpZmZlcmVudCBleGNlbCBmaWxlcy4gVXNpbmcgdGhlIGBoZXJlKClgIGZ1bmN0aW9uIG9mIHRoZSBgaGVyZWAgcGFja2FnZSwgd2UgbG9va2VkIGluIGFsbCB0aGUgZGlyZWN0b3JpZXMgb2YgdGhlIHByb2plY3QuDQpUaGUgYGxpc3QuZmlsZXMoKWAgZnVuY3Rpb24gbG9va2VkIGZvciBhbGwgZmlsZXMgd2l0aCAueGxzeCB3aXRoaW4gdGhlc2Ugc3ViLWRpcmVjdG9yaWVzLg0KDQpgYGB7cn0NCmV4Y2VsX2ZpbGVzIDwtIGxpc3QuZmlsZXMoaGVyZTo6aGVyZSgpLCByZWN1cnNpdmUgPSBUUlVFLA0KICAgICAgICAgICAgICAgICAgcGF0dGVybiA9ICIqLnhsc3giKQ0KZXhjZWxfZmlsZXMNCmBgYA0KDQpBbGwgdGhlIGZpbGVzIHdlcmUgcmVhZCB1c2luZyBgcmVhZF9leGNlbCgpYCBvZiB0aGUgYHJlYWR4bGAgcGFja2FnZS4gVXNpbmcgdGhlIGBtYXAoKWAgZnVuY3Rpb24gb2YgdGhlIGBwdXJycmAgcGFja2FnZSB0aGlzIHdhcyBkb25lIGVmZmljaWVudGx5IGZvciBhbGwgb2YgdGhlIGV4Y2VsIGZpbGVzIGluIHRoZSB2ZWN0b3IgdXNpbmcgb25lIGNvbW1hbmQuIFRoZSBgLmAgaXMgdXNlZCB0byBpbmRpY2F0ZSB0aGF0IHdlIHdhbnQgdG8gYXBwbHkgdGhlIGByZWFkX2V4Y2VsKClgIGZ1bmN0aW9uIHRvIGVhY2ggZWxlbWVudCBvZiB0aGUgZGF0YSB0aGF0IHdlIGp1c3QgcGlwZWQgaW50byB0aGUgYG1hcCgpYCBmdW5jdGlvbi4NCg0KSGVyZSB3ZSBhbHNvIHVzZWQgdGhlIGAlPiVgIHBpcGUgd2hpY2ggY2FuIGJlIHVzZWQgdG8gcGFzcyB0aGUgaW5wdXQgZnJvbSBvbmUgZnVuY3Rpb24gdG8gYW5vdGhlciBmb3IgbGF0ZXIgc2VxdWVudGlhbCBzdGVwcy4gDQoNClRoaXMgY3JlYXRlZCBhIHNpbmdsZSBsaXN0IG9mIHRpYmJsZXMgKG9uZSBmb3IgZWFjaCBmaWxlKS4gDQpgYGB7ciwgZXZhbCA9IEZBTFNFfQ0KdGJsX2ZpbGVzIDwtIGV4Y2VsX2ZpbGVzICU+JQ0KICAgICAgIG1hcCh+IHJlYWR4bDo6cmVhZF9leGNlbCguKSkNCmBgYA0KDQpUaGUgZWxlbWVudHMgb2YgdGhpcyBsaXN0IGFyZSBpbiB0aGUgc2FtZSBvcmRlciBhcyB0aGUgZWxlbWVudHMgb2YgdGhlIGBleGNlbF9maWxlc2AgdmVjdG9yLCBzbyB3ZSBjYW4gZXh0cmFjdCB0aGUgZGF0YSBmb3IgYSBwYXJ0aWN1bGFyIGZpbGUgKHllYXIpIGJ5IHNlbGVjdGluZyBhIGNlcnRhaW4gZWxlbWVudCBvZiB0aGUgbGlzdC4gSG93ZXZlciwgaXQgaXMgc2FmZXIgdG8gYmUgYWJsZSB0byBzZWxlY3QgdGhlIGRhdGEgZnJvbSB0aGlzIGxpc3QgZm9yIGEgc3BlY2lmaWMgeWVhciB1c2luZyBhIG5hbWUgYmFzZWQgb24gdGhlIG9yaWdpbmFsIHZlY3RvciBvZiBmaWxlIG5hbWVzLiBXZSBleHRyYWN0ZWQgYSBuYW1lIGZyb20gZWFjaCBFeGNlbCBmaWxlIG5hbWUgdXNpbmcgdGhlIGBzdHJfZXh0cmFjdCgpYCBmdW5jdGlvbiBvZiB0aGUgYHN0cmluZ3JgIHBhY2thZ2UuIEhlcmUgd2UgYXJlIGtlZXBpbmcgb2NjdXJyZW5jZXMgb2YgdGhlIGNoYXJhY3RlciBzdHJpbmcgIm55dHMyMDEiIGZvbGxvd2VkIGJ5IGEgIjUiLCAiNiIsICI3IiwgIjgiLCBvciAiOSIuDQoNCmBgYHtyfQ0KdGJsX25hbWVzIDwtIGV4Y2VsX2ZpbGVzICU+JQ0KICBzdHJfZXh0cmFjdCgibnl0czIwMVs1LTldIikNCg0KdGJsX25hbWVzDQpgYGANCg0KVGhlc2UgbmFtZXMgYmVjYW1lIHRoZSBuYW1lcyBvZiB0aGUgdGliYmxlcyBpbiB0aGUgbGlzdCBvZiB0aWJibGVzLg0KYGBge3IsIGV2YWwgPSBGQUxTRX0NCm5hbWVzKHRibF9maWxlcykgPC0gdGJsX25hbWVzDQpgYGANCg0KDQpTcGVjaWZpYyBjb2x1bW5zIHdlcmUgc2VsZWN0ZWQgdXNpbmcgdGhlIGBzZWxlY3QoKWAgZnVuY3Rpb24gb2YgYGRwbHlyYCBmcm9tIGVhY2ggb2YgdGhlIHRpYmJsZXMgdXNpbmcgdGhlIHZhcmlhYmxlIG5hbWUsIGFzIGlkZW50aWZpZWQgaW4gdGhlIGNvZGVib29rIGFzIGJlaW5nIG9mIGludGVyZXN0IGZvciBvdXIgYW5hbHlzaXMuDQpJbiBzb21lIGNhc2VzIGZ1bmN0aW9ucyBsaWtlIGBzdGFydHNfd2l0aCgpYCBvZiB0aGUgYGRwbHlyYCBwYWNrYWdlIHdlcmUgdXNlZCB0byBzZWxlY3Qgc2V2ZXJhbCB2YXJpYWJsZXMgYXQgb25jZS4gTW9zdCBvZiB0aGUgc3VydmV5IHF1ZXN0aW9ucyBhYm91dCB0b2JhY2NvIHVzZSBzdGFydCB3aXRoIGFuIGAiRSJgIG9yIGEgYCJDImAgYWNjb3JkaW5nIHRvIHRoZSBjb2RlYm9va3MuIA0KDQpgYGB7ciwgZXZhbCA9IEZBTFNFfQ0KDQp0YmxfZmlsZXNbWyJueXRzMjAxNSJdXSA8LSB0YmxfZmlsZXNbWyJueXRzMjAxNSJdXSAlPiUNCiAgICBkcGx5cjo6c2VsZWN0KHBzdSwgIyBQcmltYXJ5IFNhbXBsaW5nIFVuaXQNCiAgICAgICAgICAgICAgICAgIGZpbndndCwgIyBBbmFseXNpcyBXZWlnaHQNCiAgICAgICAgICAgICAgICAgIHN0cmF0dW0sICMgU2FtcGxpbmcgc3RyYXR1bQ0KICAgICAgICAgICAgICAgICAgUW4xLCAjIEFnZQ0KICAgICAgICAgICAgICAgICAgUW4yLCAjIFNleA0KICAgICAgICAgICAgICAgICAgUW4zLCAjIEdyYWRlDQogICAgICAgICAgICAgICAgICBzdGFydHNfd2l0aCgiRSIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZ25vcmUuY2FzZSA9IEZBTFNFKSwNCiAgICAgICAgICAgICAgICAgIHN0YXJ0c193aXRoKCJDIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlnbm9yZS5jYXNlID0gRkFMU0UpLA0KICAgICAgICAgICAgICAgICAgKQ0KDQoNCnRibF9maWxlc1tbIm55dHMyMDE2Il1dIDwtIHRibF9maWxlc1tbIm55dHMyMDE2Il1dICU+JQ0KICAgIGRwbHlyOjpzZWxlY3QocHN1LA0KICAgICAgICAgICAgICAgICAgZmlud2d0LA0KICAgICAgICAgICAgICAgICAgc3RyYXR1bSwNCiAgICAgICAgICAgICAgICAgIFExLCAjIEFnZQ0KICAgICAgICAgICAgICAgICAgUTIsICMgU2V4DQogICAgICAgICAgICAgICAgICBRMywgIyBHcmFkZQ0KICAgICAgICAgICAgICAgICAgc3RhcnRzX3dpdGgoIkUiLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWdub3JlLmNhc2UgPSBGQUxTRSksDQogICAgICAgICAgICAgICAgICBzdGFydHNfd2l0aCgiQyIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZ25vcmUuY2FzZSA9IEZBTFNFKSwNCiAgICAgICAgICAgICAgICAgIFE1MEEsICMgTWVudGhvbCAjIFdoYXQgZmxhdm9ycyBvZiB0b2JhY2NvIHByb2R1Y3RzIGhhdmUgeW91IHVzZWQgaW4gdGhlIHBhc3QgMzAgZGF5cz8gKFNlbGVjdCBvbmUgb3IgbW9yZSkNCiAgICAgICAgICAgICAgICAgIFE1MEIsICMgQ2xvdmUgb3Igc3BpY2UNCiAgICAgICAgICAgICAgICAgIFE1MEMsICMgRnJ1aXQNCiAgICAgICAgICAgICAgICAgIFE1MEQsICMgQ2hvY29sYXRlDQogICAgICAgICAgICAgICAgICBRNTBFLCAjIEFsY29ob2xpYyBEcmluaw0KICAgICAgICAgICAgICAgICAgUTUwRiwgIyBDYW5keS9EZXNzZXJ0cy9PdGhlciBTd2VldHMNCiAgICAgICAgICAgICAgICAgIFE1MEcgICMgU29tZSBPdGhlciBGbGF2b3IgTm90IExpc3RlZCBIZXJlDQogICAgICAgICAgICAgICAgICApDQoNCnRibF9maWxlc1tbIm55dHMyMDE3Il1dIDwtIHRibF9maWxlc1tbIm55dHMyMDE3Il1dICU+JQ0KICAgIGRwbHlyOjpzZWxlY3QocHN1LA0KICAgICAgICAgICAgICAgICAgZmlud2d0LA0KICAgICAgICAgICAgICAgICAgc3RyYXR1bSwNCiAgICAgICAgICAgICAgICAgIFExLCAjIEFnZQ0KICAgICAgICAgICAgICAgICAgUTIsICMgU2V4DQogICAgICAgICAgICAgICAgICBRMywgIyBHcmFkZQ0KICAgICAgICAgICAgICAgICAgc3RhcnRzX3dpdGgoIkUiLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWdub3JlLmNhc2UgPSBGQUxTRSksDQogICAgICAgICAgICAgICAgICBzdGFydHNfd2l0aCgiQyIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZ25vcmUuY2FzZSA9IEZBTFNFKSwNCiAgICAgICAgICAgICAgICAgIFE1MEEsICMgTWVudGhvbCAjIFdoYXQgZmxhdm9ycyBvZiB0b2JhY2NvIHByb2R1Y3RzIGhhdmUgeW91IHVzZWQgaW4gdGhlIHBhc3QgMzAgZGF5cz8gKFNlbGVjdCBvbmUgb3IgbW9yZSkNCiAgICAgICAgICAgICAgICAgIFE1MEIsICMgQ2xvdmUgb3Igc3BpY2UNCiAgICAgICAgICAgICAgICAgIFE1MEMsICMgRnJ1aXQNCiAgICAgICAgICAgICAgICAgIFE1MEQsICMgQ2hvY29sYXRlDQogICAgICAgICAgICAgICAgICBRNTBFLCAjIEFsY29ob2xpYyBEcmluaw0KICAgICAgICAgICAgICAgICAgUTUwRiwgIyBDYW5keS9EZXNzZXJ0cy9PdGhlciBTd2VldHMNCiAgICAgICAgICAgICAgICAgIFE1MEcgICMgU29tZSBPdGhlciBGbGF2b3IgTm90IExpc3RlZCBIZXJlDQogICAgICAgICAgICAgICAgICApDQoNCnRibF9maWxlc1tbIm55dHMyMDE4Il1dIDwtIHRibF9maWxlc1tbIm55dHMyMDE4Il1dICU+JQ0KICAgIGRwbHlyOjpzZWxlY3QocHN1LA0KICAgICAgICAgICAgICAgICAgZmlud2d0LA0KICAgICAgICAgICAgICAgICAgc3RyYXR1bSwNCiAgICAgICAgICAgICAgICAgIFExLCAjIEFnZQ0KICAgICAgICAgICAgICAgICAgUTIsICMgU2V4DQogICAgICAgICAgICAgICAgICBRMywgIyBHcmFkZQ0KICAgICAgICAgICAgICAgICAgc3RhcnRzX3dpdGgoIkUiLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWdub3JlLmNhc2UgPSBGQUxTRSksDQogICAgICAgICAgICAgICAgICBzdGFydHNfd2l0aCgiQyIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZ25vcmUuY2FzZSA9IEZBTFNFKSwNCiAgICAgICAgICAgICAgICAgIFE1MEEsICMgTWVudGhvbCAjV2hhdCBmbGF2b3JzIG9mIHRvYmFjY28gcHJvZHVjdHMgaGF2ZSB5b3UgdXNlZCBpbiB0aGUgcGFzdCAzMCBkYXlzPyAoU2VsZWN0IG9uZSBvciBtb3JlKQ0KICAgICAgICAgICAgICAgICAgUTUwQiwgIyBDbG92ZSBvciBzcGljZQ0KICAgICAgICAgICAgICAgICAgUTUwQywgIyBGcnVpdA0KICAgICAgICAgICAgICAgICAgUTUwRCwgIyBDaG9jb2xhdGUNCiAgICAgICAgICAgICAgICAgIFE1MEUsICMgQWxjb2hvbGljIERyaW5rDQogICAgICAgICAgICAgICAgICBRNTBGLCAjIENhbmR5L0Rlc3NlcnRzL090aGVyIFN3ZWV0cw0KICAgICAgICAgICAgICAgICAgUTUwRyAgIyBTb21lIE90aGVyIEZsYXZvciBOb3QgTGlzdGVkIEhlcmUNCiAgICAgICAgICAgICAgICAgICkNCg0KdGJsX2ZpbGVzW1sibnl0czIwMTkiXV0gPC0gdGJsX2ZpbGVzW1sibnl0czIwMTkiXV0gJT4lDQogICAgZHBseXI6OnNlbGVjdChwc3UsDQogICAgICAgICAgICAgICAgICBmaW53Z3QsDQogICAgICAgICAgICAgICAgICBzdHJhdHVtLA0KICAgICAgICAgICAgICAgICAgUTEsICMgQWdlDQogICAgICAgICAgICAgICAgICBRMiwgIyBTZXgNCiAgICAgICAgICAgICAgICAgIFEzLCAjIEdyYWRlDQogICAgICAgICAgICAgICAgICBzdGFydHNfd2l0aCgiRSIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZ25vcmUuY2FzZSA9IEZBTFNFKSwNCiAgICAgICAgICAgICAgICAgIHN0YXJ0c193aXRoKCJDIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlnbm9yZS5jYXNlID0gRkFMU0UpLA0KICAgICAgICAgICAgICAgICAgUTQwLCAjIEJyYW5kLCBlLWNpZ2FyZXR0ZXMNCiAgICAgICAgICAgICAgICAgIFE2MkEsICMgTWVudGhvbCAjIFdoYXQgZmxhdm9ycyBvZiB0b2JhY2NvIHByb2R1Y3RzIGhhdmUgeW91IHVzZWQgaW4gdGhlIHBhc3QgMzAgZGF5cz8gKFNlbGVjdCBvbmUgb3IgbW9yZSkNCiAgICAgICAgICAgICAgICAgIFE2MkIsICMgQ2xvdmUgb3Igc3BpY2UNCiAgICAgICAgICAgICAgICAgIFE2MkMsICMgRnJ1aXQNCiAgICAgICAgICAgICAgICAgIFE2MkQsICMgQ2hvY29sYXRlDQogICAgICAgICAgICAgICAgICBRNjJFLCAjIEFsY29ob2xpYyBEcmluaw0KICAgICAgICAgICAgICAgICAgUTYyRiwgIyBDYW5keS9EZXNzZXJ0cy9PdGhlciBTd2VldHMNCiAgICAgICAgICAgICAgICAgIFE2MkcsICMgU29tZSBPdGhlciBGbGF2b3IgTm90IExpc3RlZCBIZXJlDQogICAgICAgICAgICAgICAgICApDQpgYGANCg0KQSBkaXJlY3RvcnkgY2FsbGVkIGBkYXRhX3JlZHVjZWRgIHdhcyBjcmVhdGVkIGZvciB0aGUgbmV3IC5jc3YgZmlsZXMgdXNpbmcgdGhlIGJhc2UgYGRpci5jcmVhdGUoKWAgZnVuY3Rpb24uIA0KQSBjc3YgZmlsZSB3YXMgY3JlYXRlZCBmb3IgZWFjaCBvZiB0aGUgdGliYmxlcyBpbiB0aGUgbGlzdCB1c2luZyB0aGUgYHdyaXRlX2NzdigpYCBmdW5jdGlvbiBvZiB0aGUgYHJlYWRyYCBwYWNrYWdlLg0KVGhpcyB3YXMgZG9uZSBhbGwgYXQgb25jZSB1c2luZyB0aGUgYG1hcCgpYCBmdW5jdGlvbi4NCg0KYGBge3IsIGV2YWwgPSBGQUxTRX0NCmRpci5jcmVhdGUoImRhdGEvZGF0YV9yZWR1Y2VkIikNCg0KbmFtZXModGJsX2ZpbGVzKSAlPiUgbWFwKH4gd3JpdGVfY3N2KHRibF9maWxlc1tbLl1dLCANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXRoID0gcGFzdGUwKCJkYXRhL2RhdGFfcmVkdWNlZC8iLCAuLCAiLmNzdiIpKSkNCmBgYA0KDQo8L2RldGFpbHM+DQoNCioqKg0KDQpOb3cgd2Ugd2lsbCBzaG93IGhvdyB0byByZWFkIGluIHRoZSBkYXRhIGZyb20gdGhlIGZpdmUgY3N2IGZpbGVzIHRoYXQgd2VyZSBjcmVhdGVkIGZyb20gdGhlIGZpdmUgZGlmZmVyZW50IEV4Y2VsIGZpbGVzLg0KDQojIyMgKipSZWFkaW5nIGluIHRoZSBDU1YgZmlsZXMqKg0KKioqDQoNClVzaW5nIHRoZSBgaGVyZSgpYCBmdW5jdGlvbiBvZiB0aGUgYGhlcmVgIHBhY2thZ2UsIHdlIGxvb2tlZCBpbiBhbGwgdGhlIGRpcmVjdG9yaWVzIG9mIHRoZSBwcm9qZWN0LiBUaGUgYGhlcmVgIHBhY2thZ2UgYXV0b21hdGljYWxseSBzdGFydHMgbG9va2luZyBmb3IgZmlsZXMgYmFzZWQgb24gd2hlcmUgeW91IGhhdmUgYSBgLlJwcm9qYCBmaWxlIHdoaWNoIGlzIGNyZWF0ZWQgd2hlbiB5b3Ugc3RhcnQgYSBuZXcgUlN0dWRpbyBwcm9qZWN0Lg0KDQoqKioNCjxkZXRhaWxzPiA8c3VtbWFyeT4gQ2xpY2sgaGVyZSB0byBzZWUgbW9yZSBhYm91dCBjcmVhdGluZyBuZXcgcHJvamVjdHMgaW4gUlN0dWRpby4gPC9zdW1tYXJ5Pg0KDQpZb3UgY2FuIGNyZWF0ZSBhIHByb2plY3QgYnkgZ29pbmcgdG8gdGhlIEZpbGUgbWVudSBvZiBSU3R1ZGlvIGxpa2Ugc286DQoNCg0KYGBge3IsIGVjaG8gPSBGQUxTRSwgb3V0LndpZHRoPSI2MCUifQ0Ka25pdHI6OmluY2x1ZGVfZ3JhcGhpY3MoInd3dy9pbWcvTmV3X3Byb2plY3QucG5nIikNCmBgYA0KDQpZb3UgY2FuIGFsc28gZG8gc28gYnkgY2xpY2tpbmcgdGhlIHByb2plY3QgYnV0dG9uOg0KDQpgYGB7ciwgZWNobyA9IEZBTFNFLCBvdXQud2lkdGg9IjYwJSJ9DQprbml0cjo6aW5jbHVkZV9ncmFwaGljcygid3d3L2ltZy9wcm9qZWN0X2J1dHRvbi5wbmciKQ0KYGBgDQoNClNlZSBbaGVyZV0oaHR0cHM6Ly9zdXBwb3J0LnJzdHVkaW8uY29tL2hjL2VuLXVzL2FydGljbGVzLzIwMDUyNjIwNy1Vc2luZy1Qcm9qZWN0cyl7dGFyZ2V0PSJfYmxhbmsifSB0byBsZWFybiBtb3JlIGFib3V0IHVzaW5nIFJTdHVkaW8gcHJvamVjdHMuIA0KDQo8L2RldGFpbHM+DQoNCioqKg0KDQpUaGUgYGxpc3QuZmlsZXMoKWAgZnVuY3Rpb24gbG9va2VkIGZvciBhbGwgZmlsZXMgd2l0aCAuY3N2IHdpdGhpbiB0aGUgc3ViLWRpcmVjdG9yaWVzLg0KDQpBbGwgdGhlIGZpbGVzIHdlcmUgcmVhZCB1c2luZyBgcmVhZF9jc3YoKWAgb2YgdGhlIGByZWFkcmAgcGFja2FnZS4gVXNpbmcgdGhlIGBtYXAoKWAgZnVuY3Rpb24gb2YgdGhlIGBwdXJycmAgcGFja2FnZSB0aGlzIHdhcyBkb25lIGVmZmljaWVudGx5IGZvciBhbGwgb2YgdGhlIENTViBmaWxlcyBpbiB0aGUgdmVjdG9yIHVzaW5nIG9uZSBjb21tYW5kLiBUaGUgYC5gIGlzIHVzZWQgdG8gaW5kaWNhdGUgdGhhdCB3ZSB3YW50IHRvIGFwcGx5IHRoZSBgcmVhZF9jc3YoKWAgZnVuY3Rpb24gdG8gZWFjaCBlbGVtZW50IG9mIHRoZSBkYXRhIHRoYXQgd2UganVzdCBwaXBlZCBpbnRvIHRoZSBgbWFwKClgIGZ1bmN0aW9uLiBGb3IgbW9yZSBpbmZvcm1hdGlvbiBhYm91dCB0aGUgYG1hcCgpYCBmdW5jdGlvbiwgc2VlIFtoZXJlXShodHRwczovL3B1cnJyLnRpZHl2ZXJzZS5vcmcvcmVmZXJlbmNlL21hcC5odG1sKXt0YXJnZXQ9Il9ibGFuayJ9Lg0KDQpIZXJlIHdlIGFsc28gdXNlZCB0aGUgYCU+JWAgcGlwZSB3aGljaCBjYW4gYmUgdXNlZCB0byBwYXNzIHRoZSBpbnB1dCBmcm9tIG9uZSBmdW5jdGlvbiB0byBhbm90aGVyIGZvciBsYXRlciBzZXF1ZW50aWFsIHN0ZXBzLiANCg0KYGBge3J9DQpueXRzX2RhdGEgPC0gbGlzdC5maWxlcyhoZXJlOjpoZXJlKCksIHJlY3Vyc2l2ZSA9IFRSVUUsDQogICAgICAgICAgICAgICAgICAgICAgICBwYXR0ZXJuID0gIiouY3N2IikgJT4lDQogIG1hcCh+IHJlYWRfY3N2KC4pKQ0KDQoNCm55dHNfZGF0YV9uYW1lcyA8LSBsaXN0LmZpbGVzKHJlY3Vyc2l2ZSA9IFRSVUUsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXR0ZXJuID0gIiouY3N2IikgJT4lDQogIHN0cl9leHRyYWN0KCJueXRzMjAxWzUtOV0iKQ0KDQpuYW1lcyhueXRzX2RhdGEpIDwtIG55dHNfZGF0YV9uYW1lcw0KYGBgDQoNCg0KIyMgKipEYXRhIEV4cGxvcmF0aW9uIGFuZCBXcmFuZ2xpbmcqKg0KKioqIA0KDQpPdXIgZ29hbCBpbiB0aGlzIHNlY3Rpb24gaXMgdG8gYWRqdXN0IG9yICJ3cmFuZ2xlIiB0aGUgZGF0YSBmcm9tIGVhY2ggeWVhciBpbnRvIGEgY29tbW9uIGZvcm1hdCBzbyB0aGF0IHdlIGNhbiBjb21iaW5lIHRoZSBkYXRhc2V0cyBhY3Jvc3MgeWVhcnMgZm9yIG91ciBhbmFseXNpcywgYW5kIHNvIHRoYXQgd2UgaGF2ZSB2YWx1ZXMgaW4gb3VyIHZhcmlhYmxlcyB0aGF0IGFyZSBjb3JyZWN0IGFuZCBlYXN5IHRvIGludGVycHJldC4gV2Ugd2lsbCBuZWVkIHRvIHVuZGVyc3RhbmQgd2hhdCBpcyB0aGUgc2FtZSBhbmQgd2hhdCBpcyBkaWZmZXJlbnQgYWNyb3NzIHRoZSBkYXRhIGZyb20gZGlmZmVyZW50IHllYXJzLCByZW5hbWUgYW5kIHJlY29kZSB0aGUgdmFyaWFibGVzIChlLmcuLCBieSByZXBsYWNpbmcgdGhlIG51bWJlcnMgMSBhbmQgMiB3aXRoIHRoZSB2YWx1ZXMgIk1hbGUiIGFuZCAiRmVtYWxlIiBmb3IgdGhlIGBTZXhgIHZhcmlhYmxlKSwgYW5kIGNvbWJpbmUgdGhlIGRhdGEuIFdlIHdpbGwgd2FsayB0aHJvdWdoIHRoZXNlIHN0ZXBzIGJlbG93LiANCg0KRmlyc3QsIGxldCdzIHRha2UgYSBsb29rIGF0IG91ciBkYXRhLiBXZSBjYW4gZ2V0IGEgZ29vZCBzZW5zZSBvZiBpdCB1c2luZyB0aGUgYGdsaW1wc2UoKWAgZnVuY3Rpb24gb2YgdGhlIGBkcGx5cmAgcGFja2FnZS4NCg0KIyMjIyB7LnNjcm9sbGFibGUgfQ0KDQpgYGB7cn0NCmRwbHlyOjpnbGltcHNlKG55dHNfZGF0YVtbIm55dHMyMDE1Il1dKQ0KYGBgDQojIyMjDQoNCiMjIyAqKlVwZGF0aW5nIHRoZSBzZXQgb2YgdmFyaWFibGVzIGFuZCB0aGVpciBuYW1lcyoqDQoqKiogDQoNClRoZSBlYXNpZXN0IHdheSBvZiBtYWtpbmcgaXQgc28gdGhhdCB0aGUgZGF0YSBmcm9tIHRoZSBkaWZmZXJlbnQgeWVhcnMgY2FuIGJlIGNvbWJpbmVkIGlzIGJ5IG1ha2luZyBzdXJlIHRoYXQgdGhlIHNhbWUgdHlwZSBvZiBkYXRhIGluIGRpZmZlcmVudCBkYXRhc2V0cyBzaGFyZSB0aGUgc2FtZSBuYW1lcy4gSW4gYWRkaXRpb24sIGdpdmluZyB0aGUgY29sdW1ucyBpbmZvcm1hdGl2ZSBuYW1lcyB3aWxsIGhlbHAgbWFrZSBvdXIgY29kZSBtb3JlIHJlYWRhYmxlLiBDdXJyZW50bHksIGl0IGlzbid0IHZlcnkgY2xlYXIgd2hhdCBtb3N0IG9mIHRoZSB2YXJpYWJsZXMgaW5kaWNhdGUgc2luY2UgdGhlIHZhcmlhYmxlIG5hbWVzIGFyZSB1bmluZm9ybWF0aXZlIG9uIHRoZWlyIG93biwgd2l0aG91dCB0aGUgW2NvZGVib29rXSguL2RvY3MvMjAxOS1ueXRzLWRhdGFzZXQtYW5kLWNvZGVib29rLW1pY3Jvc29mdC1leGNlbC8yMDE5LW55dHMtY29kZWJvb2stcC5wZGYpe3RhcmdldD0iX2JsYW5rIn0uDQoNCldlIHdhbnQgdG8gcmVuYW1lIHZhcmlhYmxlcyBsaWtlIGBRbjFgIHRvIHNvbWV0aGluZyBtb3JlIG1lYW5pbmdmdWwgbGlrZSBgQWdlYC4NCg0KVG8gZG8gdGhpcyB3ZSB3aWxsIHVzZSB0aGUgYHJlbmFtZSgpYCBmdW5jdGlvbiBvZiB0aGUgYGRwbHlyYCBwYWNrYWdlLiBUaGUgbmV3IG5hbWUgaXMgYWx3YXlzIGxpc3RlZCBmaXJzdCBiZWZvcmUgdGhlIGA9YC4gVGhpcyBmdW5jdGlvbiB3aWxsIHJlcGxhY2UgdGhlIG9sZCB2YXJpYWJsZSBuYW1lcyB3aXRoIHRoZSBuZXcgb25lcywgaS5lLiwgYWZ0ZXIgcnVubmluZyB0aGUgY29kZSBiZWxvdywgdGhlcmUgd2lsbCBubyBsb25nZXIgYmUgYSBgUW4xYCB2YXJpYWJsZSBpbiB0aGUgZGF0YXNldCwgYnV0IHRoZXJlIHdpbGwgYmUgYW4gYEFnZWAgdmFyaWFibGUgaW5zdGVhZC4gV2Ugd2lsbCBzdGFydCB3b3JraW5nIHdpdGggdGhlIDIwMTUgZGF0YSwgYW5kIHRoZW4gbW92ZSBvbiB0byB0aGUgb3RoZXIgeWVhcnMgZG93biBiZWxvdy4NCg0KYGBge3J9DQpueXRzX2RhdGFbWyJueXRzMjAxNSJdXSA8LSBueXRzX2RhdGFbWyJueXRzMjAxNSJdXSAlPiUNCiAgZHBseXI6OnJlbmFtZShBZ2UgPSBRbjEsDQogICAgICAgICAgICAgICAgU2V4ID0gUW4yLA0KICAgICAgICAgICAgICAgIEdyYWRlID0gUW4zKQ0KYGBgDQoNCg0KDQpVbHRpbWF0ZWx5IHdlIHdpbGwgYmUgY29tYmluaW5nIHRoZSBkYXRhIGZyb20gZWFjaCB5ZWFyIHVzaW5nIHRoZSBgYmluZF9yb3dzKClgIGZ1bmN0aW9uIG9mIHRoZSBgZHBseXJgIHBhY2thZ2UsIHdoaWNoIHdpbGwgZmlsbCBpbiBgTkFgIHZhbHVlcyBmb3IgYW55IGNvbHVtbnMgdGhhdCBkbyBub3QgZXhpc3QgZm9yIG9uZSBvZiB0aGUgeWVhcnMuDQoNClRoZSBkYXRhIGZvciAyMDE2LTIwMTggaGF2ZSBtYW55IGNvbW1vbiBhdHRyaWJ1dGVzLCBzbyB3ZSB3aWxsIHdhbnQgdG8gd3JpdGUgY29kZSB0aGF0IGNhbiBiZSBhcHBsaWVkIHRvIGFsbCB0aHJlZSBkYXRhc2V0cy4gVG8gZG8gdGhpcywgd2Ugd2lsbCB1c2UgYSAqKmZ1bmN0aW9uKiogaW4gUiwgd2hpY2ggaXMgYmFzaWNhbGx5IGEgcGllY2Ugb2YgY29kZSB0aGF0IGNhbiBiZSBhcHBsaWVkIHRvIHNpbWlsYXIgYnV0IGRpZmZlcmVudCBvYmplY3RzIGluIFIgKGUuZy4sIHRoZSBkYXRhIHRpYmJsZXMgZnJvbSBlYWNoIG9mIHRoZXNlIHRocmVlIHllYXJzKS4gUmVjYWxsIHRoYXQgeW91IGFyZSB1c2luZyBmdW5jdGlvbnMgZnJvbSBwYWNrYWdlcyBhbGwgdGhlIHRpbWUsIGxpa2UgdGhlIGByZW5hbWUoKWAgZnVuY3Rpb24gb2YgdGhlIGBkcGx5cmAgcGFja2FnZS4gTm93IHlvdSBhcmUgZ29pbmcgdG8gd3JpdGUgeW91ciBvd24gZnVuY3Rpb24hIEZvciBtb3JlIGluZm9ybWF0aW9uIG9uIGZ1bmN0aW9ucywgc2VlIFtoZXJlXShodHRwczovL3I0ZHMuaGFkLmNvLm56L2Z1bmN0aW9ucy5odG1sKXt0YXJnZXQ9Il9ibGFuayJ9Lg0KDQpUaGVzZSBuZXh0IDMgeWVhcnMgaGF2ZSB0aGUgc2FtZSBzdHJ1Y3R1cmUgZm9yIG1hbnkgb2YgdGhlIHF1ZXN0aW9ucyB3ZSBhcmUgaW50ZXJlc3RlZCBpbi4gRm9yIGV4YW1wbGUsIHRoZXkgYWxsIGhhdmUgZmxhdm9yIHF1ZXN0aW9ucywgYnV0IG5vdCBhIGJyYW5kIHF1ZXN0aW9uLiBNb3Jlb3ZlciwgdGhlaXIgdmFyaWFibGUgbmFtZXMgYXJlIGNvbnNpc3RlbnQgYWNyb3NzIHRoZSB5ZWFyczsgZm9yIGVhY2ggeWVhciwgd2Ugd2FudCB0byByZXBsYWNlIHRoZSB2YWd1ZSBxdWVzdGlvbiBuYW1lIGBRNTBBYCB3aXRoIHRoZSB2YWx1ZSBgbWVudGhvbGAgaW4gYWxsIHRocmVlIGRhdGFzZXRzLCBhbmQgdGhlIHNhbWUgaXMgdHJ1ZSBmb3IgdGhlIG90aGVyIGZsYXZvciB2YXJpYWJsZXMuICANCg0KU2luY2Ugd2Ugd2FudCB0byBwZXJmb3JtIHRoZSBzYW1lIG1vZGlmaWNhdGlvbnMgb24gdGhlIGRhdGEgZnJvbSBhbGwgdGhyZWUgeWVhcnMsIHJhdGhlciB0aGFuIHJlcGVhdGluZyB0aGUgc2FtZSBzb21ld2hhdCBtZXNzeSBwaWVjZSBvZiBjb2RlIHRocmVlIHRpbWVzLCB3ZSBjYW4gZG8gdGhpcyBtb3JlIGVmZmljaWVudGx5IGlmIHdlIGNyZWF0ZSBhIGZ1bmN0aW9uIHRvIGRvIGFsbCBvZiB0aGVzZSBzdGVwcyBhdCBvbmNlLiBUaGVuIHdlIGNhbiB1c2UgdGhlIGBtYXBfYXQoKWAgZnVuY3Rpb24gb2YgdGhlIGBwdXJycmAgcGFja2FnZSwgd2hpY2ggaXMgYW4gZXh0ZW5zaW9uIG9mIHRoZSBgbWFwKClgIGZ1bmN0aW9uIHRoYXQgd2UgdXNlZCBpbiB0aGUgW0RhdGEgSW1wb3J0XSAoaHR0cHM6Ly93d3cub3BlbmNhc2VzdHVkaWVzLm9yZy9vY3MtYnAtdmFwaW5nLWNhc2Utc3R1ZHkvI0RhdGFfSW1wb3J0KXt0YXJnZXQ9Il9ibGFuayJ9IHNlY3Rpb24gdG8gYXBwbHkgdGhlIGZ1bmN0aW9uIHdlIGp1c3QgY3JlYXRlZCAoZm9yIHJlbmFtaW5nIHZhcmlhYmxlcyBldGMuKSBzcGVjaWZpY2FsbHkgdG8gdGhlIGRhdGEgZnJvbSAyMDE2LTIwMTggd2l0aGluIHRoZSBgbnl0c19kYXRhYC4gQnkgdXNpbmcgYHZhcnMoKWAgaW5zaWRlIG9mIHRoZSBgbWFwX2F0KClgIGZ1bmN0aW9uIHdlIGNhbiBzcGVjaWZ5IHdoYXQgdGliYmxlcyB3aXRoaW4gb3VyIGBueXRzX2RhdGFgIGxpc3Qgd2Ugd2FudCB0byBpbmNsdWRlIG9yIGV4Y2x1ZGUuIA0KDQoNCiMjIyMgKipGdW5jdGlvbnMqKg0KKioqIA0KDQpTbyBob3cgZG8geW91IGNyZWF0ZSBhIGZ1bmN0aW9uPw0KWW91IGZpcnN0IG5lZWQgdG8gc3BlY2lmeSB0aGF0IHlvdSBhcmUgY3JlYXRpbmcgYSBmdW5jdGlvbiBieSB1c2luZyB0aGUgYGZ1bmN0aW9uKClgIGJhc2UgZnVuY3Rpb24uDQpZZXMsIHRoYXQncyByaWdodCBpdCBpcyBhIGZ1bmN0aW9uIGZvciBjcmVhdGluZyBmdW5jdGlvbnMgY2FsbGVkIGZ1bmN0aW9uIQ0KDQpGaXJzdCB3ZSBzcGVjaWZ5IG91ciBpbnB1dCB3aXRoaW4gdGhlIHBhcmVudGhlc2VzIG9mIGBmdW5jdGlvbigpYC4gVGh1cyBpZiBvdXIgZnVuY3Rpb24gd2lsbCBhcHBseSBzb21ldGhpbmcgdG8gYW4gaW5wdXQgY2FsbGVkIGB4YCB0aGVuIHdlIHdvdWxkIHVzZSBgZnVuY3Rpb24oeClgLiBUaGVvcmV0aWNhbGx5IG91ciBpbnB1dCBjYW4gYmUgbmFtZWQgd2hhdGV2ZXIgd2Ugd2FudCwgYnV0IHdlIHdlIG5lZWQgdG8gcmVmZXIgdG8gaXQgY29uc2lzdGVudGx5IHdpdGhpbiBvdXIgZnVuY3Rpb24gdG8gaW5kaWNhdGUgd2hhdCB3ZSB3YW50IGRvbmUgd2l0aCB0aGUgaW5wdXQgZGF0YS4gV2UgY2FuIGFjdHVhbGx5IGhhdmUgbW9yZSB0aGFuIG9uZSBpbnB1dCBhcyB3ZWxsLCB3ZSB3b3VsZCBpbmRpY2F0ZSB0d28gaW5wdXRzIGxpa2UgdGhpczogYGZ1bmN0aW9uKHgsIGIpYC4gSGVyZSB3ZSB3b3VsZCBiZSB1c2luZyBib3RoIGB4YCBhbmQgYGJgIHRvIGRvIHNvbWV0aGluZyBpbiBvdXIgZnVuY3Rpb24uDQoNClRoZSBuZXh0IHBhcnQgb2YgYSBmdW5jdGlvbiBpcyBkZWZpbmVkIHdpdGhpbiBjdXJseSBicmFja2V0cyBge31gLiBUaGlzIGlzIHdoZXJlIHdlIHdyaXRlIHdoYXQgd2Ugd2FudCBkb25lIHRvIG91ciBpbnB1dHMuDQoNCioqKg0KDQo8ZGV0YWlscz4gPHN1bW1hcnk+IENsaWNrIGhlcmUgdG8gc2VlIGEgc2ltcGxlIGV4YW1wbGUgPC9zdW1tYXJ5PiANCg0KT3VyIGZ1bmN0aW9uIHdpbGwgYmUgY2FsbGVkIGBzaW1wbGVfZnVuY3Rpb25gLCB3aGljaCB3aWxsIGFkZCAyIHRvIG91ciBpbnB1dC4gSXQgd2lsbCB0YWtlIHRoZSBpbnB1dCBgdmVjdG9yX2RhdGFgIChub3RlIHRoYXQgd2UgdXN1YWxseSB3YW50IHRvIHVzZSBhbiBpbmZvcm1hdGl2ZSBpbnB1dCBhcmd1bWVudCBsaWtlIGB2ZWN0b3JfZGF0YWApLiANCg0KYGBge3J9DQpzaW1wbGVfZnVuY3Rpb24gPC0gZnVuY3Rpb24odmVjdG9yX2RhdGEpIHsNCiAgdmVjdG9yX2RhdGEgKyAyDQp9DQpgYGANCg0KV2UgY2FuIHVzZSBhbiBpbnB1dCB0aGF0IGlzIGEgdmVjdG9yIGNhbGxlZCBgeGAuDQoNCmBgYHtyfQ0KeCA9IGMoMSwgMiwgMywgNCkNCngNCmBgYA0KDQpOb3cgd2Ugc3BlY2lmeSB1c2luZyB0aGUgYXJndW1lbnQgYCB2ZWN0b3JfZGF0YSA9YCB0byBpbmRpY2F0ZSB0aGF0IGB4YCBpcyBvdXIgaW5wdXQgdGhhdCB3ZSB3YW50IHRvIHBlcmZvcm0gdGhlIGZ1bmN0aW9uIG9uLg0KDQpgYGB7cn0NCnNpbXBsZV9mdW5jdGlvbih2ZWN0b3JfZGF0YSA9IHgpDQpgYGANCg0KVGhpcyBmdW5jdGlvbiBhbHNvIHdvcmtzIGZvciBvdGhlciB2ZWN0b3IgaW5wdXQuIEZvciBleGFtcGxlLCB2ZWN0b3IgYHlgIGlzIG5vdyBvdXIgaW5wdXQgdGhhdCB3ZSB3YW50IHRvIHBlcmZvcm0gdGhlIGZ1bmN0aW9uIG9uLg0KDQpgYGB7cn0NCnkgPSBjKDUsIDEwLCAxNSwgMjApDQoNCnNpbXBsZV9mdW5jdGlvbih2ZWN0b3JfZGF0YSA9IHkpDQpgYGANCg0KPC9kZXRhaWxzPg0KDQoqKioNCg0KSW4gb3VyIGNhc2Ugd2Ugd2lsbCBiZSBhcHBseWluZyBvdXIgZnVuY3Rpb24gdG8gdGhlIHZhcmlhYmxlIG5hbWVzIGZvciB0aGUgZGF0YXNldCBmb3IgZWFjaCB5ZWFyLiBUaGUgb3V0cHV0IG9mIG91ciBmdW5jdGlvbiBpcyB0aGUgcmVzdWx0IG9mIHJlbmFtaW5nIHRoZXNlIHZhcmlhYmxlcyBmb3IgZWFjaCB5ZWFyLiANCg0KYGBge3J9DQoNCnVwZGF0ZV9zdXJ2ZXkgPC0gZnVuY3Rpb24oZGF0YXNldCkgeyBkYXRhc2V0ICU+JQ0KICAgICAgICAgICByZW5hbWUoQWdlID0gUTEsDQogICAgICAgICAgICAgICAgICBTZXggPSBRMiwNCiAgICAgICAgICAgICAgICBHcmFkZSA9IFEzLA0KICAgICAgICAgICAgICBtZW50aG9sID0gUTUwQSwNCiAgICAgICAgICBjbG92ZV9zcGljZSA9IFE1MEIsDQogICAgICAgICAgICAgICAgZnJ1aXQgPSBRNTBDLA0KICAgICAgICAgICAgY2hvY29sYXRlID0gUTUwRCwNCiAgICAgIGFsY29ob2xpY19kcmluayA9IFE1MEUsDQogY2FuZHlfZGVzc2VydF9zd2VldHMgPSBRNTBGLA0KICAgICAgICAgICAgICAgIG90aGVyID0gUTUwRykNCn0NCg0KIyBvcHRpb25zIHRvIGFwcGx5IHRoZSBmdW5jdGlvbiB0byB0aGUgZGF0YToNCiMgbnl0c19kYXRhIDwtIG55dHNfZGF0YSAlPiUgbWFwX2F0KHZhcnMobnl0czIwMTYsIG55dHMyMDE3LCBueXRzMjAxOCksIFVwZGF0ZV9zdXJ2ZXkpDQpueXRzX2RhdGEgPC0gbnl0c19kYXRhICU+JSBtYXBfYXQodmFycygtbnl0czIwMTUsIC1ueXRzMjAxOSksIHVwZGF0ZV9zdXJ2ZXkpDQpgYGANCg0KVGhlIGZpbmFsIHllYXIsIDIwMTksIGhhcyBhIHNsaWdodGx5IGRpZmZlcmVudCBkYXRhIHN0cnVjdHVyZSBjb21wYXJlZCB0byB0aGVzZSBlYXJsaWVyIGRhdGFzZXRzLiBJdCBhY3R1YWxseSBoYXMgYSBgYnJhbmRfZWNpZ2AgdmFyaWFibGUgYWxyZWFkeSBhbmQgZGlmZmVyZW50IHF1ZXN0aW9uIG51bWJlcnMgY29ycmVzcG9uZCB0byBvdXIgZmxhdm9yIHF1ZXN0aW9ucyBvZiBpbnRlcmVzdC4gU28gd2Ugd2lsbCByZW5hbWUgdGhlIHZhcmlhYmxlcyBpbiB0aGlzIGRhdGFzZXQgaW5kaXZpZHVhbGx5LiBXZSBjb3VsZCBhbHNvIHdyaXRlIHRoaXMgYXMgYSBmdW5jdGlvbiwgYnV0IHNpbmNlIHdlIGFyZSBvbmx5IGFwcGx5aW5nIHRoaXMgb25lIHRpbWUsIHRoZXJlIGlzIG5vIG5lZWQgdG8uIEZ1bmN0aW9ucyBhcmUgcmVhbGx5IGhlbHBmdWwgZm9yIHJlcGVhdGluZyB0aGUgc2FtZSB0YXNrIHJlcGVhdGVkbHkgdXNpbmcgZGlmZmVyZW50IGRhdGEgaW5wdXRzLg0KDQpgYGB7cn0NCm55dHNfZGF0YVtbIm55dHMyMDE5Il1dIDwtIG55dHNfZGF0YVtbIm55dHMyMDE5Il1dICU+JQ0KICAgIHJlbmFtZShicmFuZF9lY2lnID0gUTQwLA0KICAgICAgICAgICAgICAgICAgQWdlID0gUTEsDQogICAgICAgICAgICAgICAgICBTZXggPSBRMiwNCiAgICAgICAgICAgICAgICBHcmFkZSA9IFEzLA0KICAgICAgICAgICAgICBtZW50aG9sID0gUTYyQSwNCiAgICAgICAgICBjbG92ZV9zcGljZSA9IFE2MkIsDQogICAgICAgICAgICAgICAgZnJ1aXQgPSBRNjJDLA0KICAgICAgICAgICAgY2hvY29sYXRlID0gUTYyRCwNCiAgICAgIGFsY29ob2xpY19kcmluayA9IFE2MkUsDQogY2FuZHlfZGVzc2VydF9zd2VldHMgPSBRNjJGLA0KICAgICAgICAgICAgICAgIG90aGVyID0gUTYyRykNCmBgYA0KDQoNCk5vdyBsZXQncyB0YWtlIGEgbG9vayBhdCB0aGUgdmFyaWFibGUgbmFtZXMgZm9yIGVhY2ggb2YgdGhlIHllYXJzIHVzaW5nIHRoZSBgbWFwYCBmdW5jdGlvbiBmcm9tIGBwdXJycmAuDQoNCiMjIyMgey5zY3JvbGxhYmxlIH0NCg0KYGBge3J9DQptYXAobnl0c19kYXRhLCBuYW1lcykNCmBgYA0KIyMjIw0KDQpJdCdzIGxvb2tpbmcgYmV0dGVyISBUaGUgZGF0YSB0aGF0IG92ZXJsYXAgYWNyb3NzIHllYXJzIGhhdmUgdGhlIHNhbWUgdmFyaWFibGUgbmFtZXMuDQoNCiMjIyAqKlVwZGF0aW5nIFZhbHVlcyoqDQoqKioNCk5vdyB0aGF0IHdlIGhhdmUgbWFkZSBzb21lIHByb2dyZXNzIG9uIHRoZSBzZWxlY3Rpb24gYW5kIG5hbWVzIG9mIHRoZSB2YXJpYWJsZXMgdGhlbXNlbHZlcywgd2Ugd2lsbCB3b3JrIG9uIHRoZSB2YWx1ZXMgY29udGFpbmVkIGluIHRoZSBkaWZmZXJlbnQgdmFyaWFibGVzLg0KDQpXZSBjYW4gc3RhcnQgd2l0aCB1cGRhdGluZyB0aGUgdmFsdWVzIGZvciBgQWdlYCBhbmQgYEdyYWRlYCwgc28gdGhhdCB0aGV5IGFyZSBtb3JlIHVuZGVyc3RhbmRhYmxlLiANCg0KUmVjYWxsIGZyb20gdGhlIGNvZGVib29rIGZvciB0aGlzIHllYXIncyBkYXRhc2V0IHRoYXQgYEFnZWAgaXNuJ3QgbGlzdGVkIGluIHRoZSB3YXkgb25lIG1pZ2h0IGV4cGVjdCwgaS5lLiwgaXQgaXMgbm90IGp1c3QgYSBudW1iZXIgb2YgeWVhcnMsIGJ1dCBhIG51bWVyaWNhbGx5IHZhbHVlZCBjYXRlZ29yaWNhbCB2YXJpYWJsZS4NCg0KYGBge3IsIGVjaG8gPSBGQUxTRSwgZmlnLmFsaWduID0iY2VudGVyIiwgb3V0LndpZHRoID0gIjYwMCBweCJ9DQoNCmtuaXRyOjppbmNsdWRlX2dyYXBoaWNzKCJ3d3cvaW1nL3FuMS5wbmciKQ0KYGBgDQoNClRoZSBzYW1lIGlzIHRydWUgZm9yIGBHcmFkZWA6DQoNCmBgYHtyLCBlY2hvID0gRkFMU0UsIGZpZy5hbGlnbiA9ImNlbnRlciIsIG91dC53aWR0aCA9ICI2MDAgcHgifQ0KDQprbml0cjo6aW5jbHVkZV9ncmFwaGljcygid3d3L2ltZy9ncmFkZS5wbmciKQ0KYGBgDQoNCioqVGhpcyBpcyB3aHkgaXQgaXMgc28gaW1wb3J0YW50IHRvIGFsd2F5cyBjaGVjayB0aGUgY29kZWJvb2shISoqDQoNCldlIGFsc28gIHdhbnQgdG8gcmVwbGFjZSB0aGUgdmFsdWUgb2YgYDE5YCBmb3IgYEFnZWAgdG8gYmUgYCI+MTgiYCBhbmQgdGhlIHZhbHVlIG9mIGAxM2AgZm9yIGBHcmFkZWAgdG8gYmUgcmVwbGFjZWQgd2l0aCBgIlVuZ3JhZGVkL090aGVyImAgQWxzbyBhY2NvcmRpbmcgdG8gdGhlIGNvZGVib29rcywgbnVtZXJpYyB2YWx1ZXMgb2YgYDFgIGluZGljYXRlIGEgc3VydmV5IGFuc3dlciBvZiBgRkFMU0VgLCB3aGlsZSBhIHZhbHVlIG9mIGAyYCBpbmRpY2F0ZXMgYFRSVUVgLiBgU2V4YCBhbHNvIG5lZWRzIHRvIGJlIHJlY29kZWQuIElmIHdlIHRha2UgYSBsb29rIGF0IHRoZSBjb2RlYm9va3MgY2FyZWZ1bGx5IChtYWtlIHN1cmUgeW91IGxvb2sgYXQgdGhlIHF1ZXN0aW9ucyB0aGF0IHdlIHB1bGxlZCwgbm90IHRoZSByZWNvZGVkIHZhbHVlcyksIHdlIHdpbGwgc2VlIHRoYXQgbWFsZXMgYXJlIGluZGljYXRlZCBieSBgMWAgYW5kIGZlbWFsZXMgYXJlIGluZGljYXRlZCBieSBgMmAuIEZpbmFsbHkgc29tZSB2YWx1ZXMgYXJlIGluZGljYXRlZCB3aXRoIGAiKiJgIG9yYCIqKiJgIHdoZW4gdGhleSBhcmUgbWlzc2luZy4gV2Ugd2FudCB0byByZXBsYWNlIHRoZXNlIHdpdGggYE5BYC4NCg0KTGV0J3MgY3JlYXRlIGEgZnVuY3Rpb24gdG8gbWFrZSBhbGwgdGhlc2UgdXBkYXRlcy4gV2Ugd2lsbCB1c2UgdGhlIGBtdXRhdGVgIGZ1bmN0aW9uIG9mIHRoZSBgZHBseXJgIHBhY2thZ2UgdG8gbW9kaWZ5IHRoZXNlIHZhcmlhYmxlcy4gVGhpcyBmdW5jdGlvbiBjYW4gYWxzbyBiZSB1c2VkIHRvIGNyZWF0ZSBuZXcgdmFyaWFibGVzLiBXZSB3aWxsIGFsc28gdXNlIHRoZSAgYHJlY29kZSgpYCBmdW5jdGlvbiBvZiB0aGUgYGRwbHlyYCBwYWNrYWdlIHRvIHJlcGxhY2Ugc3BlY2lmaWMgdmFsdWVzIG9mIGNlcnRhaW4gdmFyaWFibGVzLg0KDQpgYGB7cn0NCnVwZGF0ZV92YWx1ZXMgPC0gZnVuY3Rpb24oZGF0YXNldCkgew0KICBkYXRhc2V0ICU+JQ0KICAgIGRwbHlyOjptdXRhdGUoQWdlID0gYXMubnVtZXJpYyhBZ2UpICsgOCwNCiAgICAgICAgICAgICAgICAgIEdyYWRlID0gYXMubnVtZXJpYyhHcmFkZSkgKyA1KSAlPiUNCiAgICBtdXRhdGUoQWdlID0gYXMuZmFjdG9yKEFnZSksDQogICAgICAgICAgIEdyYWRlID0gYXMuZmFjdG9yKEdyYWRlKSwNCiAgICAgICAgICAgU2V4ID0gYXMuZmFjdG9yKFNleCkpICU+JQ0KICAgIG11dGF0ZShTZXggPSByZWNvZGUoU2V4LA0KICAgICAgICAgICAgICAgICAgICAgICAgYDFgID0gIm1hbGUiLA0KICAgICAgICAgICAgICAgICAgICAgICAgYDJgID0gImZlbWFsZSIpKSAlPiUNCiAgICBkcGx5cjo6bXV0YXRlX2FsbCggfiByZXBsYWNlKC4sIC4gJWluJSBjKCIqIiwgIioqIiksIE5BKSkgJT4lDQogICAgbXV0YXRlKEFnZSA9IHJlY29kZShBZ2UsDQogICAgICAgICAgICAgICAgICAgICAgICBgMTlgID0gIj4xOCIpLA0KICAgICAgICAgICBHcmFkZSA9IHJlY29kZShHcmFkZSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgYDEzYCA9ICJVbmdyYWRlZC9PdGhlciIpKSAlPiUNCiAgICBkcGx5cjo6bXV0YXRlX2F0KHZhcnMoDQogICAgICBzdGFydHNfd2l0aCgiRSIsIGlnbm9yZS5jYXNlID0gRkFMU0UpLA0KICAgICAgc3RhcnRzX3dpdGgoIkMiLCBpZ25vcmUuY2FzZSA9IEZBTFNFKQ0KICAgICksDQogICAgbGlzdCggfiByZWNvZGUoDQogICAgICAuLA0KICAgICAgYDFgID0gVFJVRSwNCiAgICAgIGAyYCA9IEZBTFNFLA0KICAgICAgLmRlZmF1bHQgPSBOQSwNCiAgICAgIC5taXNzaW5nID0gTkENCiAgICApKSkNCn0NCg0Kbnl0c19kYXRhIDwtIG55dHNfZGF0YSAlPiUgbWFwKC4sIHVwZGF0ZV92YWx1ZXMpDQpgYGANCg0KDQpOb3cgaWYgd2Ugd2FudGVkIHRvIGNoZWNrIHRoYXQgZXZlcnl0aGluZyBpcyBleHBlY3RlZCB3ZSBjb3VsZCBkbyBzb21ldGhpbmcgbGlrZSB0aGlzIHRvIGNoZWNrIHRoZSBgU2V4YCB2YXJpYWJsZSB1c2luZyB0aGUgYGNvdW50KClgIGZ1bmN0aW9uIG9mIHRoZSBgZHBseXJgIHBhY2thZ2UuIEl0IGlzIGFkdmlzYWJsZSB0byBjaGVjayB5b3VyIGRhdGEgZnJlcXVlbnRseSB0byBtYWtlIHN1cmUgdGhhdCBpdCBpcyBhcyBleHBlY3RlZCENCg0KQWNjb3JkaW5nIHRvIHRoZSBjb2RlYm9vaywgd2Ugc2hvdWxkIGhhdmU6ICANCg0KMSkgOCw5NTggbWFsZXMgaW4gMjAxNSAgDQoyKSAxMCw0MzggbWFsZXMgaW4gMjAxNiAgDQozKSA4LDg4MSBtYWxlcyBpbiAyMDE3ICANCjQpIDEwLDA2OSBtYWxlcyBpbiAyMDE4ICANCjUpIDksODAzIG1hbGVzIGluIDIwMTkgICANCg0KYGBge3J9DQpjb3VudF9zZXggPC0gZnVuY3Rpb24oZGF0YXNldCkge2RhdGFzZXQgJT4lIGNvdW50KFNleCl9DQpueXRzX2RhdGEgJT4lIG1hcCguLCBjb3VudF9zZXgpDQpgYGANCg0KDQpMb29rcyBnb29kIQ0KDQpUaGUgeWVhcnMgKDIwMTYtMjAxOSkgdGhhdCBoYXZlIGZsYXZvcnMgYWxzbyBuZWVkIHRoZSBmbGF2b3IgZGF0YSB0byBiZSBsb2dpY2FsIChtZWFuaW5nIFRSVUUgb3IgRkFMU0UpOg0KDQpJbiB0aGlzIGNhc2Ugd2UgYWxzbyBhcmUgc2V0dGluZyBtaXNzaW5nIHZhbHVlcyB0byBgRkFMU0VgIGJlY2F1c2UgdGhlbiB0aGUgYFRSVUVgIHZhbHVlcyB3aWxsIHJlcHJlc2VudCB0aG9zZSB3aG8gcmVwb3J0ZWQgdXNpbmcgYSBzcGVjaWZpYyBmbGF2b3Igb3V0IG9mIGFsbCB1c2VycywgcmF0aGVyIHRoYW4gdGhvc2UgdGhhdCB1c2VkIGEgc3BlY2lmaWMgZmxhdm9yIGNvbXBhcmVkIHRvIHRob3NlIHdobyB1c2VkIGEgZGlmZmVyZW50IGZsYXZvci4NCg0KDQpgYGB7cn0NCnVwZGF0ZV9mbGF2b3JzIDwtIGZ1bmN0aW9uKGRhdGFzZXQpIHtkYXRhc2V0ICU+JQ0KICAgbXV0YXRlX2F0KHZhcnMobWVudGhvbDpvdGhlciksDQogICAgICAgICAgICAgIGxpc3QofiByZWNvZGUoLiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgIGAxYCA9IFRSVUUsDQogICAgICAgICAgICAgICAgICAgICAgLmRlZmF1bHQgPSBGQUxTRSwNCiAgICAgICAgICAgICAgICAgICAgICAubWlzc2luZyA9IEZBTFNFKSkpIH0NCg0Kbnl0c19kYXRhICA8LSBueXRzX2RhdGEgICU+JSBtYXBfYXQodmFycygtbnl0czIwMTUpLCB1cGRhdGVfZmxhdm9ycykNCmBgYA0KDQoNCk5vdyB0aGVyZSBhcmUganVzdCBhIGZldyBjaGFuZ2VzIG5lZWRlZCB0aGF0IGFyZSBzcGVjaWZpYyB0byAyMDE5LiBTcGVjaWZpY2FsbHksIHNvbWUgb2YgdGhlIDIwMTkgcXVlc3Rpb25zIHVzZSB0aGUgdmFsdWVzICIuTiIsICIuUyIsIGFuZCAiLloiIHRvIGluZGljYXRlIGRpZmZlcmVudCB0eXBlcyBvZiBtaXNzaW5nIGRhdGEgKHNlZSBmb3IgZXhhbXBsZSBRMiBvZiB0aGUgMjAxOSBbY29kZWJvb2tdKC4vZG9jcy8yMDE5LW55dHMtZGF0YXNldC1hbmQtY29kZWJvb2stbWljcm9zb2Z0LWV4Y2VsLzIwMTktbnl0cy1jb2RlYm9vay1wLnBkZil7dGFyZ2V0PSJfYmxhbmsifSk7IHdlIGp1c3Qgd2FudCB0aGVtIHRvIGJlIHJlcGxhY2VkIHdpdGggYE5BYCB2YWx1ZXMuDQoNCg0KYGBge3J9DQpueXRzX2RhdGFbWyJueXRzMjAxOSJdXSA8LSBueXRzX2RhdGFbWyJueXRzMjAxOSJdXSAlPiUNCiAgbXV0YXRlX2FsbCh+IHJlcGxhY2UoLiwgLiAlaW4lIGMoIi5OIiwgIi5TIiwgIi5aIiksIE5BKSkgJT4lDQogIG11dGF0ZShwc3UgPSBhcy5jaGFyYWN0ZXIocHN1KSkgJT4lDQogIG11dGF0ZShicmFuZF9lY2lnID0gcmVjb2RlKGJyYW5kX2VjaWcsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBgMWAgPSAiT3RoZXIiLCAjIGxldmVscyAxLDggY29tYmluZWQgdG8gYE90aGVyYA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYDJgID0gIkJsdSIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBgM2AgPSAiSlVVTCIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBgNGAgPSAiTG9naWMiLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYDVgID0gIk1hcmtUZW4iLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYDZgID0gIk5KT1kiLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYDdgID0gIlZ1c2UiLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYDhgID0gIk90aGVyIikpDQpgYGANCg0KR3JlYXQhIE5vdyBvdXIgdmFsdWVzIGRvbid0IG5lZWQgdG8gYmUgaGFuZGxlZCBhbnkgZGlmZmVyZW50bHkgZm9yIGFueSBvZiB0aGUgeWVhcnMsIHRodXMgd2UgY2FuIGNvbWJpbmUgdGhlIGRhdGEgYWNyb3NzIHllYXJzLg0KDQpFdmVuIHRob3VnaCB3ZSBoYXZlIGRpZmZlcmVudCBudW1iZXJzIG9mIHZhcmlhYmxlcyBmb3IgZWFjaCB5ZWFyLCB3ZSBjYW4gY29lcmNlIHRoZSBkYXRhIHRvIGJlIGNvbWJpbmVkIGludG8gb25lIHRpYmJsZSBieSB1c2luZyB0aGUgYGJpbmRfcm93cygpYCBmdW5jdGlvbiBvZiBgZHBseXJgLiBJbXBvcnRhbnRseSwgdGhpcyBmdW5jdGlvbiBkb2VzIG5vdCByZXF1aXJlIHRoYXQgdGhlIGNvbHVtbnMgYmUgdGhlIHNhbWUuICBUaGlzIHdpbGwgY3JlYXRlIE5BIHZhbHVlcyBmb3IgYW55IHZhcmlhYmxlIHRoYXQgaXMgbm90IHByZXNlbnQgaW4gZ2l2ZW4gZGF0YSBmcmFtZSBidXQgaXMgIHByZXNlbnQgaW4gb25lIG9mIHRoZSBvdGhlciBkYXRhIGZyYW1lcyB0aGF0IGlzIGJlaW5nIGNvbWJpbmVkLiBOb3RlIHRoYXQgdGhlIGBiaW5kX2NvbHMoKWAgZnVuY3Rpb24gZG9lcyBleHBlY3QgdGhhdCB0aGUgcm93cyBtYXRjaC4gVGhlIGAuaWRgIGFyZ3VtZW50IHdpbGwgY3JlYXRlIGEgbmV3IHZhcmlhYmxlIHdpdGggdmFsdWVzIHRvIGxpbmsgZWFjaCByb3cgdG8gaXRzIG9yaWdpbmFsIGRhdGEgZnJhbWUuIEZvciBtb3JlIGluZm9ybWF0aW9uIHNlZSBbaGVyZV0oaHR0cHM6Ly9kcGx5ci50aWR5dmVyc2Uub3JnL3JlZmVyZW5jZS9iaW5kLmh0bWwpLg0KDQoNCmBgYHtyfQ0Kbnl0c19kYXRhIDwtIG55dHNfZGF0YSAlPiUNCiAgbWFwX2RmKGRwbHlyOjpiaW5kX3Jvd3MsIC5pZCA9ICJ5ZWFyIikNCg0KZ2xpbXBzZShueXRzX2RhdGEpDQpgYGANCg0KV2Ugd2lsbCB3YW50IHRvIGRvIHNvbWUgb2Ygb3VyIGFuYWx5c2lzIHNwbGl0IGJ5IHllYXIsIHNvIHdlIHdvdWxkIGxpa2UgdG8gYmUgc3VyZSB3ZSBoYXZlIG9uZSB2YXJpYWJsZSB0aGF0IGhhcyB0aGUgY29ycmVjdCB2YWx1ZSBmb3IgeWVhci4gSXQgbG9va3MgbGlrZSB3ZSBqdXN0IG5lZWQgdG8gcmVtb3ZlIGAibnl0cyJgIGZyb20gdGhlIHllYXIgdmFyaWFibGUgdGhhdCB3ZSBjcmVhdGVkIGZyb20gdGhlIG5hbWVzIG9mIHRoZSB0aWJibGVzIGluIG91ciBsaXN0IGFuZCB3ZSBzaG91bGQgYmUgYWxsIHNldC4gV2Ugd2lsbCB1c2UgYW5vdGhlciBmdW5jdGlvbiBmcm9tIHRoZSBgc3RyaW5ncmAgcGFja2FnZSB0byBkbyB0aGlzLiBUaGUgYHN0cl9yZW1vdmUoKWAgZnVuY3Rpb24gdGFrZXMgYSBzdHJpbmcgZm9sbG93ZWQgYnkgYSBwYXR0ZXJuIGFuZCByZW1vdmVzIHRoZSBwYXR0ZXJuIGZyb20gdGhlIHN0cmluZy4NCg0KYGBge3J9DQpueXRzX2RhdGEgPC0gbnl0c19kYXRhICU+JQ0KICBtdXRhdGUoeWVhciA9IGFzLm51bWVyaWMoc3RyX3JlbW92ZSh5ZWFyLCAibnl0cyIpKSkNCmBgYA0KDQpIZXJlIGlzIG91ciBjbGVhbiBhbmQgd3JhbmdsZWQgZGF0YToNCg0KIyMjIyB7LnNjcm9sbGFibGV9DQpgYGB7cn0NCmdsaW1wc2Uobnl0c19kYXRhKQ0KDQpgYGANCg0KIyMjIw0KDQoNCk5vdGUgdGhhdCB0aGVyZSBhcmUgc2V2ZXJhbCB2YXJpYWJsZXMgd2hlcmUgdGhlcmUgYXJlIHNpbWlsYXIgbmFtZXMsIGJ1dCB3aXRoIGEgYENgIGNvbXBhcmVkIHRvIGFuIGBFYCBpbiB0aGUgdmFyaWFibGUgbmFtZS4gVGhvc2Ugc3RhcnRpbmcgd2l0aCBgQ2AgYXJlIHJlbGF0ZWQgdG8gcXVlc3Rpb25zIGFib3V0IGN1cnJlbnQgdXNhZ2UgKGxhc3QgMzAgZGF5cyksIHdoaWxlIHRob3NlIHdpdGggYW4gYEVgIGFyZSByZWxhdGVkIHRvIHVzYWdlIGFjcm9zcyB0aGUgc3R1ZGVudCByZXNwb25kZW50J3Mgd2hvbGUgbGlmZSAoImV2ZXIiIHVzYWdlKS4gV2Ugd2lsbCBkaXNjdXNzIHRoZXNlIGdyb3VwcyBmdXJ0aGVyIGJlbG93Lg0KDQpgYGB7ciwgZWNobyA9IEZBTFNFLCBldmFsID0gRkFMU0V9DQpzYXZlKG55dHNfZGF0YSwgZmlsZSA9IGhlcmU6OmhlcmUoImRhdGEiLCAid3JhbmdsZWRfZGF0YS5yZGEiKSkNCmBgYA0KDQoNCiMjIyAqKlZhcmlhYmxlIFRhYmxlKioNCioqKg0KPGRldGFpbHM+PHN1bW1hcnk+IENsaWNrIGhlcmUgdG8gc2VlIGEgdGFibGUgYWJvdXQgdGhlIGZpbmFsIHZhcmlhYmxlcyBpbiBvdXIgZGF0YSBzZXQuIDwvc3VtbWFyeT4NCg0KDQpWYXJpYWJsZSAgIHwgRGV0YWlscyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIA0KLS0tLS0tLS0tLSB8LS0tLS0tLS0tLS0tLQ0KKip5ZWFyKiogIHwgdGhlIHllYXIgdGhhdCB0aGUgc3VydmV5IHJlc3VsdHMgZnJvbSBhIHBhcnRpY3VsYXIgc3R1ZGVudCByZXNwb25kZW50IHdlcmUgYWNxdWlyZWQgIA0KKipwc3UqKiB8IHRoZSBwcmltYXJ5IHNhbXBsaW5nIHVuaXQgZm9yIHRoZSBzdXJ2ZXkgd2VpZ2h0aW5nICANCioqZmlud2d0KiogfCB0aGUgZmluYWwgYW5hbHlzaXMgd2VpZ2h0IGZvciB0aGUgc3VydmV5IHdlaWdodGluZyAgDQoqKnN0cmF0dW0qKiB8IHRoZSBzdHJhdHVtIHVzZWQgZm9yIHZhcmlhbmNlIGVzdGltYXRpb24gZm9yIHRoZSBzdXJ2ZXkgd2VpZ2h0aW5nICANCioqQWdlKiogfCB0aGUgYWdlIG9mIHRoZSBzdHVkZW50IHdoZW4gdGhleSB0b29rIHRoZSBzdXJ2ZXkgIA0KKipTZXgqKiB8IHRoZSBzZXggb2YgdGhlIHN0dWRlbnQgd2hlbiB0aGV5IHRvb2sgdGhlIHN1cnZleSAgDQoqKkdyYWRlKiogfCB0aGUgZ3JhZGUgb2YgdGhlIHRoZSBzdHVkZW50IHdoZW4gdGhlIHRvb2sgdGhlIHN1cnZleSAgDQoqKkVDSUdUKiogfCBzdHVkZW50IHJlcG9ydGVkIGhhdmluZyBldmVyIHRyaWVkIGNpZ2FyZXR0ZSBzbW9raW5nLCBldmVuIG9uZSBvciB0d28gcHVmZnMgIA0KKipFQ0lHQVIqKiB8IHN0dWRlbnQgcmVwb3J0ZWQgaGF2aW5nIGV2ZXIgdHJpZWQgY2lnYXIsIGNpZ2FyaWxsbywgb3IgbGl0dGxlIGNpZ2FyIHNtb2tpbmcsIGV2ZW4gb25lIG9yIHR3byBwdWZmcyAgDQoqKkVTTFQqKiB8IHN0dWRlbnQgcmVwb3J0ZWQgaGF2aW5nIGV2ZXIgdHJpZWQgY2hld2luZyB0b2JhY2NvLCBzbnVmZiwgb3IgZGlwICANCioqRUVMQ0lHVCoqIHwgc3R1ZGVudCByZXBvcnRlZCBoYXZpbmcgZXZlciB0cmllZCBlLWNpZ2FyZXR0ZXMgIA0KKipFUk9MTENJR1RTKiogfCBzdHVkZW50IHJlcG9ydGVkIGhhdmluZyBldmVyIHRyaWVkIHJvbGwteW91ci1vd24gY2lnYXJldHRlcyAgDQoqKkVGTEFWQ0lHVFMqKiB8ICAoMjAxNSBvbmx5KSBiYXNlZCBvbiBhbnN3ZXIgdG8gIldoaWNoIG9mIHRoZSBmb2xsb3dpbmcgdG9iYWNjbyBwcm9kdWN0cyB0aGF0IHlvdSB1c2VkIGluIHRoZSBwYXN0IDMwIGRheXMgd2VyZSBmbGF2b3JlZD8iICANCioqRUJJRElTKiogfCBzdHVkZW50IHJlcG9ydGVkIGhhdmluZyBldmVyIHRyaWVkIGJpZGlzIChzbWFsbCBicm93biBjaWdhcmV0dGVzIHdyYXBwZWQgaW4gYSBsZWFmKSAgDQoqKkVGTEFWQ0lHQVIqKiB8IHN0dWRlbnQgcmVwb3J0ZWQgaGF2aW5nIGV2ZXIgdHJpZWQgYSBmbGF2b3JlZCBjaWdhciAoMjAxNS0yMDE2KQ0KKipFSE9PS0FIKiogfCBzdHVkZW50IHJlcG9ydGVkIGhhdmluZyBldmVyIHNtb2tlZCB0b2JhY2NvIGZyb20gYSBob29rYWggb3IgYSB3YXRlcnBpcGUgIA0KKipFUElQRSoqIHwgc3R1ZGVudCByZXBvcnRlZCBoYXZpbmcgZXZlciBzbW9rZWQgdG9iYWNjbyBmcm9tIGEgcGlwZSAobm90IGhvb2thaCkgIA0KKipFU05VUyoqIHwgc3R1ZGVudCByZXBvcnRlZCBoYXZpbmcgZXZlciB1c2VkIHNudXMsIHN1Y2ggYXMgQ2FtZWwgb3IgTWFsYm9ybyBTbnVzICANCioqRURJU1NPTFYqKiB8IHN0dWRlbnQgcmVwb3J0ZWQgaGF2aW5nIGV2ZXIgdHJpZWQgZGlzc29sdmFibGUgdG9iYWNjbyBwcm9kdWN0cyBzdWNoIGFzIEFyaXZhLCBTdG9uZXdhbGwsIENhbWVsIG9yYnMsIENhbWVsIHN0aWNrcywgTWFybGJvcm8gc3RpY2tzLCBvciBDYW1lbCBzdHJpcHMgIA0KKipDQ0lHVCoqIHwgc3R1ZGVudCByZXBvcnRlZCB0aGV5IHNtb2tlZCBjaWdhcmV0dGVzIG9uID49IDEgb2YgdGhlIHBhc3QgMzAgZGF5cyAgDQoqKkNDSUdBUioqIHwgc3R1ZGVudCByZXBvcnRlZCB0aGV5IHNtb2tlZCBjaWdhcnMgb24gPj0gMSBvZiB0aGUgcGFzdCAzMCBkYXlzICANCioqQ1NMVCoqIHwgc3R1ZGVudCByZXBvcnRlZCB0aGV5IHVzZWQgY2hld2luZyB0b2JhY2NvLCBzbnVmZiwgb3IgZGlwIG9uID49IDEgb2YgdGhlIHBhc3QgMzAgZGF5cyAgDQoqKkNFTENJR1QqKiB8IHN0dWRlbnQgcmVwb3J0ZWQgdGhleSB1c2VkIGVsZWN0cm9uaWMgY2lnYXJldHRlcyBvciBlLWNpZ2FyZXR0ZXMgb25lIG9yIG1vcmUgZGF5cyBpbiB0aGUgcGFzdCAzMA0KKipDUk9MTENJR1RTKiogfCBzdHVkZW50IHJlcG9ydGVkIHRoZXkgc21va2VkIHJvbGwteW91ci1vd24gY2lnYXJldHRlcyBkdXJpbmcgdGhlIHBhc3QgMzAgZGF5cyAgDQoqKkNGTEFWQ0lHVFMqKnwgKDIwMTUgb25seSkgYmFzZWQgb24gYW5zd2VyIHRvICJXaGljaCBvZiB0aGUgZm9sbG93aW5nIHRvYmFjY28gcHJvZHVjdHMgdGhhdCB5b3UgdXNlZCBpbiB0aGUgcGFzdCAzMCBkYXlzIHdlcmUgZmxhdm9yZWQ/IiANCioqQ0JJRElTKiogfCBzdHVkZW50IHJlcG9ydGVkIHRoZXkgc21va2VkIGJpZGlzIGR1cmluZyB0aGUgcGFzdCAzMCBkYXlzICANCioqQ0hPT0tBSCoqIHwgc3R1ZGVudCByZXBvcnRlZCB0aGV5IHNtb2tlZCB0b2JhY2NvIGluIGEgaG9va2FoIG9uID49IDEgb2YgdGhlIHBhc3QgMzAgZGF5cyAgDQoqKkNQSVBFKiogfCBzdHVkZW50IHJlcG9ydGVkIHRoZXkgc21va2VkIHRvYmFjY28gaW4gYSBwaXBlIChub3QgaG9va2FoKSBkdXJpbmcgdGhlIHBhc3QgMzAgZGF5cyAgDQoqKkNTTlVTKiogfCBzdHVkZW50IHJlcG9ydGVkIHRoZXkgdXNlZCBzbnVzIGR1cmluZyB0aGUgcGFzdCAzMCBkYXlzICAgIA0KKipDRElTU09MVioqIHwgc3R1ZGVudCByZXBvcnRlZCB0aGV5IHVzZWQgZGlzc29sdmFibGUgdG9iYWNjbyBwcm9kdWN0cyBzdWNoIGFzIEFyaXZhLCBTdG9uZXdhbGwsIENhbWVsIG9yYnMsIENhbWVsIHN0aWNrcywgTWFybGJvcm8gc3RpY2tzLCBvciBDYW1lbCBzdHJpcHMgZHVyaW5nIHRoZSBwYXN0IDMwIGRheXMgIA0KKipicmFuZF9lY2lnKiogfCBzdHVkZW50IGFuc3dlciB0byAiRHVyaW5nIHRoZSBwYXN0IDMwIGRheXMsIHdoYXQgYnJhbmQgb2YgZS1jaWdhcmV0dGVzIGRpZCB5b3UgdXN1YWxseSB1c2U/IiAgDQoqKm1lbnRob2wqKiB8IHN0dWRlbnQgc2VsZWN0ZWQgTWVudGhvbCBvciBtaW50IGFzIHRoZSBhbnN3ZXIgdG8gIldoYXQgZmxhdm9ycyBvZiB0b2JhY2NvIHByb2R1Y3RzIGhhdmUgeW91IHVzZWQgaW4gdGhlIHBhc3QgMzAgZGF5cz8gKHNlbGVjdCBvbmUgb3IgbW9yZSkiICANCioqY2xvdmVfc3BpY2UqKiB8IHN0dWRlbnQgc2VsZWN0ZWQgY2xvdmUgb3Igc3BpY2UgYXMgdGhlIGFuc3dlciB0byAiV2hhdCBmbGF2b3JzIG9mIHRvYmFjY28gcHJvZHVjdHMgaGF2ZSB5b3UgdXNlZCBpbiB0aGUgcGFzdCAzMCBkYXlzPyAoc2VsZWN0IG9uZSBvciBtb3JlKSIgIA0KKipmcnVpdCoqIHwgc3R1ZGVudCBzZWxlY3RlZCBmcnVpdCBhcyB0aGUgYW5zd2VyIHRvICJXaGF0IGZsYXZvcnMgb2YgdG9iYWNjbyBwcm9kdWN0cyBoYXZlIHlvdSB1c2VkIGluIHRoZSBwYXN0IDMwIGRheXM/IChzZWxlY3Qgb25lIG9yIG1vcmUpIiAgDQoqKmNob2NvbGF0ZSoqIHwgc3R1ZGVudCBzZWxlY3RlZCBjaG9jb2xhdGUgYXMgdGhlIGFuc3dlciB0byAiV2hhdCBmbGF2b3JzIG9mIHRvYmFjY28gcHJvZHVjdHMgaGF2ZSB5b3UgdXNlZCBpbiB0aGUgcGFzdCAzMCBkYXlzPyAoc2VsZWN0IG9uZSBvciBtb3JlKSIgIA0KKiphbGNvaG9saWNfZHJpbmsqKiB8IHN0dWRlbnQgc2VsZWN0ZWQgYWxjb2hvbGljIGRyaW5rIChzdWNoIGFzIHdpbmUsIGNvZ25hYywgbWFyZ2FyaXRhLCBvciBvdGhlciBjb2NrdGFpbHMpIGFzIHRoZSBhbnN3ZXIgdG8gIldoYXQgZmxhdm9ycyBvZiB0b2JhY2NvIHByb2R1Y3RzIGhhdmUgeW91IHVzZWQgaW4gdGhlIHBhc3QgMzAgZGF5cz8gKGNob29zZSBvbmUgb3IgbW9yZSkiICANCioqY2FuZHlfZGVzc2VydF9zd2VldHMqKiB8ICBzdHVkZW50IHNlbGVjdGVkIGNhbmR5LCBkZXNzZXJ0cyBvciBvdGhlciBzd2VldHMgYXMgdGhlIGFuc3dlciB0byAiV2hhdCBmbGF2b3JzIG9mIHRvYmFjY28gcHJvZHVjdHMgaGF2ZSB5b3UgdXNlZCBpbiB0aGUgcGFzdCAzMCBkYXlzPyAoY2hvb3NlIG9uZSBvciBtb3JlKSIgDQoqKm90aGVyKiogfCBzdHVkZW50IHNlbGVjdGVkIHNvbWUgb3RoZXIgZmxhdm9yIG5vdCBsaXN0ZWQgYXMgdGhlIGFuc3dlciB0byAiV2hhdCBmbGF2b3JzIG9mIHRvYmFjY28gcHJvZHVjdHMgaGF2ZSB5b3UgdXNlZCBpbiB0aGUgcGFzdCAzMCBkYXlzPyAoY2hvb3NlIG9uZSBvciBtb3JlKSIgDQoqKkVIVFAqKiB8IHN0dWRlbnQgcmVwb3J0ZWQgaGF2aW5nIGV2ZXIgdHJpZWQgaGVhdGVkIChhbHNvIGtub3duIGFzICJoZWF0LW5vdC1idXJuIikgdG9iYWNjbyBwcm9kdWN0cyAgDQoqKkNIVFAqKiB8IHN0dWRlbnQgcmVwb3J0ZWQgdGhleSB1c2VkIGhlYXRlZCB0b2JhY2NvIHByb2R1Y3RzIGR1cmluZyB0aGUgcGFzdCAzMCBkYXlzICANCjwvZGV0YWlscz4NCg0KIyMjICoqRXhlcmNpc2UqKg0KKioqDQoNCmBgYCB7ciBERVdfUXVpeiwgZWNobyA9IEZBTFNFfQ0KcXVpeihjYXB0aW9uID0gIiIsDQogIHF1ZXN0aW9uKCJTdXBwb3NlIHRoYXQgd2Ugd2FudCB0byBjaGFuZ2UgdmFsdWUgXCJhXCIgaW4gYSBjb2x1bW4odmFyaWFibGUpIG9mIGEgZGF0YXNldCB0byB2YWx1ZSBcImJcIiAsIHdoaWNoIG9uZSBvZiB0aGUgZm9sbG93aW5nIGZ1bmN0aW9ucyBvZiB0aGUgYGRwbHlyYCBwYWNrYWdlIHNob3VsZCBiZSB1c2VkPyIsDQogICAgYW5zd2VyKCJgcmVuYW1lKClgIiwgbWVzc2FnZSA9ICJgcmVuYW1lKClgIHJlbmFtZXMgYSBjb2x1bW4sIG5vdCBhIHZhbHVlIGluIHRoYXQgY29sdW1uLiIpLA0KICAgIGFuc3dlcigiYHJlY29kZSgpYCIsIGNvcnJlY3QgPSBUUlVFKSwNCiAgICBhbGxvd19yZXRyeSA9IFRSVUUsDQogICAgcmFuZG9tX2Fuc3dlcl9vcmRlciA9IFRSVUUNCiAgKSwNCiAgcXVlc3Rpb24oIldoaWNoIG9mIHRoZSBmb2xsb3dpbmcgY2FuIHRoZSBgbXV0YXRlKClgIGZ1bmN0aW9uIGluIHRoZSBgZHBseXJgIHBhY2thZ2UgZG8/IChjaGVjayBhbGwgdGhhdCBhcHBseSkiLA0KICAgIGFuc3dlcigiU2VsZWN0IGNlcnRhaW4gdmFyaWFibGVzKGNvbHVtbnMpIG9mIHRoZSBkYXRhLiIsIG1lc3NhZ2UgPSAiU2VsZWN0aW5nIGNlcnRhaW4gdmFyaWFibGVzKGNvbHVtbnMpIG9mIHRoZSBkYXRhIGlzIHRoZSBmdW5jdGlvbiBvZiB0aGUgYHNlbGVjdCgpYCBmdW5jdGlvbi4iKSwNCiAgICBhbnN3ZXIoIlJlbmFtZSBhIHZhcmlhYmxlLiIsIG1lc3NhZ2UgPSAiUmVuYW1pbmcgYSB2YXJpYWJsZSBpcyB0aGUgZnVuY3Rpb24gb2YgdGhlIGByZW5hbWUoKWAgZnVuY3Rpb24uIiksDQogICAgYW5zd2VyKCJDcmVhdGUgYSBuZXcgdmFyaWFibGUuIiwgY29ycmVjdCA9IFRSVUUpLA0KICAgIGFuc3dlcigiTW9kaWZ5IGFuIGV4aXN0aW5nIHZhcmlhYmxlLiIsIGNvcnJlY3QgPSBUUlVFKSwNCiAgICBhbGxvd19yZXRyeSA9IFRSVUUsDQogICAgcmFuZG9tX2Fuc3dlcl9vcmRlciA9IFRSVUUNCiAgKQ0KKQ0KYGBgDQoNClN1cHBvc2UgdGhlcmUgaXMgYSBsaXN0IG9mIGRhdGFzZXRzIGNhbGxlZCBgbm9ybV9kYXRhYC4gVGhlIGZpcnN0IGRhdGFzZXQgaW4gYG5vcm1fZGF0YWAgY29udGFpbnMgb2JzZXJ2YXRpb25zIGZyb20gYSBub3JtYWwgZGlzdHJpYnV0aW9uIHdpdGggbWVhbiAwLiBUaGUgc2Vjb25kIGNvbnRhaW5zIG9ic2VydmF0aW9ucyBmcm9tIGEgbm9ybWFsIGRpc3RyaWJ1dGlvbiB3aXRoIG1lYW4gNS4gRm9yIGJvdGggb2YgdGhlbSwgdGhlIG9ic2VydmF0aW9ucyBpbiB0aGUgZmlyc3QgY29sdW1uIGB2YXIxYCBhcmUgZnJvbSBhIGRpc3RyaWJ1dGlvbiB3aXRoIHZhcmlhbmNlIDEuIFRoZSBvYnNlcnZhdGlvbnMgaW4gdGhlIHNlY29uZCBjb2x1bW4gYHZhcjJgIGFyZSBmcm9tIGEgZGlzdHJpYnV0aW9uIHdpdGggdmFyaWFuY2UgNC4NCg0KV3JpdGUgYSBmdW5jdGlvbiBjYWxsZWQgYHJlbmFtZV9zZGAgdGhhdCByZW5hbWVzIHRoZSBmaXJzdCBjb2x1bW4gYXMgIlNEID0gMSIsIGFuZCB0aGUgc2Vjb25kIGNvbHVtbiBhcyAiU0QgPSAyIi4gVGhlbiwgYXBwbHkgdGhpcyBmdW5jdGlvbiB0byB0aGUgbGlzdCBgbm9ybV9kYXRhYC4NCg0KYGBge3IgREVXX0V4ZXJjaXNlLXNldHVwfQ0Kc2V0LnNlZWQoMTAwKQ0KdmFyMSA8LSBybm9ybSg1LCAwLCAxKQ0KdmFyMiA8LSBybm9ybSg1LCAwLCAyKQ0KbWVhbjAgPC0gZGF0YS5mcmFtZSh2YXIxLCB2YXIyKQ0KdmFyMSA8LSBybm9ybSg1LCA1LCAxKQ0KdmFyMiA8LSBybm9ybSg1LCA1LCAyKQ0KbWVhbjUgPC0gZGF0YS5mcmFtZSh2YXIxLCB2YXIyKQ0KDQpub3JtX2RhdGEgPC0gbGlzdChtZWFuMCwgbWVhbjUpDQpuYW1lcyhub3JtX2RhdGEpIDwtIGMoIm5vcm0gd2l0aCBtZWFuID0gMCIsICJub3JtIHdpdGggbWVhbiA9IDUiKQ0KYGBgDQoNCmBgYHtyIERFV19FeGVyY2lzZSwgZXhlcmNpc2UgPSBUUlVFfQ0KIyB3cml0ZSB0aGUgZnVuY3Rpb24NCnJlbmFtZV9zZCA8LSBmdW5jdGlvbigpew0KICANCn0NCg0KIyBhcHBseSB0aGUgZnVuY3Rpb24NCm5vcm1fZGF0YSA8LSANCiAgDQojIHZpZXcgcmVzdWx0cw0Kbm9ybV9kYXRhDQpgYGANCg0KYGBge3IgREVXX0V4ZXJjaXNlLWhpbnQtMX0NCiMgV2hhdCBpbnB1dCBhcmd1bWVudCBzaG91bGQgdGhlIGZ1bmN0aW9uIHRha2U/DQojIFdoYXQgc2hvdWxkIHRoZSBmdW5jdGlvbiBkbyB3aXRoIHRoZSBpbnB1dCBhcmd1bWVudD8NCmBgYA0KDQpgYGB7ciBERVdfRXhlcmNpc2UtaGludC0yfQ0KIyBXaGF0IGlucHV0IGFyZ3VtZW50IHNob3VsZCB0aGUgZnVuY3Rpb24gdGFrZT8NCiMgV2hhdCBzaG91bGQgdGhlIGZ1bmN0aW9uIGRvIHdpdGggdGhlIGlucHV0IGFyZ3VtZW50Pw0KDQojIFdoYXQgZnVuY3Rpb24gY2FuIGJlIHVzZWQgdG8gYXBwbHkgYSBmdW5jdGlvbiB0byBlYWNoIGVsZW1lbnQgaW4gb3VyIGxpc3Q/DQpgYGANCg0KYGBge3IgREVXX0V4ZXJjaXNlLWhpbnQtM30NCiMgd3JpdGUgdGhlIGZ1bmN0aW9uDQpyZW5hbWVfc2QgPC0gZnVuY3Rpb24oZGF0YXNldCkgew0KICBkYXRhc2V0ICU+JQ0KICAgIHJlbmFtZSgiU0QgPSAxIiA9IHZhcjEsICJTRCA9IDIiID0gdmFyMikNCn0NCmBgYA0KDQpgYGB7ciBERVdfRXhlcmNpc2Utc29sdXRpb259DQojIHdyaXRlIHRoZSBmdW5jdGlvbg0KcmVuYW1lX3NkIDwtIGZ1bmN0aW9uKGRhdGFzZXQpIHsNCiAgZGF0YXNldCAlPiUNCiAgICByZW5hbWUoIlNEID0gMSIgPSB2YXIxLCAiU0QgPSAyIiA9IHZhcjIpDQp9DQoNCiMgYXBwbHkgdGhlIGZ1bmN0aW9uDQpub3JtX2RhdGEgPC0gbm9ybV9kYXRhICU+JQ0KICBtYXAoLiwgcmVuYW1lX3NkKQ0KDQojIHZpZXcgcmVzdWx0cw0Kbm9ybV9kYXRhDQpgYGANCg0KIyMgKipEYXRhIFZpc3VhbGl6YXRpb24qKg0KKioqIA0KDQpSZWNhbGwgdGhhdCBvdXIgbWFpbiBxdWVzdGlvbnMgd2VyZToNCg0KMSkgSG93IGhhcyB0b2JhY2NvIGFuZCBlLWNpZ2FyZXR0ZS92YXBpbmcgdXNlIGJ5IEFtZXJpY2FuIHlvdXRocyBjaGFuZ2VkIHNpbmNlIDIwMTU/DQoyKSBIb3cgZG9lcyBlLWNpZ2FyZXR0ZSB1c2UgY29tcGFyZSBiZXR3ZWVuIG1hbGVzIGFuZCBmZW1hbGVzPw0KMykgV2hhdCB2YXBpbmcgYnJhbmRzIGFuZCBmbGF2b3JzIGFwcGVhciB0byBiZSB1c2VkIHRoZSBtb3N0IGZyZXF1ZW50bHk/ICANCldlIHdpbGwgYmFzZSB0aGlzIG9uIHRoZSBmb2xsb3dpbmcgc3VydmV5IHF1ZXN0aW9uczogICANCj4gIkR1cmluZyB0aGUgcGFzdCAzMCBkYXlzLCB3aGF0IGJyYW5kIG9mIGUtY2lnYXJldHRlcyBkaWQgeW91IHVzdWFsbHkgdXNlPyIgICANCj4gIldoYXQgZmxhdm9ycyBvZiB0b2JhY2NvIHByb2R1Y3RzIGhhdmUgeW91IHVzZWQgaW4gdGhlIHBhc3QNCjMwIGRheXM/IiANCg0KNCkgSXMgdGhlcmUgYSByZWxhdGlvbnNoaXAgYmV0d2VlbiBlLWNpZ2FyZXR0ZS92YXBpbmcgdXNlIGFuZCBvdGhlciB0b2JhY2NvIHVzZT8NCg0KDQpXZSBhcmUgbm93IGdvaW5nIHRvIGNyZWF0ZSBkYXRhIHZpc3VhbGl6YXRpb25zIHRvIGV4cGxvcmUgZWFjaCBvZiB0aGVzZSBxdWVzdGlvbnMuDQoNCkZvciBtYW55IG9mIHRoZXNlIHF1ZXN0aW9ucyB3ZSB3aWxsIGJlIGludGVyZXN0ZWQgaW4gYm90aCAqKmN1cnJlbnQqKiBhbmQgKipldmVyKiogdXNlcnMsIHNvIHdlIHdpbGwgd2FudCB0byBjcmVhdGUgYSB2YXJpYWJsZSBmb3IgbGFiZWxpbmcgaW5kaXZpZHVhbHMgd2hvIGFyZSBjdXJyZW50IHVzZXJzIG9mIGFueSB0b2JhY2NvIHByb2R1Y3QgKG9yIG5vdCwgaS5lLiwgd2hvIGRvIG5vdCBjdXJyZW50bHkgdXNlIGEgdG9iYWNjbyBwcm9kdWN0KSBhbmQgYSB2YXJpYWJsZSBmb3IgbGFiZWxpbmcgaW5kaXZpZHVhbHMgd2hvIGFyZSAiZXZlciB1c2VycyIgb2YgYW55IHRvYmFjY28gcHJvZHVjdCAob3Igbm90LCBpLmUuLCB3aG8gaGF2ZSBuZXZlciB1c2VkIGEgdG9iYWNjbyBwcm9kdWN0KS4NCg0KV2UgZGVmaW5lIHRoZXNlIHR3byBncm91cHMgYXMgZm9sbG93czoNCg0KMSkgKipjdXJyZW50KiogPSBzdHVkZW50cyB3aG8gdXNlZCBhIHByb2R1Y3QgZm9yID49MSBkYXkgaW4gdGhlIHBhc3QgMzAgZGF5cyAgDQoyKSAqKmV2ZXIqKiA9ICBzdHVkZW50cyB3aG8gcmVwb3J0IGhhdmluZyB1c2VkIG9yIHRyaWVkIGEgcHJvZHVjdCBhdCBhbnkgcG9pbnQgaW4gdGltZQ0KDQpBbGwgKipjdXJyZW50KiogdXNlcnMgYXJlIHRoZXJlZm9yZSAqKmV2ZXIqKiB1c2VycyBidXQgbm90IGFsbCAqKmV2ZXIqKiB1c2VycyBhcmUgKipjdXJyZW50KiogdXNlcnMuIFRodXMsICoqY3VycmVudCoqIHVzZXJzIGFyZSBhIHN1YnNldCBvZiAqKmV2ZXIqKiB1c2Vycy4NCg0KVG8gYWRkIHRoZXNlIGdyb3VwaW5nIHZhcmlhYmxlcyB0byBvdXIgZGF0YSB3ZSB3aWxsIGRvIGEgYml0IG1vcmUgd3JhbmdsaW5nIHVzaW5nIHRoZSBgbXV0YXRlKClgIGZ1bmN0aW9uIGFnYWluIG9mIHRoZSBgZHBseXJgIHBhY2thZ2UuIEFzIGRpc2N1c3NlZCBhYm92ZSwgb3VyIGRhdGFzZXQgY29udGFpbnMgYSBzZXQgb2YgcXVlc3Rpb25zIHRoYXQgcmVsYXRlIHRvIHdoZXRoZXIgdGhlIHN0dWRlbnQgaGFzIGV2ZXIgdXNlZCB0aGUgcGFydGljdWxhciB0b2JhY2NvIHByb2R1Y3QgKHF1ZXN0aW9ucyB0aGF0IHN0YXJ0IHdpdGggdGhlIGxldHRlciAiRSIpLCBhbmQgcXVlc3Rpb25zIHRoYXQgcmVsYXRlIHRvIHdoZXRoZXIgdGhlIHN0dWRlbnQgY3VycmVudGx5IHVzZXMgdGhlIHBhcnRpY3VsYXIgdG9iYWNjbyBwcm9kdWN0IChxdWVzdGlvbnMgdGhhdCBzdGFydCB3aXRoIHRoZSBsZXR0ZXIgIkMiKS4gDQoNCkhlcmUgYXJlIHNvbWUgZXhhbXBsZXMgZm9yIHRoZXNlIGRhdGEgZW50cmllczogIA0KDQogLSBFUElQRTogU3R1ZGVudHMgd2hvIHJlcG9ydGVkIHRoZXkgaGF2ZSBzbW9rZWQgdG9iYWNjbyBmcm9tIGEgcGlwZSAobm90IGhvb2thaCkuICANCiAtIENQSVBFOiBTdHVkZW50cyB3aG8gcmVwb3J0ZWQgdGhleSBzbW9rZWQgdG9iYWNjbyBpbiBhIHBpcGUgKG5vdCBob29rYWgpIGR1cmluZyB0aGUgcGFzdCAzMCBkYXlzLiANCiAtIEVST0xMQ0lHVFM6IFN0dWRlbnRzIHdobyByZXBvcnRlZCB0aGV5IGhhdmUgdHJpZWQgc21va2luZyByb2xsLXlvdXItb3duIGNpZ2FyZXR0ZXMuIA0KIC0gQ1JPTExDSUdUUzogU3R1ZGVudHMgd2hvIHJlcG9ydGVkIHRoZXkgc21va2VkIHJvbGwteW91ci1vd24gY2lnYXJldHRlcyBkdXJpbmcgdGhlIHBhc3QgMzAgZGF5cy4gDQogDQpCYXNlZCBvbiBtYW55IHF1ZXN0aW9ucyBsaWtlIHRoaXM6ICANCiANCiBJbiB0aGUgcGFzdCAzMCBkYXlzLCB3aGljaCBvZiB0aGUgZm9sbG93aW5nIHByb2R1Y3RzIGhhdmUgeW91IHVzZWQgb24gYXQgbGVhc3Qgb25lIGRheT8gKFNlbGVjdCBvbmUgb3IgbW9yZSkgICANCkEuIFJvbGwteW91ci1vd24gY2lnYXJldHRlcyAgDQpCLiBQaXBlcyBmaWxsZWQgd2l0aCB0b2JhY2NvIChub3QgaG9va2FoIG9yIHdhdGVycGlwZSkgICANCkMuIFNudXMsIHN1Y2ggYXMgQ2FtZWwsIE1hcmxib3JvLCBvciBHZW5lcmFsIFNudXMgIA0KRC4gRGlzc29sdmFibGUgdG9iYWNjbyBwcm9kdWN0cyBzdWNoIGFzIEFyaXZhLCBTdG9uZXdhbGwsIENhbWVsIG9yYnMsIENhbWVsIHN0aWNrcywgTWFybGJvcm8gc3RpY2tzLA0Kb3IgQ2FtZWwgc3RyaXBzICANCkUuIEJpZGlzIChzbWFsbCBicm93biBjaWdhcmV0dGVzIHdyYXBwZWQgaW4gYSBsZWFmKSAgDQpGLiBJIGhhdmUgbm90IHVzZWQgYW55IG9mIHRoZSBwcm9kdWN0cyBsaXN0ZWQgYWJvdmUgaW4gdGhlIHBhc3QgMzAgZGF5cyAgDQoNCiBXaGljaCBvZiB0aGUgZm9sbG93aW5nIHRvYmFjY28gcHJvZHVjdHMgaGF2ZSB5b3UgZXZlciB0cmllZCwgZXZlbiBqdXN0IG9uZSB0aW1lPyAoU2VsZWN0IG9uZSBvciBtb3JlKSAgIA0KQS4gUm9sbC15b3VyLW93biBjaWdhcmV0dGVzICANCkIuIFBpcGVzIGZpbGxlZCB3aXRoIHRvYmFjY28gKG5vdCBob29rYWggb3Igd2F0ZXJwaXBlKSAgIA0KQy4gU251cywgc3VjaCBhcyBDYW1lbCwgTWFybGJvcm8sIG9yIEdlbmVyYWwgU251cyAgDQpELiBEaXNzb2x2YWJsZSB0b2JhY2NvIHByb2R1Y3RzIHN1Y2ggYXMgQXJpdmEsIFN0b25ld2FsbCwgQ2FtZWwgb3JicywgQ2FtZWwgc3RpY2tzLCBNYXJsYm9ybyBzdGlja3MsIG9yIENhbWVsIHN0cmlwcyAgIA0KRS4gQmlkaXMgKHNtYWxsIGJyb3duIGNpZ2FyZXR0ZXMgd3JhcHBlZCBpbiBhIGxlYWYpICANCkYuIEkgaGF2ZSBuZXZlciB0cmllZCBhbnkgb2YgdGhlIHByb2R1Y3RzIGxpc3RlZCBhYm92ZSAgIA0KIA0KIA0KV2Ugd2lsbCBzdW0gYWNyb3NzIHRoZSB2YXJpYWJsZXMgdGhhdCByZWxhdGUgdG8gZXZlciBvciBjdXJyZW50IHRvYmFjY28gdXNhZ2UgcXVlc3Rpb25zIHRvIGRldGVybWluZSBpZiB0aGUgc3R1ZGVudCBhbnN3ZXJlZCB5ZXMgdG8gYW55IG9mIHRoZSBldmVyIG9yIGN1cnJlbnQgcXVlc3Rpb25zLiBUbyBkbyB0aGlzIHdlIHdpbGwgdXNlIHRoZSBiYXNlIGByb3dTdW1zYCBmdW5jdGlvbi4NCg0KV2Ugd2lsbCB0aGVuIHVzZSB0aGUgYGNhc2Vfd2hlbigpYCBmdW5jdGlvbiBvZiB0aGUgYGRwbHlyYCBwYWNrYWdlIHRvIGNvbnZlcnQgdGhlIHN1bSB2YWx1ZXMgdG8gYFRSVUVgIG9yIGBGQUxTRWAgYmFzZWQgb24gdGhlIHRocmVzaG9sZCBvZiB6ZXJvLiBJZiB0aGUgc3VtIGlzIGdyZWF0ZXIgdGhhbiB6ZXJvLCB0aGVuIHdlIGtub3cgdGhlIHN0dWRlbnQgYW5zd2VyZWQgeWVzIHRvIGF0IGxlYXN0IG9uZSBxdWVzdGlvbi4gDQoNCmBgYHtyLCBlY2hvID0gRkFMU0V9DQojaW4gY2FzZSB5b3UgYXJlIHN0YXJ0aW5nIGF0IHRoaXMgc2VjdGlvbi0gbmVlZCB0byBsb2FkIHRoZSBkYXRhOg0KI2xvYWQoaGVyZTo6aGVyZSgiZGF0YSIsICJ3cmFuZ2xlZF9kYXRhLnJkYSIpKQ0KbG9hZCgid3d3L2RhdGEvd3JhbmdsZWRfZGF0YS5yZGEiKQ0KYGBgDQoNCmBgYHtyfQ0Kbnl0c19kYXRhICU8PiUNCiAgbXV0YXRlKHRvYmFjY29fc3VtX2V2ZXIgPSByb3dTdW1zKHNlbGVjdCguLCBzdGFydHNfd2l0aCgiRSIsIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWdub3JlLmNhc2UgPSBGQUxTRSkpLCBuYS5ybSA9IFRSVUUpLA0KICAgICAgdG9iYWNjb19zdW1fY3VycmVudCA9IHJvd1N1bXMoc2VsZWN0KC4sIHN0YXJ0c193aXRoKCJDIiwgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZ25vcmUuY2FzZSA9IEZBTFNFKSksIG5hLnJtID0gVFJVRSkpICU+JQ0KICAgICAgbXV0YXRlKHRvYmFjY29fZXZlciA9IGNhc2Vfd2hlbih0b2JhY2NvX3N1bV9ldmVyID4gMCB+IFRSVUUsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvYmFjY29fc3VtX2V2ZXIgPT0gMCB+IEZBTFNFKSwNCiAgICAgICAgICB0b2JhY2NvX2N1cnJlbnQgPSBjYXNlX3doZW4odG9iYWNjb19zdW1fY3VycmVudCA+IDAgfiBUUlVFLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b2JhY2NvX3N1bV9jdXJyZW50ID09IDAgfiBGQUxTRSkpDQpgYGANCiANCiANCiMjIyMgey5zY3JvbGxhYmxlfQ0KYGBge3J9DQpnbGltcHNlKG55dHNfZGF0YSkNCmBgYA0KIyMjIw0KDQpXZSBhcmUgYWxzbyBpbnRlcmVzdGVkIGluIGUtY2lnYXJldHRlL3ZhcGluZyBwcm9kdWN0IHVzYWdlIGNvbXBhcmVkIHRvIG90aGVyIHRvYmFjY28gcHJvZHVjdHMsIHNvIHdlIHdpbGwgY3JlYXRlIHNvbWUgdmFyaWFibGVzIHJlbGF0ZWQgdG8gdGhlIHN1bSBvZiBhbGwgZS1jaWdhcmV0dGUgdXNhZ2UgcXVlc3Rpb24gdmFyaWFibGVzIGFuZCB0aGUgc3VtIG9mIGFsbCB0b2JhY2NvIHVzYWdlIHF1ZXN0aW9uIHZhcmlhYmxlcyBleGNsdWRpbmcgdGhvc2UgdGhhdCBhcmUgYWJvdXQgZS1jaWdhcmV0dGVzLiBUaGVyZSBpcyBvbmx5IG9uZSB2YXJpYWJsZSBhYm91dCBlLWNpZ2FyZXR0ZSB1c2FnZSBldmVyIChFRUxDSUdUKSBhbmQgb25lIGFib3V0IGN1cnJlbnQgdXNhZ2UgKENFTENJR1QpLg0KDQoNCmBgYHtyfQ0Kbnl0c19kYXRhIDwtIG55dHNfZGF0YSAlPiUgDQogIG11dGF0ZShlY2lnX3N1bV9ldmVyID0gcm93U3VtcyhzZWxlY3QoLiwgRUVMQ0lHVCksIG5hLnJtID0gVFJVRSksDQogICAgICBlY2lnX3N1bV9jdXJyZW50ID0gcm93U3VtcyhzZWxlY3QoLiwgQ0VMQ0lHVCksIG5hLnJtID0gVFJVRSksDQogICAgIG5vbl9lY2lnX3N1bV9ldmVyID0gcm93U3VtcyhzZWxlY3QoLiwgc3RhcnRzX3dpdGgoIkUiLCANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZ25vcmUuY2FzZSA9IEZBTFNFKSwgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLUVFTENJR1QpLCBuYS5ybSA9IFRSVUUpLA0KICBub25fZWNpZ19zdW1fY3VycmVudCA9IHJvd1N1bXMoc2VsZWN0KC4sIHN0YXJ0c193aXRoKCJDIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZ25vcmUuY2FzZSA9IEZBTFNFKSwgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLUNFTENJR1QpLCBuYS5ybSA9IFRSVUUpKSAlPiUNCiAgICAgIG11dGF0ZShlY2lnX2V2ZXIgPSBjYXNlX3doZW4oZWNpZ19zdW1fZXZlciA+IDAgfiBUUlVFLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlY2lnX3N1bV9ldmVyID09IDAgfiBGQUxTRSksDQogICAgICAgICAgZWNpZ19jdXJyZW50ID0gY2FzZV93aGVuKGVjaWdfc3VtX2N1cnJlbnQgPiAwIH4gVFJVRSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWNpZ19zdW1fY3VycmVudCA9PSAwIH4gRkFMU0UpLA0KICAgICAgICAgbm9uX2VjaWdfZXZlciA9IGNhc2Vfd2hlbihub25fZWNpZ19zdW1fZXZlciA+IDAgfiBUUlVFLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub25fZWNpZ19zdW1fZXZlciA9PSAwIH4gRkFMU0UpLA0KICAgICAgbm9uX2VjaWdfY3VycmVudCA9IGNhc2Vfd2hlbihub25fZWNpZ19zdW1fY3VycmVudCA+IDAgfiBUUlVFLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub25fZWNpZ19zdW1fY3VycmVudCA9PSAwIH4gRkFMU0UpKQ0KYGBgICAgICAgICAgICAgICAgICAgICAgICANCg0KIyMjIyB7LnNjcm9sbGFibGV9DQpgYGB7cn0NCmdsaW1wc2Uobnl0c19kYXRhKQ0KYGBgDQoNCiMjIyMNCg0KRmluYWxseSwgd2UgYXJlIGFsc28gaW50ZXJlc3RlZCBpbiBncm91cGluZyBzdHVkZW50cyB0aGF0IG9ubHkgdXNlIGUtY2lnYXJldHRlcyBhbmQgdGhvc2UgdGhhdCBvbmx5IHVzZSBvdGhlciBmb3JtcyBvZiB0b2JhY2NvLg0KDQpSZWNhbGwgdGhhdCBjdXJyZW50IHVzZXJzIGFyZSBhIHN1YnNldCBvZiBldmVyIHVzZXJzLCB0aHVzIHN0dWRlbnRzIHdvdWxkIHR5cGljYWxseSBhbnN3ZXIgeWVzIHRvIGhhdmluZyB0cmllZCB2YXBpbmcgcHJvZHVjdHMgaWYgdGhleSBoYWQgdXNlZCB0aGVtIG9uZSBvciBtb3JlIGRheXMgaW4gdGhlIHBhc3QgMzAgZGF5cy4NCg0KRmlyc3Qgd2Ugd2lsbCBtYWtlIGEgc21hbGwgdG95IGRhdGFzZXQgY2FsbGVkIGB0ZXN0YCB0byBzaG93IHdoYXQgd2Ugd2lsbCBkbyB3aXRoIHRoZSBsYXJnZXIgZGF0YXNldDoNCmBgYHtyfQ0KdGVzdCA8LSB0aWJibGUoZWNpZ19ldmVyID0gYygiVFJVRSIsICJUUlVFIiwgIlRSVUUiLCAiVFJVRSIsICJGQUxTRSIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICJGQUxTRSIsICJUUlVFIiwgIkZBTFNFIiwgIkZBTFNFIiksDQogICAgICAgICAgICAgICBub25fZWNpZ19ldmVyID0gYygiVFJVRSIsICJGQUxTRSIsICJGQUxTRSIsICJGQUxTRSIsICJGQUxTRSIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiRkFMU0UiLCAiVFJVRSIsICJUUlVFIiwgIlRSVUUiKSwNCiAgICAgICAgICAgICAgIGVjaWdfY3VycmVudCA9IGMoIlRSVUUiLCAiRkFMU0UiLCAiRkFMU0UiLCAiVFJVRSIsICJUUlVFIiwgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJGQUxTRSIsICJGQUxTRSIsICJGQUxTRSIsICJGQUxTRSIpLA0KICAgICAgICAgICAgICAgbm9uX2VjaWdfY3VycmVudCA9IGMoIlRSVUUiLCAiRkFMU0UiLCAiVFJVRSIsICJGQUxTRSIsICJUUlVFIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJGQUxTRSIsICJGQUxTRSIsICJGQUxTRSIsICJUUlVFIikpDQoNCnRlc3QNCmBgYA0KDQpOb3csIGxldCdzIGxvb2sgYXQgaWRlbnRpZnlpbmcgc3R1ZGVudHMgd2hvIGhhdmUgdHJpZWQgZS1jaWdhcmV0dGVzLCBidXQgYXJlIG5vdCBjdXJyZW50IHVzZXJzLCBhbmQgd2hvIGhhdmUgbmV2ZXIgdHJpZWQgb3RoZXIgdG9iYWNjbyBwcm9kdWN0cyAoYW5kIGFyZSB0aGVyZWZvcmUgbm90IGN1cnJlbnQgdXNlcnMpLiBXZSB3aWxsIGFnYWluIHVzZSB0aGUgYGNhc2Vfd2hlbigpYCBhbmQgdGhlIGBtdXRhdGVgIGZ1bmN0aW9uIHRvIGNyZWF0ZSBuZXcgdmFyaWFibGVzIHdpdGggc3BlY2lmaWMgdmFsdWVzIHdoZW4gY2VydGFpbiBjb25kaXRpb25zIGFyZSBtZXQuIEluIHRoaXMgY2FzZSwgd2Ugd2lsbCBzcGVjaWZ5IHRoYXQgc2V2ZXJhbCBjb25kaXRpb25zIG11c3QgYmUgbWV0IGJ5IHVzaW5nIHRoZSBgJmAgc3ltYm9sLiBGb3IgYSB2YWx1ZSBvZiBgVFJVRWAgZm9yIHRoZSBuZXcgYGVjaWdfb25seV9ldmVyYCB2YXJpYWJsZSwgYWxsIG9mIHRoZSBjb25kaXRpb25zIGNvbWJpbmVkIHdpdGggYCZgIG11c3QgYmUgbWV0LiAgSWYgYW55IG9mIHRoZSBjb25kaXRpb25zIGFyZSBub3QgbWV0IHRoZW4gdGhlIGBlY2lnX29ubHlfZXZlcmAgdmFsdWUgd2lsbCBiZSBgRkFMU0VgIGJhc2VkIG9uIHRoZSBsYXN0IGxpbmUgYFRSVUUgfiBGQUxTRWAuDQoNCmBgYHtyfQ0KDQp0ZXN0IDwtIHRlc3QgJT4lIG11dGF0ZShlY2lnX29ubHlfZXZlciA9IGNhc2Vfd2hlbihlY2lnX2V2ZXIgPT0gVFJVRSAmDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vbl9lY2lnX2V2ZXIgPT0gRkFMU0UgJg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWNpZ19jdXJyZW50ID09IEZBTFNFICYNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9uX2VjaWdfY3VycmVudCA9PSBGQUxTRSB+IFRSVUUsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBUUlVFIH4gRkFMU0UpKQ0KdGVzdA0KYGBgDQoNCldlIGNhbiBzZWUgZnJvbSB0aGUgc2Vjb25kIHJvdywgdGhhdCB0aGUgYGVjaWdfb25seV9ldmVyYCBpcyBgVFJVRWAgd2hlbiB3ZSB3b3VsZCBleHBlY3QgaXQgdG8gYmUuDQpXZSBjYW4gYWxzbyBzZWUgZnJvbSB0aGUgZm91cnRoIHJvdywgdGhhdCBldmVuIHRob3VnaCB0aGUgc3R1ZGVudCByZXBvcnRlZCB5ZXMgdG8gZXZlciB0cnlpbmcgZS1jaWdhcmV0dGVzLCBiZWNhdXNlIHRoZXkgYWxzbyByZXBvcnRlZCB5ZXMgdG8gY3VycmVudGx5IHVzaW5nIGUtY2lnYXJldHRlcyB0aGUgdmFsdWUgZm9yIG9ubHkgZXZlciB0cnlpbmcgZS1jaWdhcmV0dGVzIGlzIGBGQUxTRWAuIEFkZGl0aW9uYWxseSB3ZSBjYW4gc2VlIGZyb20gdGhlIHNldmVudGggcm93IHRoYXQgc2ltaWxhcmx5IGV2ZW4gdGhvdWdoIHRoZSBzdHVkZW50IHJlcG9ydGVkIHllcyB0byBldmVyIHRyeWluZyBlLWNpZ2FyZXR0ZXMsIHRoZXkgYWxzbyByZXBvcnRlZCB5ZXMgdG8gZXZlciB0cnlpbmcgb3RoZXIgcHJvZHVjdHMsIGFuZCB0aGUgdmFsdWUgZm9yIG9ubHkgZXZlciB0cnlpbmcgZS1jaWdhcmV0dGVzIGlzIGBGQUxTRWAuIEltcG9ydGFudGx5LCB3ZSBjYW4gc2VlIGZyb20gdGhlIDZ0aCByb3csIHRoYXQgaWYgYWxsIHJlc3BvbnNlcyBhcmUgbmVnYXRpdmUgdGhhbiB0aGUgdmFsdWUgaXMgYEZBTFNFYC4NCg0KTm93IHdlIHdpbGwgZXhwYW5kIHRoaXMgdG8gdGhlIG90aGVyIHBvc3NpYmxlIGNhdGVnb3JpZXMuIEluIHRoaXMgY2FzZSB3ZSBub3RlIHRoYXQgc2luY2UgY3VycmVudCB1c2VycyBhcmUgYSBzdWJzZXQgb2YgZXZlciB1c2VycywgaXQgZG9lc24ndCBtYXR0ZXIgaWYgYSB1c2VyIHJlcG9ydHMgeWVzIHRvIGV2ZXIgdHJ5aW5nICBlLWNpZ2FyZXR0ZXMsIHRoZXkgY2FuIHN0aWxsIGJlIGEgY3VycmVudCB1c2VyLg0KDQoNCmBgYHtyfQ0KdGVzdCA8LSB0ZXN0ICU+JQ0KICAgICAgICAgbXV0YXRlKGVjaWdfb25seV9ldmVyID0gY2FzZV93aGVuKGVjaWdfZXZlciA9PSBUUlVFICYNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vbl9lY2lnX2V2ZXIgPT0gRkFMU0UgJg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVjaWdfY3VycmVudCA9PSBGQUxTRSAmDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub25fZWNpZ19jdXJyZW50ID09IEZBTFNFIH4gVFJVRSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVFJVRSB+IEZBTFNFKSwNCiAgICAgICAgICBlY2lnX29ubHlfY3VycmVudCA9IGNhc2Vfd2hlbihlY2lnX2N1cnJlbnQgPT0gVFJVRSAmDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub25fZWNpZ19ldmVyID09IEZBTFNFICYNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vbl9lY2lnX2N1cnJlbnQgPT0gRkFMU0UgfiBUUlVFLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBUUlVFIH4gRkFMU0UpLA0KICAgICAgICBub25fZWNpZ19vbmx5X2V2ZXIgPSBjYXNlX3doZW4obm9uX2VjaWdfZXZlciA9PSBUUlVFICYNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlY2lnX2V2ZXIgPT0gRkFMU0UgJg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVjaWdfY3VycmVudCA9PSBGQUxTRSAmDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub25fZWNpZ19jdXJyZW50ID09IEZBTFNFIH4gVFJVRSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVFJVRSB+IEZBTFNFKSwNCiAgbm9uX2VjaWdfb25seV9jdXJyZW50ID0gY2FzZV93aGVuKG5vbl9lY2lnX2N1cnJlbnQgPT0gVFJVRSAmDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWNpZ19ldmVyID09IEZBTFNFICYNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlY2lnX2N1cnJlbnQgPT0gRkFMU0UgfiBUUlVFLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBUUlVFIH4gRkFMU0UpLA0KICAgICAgICAgICAgICAgICAgICBub191c2UgPSBjYXNlX3doZW4obm9uX2VjaWdfZXZlciA9PSBGQUxTRSAmDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWNpZ19ldmVyID09IEZBTFNFICYNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlY2lnX2N1cnJlbnQgPT0gRkFMU0UgJg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9uX2VjaWdfY3VycmVudCA9PSBGQUxTRSB+IFRSVUUsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFRSVUUgfiBGQUxTRSkpDQpnbGltcHNlKHRlc3QpDQpgYGANCg0KDQoNClRha2UgYSBtaW51dGUgdG8gY2hlY2sgdGhhdCB0aGUgdmFsdWVzIGFyZSB3aGF0IHdlIHdvdWxkIGV4cGVjdC4NCg0KT0ssIG5vdyB3ZSBhcmUgZ29pbmcgdG8gbWFrZSBhIGBHcm91cGAgdmFyaWFibGUgYmFzZWQgb24gdGhlIG5ldyB2YXJpYWJsZXMgd2UganVzdCBtYWRlIHRvIGNsYXNzaWZ5IHN0dWRlbnRzIGludG8gb25lIG9mIGZvdXIgbXV0dWFsbHkgZXhjbHVzaXZlIGFuZCBleGhhdXN0aXZlIGNhdGVnb3JpZXMuIEluIHRoaXMgY2FzZSB3ZSB3aWxsIGhhdmUgYSBwYXJ0aWN1bGFyIHZhbHVlIGJhc2VkIG9uIG9uZSBjb25kaXRpb24gKipvcioqIGFub3RoZXIuIFRoaXMgKipvcioqIGNvbmRpdGlvbmFsIGlzIHNwZWNpZmllZCBieSB0aGUgYHxgIHN5bWJvbC4gT25seSBvbmUgb2YgdGhlIGNvbmRpdGlvbnMgbmVlZHMgdG8gZXhpc3QgZm9yIHRoYXQgcGFydGljdWxhciB2YWx1ZSwgd2hlcmVhcyB3aGVuIHdlIHVzZWQgdGhlIGAmYCBzeW1ib2wsIGFsbCBvZiB0aGUgY29uZGl0aW9ucyBoYWQgdG8gYmUgbWV0LiANCg0KSWYgYSBzdHVkZW50IGhhcyBldmVyIHRyaWVkIG9yIGN1cnJlbnRseSB1c2VzIGUtY2lnYXJldHRlcywgYnV0IGhhcyBuZXZlciB0cmllZCBvdGhlciB0b2JhY2NvIHByb2R1Y3RzLCB0aGUgdmFsdWUgd2lsbCBiZSBgT25seSBlLWNpZ2FyZXR0ZXNgLiBJZiBhIHN0dWRlbnQgaGFzIGV2ZXIgdHJpZWQgb3IgaXMgYSBjdXJyZW50IHVzZXIgb2Ygb3RoZXIgdG9iYWNjbyBwcm9kdWN0cywgYnV0IGhhcyBuZXZlciB0cmllZCBlLWNpZ2FyZXR0ZXMsIHRoZSB2YWx1ZSB3aWxsIGJlIGBPbmx5IG90aGVyIHByb2R1Y3RzYC4gSWYgdGhlIHZhbHVlIG9mIHRoZSBgbm9fdXNlYCB2YXJpYWJsZSBpcyBzaW1wbHkgYFRSVUVgLCB0aGVuIHRoZSBgR3JvdXBgIHZhcmlhYmxlIHZhbHVlIHdpbGwgYmUgYE5laXRoZXJgLiBGaW5hbGx5LCBpZiBhIHN0dWRlbnQgaGFzIHRyaWVkIG9yIGN1cnJlbnRseSB1c2VzIGJvdGggZS1jaWdhcmV0dGVzIGFuZCBvdGhlciB0b2JhY2NvIHByb2R1Y3RzIHRoZSBgR3JvdXBgIHZhcmlhYmxlIHZhbHVlIHdpbGwgYmUgYENvbWJpbmF0aW9uIG9mIHByb2R1Y3RzYC4gVGh1cyBpbiB0aGlzIGNhc2UgdGhlIHZhbHVlcyBmb3IgdGhlIHVzYWdlIG9mIHRoZSB2YXJpYWJsZXMgYmFzZWQgb24gKipvbmx5KiogdXNpbmcgZS1jaWdhcmV0dGVzIG9yICoqb25seSoqIG90aGVyIHByb2R1Y3RzIHdpbGwgYWxsIGJlIGBGQUxTRWAuIA0KDQpgYGB7Un0NCg0KdGVzdCA8LSB0ZXN0ICU+JQ0KICBtdXRhdGUoR3JvdXAgPSBjYXNlX3doZW4oZWNpZ19vbmx5X2V2ZXIgPT0gVFJVRSB8DQogICAgICAgICAgICAgICAgICAgICAgICBlY2lnX29ubHlfY3VycmVudCA9PSBUUlVFIH4gIk9ubHkgZS1jaWdhcmV0dGVzIiwNCiAgICAgICAgICAgICAgICAgICAgICAgbm9uX2VjaWdfb25seV9ldmVyID09IFRSVUUgfA0KICAgICAgICAgICAgICAgICAgICBub25fZWNpZ19vbmx5X2N1cnJlbnQgPT0gVFJVRSB+ICJPbmx5IG90aGVyIHByb2R1Y3RzIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9fdXNlID09IFRSVUUgfiAiTmVpdGhlciIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICBlY2lnX29ubHlfZXZlciA9PSBGQUxTRSAmDQogICAgICAgICAgICAgICAgICAgICAgICBlY2lnX29ubHlfY3VycmVudCA9PSBGQUxTRSAmDQogICAgICAgICAgICAgICAgICAgICAgIG5vbl9lY2lnX29ubHlfZXZlciA9PSBGQUxTRSAmDQogICAgICAgICAgICAgICAgICAgIG5vbl9lY2lnX29ubHlfY3VycmVudCA9PSBGQUxTRSAmDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vX3VzZSA9PSBGQUxTRSB+ICJDb21iaW5hdGlvbiBvZiBwcm9kdWN0cyIpKQ0KDQoNCnRlc3QgJT4lIGNvdW50KEdyb3VwKQ0KDQpnbGltcHNlKHRlc3QpDQpgYGANCg0KT0ssIG5vdyB0aGF0IHdlIGhhdmUgc2VlbiBob3cgdGhpcyB3b3JrcyB3aXRoIG91ciB0b3kgZGF0YXNldCwgd2Ugd2lsbCBhcHBseSBvdXIgY29kZSB0byBvdXIgYG55dHNfZGF0YWAuDQoNCmBgYHtyfQ0Kbnl0c19kYXRhICU8PiUNCiAgICAgICAgICAgICBtdXRhdGUoZWNpZ19vbmx5X2V2ZXIgPSBjYXNlX3doZW4oZWNpZ19ldmVyID09IFRSVUUgJg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vbl9lY2lnX2V2ZXIgPT0gRkFMU0UgJg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlY2lnX2N1cnJlbnQgPT0gRkFMU0UgJg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vbl9lY2lnX2N1cnJlbnQgPT0gRkFMU0UgfiBUUlVFLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFRSVUUgfiBGQUxTRSksDQogICAgICAgICAgICAgIGVjaWdfb25seV9jdXJyZW50ID0gY2FzZV93aGVuKGVjaWdfY3VycmVudCA9PSBUUlVFICYNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub25fZWNpZ19ldmVyID09IEZBTFNFICYNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub25fZWNpZ19jdXJyZW50ID09IEZBTFNFIH4gVFJVRSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFRSVUUgfiBGQUxTRSksDQogICAgICAgICAgICBub25fZWNpZ19vbmx5X2V2ZXIgPSBjYXNlX3doZW4obm9uX2VjaWdfZXZlciA9PSBUUlVFICYNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWNpZ19ldmVyID09IEZBTFNFICYNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWNpZ19jdXJyZW50ID09IEZBTFNFICYNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub25fZWNpZ19jdXJyZW50ID09IEZBTFNFIH4gVFJVRSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFRSVUUgfiBGQUxTRSksDQogICAgICBub25fZWNpZ19vbmx5X2N1cnJlbnQgPSBjYXNlX3doZW4obm9uX2VjaWdfY3VycmVudCA9PSBUUlVFICYNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWNpZ19ldmVyID09IEZBTFNFICYNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWNpZ19jdXJyZW50ID09IEZBTFNFIH4gVFJVRSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFRSVUUgfiBGQUxTRSksDQogICAgICAgICAgICAgICAgICAgICAgICBub191c2UgPSBjYXNlX3doZW4obm9uX2VjaWdfZXZlciA9PSBGQUxTRSAmDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVjaWdfZXZlciA9PSBGQUxTRSAmDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVjaWdfY3VycmVudCA9PSBGQUxTRSAmDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9uX2VjaWdfY3VycmVudCA9PSBGQUxTRSB+IFRSVUUsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBUUlVFIH4gRkFMU0UpKSAlPiUNCiAgICAgICAgICAgICAgICAgbXV0YXRlKEdyb3VwID0gY2FzZV93aGVuKGVjaWdfb25seV9ldmVyID09IFRSVUUgfA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWNpZ19vbmx5X2N1cnJlbnQgPT0gVFJVRSB+ICJPbmx5IGUtY2lnYXJldHRlcyIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vbl9lY2lnX29ubHlfZXZlciA9PSBUUlVFIHwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9uX2VjaWdfb25seV9jdXJyZW50ID09IFRSVUUgfiAiT25seSBvdGhlciBwcm9kdWN0cyIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vX3VzZSA9PSBUUlVFIH4gIk5laXRoZXIiLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWNpZ19vbmx5X2V2ZXIgPT0gRkFMU0UgJg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWNpZ19vbmx5X2N1cnJlbnQgPT0gRkFMU0UgJg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub25fZWNpZ19vbmx5X2V2ZXIgPT0gRkFMU0UgJg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub25fZWNpZ19vbmx5X2N1cnJlbnQgPT0gRkFMU0UgJg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub191c2UgPT0gRkFMU0UgfiAiQ29tYmluYXRpb24gb2YgcHJvZHVjdHMiKSkNCmBgYA0KDQoNCkxhc3RseSwgaXQgY2FuIGJlIHZlcnkgaGVscGZ1bCB0byBoYXZlIHRoZSB0b3RhbCBudW1iZXIgb2Ygc3R1ZGVudHMgc3VydmV5ZWQgZWFjaCB5ZWFyLiBXZSBjYW4gZWFzaWx5IGFkZCBhIHZhcmlhYmxlIGZvciB0aGlzIGJ5IHVzaW5nIHRoZSBgYWRkX2NvdW50KClgIGZ1bmN0aW9uIG9mIHRoZSBgZHBseXJgIHBhY2thZ2UuIFRoaXMgd2lsbCBjcmVhdGUgYSB2YXJpYWJsZSBjYWxsZWQgYG5gIHdoaWNoIHdpbGwgc2hvdyB0aGUgdG90YWwgbnVtYmVyIG9mIHN1cnZleSByZXNwb25zZXMgZm9yIHRoYXQgeWVhci4NCg0KYGBge3J9DQpueXRzX2RhdGEgJTw+JSBkcGx5cjo6YWRkX2NvdW50KHllYXIpDQpgYGANCg0KIyMjIyB7LnNjcm9sbGFibGV9DQpgYGB7cn0NCmdsaW1wc2Uobnl0c19kYXRhKQ0KYGBgDQoNCmBgYHtyLCBlY2hvID0gRkFMU0UsIGV2YWwgPSBGQUxTRX0NCnNhdmUobnl0c19kYXRhLCBmaWxlID0gaGVyZTo6aGVyZSgiZGF0YSIsICJ3cmFuZ2xlZF9kYXRhX3dpdGhfdmFyX2Zvcl9wbG90cy5yZGEiKSkNCmBgYA0KDQojIyMgKipRdWVzdGlvbiAxKioNCioqKg0KDQpgYGB7ciwgZWNobyA9IEZBTFNFfQ0KIyBJZiBpbnN0cnVjdG9ycyB3YW50IHRvIHN0YXJ0IGhlcmUsIHdlIG5lZWQgdG8gbG9hZCB0aGUgZGF0YToNCiMgbG9hZChoZXJlOjpoZXJlKCJkYXRhIiwgIndyYW5nbGVkX2RhdGFfd2l0aF92YXJfZm9yX3Bsb3RzLnJkYSIpKQ0KbG9hZCgid3d3L2RhdGEvd3JhbmdsZWRfZGF0YV93aXRoX3Zhcl9mb3JfcGxvdHMucmRhIikNCmBgYA0KDQpSZWNhbGwgdGhhdCB3ZSBhcmUgaW50ZXJlc3RlZCBpbiBpbnZlc3RpZ2F0aW5nIGhvdyB2YXBpbmcgcHJvZHVjdCB1c2UgaGFzIGNvbXBhcmVkIHdpdGggb3RoZXIgdG9iYWNjbyB1c2Ugb3ZlciB0aW1lLiBUbyBhbnN3ZXIgdGhpcywgd2UgZmlyc3Qgd2FudCB0byBnZXQgYSBzZW5zZSBvZiBob3cgdG9iYWNjbyB1c2UgaGFzIGNoYW5nZWQgaW4gZ2VuZXJhbCBzaW5jZSAyMDE1LiANCg0KVG8gY3JlYXRlIGEgdmlzdWFsaXphdGlvbiBvZiBob3cgdG9iYWNjbyB1c2FnZSBoYXMgY2hhbmdlZCBvdmVyIHRpbWUsIHdlIHdpbGwgZmlyc3QgY29udmVydCB0aGUgdXNhZ2UgZGF0YSB0byBhIHBlcmNlbnQgdmFsdWUgZm9yIGVhY2ggeWVhciwgdGVsbGluZyB1cyB3aGF0IHBlcmNlbnQgb2Ygc3R1ZGVudCByZXNwb25kZW50cyBmYWxsIGludG8gYSBwYXJ0aWN1bGFyIHVzYWdlIGNhdGVnb3J5LiBUbyBkbyB0aGlzIHdlIHdpbGwgdXNlIHRoZSBgZ3JvdXBfYnkoKWAgYW5kIGBzdW1tYXJpemUoKWAgZnVuY3Rpb25zIG9mIHRoZSBgZHBseXJgIHBhY2thZ2UuIFRoaXMgd2lsbCBjcmVhdGUgbmV3IHZhcmlhYmxlcyB3aGljaCB3ZSB3aWxsIG5hbWUgYEV2ZXJgIGFuZCBgQ3VycmVudGAgYmFzZWQgb24gdGhlICBwZXJjZW50YWdlcyBvZiBgVFJVRWAgdmFsdWVzIGZvciBgdG9iYWNjb19ldmVyYCBhbmQgYHRvYmFjY29fY3VycmVudGAgZm9yIGVhY2ggeWVhci4gSW4gdGhpcyBjYXNlIHRoZSBgbWVhbigpYCBmdW5jdGlvbiBpcyB1c2VkIHRvIGNhbGN1bGF0ZSB0aGUgcGVyY2VudGFnZXMgYmFzZWQgb24gYW4gYXV0b21hdGljIGNvbnZlcnNpb24gdGhhdCBSIGRvZXMgd2hlcmUgZm9yIFRSVUUvRkFMU0UgdmFyaWFibGVzLCBgVFJVRWAgaXMgZ2l2ZW4gYSB2YWx1ZSBvZiBvbmUgYW5kIGBGQUxTRWAgaXMgZ2l2ZW4gYSB2YWx1ZSBvZiB6ZXJvLiBUaGUgbWVhbiBvZiBhIDAtMSBiaW5hcnkgdmFyaWFibGUgaXMganVzdCB0aGUgcGVyY2VudCBvZiB0aGUgdGltZSB0aGUgdmFsdWUgaXMgMS4gTkEgdmFsdWVzIGRvIG5vdCBjb250cmlidXRlIHRvIHRoZSB0b3RhbCBjb3VudCB3aGVuIHdlIGluY2x1ZGUgdGhlIGFyZ3VtZW50IGBuYS5ybSA9IFRSVUVgIHRvIG91ciBmdW5jdGlvbiBjYWxsLiANCg0KKioqDQoNCjxkZXRhaWxzPiA8c3VtbWFyeT4gQ2xpY2sgaGVyZSB0byBzZWUgYSB0b3kgZXhhbXBsZTo8L3N1bW1hcnk+DQpgYGB7cn0NCiMgdGhlIHRlc3QgZGF0YSBoYXMgMyBUUlVFIHZhbHVlcyBhbmQgNyBGQUxTRSB2YWx1ZXMNCnRlc3QgPC0gdGliYmxlKCJ2YXIxIiA9IGMoIlRSVUUiLCAiVFJVRSIsICJUUlVFIiwgcmVwKCJGQUxTRSIsIDcpKSkNCnRlc3QgJTw+JSBtdXRhdGUodmFyMSA9IGFzLmxvZ2ljYWwodmFyMSkpDQp0ZXN0DQoNCnRlc3QgJT4lIHN1bW1hcml6ZShQZXJjZW50YWdlID0gbWVhbih2YXIxKSAqIDEwMCkNCg0KDQojIHRoZSB0ZXN0IGRhdGEgaGFzIDMgVFJVRSB2YWx1ZXMsIDMgRkFMU0UgdmFsdWVzLCBhbmQgNCBOQSB2YWx1ZQ0KdGVzdCA8LSB0aWJibGUoInZhcjEiID0gYygiVFJVRSIsICJUUlVFIiwgIlRSVUUiLCByZXAoIkZBTFNFIiwgMyksIHJlcCgiTkEiLCA0KSkpDQp0ZXN0ICU8PiUgbXV0YXRlKHZhcjEgPSBhcy5sb2dpY2FsKHZhcjEpKQ0KdGVzdA0KDQp0ZXN0ICU+JSBzdW1tYXJpemUoUGVyY2VudGFnZSA9IG1lYW4odmFyMSwgbmEucm0gPSBUUlVFKSAqIDEwMCkNCmBgYA0KPC9kZXRhaWxzPg0KDQoqKioNCg0KQW5kIG5vdyBiYWNrIHRvIG91ciBkYXRhOg0KDQpgYGB7cn0NCg0Kbnl0c19kYXRhICU+JQ0KICBkcGx5cjo6Z3JvdXBfYnkoeWVhcikgJT4lDQogIGRwbHlyOjpzdW1tYXJpemUoRXZlciA9IChtZWFuKHRvYmFjY29fZXZlciwgbmEucm0gPSBUUlVFKSAqIDEwMCksDQogICAgICAgICAgICAgICAgICAgQ3VycmVudCA9IChtZWFuKHRvYmFjY29fY3VycmVudCwgbmEucm0gPSBUUlVFKSAqIDEwMCkpDQpgYGANCg0KV2Ugd2lsbCB1c2UgdGhlIGBwaXZvdF9sb25nZXJgIGZ1bmN0aW9uIGZyb20gdGhlIGB0aWR5cmAgcGFja2FnZSB0byB0YWtlIGFsbCBjb2x1bW5zIGV4Y2VwdCB5ZWFyIChpbiB0aGlzIGNhc2UgdGhlIGBFdmVyYCBhbmQgYEN1cnJlbnRgIGNvbHVtbnMpLCB0byBjcmVhdGUgYSBjb2x1bW4gY2FsbGVkIGBVc2VyYCB0aGF0IHdpbGwgY29udGFpbiB0aGUgY3VycmVudCBjb2x1bW4gbmFtZSBpbmZvcm1hdGlvbiBhbmQgYSBjb2x1bW4gY2FsbGVkIGBQZXJjZW50YWdlIG9mIHN0dWRlbnRzYCB3aGljaCB3aWxsIGNvbnRhaW4gdGhlIG1lYW4gcGVyY2VudGFnZSB2YWx1ZXMgdGhhdCB3ZSBqdXN0IGNhbGN1bGF0ZWQuIFRoaXMgY29udmVydHMgb3VyIGRhdGEgaW50byBhIGZvcm1hdCBjYWxsZWQgImxvbmciIGZvcm1hdC4NCg0KYGBge3J9DQoNCm55dHNfZGF0YSAlPiUNCiAgZHBseXI6Omdyb3VwX2J5KHllYXIpICU+JQ0KICBkcGx5cjo6c3VtbWFyaXplKEV2ZXIgPSAobWVhbih0b2JhY2NvX2V2ZXIsIG5hLnJtID0gVFJVRSkgKiAxMDApLA0KICAgICAgICAgICAgICAgICAgIEN1cnJlbnQgPSAobWVhbih0b2JhY2NvX2N1cnJlbnQsIG5hLnJtID0gVFJVRSkgKiAxMDApKSAlPiUNCiAgdGlkeXI6OnBpdm90X2xvbmdlcihjb2xzID0gLXllYXIsDQogICAgICAgICAgICAgICAgICAgICAgbmFtZXNfdG8gPSAiVXNlciIsDQogICAgICAgICAgICAgICAgICAgICAgdmFsdWVzX3RvID0gIlBlcmNlbnRhZ2Ugb2Ygc3R1ZGVudHMiKQ0KYGBgDQpZb3UgbWF5IGhhdmUgbm90aWNlZCB0aGF0IG91ciBkYXRhIGlzIGxvbmdlciB0aGFuIGl0IHVzZWQgdG8gYmUhIEhlbmNlIHRoZSBuYW1lIG9mIHRoZSBmdW5jdGlvbiBgcGl2b3RfbG9uZ2VyKClgLiBEYXRhIGlzIG9mdGVuIGVhc2llciB0byBwbG90IHdoZW4gaXQgaXMgaW4gdGhpcyBmb3JtYXQuDQogIA0KTm93IHdlIHdpbGwgdXNlIHRoaXMgZGF0YSB0byBjcmVhdGUgYSBwbG90IHVzaW5nIHRoZSBgZ2dwbG90MmAgcGFja2FnZS4gDQoNClRoZSBmaXJzdCB0aGluZyB3ZSBkbyB0byBjcmVhdGUgYSBwbG90IGlzIHNwZWNpZnkgd2hhdCBkYXRhIHdlIGFyZSB1c2luZyBmb3Igb3VyIHggYXhpcyBhbmQgeSBheGlzIHdpdGggdGhlYGFlcygpYCBhcmd1bWVudCBvZiB0aGUgYGdncGxvdCgpYCBmdW5jdGlvbi4gVGhlbiB3ZSBhZGQgbGF5ZXJzIHRvIG91ciBwbG90IHRoYXQgc3BlY2lmeSB3aGF0IHR5cGUgb2YgcGxvdCB3ZSB3b3VsZCBsaWtlIHRvIGNyZWF0ZS4gV2UgY2FuIHVzZSB0aGUgYGdlb21fbGluZSgpYCBmdW5jdGlvbiB0byBjcmVhdGUgbGluZXMgZm9yIGVhY2ggdHlwZSBvZiB1c2VyLiBXZSBzcGVjaWZ5IHRoYXQgd2Ugd2FudCB0byB1c2UgZGlmZmVyZW50IGxpbmUgdHlwZXMgZm9yIGVhY2ggdXNlciB1c2luZyBgYWVzKClgLiBXZSB3aWxsIGFsc28gYWRkIHBvaW50cyB0byBvdXIgbGluZXMgdXNpbmcgdGhlIGBnZW9tX3BvaW50KClgIGZ1bmN0aW9uLiBXZSBjYW4gYWRkIGFkZGl0aW9uYWwgbGF5ZXJzIHRvIHNwZWNpZnkgY29sb3JzIGFuZCBkZXRhaWxzIGFib3V0IGxhYmVscyBhbmQgbGVnZW5kcyBldGMuDQogIA0KYGBge3J9ICANCg0KcGxvdDEgPC0gbnl0c19kYXRhICU+JQ0KICAgIGRwbHlyOjpncm91cF9ieSh5ZWFyKSAlPiUNCiAgICBkcGx5cjo6c3VtbWFyaXplKEV2ZXIgPSAobWVhbih0b2JhY2NvX2V2ZXIsIG5hLnJtID0gVFJVRSkgKiAxMDApLA0KICAgICAgICAgICAgICAgICAgICAgQ3VycmVudCA9IChtZWFuKHRvYmFjY29fY3VycmVudCwgbmEucm0gPSBUUlVFKSAqIDEwMCkpICU+JQ0KICBwaXZvdF9sb25nZXIoY29scyA9IC15ZWFyLCBuYW1lc190byA9ICJVc2VyIiwgdmFsdWVzX3RvID0gIlBlcmNlbnRhZ2Ugb2Ygc3R1ZGVudHMiKSAlPiUNCiAgZ2dwbG90KGFlcyh4ID0geWVhciwgeSA9IGBQZXJjZW50YWdlIG9mIHN0dWRlbnRzYCkpICsNCiAgZ2VvbV9saW5lKGFlcyhsaW5ldHlwZSA9IFVzZXIpKSArDQogIGdlb21fcG9pbnQoc2hvdy5sZWdlbmQgPSBGQUxTRSwgc2l6ZSA9IDIpICsNCiAgIyB0aGlzIGFsbG93cyB1cyB0byBjaG9vc2Ugd2hhdCB0eXBlIG9mIGxpbmUgd2Ugd2FudCBmb3IgZWFjaCBsaW5lDQogIHNjYWxlX2xpbmV0eXBlX21hbnVhbCh2YWx1ZXMgPSBjKDIsIDEpKSArDQogICMgdGhpcyBhbGxvd3MgdXMgdG8gc3BlY2lmeSBob3cgdGhlIHktYXhpcyBzaG91bGQgYXBwZWFyDQogIHNjYWxlX3lfY29udGludW91cyhicmVha3MgPSBzZXEoMCwgNzAsIGJ5ID0gMTApLA0KICAgICAgICAgICAgICAgICAgICAgbGFiZWxzID0gc2VxKDAsIDcwLCBieSA9IDEwKSwNCiAgICAgICAgICAgICAgICAgICAgIGxpbWl0cyA9IGMoMCwgNzApKSArDQogICMgdGhpcyBhZGp1c3RzIHRoZSBiYWNrZ3JvdW5kIHN0eWxlIG9mIHRoZSBwbG90DQogICAgdGhlbWVfbGluZWRyYXcoKSArDQogICMgdGhpcyBtb3ZlcyB0aGUgbGVnZW5kIHRvIHRoZSBib3R0b20gb2YgdGhlIHBsb3QgYW5kIHJlbW92ZXMgdGhlIHggYXhpcyB0aXRsZQ0KICAgIHRoZW1lKGxlZ2VuZC5wb3NpdGlvbiA9ICJib3R0b20iLA0KICAgICAgICAgIGF4aXMudGl0bGUueCA9IGVsZW1lbnRfYmxhbmsoKSkgKw0KICAgIGxhYnModGl0bGUgPSAiSG93IGhhcyB0b2JhY2NvIHVzZSB2YXJpZWQgb3ZlciB0aGUgeWVhcnM/IiwNCiAgICAgICAgIHkgPSAiJSBvZiBzdHVkZW50cyIpDQoNCnBsb3QxDQpgYGANCg0KTmljZSEgTm93IHdlIGNhbiBzZWUgaG93IG92ZXJhbGwgdG9iYWNjbyB1c2FnZSBoYXMgY2hhbmdlZCBzaW5jZSAyMDE3LiBJdCBhcHBlYXJzIHRoYXQgdXNhZ2UgZmlyc3QgZGVjcmVhc2VkIGZyb20gMjAxNSB0byAyMDE3IGFuZCB0aGVuIGluY3JlYXNlZCBhIGJpdCBzaW5jZSAyMDE3LCBzdXJwYXNzaW5nIHRoZSBsZXZlbHMgaW4gMjAxNS4NCg0KV2hhdCBhYm91dCBlLWNpZ2FyZXR0ZSB1c2U/IEhvdyBoYXMgdGhlIHVzYWdlIG9mIGUtY2lnYXJldHRlcyBjaGFuZ2VkIG92ZXIgdGltZT8NCg0KYGBge3J9DQpwbG90MWEgPC0gbnl0c19kYXRhICU+JQ0KICAgIGRwbHlyOjpncm91cF9ieSh5ZWFyKSAlPiUNCiAgICBkcGx5cjo6c3VtbWFyaXplKEV2ZXIgPSAobWVhbihlY2lnX2V2ZXIsIG5hLnJtID0gVFJVRSkgKiAxMDApLA0KICAgICAgICAgICAgICAgICAgICAgQ3VycmVudCA9IChtZWFuKGVjaWdfY3VycmVudCwgbmEucm0gPSBUUlVFKSAqIDEwMCkpICU+JQ0KICBwaXZvdF9sb25nZXIoY29scyA9IC15ZWFyLCBuYW1lc190byA9ICJVc2VyIiwgdmFsdWVzX3RvID0gIlBlcmNlbnRhZ2Ugb2Ygc3R1ZGVudHMiKSAlPiUNCiAgZ2dwbG90KGFlcyh4ID0geWVhciwgeSA9IGBQZXJjZW50YWdlIG9mIHN0dWRlbnRzYCkpICsNCiAgZ2VvbV9saW5lKGFlcyhsaW5ldHlwZSA9IFVzZXIpKSArDQogIGdlb21fcG9pbnQoc2hvdy5sZWdlbmQgPSBGQUxTRSwgc2l6ZSA9IDIpICsNCiAgIyB0aGlzIGFsbG93cyB1cyB0byBjaG9vc2Ugd2hhdCB0eXBlIG9mIGxpbmUgd2Ugd2FudCBmb3IgZWFjaCBsaW5lDQogIHNjYWxlX2xpbmV0eXBlX21hbnVhbCh2YWx1ZXMgPSBjKDIsIDEpKSArDQogICMgdGhpcyBhbGxvd3MgdXMgdG8gc3BlY2lmeSBob3cgdGhlIHktYXhpcyBzaG91bGQgYXBwZWFyDQogIHNjYWxlX3lfY29udGludW91cyhicmVha3MgPSBzZXEoMCwgNjAsIGJ5ID0gMTApLA0KICAgICAgICAgICAgICAgICAgICAgbGFiZWxzID0gc2VxKDAsIDYwLCBieSA9IDEwKSwNCiAgICAgICAgICAgICAgICAgICAgIGxpbWl0cyA9IGMoMCwgNjApKSArDQogICMgdGhpcyBhZGp1c3RzIHRoZSBiYWNrZ3JvdW5kIHN0eWxlIG9mIHRoZSBwbG90DQogICAgdGhlbWVfbGluZWRyYXcoKSArDQogICMgdGhpcyBtb3ZlcyB0aGUgbGVnZW5kIHRvIHRoZSBib3R0b20gb2YgdGhlIHBsb3QgYW5kIHJlbW92ZXMgdGhlIHggYXhpcyB0aXRsZQ0KICAgIHRoZW1lKGxlZ2VuZC5wb3NpdGlvbiA9ICJib3R0b20iLA0KICAgICAgICAgIGF4aXMudGl0bGUueCA9IGVsZW1lbnRfYmxhbmsoKSkgKw0KICAgIGxhYnModGl0bGUgPSAiSG93IGhhcyBlLWNpZ2FyZXR0ZSB1c2UgdmFyaWVkIG92ZXIgdGhlIHllYXJzPyIsDQogICAgICAgICB5ID0gIiUgb2Ygc3R1ZGVudHMiKQ0KDQpwbG90MWENCmBgYA0KSXQgbG9va3MgbGlrZSB0aGUgc2hhcGUgb2YgdGhlIHBsb3QgaXMgdmVyeSBzaW1pbGFyIHRvIHRvYmFjY28gdXNhZ2Ugb3ZlcmFsbC4gV2Ugc2VlIGEgZG93bndhcmQgdHJlbmQgdW50aWwgMjAxNyB3aGVuIHRoZSByYXRlIG9mIGJvdGggY3VycmVudCBhbmQgZXZlciB1c2VycyBpbmNyZWFzZWQuIFJlY2FsbCB0aGF0IHRoaXMgaXMgaW4gYWdyZWVtZW50IHdpdGggdGhlIGFydGljbGVzIHRoYXQgd2UgcmVmZXJlbmNlZCBlYXJsaWVyLiBXZSBjYW4gc2VlIHRoYXQgdGhlIHNsb3BlIGxvb2tzIHN0ZWVwZXIgZm9yIGUtY2lnYXJldHRlIHVzYWdlIGFzIGNvbXBhcmVkIHRvIGFsbCB0b2JhY2NvIHByb2R1Y3RzIChpbmNsdWRpbmcgZS1jaWdhcmV0dGVzKS4NCg0KDQpOb3cgbGV0J3MgcGxvdCB0aGlzIGRhdGEgdG9nZXRoZXIgb24gdGhlIHNhbWUgcGxvdC4NCg0KV2Ugd2lsbCBoYXZlIGZvdXIgZ3JvdXBzIChlLWNpZ2FyZXR0ZSBldmVyIHVzZXJzLCBlLWNpZ2FyZXR0ZSBjdXJyZW50IHVzZXJzLCB0b2JhY2NvIGV2ZXIgdXNlcnMsIGFuZCB0b2JhY2NvIGN1cnJlbnQgdXNlcnMpIHRvIHBsb3QsIHRoZXJlZm9yZSwgaXQgd291bGQgYmUgdXNlZnVsIHRvIGFkZCBjb2xvciB0byBvdXIgcGxvdC4gS2VlcCBpbiBtaW5kIHRoYXQgZS1jaWdhcmV0dGUgdXNlcnMgYXJlIGEgc3Vic2V0IG9mIGFueSB0b2JhY2NvIHByb2R1Y3QgdXNlcnMuDQoNCk9uZSBpbXBvcnRhbnQgdGhpbmcgdG8ga2VlcCBpbiBtaW5kIHdoZW4gY3JlYXRpbmcgcGxvdHMgaXMgdGhhdCBpbmRpdmlkdWFscyB3aXRoIGNvbG9yIGJsaW5kbmVzcyBtYXkgaGF2ZSBhIGRpZmZpY3VsdCB0aW1lIGRpc3Rpbmd1aXNoaW5nIGdyb3VwcyB3aGVuIGNlcnRhaW4gY29sb3IgY2hvaWNlcyBhcmUgdXNlZC4gDQoNCk9uZSBncmVhdCBvcHRpb24gaXMgdG8gdXNlIHRoZSBgdmlyaWRpc2AgcGFja2FnZSwgd2hpY2ggb2ZmZXJzIGNvbG9yIHBhbGV0dGVzIHdpdGggY29sb3JzIHRoYXQgYXJlIHN0aWxsIGRpc3Rpbmd1aXNoYWJsZSBieSBpbmRpdmlkdWFscyB3aXRoIG1vc3QgZm9ybXMgb2YgY29sb3IgYmxpbmRuZXNzLiANCg0KV2UgY2FuIGNob29zZSB3aGljaCBjb2xvcnMgd2Ugd2FudCB0byB1c2UgYnkgdXNpbmcgdGhlIGBzaG93X2NvbCgpYCBmdW5jdGlvbiBvZiB0aGUgYHNjYWxlc2AgcGFja2FnZS4NCg0KSGVyZSBhcmUgc29tZSBjb2xvciBvcHRpb25zOg0KYGBge3J9DQoNCnNjYWxlczo6c2hvd19jb2wodmlyaWRpc19wYWwoKSg2KSkNCnZfY29sb3JzID0gIHZpcmlkaXMoNilbYygxLCA0KV0NCmBgYA0KDQpXZSB3aWxsIHNlbGVjdCB0aGUgZmlyc3QgYW5kIGZvdXJ0aCBjb2xvcnMgZm9yIG91ciBwbG90LiBUbyBhZGQgdGhlc2Ugc3BlY2lmaWMgY29sb3JzIHdlIHdpbGwgdXNlIHRoZSBgc2NhbGVfY29sb3JfbWFudWFsKClgIGZ1bmN0aW9uIG9mIHRoZSBgZ2dwbG90MmAgcGFja2FnZS4NCg0KV2Ugd2lsbCBjYWxjdWxhdGUgdGhlIG1lYW4gZXZlciBhbmQgY3VycmVudCB1c2FnZSBwZXJjZW50YWdlcyBmb3Igc3R1ZGVudHMgd2hvIHVzZWQgZS1jaWdhcmV0dGVzIG9yIGFueSB0b2JhY2NvIHByb2R1Y3RzIChpbmNsdWRpbmcgZS1jaWdhcmV0dGVzKSBmb3IgZWFjaCB5ZWFyIGFnYWluIHVzaW5nIHRoZSBgZ3JvdXBfYnkoKWAgYW5kIGBzdW1tYXJpemUoKWAgZnVuY3Rpb25zLiBXZSB3aWxsIGFnYWluIHVzZSB0aGUgYHBpdm90X2xvbmdlcmAgZnVuY3Rpb24gdG8gY29udmVydCBvdXIgZGF0YSB0byBsb25nIGZvcm1hdC4gV2Ugd2lsbCBhbHNvIHVzZSB0aGUgYHNlcGFyYXRlKClgIGZ1bmN0aW9uIG9mIHRoZSBgdGlkeXJgIHBhY2thZ2UgdG8gY3JlYXRlIHR3byB2YXJpYWJsZXMgZnJvbSBvbmUgb2YgdGhlIHZhcmlhYmxlcy4gVGhpcyBpcyBkb25lIGJ5IHNlcGFyYXRpbmcgYnksIGluIHRoaXMgY2FzZSwgYW4gdW5kZXJzY29yZS4gDQoNCg0KYGBge3J9DQpueXRzX2RhdGEgJT4lDQogICAgZHBseXI6Omdyb3VwX2J5KHllYXIpICU+JQ0KICAgIGRwbHlyOjpzdW1tYXJpemUoIkV2ZXJfQW55IFRvYmFjY28gUHJvZHVjdCBcbiAoaW5jbHVkaW5nIGUtY2lnYXJldHRlcykiID0gDQogICAgICAgICAgICAgICAgICAgICAgIChtZWFuKHRvYmFjY29fZXZlciwgbmEucm0gPSBUUlVFKSAqIDEwMCksDQogICAgICAgICAgICAgICAgICAgICAiQ3VycmVudF9BbnkgVG9iYWNjbyBQcm9kdWN0IFxuIChpbmNsdWRpbmcgZS1jaWdhcmV0dGVzKSIgPSAgIA0KICAgICAgICAgICAgICAgICAgICAgICAobWVhbih0b2JhY2NvX2N1cnJlbnQsIG5hLnJtID0gVFJVRSkgKiAxMDApLA0KICAgICAgICAgICAgICAgICAgICAgIkV2ZXJfRS1jaWdhcmV0dGVzIiA9IA0KICAgICAgICAgICAgICAgICAgICAgICAobWVhbihlY2lnX2V2ZXIsIG5hLnJtID0gVFJVRSkgKiAxMDApLA0KICAgICAgICAgICAgICAgICAgICAgIkN1cnJlbnRfRS1jaWdhcmV0dGVzIiA9IA0KICAgICAgICAgICAgICAgICAgICAgICAobWVhbihlY2lnX2N1cnJlbnQsIG5hLnJtID0gVFJVRSkgKiAxMDApKSAlPiUNCiAgcGl2b3RfbG9uZ2VyKGNvbHMgPSAteWVhciwgDQogICAgICAgICAgIG5hbWVzX3RvID0gIlVzZXIiLCANCiAgICAgICAgICB2YWx1ZXNfdG8gPSAiUGVyY2VudGFnZSBvZiBzdHVkZW50cyIpICU+JQ0KICBzZXBhcmF0ZShVc2VyLCBpbnRvID0gYygiVXNlciIsICJQcm9kdWN0IiksIHNlcCA9ICJfIikgJT4lDQogIGhlYWQoKQ0KDQoNCnBsb3QxdCA8LSBueXRzX2RhdGEgJT4lDQogICAgZ3JvdXBfYnkoeWVhcikgJT4lDQogICAgc3VtbWFyaXplKCJFdmVyX0FueSBUb2JhY2NvIFByb2R1Y3QgXG4gKGluY2x1ZGluZyBlLWNpZ2FyZXR0ZXMpIiA9IA0KICAgICAgICAgICAgICAgIChtZWFuKHRvYmFjY29fZXZlciwgbmEucm0gPSBUUlVFKSAqIDEwMCksDQogICAgICAgICAgICAgICJDdXJyZW50X0FueSBUb2JhY2NvIFByb2R1Y3QgXG4gKGluY2x1ZGluZyBlLWNpZ2FyZXR0ZXMpIiA9IA0KICAgICAgICAgICAgICAgIChtZWFuKHRvYmFjY29fY3VycmVudCwgbmEucm0gPSBUUlVFKSAqIDEwMCksDQogICAgICAgICAgICAgICJFdmVyX0UtY2lnYXJldHRlcyIgPSANCiAgICAgICAgICAgICAgICAobWVhbihlY2lnX2V2ZXIsIG5hLnJtID0gVFJVRSkgKiAxMDApLA0KICAgICAgICAgICAgICAgIkN1cnJlbnRfRS1jaWdhcmV0dGVzIiA9IA0KICAgICAgICAgICAgICAgIChtZWFuKGVjaWdfY3VycmVudCwgbmEucm0gPSBUUlVFKSAqIDEwMCkpICU+JQ0KICBwaXZvdF9sb25nZXIoY29scyA9IC15ZWFyLCANCiAgICAgICAgICAgbmFtZXNfdG8gPSAiVXNlciIsIA0KICAgICAgICAgIHZhbHVlc190byA9ICJQZXJjZW50YWdlIG9mIHN0dWRlbnRzIikgJT4lDQogIHNlcGFyYXRlKFVzZXIsIA0KICAgICAgICAgICBpbnRvID0gYygiVXNlciIsICJQcm9kdWN0IiksIA0KICAgICAgICAgICAgc2VwID0gIl8iKSAlPiUNCiAgICBnZ3Bsb3QoYWVzKHggPSB5ZWFyLCANCiAgICAgICAgICAgICAgIHkgPSBgUGVyY2VudGFnZSBvZiBzdHVkZW50c2AsDQogICAgICAgICAgIGNvbG9yID0gUHJvZHVjdCkpICsNCiAgICBnZW9tX2xpbmUoYWVzKGxpbmV0eXBlID0gVXNlcikpICsNCiAgZ2VvbV9wb2ludChzaG93LmxlZ2VuZCA9IEZBTFNFLCBzaXplID0gMikgKw0KICAjIHRoaXMgYWxsb3dzIHVzIHRvIGNob29zZSB3aGF0IHR5cGUgb2YgbGluZSB3ZSB3YW50IGZvciBlYWNoIGxpbmUNCiAgc2NhbGVfbGluZXR5cGVfbWFudWFsKHZhbHVlcyA9IGMoMiwgMSkpICsNCiAgIyB3ZSB3YW50IHB1cnBsZSBhc3NvY2lhdGVkIHdpdGggZS1jaWdhcmV0dGVzIHRvIGJlIGNvbnNpc3RlbnQgd2l0aCBsYXRlciBwbG90cw0KICBzY2FsZV9jb2xvcl9tYW51YWwodmFsdWVzID0gcmV2KHZfY29sb3JzKSkgKw0KICAjIHRoaXMgYWxsb3dzIHVzIHRvIHNwZWNpZnkgaG93IHRoZSB5LWF4aXMgc2hvdWxkIGFwcGVhcg0KICBzY2FsZV95X2NvbnRpbnVvdXMoYnJlYWtzID0gc2VxKDAsIDYwLCBieSA9IDEwKSwNCiAgICAgICAgICAgICAgICAgICAgIGxhYmVscyA9IHNlcSgwLCA2MCwgYnkgPSAxMCksDQogICAgICAgICAgICAgICAgICAgICBsaW1pdHMgPSBjKDAsIDYwKSkgKw0KICAjIHRoaXMgYWRqdXN0cyB0aGUgYmFja2dyb3VuZCBzdHlsZSBvZiB0aGUgcGxvdA0KICAgIHRoZW1lX2xpbmVkcmF3KCkgKw0KICAjIHRoaXMgbW92ZXMgdGhlIGxlZ2VuZCB0byB0aGUgYm90dG9tIG9mIHRoZSBwbG90IGFuZCByZW1vdmVzIHRoZSB4IGF4aXMgdGl0bGUNCiAgICB0aGVtZShsZWdlbmQucG9zaXRpb24gPSAiYm90dG9tIiwNCiAgICAgICAgICBheGlzLnRpdGxlLnggPSBlbGVtZW50X2JsYW5rKCkpICsNCiAgICBsYWJzKHRpdGxlID0gIkhvdyBoYXMgdG9iYWNjbyB1c2UgdmFyaWVkIG92ZXIgdGhlIHllYXJzPyIsDQogICAgICAgICB5ID0gIiUgb2Ygc3R1ZGVudHMiKQ0KDQpwbG90MXQNCmBgYA0KDQpXZSBzZWUgYW4gaW5jcmVhc2UgaW4gYWxsIGNhdGVnb3JpZXMgc3RhcnRpbmcgaW4gMjAxNywgYnV0IHRoZSByYXRlIG9mIGluY3JlYXNlIGlzIGhpZ2hlciBmb3Igc3R1ZGVudHMgdXNpbmcgb25seSBlLWNpZ2FyZXR0ZXMgKGN1cnJlbnQgb3IgZXZlciB1c2VycyksIGFzIHNob3duIGJ5IHRoZSBoaWdoZXIgc2xvcGUgb2YgdGhlIGUtY2lnYXJldHRlIGxpbmVzLg0KDQpJbiB0aGUgYWJvdmUgcGxvdHMsIHRoZSAiQW55IHRvYmFjY28gcHJvZHVjdCIgZ3JvdXBzIGluY2x1ZGUgaW5kaXZpZHVhbHMgaW4gdGhlICJFLWNpZ2FyZXR0ZSBvbmx5IiBncm91cHMuIE5vdyBsZXQncyBwbG90IHN0dWRlbnRzIGluIHR3byBtdXR1YWxseSBleGNsdXNpdmUgZ3JvdXBzIG9uIHRoZSBzYW1lIHBsb3Q6IHRob3NlIHdobyByZXBvcnRlZCBlaXRoZXIgdXNpbmcgb25seSBlLWNpZ2FyZXR0ZXMgb3Igb25seSBvdGhlciB0b2JhY2NvIHByb2R1Y3RzIChiZXNpZGVzIGUtY2lnYXJldHRlcyksIGJ1dCBub3QgYm90aC4gDQoNCldlIHdpbGwgY2FsY3VsYXRlIHRoZSBtZWFuIGV2ZXIgYW5kIGN1cnJlbnQgdXNhZ2UgcGVyY2VudGFnZXMgZm9yIHN0dWRlbnRzIGluIHRoZXNlIHR3byBtdXR1YWxseSBleGNsdXNpdmUgZ3JvdXBzLCBhZ2FpbiB1c2luZyB0aGUgYGdyb3VwX2J5KClgIGZ1bmN0aW9uIGFuZCB0aGUgYHN1bW1hcml6ZSgpYCBmdW5jdGlvbi4gV2Ugd2lsbCBhZ2FpbiB1c2UgdGhlIGBwaXZvdF9sb25nZXJgIGZ1bmN0aW9uIHRvIGNvbnZlcnQgb3VyIGRhdGEgdG8gbG9uZyBmb3JtYXQuIFdlIHdpbGwgYWxzbyBhZ2FpbiB1c2UgdGhlIGBzZXBhcmF0ZSgpYCBmdW5jdGlvbiBvZiB0aGUgYHRpZHlyYCBwYWNrYWdlIHRvIGNyZWF0ZSB0d28gdmFyaWFibGVzIGZyb20gb25lIHZhcmlhYmxlLiBUaGlzIGlzIGRvbmUgYnkgc2VwYXJhdGluZyBieSwgaW4gdGhpcyBjYXNlLCBhIHNwYWNlLiANCg0KYGBge3J9DQoNCm55dHNfZGF0YSAlPiUNCiAgICBkcGx5cjo6Z3JvdXBfYnkoeWVhcikgJT4lDQogICAgZHBseXI6OnN1bW1hcml6ZSgiRXZlcl9FLWNpZ2FyZXR0ZSIgPSANCiAgICAgICAgICAgICAgICAgICAgICAgKG1lYW4oZWNpZ19vbmx5X2V2ZXIsIG5hLnJtID0gVFJVRSkgKiAxMDApLA0KICAgICAgICAgICAgICAgICAgICAgIkN1cnJlbnRfRS1jaWdhcmV0dGUiID0gDQogICAgICAgICAgICAgICAgICAgICAgIChtZWFuKGVjaWdfb25seV9jdXJyZW50LCBuYS5ybSA9IFRSVUUpICogMTAwKSwNCiAgICAgICAgICAgICAgICAgICAgICJFdmVyX05vbi1lLWNpZ2FyZXR0ZSIgPSANCiAgICAgICAgICAgICAgICAgICAgICAgKG1lYW4obm9uX2VjaWdfb25seV9ldmVyLCBuYS5ybSA9IFRSVUUpICogMTAwKSwNCiAgICAgICAgICAgICAgICAgICAgICJDdXJyZW50X05vbi1lLWNpZ2FyZXR0ZSIgPSANCiAgICAgICAgICAgICAgICAgICAgICAgKG1lYW4obm9uX2VjaWdfb25seV9jdXJyZW50LCBuYS5ybSA9IFRSVUUpICogMTAwKSkgJT4lDQogIHBpdm90X2xvbmdlcihjb2xzID0gLXllYXIsIA0KICAgICAgICAgICBuYW1lc190byA9ICJVc2VyIiwgDQogICAgICAgICAgdmFsdWVzX3RvID0gIlBlcmNlbnRhZ2Ugb2Ygc3R1ZGVudHMiKSAlPiUNCiAgdGlkeXI6OnNlcGFyYXRlKFVzZXIsIGludG8gPSBjKCJVc2VyIiwgIlByb2R1Y3QiKSwgc2VwID0gIl8iKSAlPiUNCiAgaGVhZCgpDQoNCnBsb3QxYyA8LSBueXRzX2RhdGEgJT4lDQogICAgZHBseXI6Omdyb3VwX2J5KHllYXIpICU+JQ0KICAgIGRwbHlyOjpzdW1tYXJpemUoIkV2ZXJfRS1jaWdhcmV0dGUiID0gDQogICAgICAgICAgICAgICAgICAgICAgIChtZWFuKGVjaWdfb25seV9ldmVyLCBuYS5ybSA9IFRSVUUpICogMTAwKSwNCiAgICAgICAgICAgICAgICAgICAgICJDdXJyZW50X0UtY2lnYXJldHRlIiA9IA0KICAgICAgICAgICAgICAgICAgICAgICAobWVhbihlY2lnX29ubHlfY3VycmVudCwgbmEucm0gPSBUUlVFKSAqIDEwMCksDQogICAgICAgICAgICAgICAgICAgICAiRXZlcl9Ob24tZS1jaWdhcmV0dGUiID0gDQogICAgICAgICAgICAgICAgICAgICAgIChtZWFuKG5vbl9lY2lnX29ubHlfZXZlciwgbmEucm0gPSBUUlVFKSAqIDEwMCksDQogICAgICAgICAgICAgICAgICAgICAiQ3VycmVudF9Ob24tZS1jaWdhcmV0dGUiID0gDQogICAgICAgICAgICAgICAgICAgICAgIChtZWFuKG5vbl9lY2lnX29ubHlfY3VycmVudCwgbmEucm0gPSBUUlVFKSAqIDEwMCkpICU+JQ0KICBwaXZvdF9sb25nZXIoY29scyA9IC15ZWFyLCANCiAgICAgICAgICAgbmFtZXNfdG8gPSAiVXNlciIsIA0KICAgICAgICAgIHZhbHVlc190byA9ICJQZXJjZW50YWdlIG9mIHN0dWRlbnRzIikgJT4lDQogIHNlcGFyYXRlKFVzZXIsIGludG8gPSBjKCJVc2VyIiwgIlByb2R1Y3QiKSwgc2VwID0gIl8iKSAlPiUNCiAgICBnZ3Bsb3QoYWVzKHggPSB5ZWFyLCB5ID0gYFBlcmNlbnRhZ2Ugb2Ygc3R1ZGVudHNgLCBjb2xvciA9IFByb2R1Y3QpKSArDQogICAgZ2VvbV9saW5lKGFlcyhsaW5ldHlwZSA9IFVzZXIpKSArDQogIGdlb21fcG9pbnQoc2hvdy5sZWdlbmQgPSBGQUxTRSwgc2l6ZSA9IDIpICsNCiAgIyB0aGlzIGFsbG93cyB1cyB0byBjaG9vc2Ugd2hhdCB0eXBlIG9mIGxpbmUgd2Ugd2FudCBmb3IgZWFjaCBsaW5lDQogIHNjYWxlX2xpbmV0eXBlX21hbnVhbCh2YWx1ZXMgPSBjKDIsIDEpKSArDQogICMgdGhpcyBhbGxvd3MgdXMgdG8gc3BlY2lmeSBob3cgdGhlIHktYXhpcyBzaG91bGQgYXBwZWFyDQogIHNjYWxlX3lfY29udGludW91cyhicmVha3MgPSBzZXEoMCwgMzAsIGJ5ID0gMTApLA0KICAgICAgICAgICAgICAgICAgICAgbGFiZWxzID0gc2VxKDAsIDMwLCBieSA9IDEwKSwNCiAgICAgICAgICAgICAgICAgICAgIGxpbWl0cyA9IGMoMCwgMzApKSArDQogIHNjYWxlX2NvbG9yX21hbnVhbCh2YWx1ZXMgPSB2X2NvbG9ycykgKw0KICAjIHRoaXMgYWRqdXN0cyB0aGUgYmFja2dyb3VuZCBzdHlsZSBvZiB0aGUgcGxvdA0KICAgIHRoZW1lX2xpbmVkcmF3KCkgKw0KICAjIHRoaXMgbW92ZXMgdGhlIGxlZ2VuZCB0byB0aGUgYm90dG9tIG9mIHRoZSBwbG90IGFuZCByZW1vdmVzIHRoZSB4IGF4aXMgdGl0bGUNCiAgICB0aGVtZShsZWdlbmQucG9zaXRpb24gPSAiYm90dG9tIiwNCiAgICAgICAgICBheGlzLnRpdGxlLnggPSBlbGVtZW50X2JsYW5rKCkpICsNCiAgICBsYWJzKHRpdGxlID0gIkhvdyBoYXMgdXNlIG9mIG9ubHkgZS1jaWdhcmV0dGVzIGFuZA0Kb25seSB0b2JhY2NvIHByb2R1Y3RzIGJlc2lkZXMgZS1jaWdhcmV0dGVzIHZhcmllZCBvdmVyIHRpbWU/IiwNCiAgICAgICAgIHkgPSAiJSBvZiBzdHVkZW50cyIpDQoNCnBsb3QxYw0KYGBgDQoNClZlcnkgaW50ZXJlc3RpbmchIFdlIGNhbiBzZWUgZnJvbSB0aGlzIHBsb3QgdGhhdCB0aGUgcGVyY2VudGFnZSBvZiBzdHVkZW50cyB3aG8gaGFkIGN1cnJlbnRseSB1c2VkIChvciBldmVyIHRyaWVkKSBvbmx5IGUtY2lnYXJldHRlcyBncmVhdGx5IGluY3JlYXNlZCBzdGFydGluZyBpbiAyMDE3LCB3aGlsZSBpbiBjb250cmFzdCB0aGUgcGVyY2VudGFnZSBvZiBzdHVkZW50cyB3aG8gaGFkIGV2ZXIgdHJpZWQgb25seSBub24tZS1jaWdhcmV0dGUgdG9iYWNjbyBwcm9kdWN0cyBhY3R1YWxseSBkaW1pbmlzaGVkIG92ZXIgdGltZS4gSW4gZmFjdCwgd2UgY2FuIHNlZSB0aGF0IGluIDIwMTkgdGhlIHBlcmNlbnRhZ2Ugb2Ygc3R1ZGVudHMgd2hvIHdlcmUgY3VycmVudCBlLWNpZ2FyZXR0ZSB1c2VycyBzdXJwYXNzZWQgdGhlIHBlcmNlbnRhZ2UgdGhhdCBoYWQgdHJpZWQgYSBub24tZS1jaWdhcmV0dGUgcHJvZHVjdCBldmVuIGp1c3Qgb25jZS4gDQoNCg0KUmVjYWxsIHRoYXQgd2UgbWFkZSBhIHZhcmlhYmxlIGNhbGxlZCBgR3JvdXBgIHRoYXQgaWRlbnRpZmllZCBzdHVkZW50cyB3aG8gdXNlZCBlaXRoZXIganVzdCBlLWNpZ2FyZXR0ZSBwcm9kdWN0cywganVzdCBvdGhlciB0b2JhY2NvIHByb2R1Y3RzIChiZXNpZGVzIGUtY2lnYXJldHRlcyksIG9yIHN0dWRlbnRzIHdobyB1c2VkIGJvdGggZS1jaWdhcmV0dGVzIGFuZCBzb21lIG90aGVyIHR5cGUgb2YgdG9iYWNjbyBwcm9kdWN0Lg0KDQpgYGB7cn0NCm55dHNfZGF0YSAlPiUNCiAgY291bnQoR3JvdXApDQpgYGANCg0KV2Ugd2lsbCBub3cgbWFrZSBhIHBsb3Qgb3ZlciB0aW1lIG9mIGVhY2ggb2YgdGhlc2UgZ3JvdXBzLiBTaW5jZSB3ZSB3aWxsIGhhdmUgNCB0b3RhbCBncm91cHMsIHdlIHdpbGwgdXNlIDQgb2YgdGhlIHZpcmlkaXMgY29sb3JzLg0KTm90aWNlLCB0aGF0IGluIHRoaXMgY2FzZSB3ZSBhcmUgZ3JvdXBpbmcgYnkgdGhyZWUgdmFyaWFibGVzIGJ5IHNpbXBseSBzZXBhcmF0aW5nIHRoZSB2YXJpYWJsZXMgdGhhdCB3ZSB3YW50IHRvIGdyb3VwIGJ5IHdpdGggYSBjb21tYSBpbiBvdXIgYGdyb3VwX2J5KClgIGZ1bmN0aW9uIGxpa2UgdGhpczogYGdyb3VwX2J5KEdyb3VwLCB5ZWFyLCBuKWAuIA0KDQpgYGB7cn0NCg0Kbnl0c19kYXRhICU+JQ0KICBncm91cF9ieShHcm91cCwgeWVhciwgbikgJT4lDQogIHN1bW1hcml6ZShncm91cF9jb3VudCA9IG4oKSkgJT4lDQogIG11dGF0ZSgiUGVyY2VudGFnZSBvZiBzdHVkZW50cyIgPSBncm91cF9jb3VudCAvIG4gKiAxMDApICU+JQ0KICBoZWFkKCkNCg0Kdl9jb2xvcnMgPSAgdmlyaWRpcyg1KVsxOjRdDQoNCm55dHNfZGF0YSAlPiUNCiAgZ3JvdXBfYnkoR3JvdXAsIHllYXIsIG4pICU+JQ0KICBzdW1tYXJpemUoZ3JvdXBfY291bnQgPSBuKCkpICU+JQ0KICBtdXRhdGUoIlBlcmNlbnRhZ2Ugb2Ygc3R1ZGVudHMiID0gZ3JvdXBfY291bnQgLyBuICogMTAwKSAlPiUNCiAgZ2dwbG90KGFlcyh4ID0geWVhciwgeSA9IGBQZXJjZW50YWdlIG9mIHN0dWRlbnRzYCwgY29sb3IgPSBHcm91cCkpICsNCiAgZ2VvbV9wb2ludChzaXplID0gMikgKw0KICBnZW9tX2xpbmUoKSArDQogIHNjYWxlX2NvbG9yX21hbnVhbCh2YWx1ZXMgPSB2X2NvbG9ycykgKw0KICB0aGVtZV9saW5lZHJhdygpICsNCiAgbGFicyh4ID0gIlllYXIiKQ0KYGBgDQoNCldlIGNhbiBzZWUgdGhhdCB0aGUgbWFqb3JpdHkgb2Ygc3R1ZGVudHMgZGlkIG5vdCByZXBvcnQgdXNpbmcgYW55IHRvYmFjY28gcHJvZHVjdHMuIE9mIHRoZSBzdHVkZW50cyB0aGF0IGRpZCByZXBvcnQgdXNpbmcgdG9iYWNjbyBwcm9kdWN0cywgdGhlIG1ham9yaXR5IG9mIHRoZSBzdHVkZW50cyB1c2VkIGJvdGggZS1jaWdhcmV0dGVzIGFuZCBzb21lIG90aGVyIHRvYmFjY28gcHJvZHVjdC4gQWdhaW4sIGEgbXVjaCBsYXJnZXIgcGVyY2VudGFnZSByZXBvcnRlZCB1c2luZyBvbmx5IGUtY2lnYXJldHRlcyByYXRoZXIgdGhhbiBvbmx5IG90aGVyIHRvYmFjY28gcHJvZHVjdHMgaW4gMjAxOS4NCg0KV2Ugd2lsbCBmdXJ0aGVyIGV4cGxvcmUgdGhlIHJlbGF0aW9uc2hpcCBiZXR3ZWVuIGUtY2lnYXJldHRlIHVzYWdlIGFuZCBvdGhlciB0b2JhY2NvIHByb2R1Y3RzIGEgYml0IGxhdGVyIGluIHRoZSBjYXNlIHN0dWR5Lg0KDQoNCiMjIyAqKlF1ZXN0aW9uIDIqKg0KKioqDQoNCk5vdyB3ZSB3YW50IHRvIGxvb2sgaG93IGUtY2lnYXJldHRlIHNtb2tpbmcgcmF0ZXMgY29tcGFyZSBiZXR3ZWVuIG1hbGVzIGFuZCBmZW1hbGVzIGFjcm9zcyB0aW1lLiANCg0KDQpXZSB3aWxsIGNhbGN1bGF0ZSB0aGUgcGVyY2VudCBldmVyIGFuZCBjdXJyZW50IGUtY2lnYXJldHRlIHVzZXJzIGZvciBlYWNoIHllYXIgYW5kIHNleCBjYXRlZ29yeSBhZ2FpbiB1c2luZyB0aGUgYGdyb3VwX2J5KClgIGZ1bmN0aW9uIGFuZCB0aGUgYHN1bW1hcml6ZSgpYCBmdW5jdGlvbi4gIFdlIHdpbGwgYWdhaW4gdXNlIHRoZSBgcGl2b3RfbG9uZ2VyYCBmdW5jdGlvbiB0byBjb252ZXJ0IG91ciBkYXRhIHRvIGxvbmcgZm9ybWF0LiANCg0KQXMgZGlzY3Vzc2VkIGFib3ZlLCB3ZSBhY2tub3dsZWRnZSB0aGF0IHdoaWxlIFtnZW5kZXJdKGh0dHBzOi8vd3d3LmdlbmRlcnNwZWN0cnVtLm9yZy9xdWljay1saW5rcy91bmRlcnN0YW5kaW5nLWdlbmRlci8pe3RhcmdldD0iX2JsYW5rIn0gYW5kIFtzZXhdKGh0dHBzOi8vd3d3Lndoby5pbnQvZ2Vub21pY3MvZ2VuZGVyL2VuL2luZGV4MS5odG1sKXt0YXJnZXQ9Il9ibGFuayJ9IGFyZSBub3QgYWN0dWFsbHkgYmluYXJ5LCB0aGUgZGF0YSB1c2VkIGluIHRoaXMgYW5hbHlzaXMgb25seSBjb250YWluIGluZm9ybWF0aW9uIGZvciBncm91cHMgb2YgaW5kaXZpZHVhbHMgd2hvIGFuc3dlcmVkIHRoZSBzdXJ2ZXkgcXVlc3Rpb25zIGFzIG1hbGUgb3IgZmVtYWxlLiBGb3IgaW5kaXZpZHVhbHMgdGhhdCBoYXZlIE5BIHZhbHVlcywgaXQgaXMgdW5jbGVhciBpZiB0aGUgcXVlc3Rpb24gd2FzIG5vdCBhbnN3ZXJlZCBvciBpZiB0aGUgaW5kaXZpZHVhbCBpZGVudGlmaWVzIGFzIG5vbi1iaW5hcnkuIEJlY2F1c2Ugb2YgdGhpcyB1bmNlcnRhaW50eSwgd2Ugd2lsbCBmaWx0ZXIgdGhlc2UgaW5kaXZpZHVhbHMgb3V0LiANCg0KYGBge3J9DQoNCnZfY29sb3JzID0gIHZpcmlkaXMoNilbYygxLCA0KV0NCg0Kbnl0c19kYXRhICU+JQ0KICAgICBmaWx0ZXIoIWlzLm5hKFNleCkpICU+JQ0KICAgICBncm91cF9ieSh5ZWFyLCBTZXgpICU+JQ0KICAgICBzdW1tYXJpemUoRXZlciA9IChtZWFuKEVFTENJR1QsIG5hLnJtID0gVFJVRSkgKiAxMDApLA0KICAgICAgICAgICAgICAgQ3VycmVudCA9IChtZWFuKENFTENJR1QsIG5hLnJtID0gVFJVRSkgKiAxMDApKSAlPiUNCiAgICAgcGl2b3RfbG9uZ2VyKGNvbHMgPSBFdmVyOkN1cnJlbnQsDQogICAgICAgICAgICAgICAgICBuYW1lc190byA9ICJVc2VyIiwNCiAgICAgICAgICAgICAgICAgIHZhbHVlc190byA9ICJQZXJjZW50YWdlIG9mIHN0dWRlbnRzIikgJT4lDQogICAgIGhlYWQoKQ0KDQpwbG90MiA8LSBueXRzX2RhdGEgJT4lDQogICAgIGZpbHRlcighaXMubmEoU2V4KSkgJT4lDQogICAgIGdyb3VwX2J5KHllYXIsIFNleCkgJT4lDQogICAgIHN1bW1hcml6ZShFdmVyID0gKG1lYW4oRUVMQ0lHVCwgbmEucm0gPSBUUlVFKSAqIDEwMCksDQogICAgICAgICAgICAgICBDdXJyZW50ID0gKG1lYW4oQ0VMQ0lHVCwgbmEucm0gPSBUUlVFKSAqIDEwMCkpICU+JQ0KICAgICBwaXZvdF9sb25nZXIoY29scyA9IEV2ZXI6Q3VycmVudCwNCiAgICAgICAgICAgICAgICAgIG5hbWVzX3RvID0gIlVzZXIiLA0KICAgICAgICAgICAgICAgICAgdmFsdWVzX3RvID0gIlBlcmNlbnRhZ2Ugb2Ygc3R1ZGVudHMiKSAlPiUNCiAgICBnZ3Bsb3QoYWVzKHggPSB5ZWFyLCB5ID0gYFBlcmNlbnRhZ2Ugb2Ygc3R1ZGVudHNgLCBjb2xvciA9IFNleCkpICsNCiAgICBnZW9tX2xpbmUoYWVzKGxpbmV0eXBlID0gVXNlcikpICsNCiAgICBnZW9tX3BvaW50KHNob3cubGVnZW5kID0gRkFMU0UsIHNpemUgPSAyKSArDQogICAgc2NhbGVfbGluZXR5cGVfbWFudWFsKHZhbHVlcyA9IGMoMiwgMSkpICsNCiAgICBzY2FsZV9jb2xvcl9tYW51YWwodmFsdWVzID0gdl9jb2xvcnMpICsNCiAgICB0aGVtZV9saW5lZHJhdygpICsNCiAgICB0aGVtZShsZWdlbmQucG9zaXRpb24gPSAiYm90dG9tIiwNCiAgICAgICAgICBheGlzLnRpdGxlLnggPSBlbGVtZW50X2JsYW5rKCkpICsNCiAgICBsYWJzKHRpdGxlID0gIkhvdyBkb2VzIGUtY2lnYXJldHRlIHVzYWdlIGNvbXBhcmUgYmV0d2VlbiBtYWxlcyBhbmQgZmVtYWxlcz8iLA0KICAgICAgICAgc3VidGl0bGUgPSAiQ3VycmVudCBhbmQgZXZlciB1c2VycyBieSBzZXgiLA0KICAgICAgICAgeSA9ICIlIG9mIHN0dWRlbnRzIikNCg0KcGxvdDINCmBgYA0KDQpJdCBsb29rcyBsaWtlIHRoZSByYXRlcyBhcmUgZmFpcmx5IHNpbWlsYXIgYmV0d2VlbiB0aGUgc2V4ZXMsIGhvd2V2ZXIgdGhlIHJhdGUgZm9yIG1hbGVzIGFwcGVhcnMgdG8gYmUgY29uc2lzdGVudGx5IGhpZ2hlciBhY3Jvc3MgdGltZS4NCg0KYGBge3IsIGVjaG89RkFMU0UsIGV2YWw9RkFMU0V9DQpnZ3NhdmUoaGVyZTo6aGVyZSgiaW1nIiwgInBsb3QyLnBuZyIpKQ0KYGBgDQoNCiMjIyAqKlF1ZXN0aW9uIDMqKg0KKioqDQoNCldlIGFyZSBhbHNvIGludGVyZXN0ZWQgaW4gd2hhdCB2YXBpbmcgYnJhbmRzIGFuZCBmbGF2b3JzIGFwcGVhciB0byBiZSB1c2VkIHRoZSBtb3N0IGZyZXF1ZW50bHkuIE9ubHkgdGhlIDIwMTkgZGF0YXNldCBoYXMgdGhpcyBpbmZvcm1hdGlvbi4gVGhlcmVmb3JlLCB3ZSB3aWxsIGZpbHRlciBmb3IganVzdCB0aGlzIHllYXIgdXNpbmcgdGhlIGBmaWx0ZXIoKWAgZnVuY3Rpb24gb2YgIHRoZSBgZHBseXJgIHBhY2thZ2UuIFdlIHdpbGwgdXNlIHRoZSBgc3VtbWFyaXplKClgIGZ1bmN0aW9uIHNsaWdodGx5IGRpZmZlcmVudGx5IHRoaXMgdGltZSwgdG8gY2FsY3VsYXRlIHRoZSB0b3RhbCBudW1iZXIgb2Ygc3R1ZGVudHMgdXNpbmcgZWFjaCBicmFuZCB1c2luZyB0aGUgYG4oKWAgZnVuY3Rpb24gYW5kIHRoZSBgc3VtKClgIGZ1bmN0aW9uIHRvIGNhbGN1bGF0ZSB0aGUgcGVyY2VudCBmb3IgZWFjaCBicmFuZCBiYXNlZCBvbiB0aGUgY291bnRzLiBXZSB3aWxsIGFsc28gcmVvcmRlciB0aGUgZmFjdG9yIGxldmVscyBmb3IgdGhlIGJyYW5kIG5hbWVzIHNvIHRoYXQgdGhleSBhcmUgaW4gZGVzY2VuZGluZyBvcmRlciBvZiBwZXJjZW50IHVzZSwgdXNpbmcgdGhlIGBmY3RfcmVvcmRlcigpYCBmdW5jdGlvbiBmcm9tIGBkcGx5cmAuIFRoaXMgd2lsbCBtYWtlIHRoZW0gYXBwZWFyIGluIGRlY3JlYXNpbmcgb3JkZXIgb2YgcGVyY2VudCB1c2Ugb24gdGhlIHBsb3QuDQoNCldlIHdpbGwgbWFrZSBhIGJhciBwbG90IHRoaXMgdGltZSBieSB1c2luZyBgZ2VvbV9iYXJgLiBJbXBvcnRhbnRseSB3ZSBhc3NpZ24gdGhlIGBzdGF0YCBhcmd1bWVudCB0byBgaWRlbnRpdHlgLCBzbyB0aGF0IHdlIGFyZSB1c2luZyB0aGUgcGVyY2VudGFnZXMgdGhhdCB3ZSBjYWxjdWxhdGVkIG5vdCB0aGUgY291bnRzIHdoaWNoIGlzIHdoYXQgaXMgdXNlZCBieSBkZWZhdWx0LiBXaGVuIGNvbG9yIGluIHNwZWNpZmllZCBvdXRzaWRlIG9mIHRoZSBgYWVzKClgIGFyZ3VtZW50LCB0aGlzIGRldGVybWluZXMgdGhlIGJvcmRlciBjb2xvciBvZiB0aGUgYmFycywgd2hpY2ggaW4gdGhpcyBjYXNlIHdpbGwgYmUgYmxhY2suDQoNCmBgYHtyfQ0KDQpueXRzX2RhdGEgJT4lDQogIGZpbHRlcih5ZWFyID09IDIwMTkpICU+JQ0KICBncm91cF9ieShicmFuZF9lY2lnKSAlPiUNCiAgZmlsdGVyKCFpcy5uYShicmFuZF9lY2lnKSkgJT4lDQogIHN1bW1hcml6ZShuID0gbigpKSAlPiUNCiAgbXV0YXRlKHRvdGFsID0gc3VtKG4pLA0KICAgICAgICAgUGVyY2VudCA9IG4gKiAxMDAgLyB0b3RhbCkgJT4lDQogIG11dGF0ZShicmFuZF9lY2lnID0gZmN0X3Jlb3JkZXIoYnJhbmRfZWNpZywgZGVzYyhQZXJjZW50KSkpDQoNCg0KcGxvdDMgPC0gbnl0c19kYXRhICU+JQ0KICBmaWx0ZXIoeWVhciA9PSAyMDE5KSAlPiUNCiAgZ3JvdXBfYnkoYnJhbmRfZWNpZykgJT4lDQogIGZpbHRlcighaXMubmEoYnJhbmRfZWNpZykpICU+JQ0KICBzdW1tYXJpemUobiA9IG4oKSkgJT4lDQogIG11dGF0ZSh0b3RhbCA9IHN1bShuKSwNCiAgICAgICAgIFBlcmNlbnQgPSBuICogMTAwIC8gdG90YWwpICU+JQ0KICBtdXRhdGUoYnJhbmRfZWNpZyA9IGZjdF9yZW9yZGVyKGJyYW5kX2VjaWcsIGRlc2MoUGVyY2VudCkpKSAlPiUNCiAgZ2dwbG90KGFlcyh4ID0gYnJhbmRfZWNpZywgeSA9IFBlcmNlbnQsIGZpbGwgPSBicmFuZF9lY2lnKSkgKw0KICBnZW9tX2JhcihzdGF0ID0gImlkZW50aXR5IiwgY29sb3IgPSAiYmxhY2siKSArDQogIHRoZW1lX2xpbmVkcmF3KCkgKw0KICB0aGVtZSgNCiAgICBsZWdlbmQucG9zaXRpb24gPSAibm9uZSIsDQogICAgYXhpcy50ZXh0LnggPSBlbGVtZW50X3RleHQoc2l6ZSA9IDEwKSwNCiAgICBheGlzLnRpdGxlLnggPSBlbGVtZW50X2JsYW5rKCkNCiAgKSArDQogIGxhYnModGl0bGUgPSAiV2hhdCB2YXBpbmcgYnJhbmRzIGFwcGVhciB0byBiZSB1c2VkIHRoZSBtb3N0IGZyZXF1ZW50bHk/IiwNCiAgICAgICBzdWJ0aXRsZSA9ICJCcmFuZCBvZiBlLWNpZ2FyZXR0ZSBtb3N0IGZyZXF1ZW50bHkgdXNlZCBpbiB0aGUgbGFzdCAzMCBkYXlzICgyMDE5KSIsDQogICAgICAgeSA9ICIlIG9mIGUtY2lnYXJldHRlIHVzZXJzIHJlc3BvbmRpbmciKQ0KDQpwbG90Mw0KYGBgDQoNCkp1dWwgYXBwZWFycyB0byBiZSB0aGUgbW9zdCB3aWRlbHkgdXNlZCBicmFuZC4gVGhpcyBpcyBpbiBhZ3JlZW1lbnQgd2l0aCBhIHJlY2VudCBbYXJ0aWNsZV0oaHR0cHM6Ly90b2JhY2NvY29udHJvbC5ibWouY29tL2NvbnRlbnQvdG9iYWNjb2NvbnRyb2wvMjgvMi8xNDYuZnVsbC5wZGYpLCB3aG9zZSBtb3N0IHJlY2VudCBkYXRhIHdhcyBmcm9tIDIwMTc6DQoNCmBgYHtyLCBlY2hvPUZBTFNFLCBmaWcuY2FwPSJIdWFuZyBKLCBEdWFuIFosIEt3b2sgSiwgZXQgYWwuIFRvYiBDb250cm9sIDIwMTk7Mjg6MTQ24oCTMTUxLiIsIG91dC53aWR0aCA9ICcxMDAlJ30NCmtuaXRyOjppbmNsdWRlX2dyYXBoaWNzKCJ3d3cvaW1nL0h1YW5nSl9EdWFuWl9Ld29rSl9ldF9hbF9Ub2JhY2NvQ29udHJvbF9GaWd1cmUxLnBuZyIpDQpgYGANCg0KV2UgYXJlIGFsc28gaW50ZXJlc3RlZCBpbiBob3cgdGhlIHVzYWdlIG9mIGRpZmZlcmVudCBmbGF2b3JzIGhhcyBjaGFuZ2VkIG92ZXIgdGltZS4gDQoNCg0KVG8gZXZhbHVhdGUgdGhpcyB3ZSB3aWxsIGNhbGN1bGF0ZSB0aGUgcGVyY2VudGFnZSBvZiBzdHVkZW50cyB1c2luZyBlYWNoIGZsYXZvciBlYWNoIHllYXIgLSB0aGlzIGluY2x1ZGVzIHVzYWdlIG9mIGFueSB0eXBlIG9mIGZsYXZvcmVkIHRvYmFjY28gcHJvZHVjdC4gV2Ugd2lsbCBleGNsdWRlIDIwMTUgZGF0YSwgYXMgbm8gc3BlY2lmaWMgZmxhdm9yIHF1ZXN0aW9ucyB3ZXJlIGFza2VkIGF0IHRoYXQgdGltZS4NCg0KUmVjYWxsIHRoYXQgYE5BYCB2YWx1ZXMgYXJlIG5vdCBpbmNsdWRlZCBpbiBjYWxjdWxhdGluZyB0aGUgdG90YWwgY291bnQgZm9yIG91ciBwZXJjZW50YWdlcy4gSG93ZXZlciBhbGwgb2YgdGhlc2UgZmxhdm9yIHF1ZXN0aW9ucyBoYWQgY29tcGxldGUgcmVwb3J0aW5nIGFuZCBkaWQgbm90IGhhdmUgYE5BYCB2YWx1ZXMuIFRoZXJlZm9yZSwgdGhlc2UgdmFsdWVzIHJlZmxlY3QgdGhlIHBlcmNlbnRhZ2Ugb2Ygc3R1ZGVudHMgcmVwb3J0aW5nIHVzaW5nIGEgcGFydGljdWxhciBmYXZvciBvdXQgb2YgYWxsIHN0dWRlbnRzIHN1cnZleWVkIChpbmNsdWRpbmcgdGhvc2UgdGhhdCBkaWQgbm90IHVzZSBhbnkgdG9iYWNjbyBwcm9kdWN0cykuIEFsc28gc3R1ZGVudHMgd2VyZSBhbGxvd2VkIHRvIHNlbGVjdCBtb3JlIHRoYW4gb25lIGZsYXZvci4gWW91IGNhbiBzZWUgd2hldGhlciB0aGVzZSB2YXJpYWJsZXMgaGFkIGNvbXBsZXRlIHJlcG9ydGluZyBieSBjaGVja2luZyB0aGUgYE5BYCB2YWx1ZXMgdXNpbmcgdGhlIGJhc2UgYHN1bW1hcnlgIGZ1bmN0aW9uLiBBbHRlcm5hdGl2ZWx5IHlvdSBjYW4gY3JlYXRlIGEgdmlzdWFsIHJlcHJlc2VudGF0aW9uIHVzaW5nIHRoZSBgdmlzX21pc3MoKWAgZnVuY3Rpb24gb2YgdGhlIGBuYW5pYXJgIHBhY2thZ2UuDQoNCiMjIyMgey5zY3JvbGxhYmxlfQ0KYGBge3J9DQojIFNjcm9sbCB0aHJvdWdoIHRoZSBvdXRwdXQhDQpueXRzX2RhdGEgJT4lDQogIGZpbHRlcih5ZWFyICE9IDIwMTUpICU+JQ0KICBzdW1tYXJ5KCkNCmBgYA0KIyMjIw0KDQoNCmBgYHtyfQ0Kbnl0c19kYXRhICU+JQ0KICBmaWx0ZXIoeWVhciAhPSAyMDE1KSAlPiUNCiAgc2VsZWN0KG1lbnRob2w6YWxjb2hvbGljX2RyaW5rKSAlPiUNCiAgdmlzX21pc3MoKQ0KYGBgDQoNCg0KVGhlIHBsb3QgYWJvdmUgY29uZmlybXMgdGhhdCB0aGVzZSB2YXJpYWJsZXMgaGF2ZSBubyBgTkFgIHZhbHVlcyAoYmVjYXVzZSBhbGwgZmllbGRzIGluZGljYXRlIDEwMCUgb2YgZGF0YSBpcyBwcmVzZW50KS4NCg0KYGBge3J9DQpwbG90NCA8LSBueXRzX2RhdGEgJT4lDQogIGZpbHRlcih5ZWFyICE9IDIwMTUpICU+JQ0KICBncm91cF9ieSh5ZWFyKSAlPiUNCiAgICAgIHN1bW1hcml6ZShNZW50aG9sID0gKG1lYW4obWVudGhvbCkgKiAxMDApLA0KICAgICAgIGBDbG92ZSBvciBTcGljZWAgPSAobWVhbihjbG92ZV9zcGljZSkgKiAxMDApLA0KICAgICAgICAgICAgICAgICAgRnJ1aXQgPSAobWVhbihmcnVpdCkgKiAxMDApLA0KICAgICAgICAgICAgICBDaG9jb2xhdGUgPSAobWVhbihjaG9jb2xhdGUpICogMTAwKSwNCiAgICAgIGBBbGNvaG9saWMgRHJpbmtgID0gKG1lYW4oYWxjb2hvbGljX2RyaW5rKSAqIDEwMCksDQpgQ2FuZHkvRGVzc2VydHMvU3dlZXRzYCA9IChtZWFuKGNhbmR5X2Rlc3NlcnRfc3dlZXRzKSAqIDEwMCksDQogICAgICAgICAgICAgICAgICBPdGhlciA9IChtZWFuKG90aGVyKSAqIDEwMCkpICU+JQ0KICAgICAgcGl2b3RfbG9uZ2VyKGNvbHMgPSAteWVhciwgDQogICAgICAgICAgICAgICBuYW1lc190byA9ICJGbGF2b3IiLA0KICAgICAgICAgICAgICB2YWx1ZXNfdG8gPSAiUGVyY2VudGFnZSBvZiBzdHVkZW50cyIpICU+JQ0KICByZW5hbWUoWWVhciA9IHllYXIpICU+JQ0KDQogZ2dwbG90KGFlcyh5ID0gYFBlcmNlbnRhZ2Ugb2Ygc3R1ZGVudHNgLA0KICAgICAgICAgICAgeCA9IFllYXIsDQogICAgICAgICAgICBmaWxsID0gcmVvcmRlcihGbGF2b3IsIGBQZXJjZW50YWdlIG9mIHN0dWRlbnRzYCkpKSArDQogIGdlb21fYmFyKHN0YXQgPSAiaWRlbnRpdHkiLA0KICAgICAgICAgICBwb3NpdGlvbiA9ICJkb2RnZSIsDQogICAgICAgICAgIGNvbG9yID0gImJsYWNrIikgKw0KICBzY2FsZV9maWxsX3ZpcmlkaXMoZGlzY3JldGUgPSBUUlVFKSArDQogIHRoZW1lX2xpbmVkcmF3KCkgKw0KICBndWlkZXMoZmlsbCA9IGd1aWRlX2xlZ2VuZCgiRmxhdm9yIikpICsNCiAgbGFicyh0aXRsZSA9ICJXaGF0IGZsYXZvcnMgYXBwZWFyIHRvIGJlIHVzZWQgdGhlIG1vc3QgZnJlcXVlbnRseT8iLA0KICAgICAgIHN1YnRpdGxlID0gIkZsYXZvcnMgb2YgdG9iYWNjbyBwcm9kdWN0cyB1c2VkIGluIHRoZSBwYXN0IDMwIGRheXMiKQ0KDQpwbG90NA0KYGBgDQoNCkZyb20gdGhpcyBwbG90LCB3ZSBjYW4gc2VlIHRoYXQgZnJ1aXQgZmxhdm9ycyBhcmUgdGhlIG1vc3Qgd2lkZWx5IHVzZWQgcHJvZHVjdHMsIGZvbGxvd2VkIGJ5IG1lbnRob2wgb3IgbWludCBmbGF2b3JlZCBwcm9kdWN0cy4gV2UgY2FuIGFsc28gc2VlIHRoYXQgdGhlcmUgd2FzIGEgZ2VuZXJhbCBpbmNyZWFzZSBpbiB0aGUgdXNhZ2Ugb2YgZmxhdm9yZWQgcHJvZHVjdHMgb3ZlciB0aW1lLg0KDQpXZSB3aWxsIG5vdyBsb29rIHNwZWNpZmljYWxseSBhdCB0aGUgdXNhZ2Ugb2YgZmxhdm9yZWQgZS1jaWdhcmV0dGUgcHJvZHVjdHMgdnMgb3RoZXIgZmxhdm9yZWQgdG9iYWNjbyBwcm9kdWN0cy4gDQoNClJlY2FsbCB0aGF0IHdlIG1hZGUgYSB2YXJpYWJsZSBjYWxsZWQgYEdyb3VwYCB0aGF0IGlkZW50aWZpZWQgc3R1ZGVudHMgd2hvIHVzZWQgZWl0aGVyIGp1c3QgZS1jaWdhcmV0dGUvdmFwaW5nIHByb2R1Y3RzLCBqdXN0IG90aGVyIHRvYmFjY28gcHJvZHVjdHMgKGJlc2lkZXMgZS1jaWdhcmV0dGVzKSwgb3Igc3R1ZGVudHMgd2hvIHVzZWQgYm90aCBlLWNpZ2FyZXR0ZXMgYW5kIHNvbWUgb3RoZXIgdHlwZSBvZiB0b2JhY2NvIHByb2R1Y3QuIFdlIHdpbGwgY29tcGFyZSB0aGUgdXNhZ2Ugb2YgdGhlc2UgZmxhdm9ycyBmb3IgdGhlc2UgZGlmZmVyZW50IGdyb3Vwcy4gV2UgYWxzbyBwZXJmb3JtIHNvbWUgZGF0YSBzdW1tYXJpZXMgdG8gZGVjaWRlIGhvdyB0byBvcmRlciB0aGUgcGFuZWxzIChmbGF2b3JzKSBmb3IgZGlzcGxheS4NCg0KDQoNCmBgYHtyfQ0KDQp2X2NvbG9ycyA9ICB2aXJpZGlzKDUpWzE6NF0NCg0KcGxvdDUgPC0gbnl0c19kYXRhICU+JQ0KICBmaWx0ZXIoeWVhciAhPSAyMDE1KSAlPiUNCiAgZ3JvdXBfYnkoeWVhciwgR3JvdXApICU+JQ0KICAgICAgICBzdW1tYXJpemUoTWVudGhvbCA9IChtZWFuKG1lbnRob2wpICogMTAwKSwNCiAgICAgICAgIGBDbG92ZSBvciBTcGljZWAgPSAobWVhbihjbG92ZV9zcGljZSkgKiAxMDApLA0KICAgICAgICAgICAgICAgICAgICBGcnVpdCA9IChtZWFuKGZydWl0KSAqIDEwMCksDQogICAgICAgICAgICAgICAgQ2hvY29sYXRlID0gKG1lYW4oY2hvY29sYXRlKSAqIDEwMCksDQogICAgICAgIGBBbGNvaG9saWMgRHJpbmtgID0gKG1lYW4oYWxjb2hvbGljX2RyaW5rKSAqIDEwMCksDQpgQ2FuZHkvRGVzc2VydHMvXG5Td2VldHNgID0gKG1lYW4oY2FuZHlfZGVzc2VydF9zd2VldHMpICogMTAwKSwNCiAgICAgICAgICAgICAgICAgICAgT3RoZXIgPSAobWVhbihvdGhlcikgKiAxMDApLA0KICAgICAgICAgICAgICBSZXNwb25kZW50cyA9IG4oKSkgJT4lDQogICMgY29udmVydGluZyBjb2x1bW5zIGJldHdlZW4gYW5kIGluY2x1ZGluZyBNZW50aG9sIGFuZCBPdGhlciB0byBvbmUgY29sdW1uIGNhbGxlZCBGbGF2b3INCiAgcGl2b3RfbG9uZ2VyKGNvbHMgPSBNZW50aG9sOk90aGVyLCANCiAgICAgICAgICAgbmFtZXNfdG8gPSAiRmxhdm9yIiwgDQogICAgICAgICAgdmFsdWVzX3RvID0gIlBlcmNlbnRhZ2Ugb2Ygc3R1ZGVudHMiKSAlPiUNCiAgZ3JvdXBfYnkoRmxhdm9yKSAlPiUNCiAgIyBjYWxjdWxhdGUgdGhlIGNvdW50IG9mIHN0dWRlbnRzIGluIHRoZSB5ZWFyL2dyb3VwIGNvbWJpbmF0aW9uIHdobyB1c2VkIHRoYXQgZmxhdm9yDQogIG11dGF0ZShhZmZpcm1hdGl2ZSA9IChSZXNwb25kZW50cyAqIGBQZXJjZW50YWdlIG9mIHN0dWRlbnRzYCkgLyAxMDApICU+JQ0KICAjIGNhbGN1bGF0ZSB0aGUgZnJhY3Rpb24gb2YgdG90YWwgcmVzcG9uZGVudHMgd2hvIHVzZWQgdGhhdCBmbGF2b3INCiAgbXV0YXRlKGZsYXZvcl9tZWFuID0gc3VtKGFmZmlybWF0aXZlKSAvIHN1bShSZXNwb25kZW50cykpICU+JQ0KICB1bmdyb3VwKCkgJT4lDQogICMgcmVvcmRlciB0aGUgbGV2ZWxzIG9mIEZsYXZvciB0byBiZSBpbiBpbmNyZWFzaW5nIG9yZGVyIG9mIHBlcmNlbnQgb2Ygc3R1ZGVudHMNCiAgbXV0YXRlKGZsYXZvcl9tZWFuX3JhbmsgPSBkZW5zZV9yYW5rKGZsYXZvcl9tZWFuKSwNCiAgICAgICAgIEZsYXZvciA9IGZjdF9yZW9yZGVyKEZsYXZvciwgZmxhdm9yX21lYW5fcmFuaykpICU+JQ0KICBnZ3Bsb3QoYWVzKHggPSB5ZWFyLCANCiAgICAgICAgICAgICB5ID0gYFBlcmNlbnRhZ2Ugb2Ygc3R1ZGVudHNgLCANCiAgICAgICAgIGNvbG9yID0gR3JvdXApKSArDQogIGZhY2V0X2dyaWQofkZsYXZvcikgKw0KICBnZW9tX2xpbmUoKSArDQogIGdlb21fcG9pbnQoc2hvdy5sZWdlbmQgPSBGQUxTRSwgc2l6ZSA9IDIpICsNCiAgc2NhbGVfY29sb3JfbWFudWFsKHZhbHVlcyA9IHZfY29sb3JzKSArDQogIHRoZW1lX2xpbmVkcmF3KCkgKw0KICB0aGVtZShsZWdlbmQucG9zaXRpb24gPSAiYm90dG9tIiwNCiAgICAgICAgYXhpcy50aXRsZS54ID0gZWxlbWVudF9ibGFuaygpLA0KICAgICAgICBheGlzLnRleHQueCA9IGVsZW1lbnRfdGV4dChhbmdsZSA9IDkwKSwNCiAgICAgICAgc3RyaXAudGV4dC54ID0gZWxlbWVudF90ZXh0KHNpemUgPSAxMCwgZmFjZSA9ICJib2xkIikpICsNCiAgbGFicyh0aXRsZSA9ICJBbW9uZyBkaWZmZXJlbnQgcHJvZHVjdCB1c2Vycywgd2hhdCBmbGF2b3JzIGFyZSBtb3N0IGZyZXF1ZW50bHkgdXNlZD8iKQ0KDQpwbG90NQ0KYGBgDQoNCg0KV2UgY2FuIHNlZSBmcm9tIHRoaXMgcGxvdCB0aGF0IHRoZXJlIGhhcyBiZWVuIGFuIGluY3JlYXNlIGluIHRoZSBudW1iZXIgb2Ygc3R1ZGVudHMgcmVwb3J0aW5nIHVzaW5nIGZsYXZvcmVkIHRvYmFjY28gcHJvZHVjdHMuIFVzZXJzIHdobyB1c2UgYm90aCBlLWNpZ2FyZXR0ZXMgYW5kIG90aGVyIHRvYmFjY28gcHJvZHVjdHMgYXBwZWFyIHRvIHJlcG9ydCB1c2luZyBmbGF2b3JlZCBwcm9kdWN0cyB0aGUgbW9zdCwgZm9sbG93ZWQgYnkgdXNlcnMgd2hvIG9ubHkgdXNlIGUtY2lnYXJldHRlcy4NCg0KIyMjICoqUXVlc3Rpb24gNCoqDQoqKioNCg0KSXMgdGhlcmUgYSByZWxhdGlvbnNoaXAgYmV0d2VlbiBlLWNpZ2FyZXR0ZSB1c2UgYW5kIHRvYmFjY28gdXNlPyBOb3cgd2Ugd2lsbCBpbnZlc3RpZ2F0ZSB0aGUgdXNhZ2Ugb2YgZS1jaWdhcmV0dGVzIGNvbXBhcmVkIHRvIG90aGVyIHRvYmFjY28gcHJvZHVjdHMgaW4gZ3JlYXRlciBkZXB0aC4gDQoNCkZpcnN0IGxldCdzIHRha2UgYSBsb29rIGF0IGhvdyBlLWNpZ2FyZXR0ZSB1c2FnZSBhbmQgY2lnYXJldHRlIHVzYWdlIGNvbXBhcmUuIFdlIHdpbGwgc2VsZWN0IHRoZSBkYXRhIHRoYXQgc3BlY2lmaWNhbGx5IGhhcyB0byBkbyB3aXRoIHRoZXNlIHByb2R1Y3RzLg0KDQpgYGB7cn0NCg0KDQp2X2NvbG9ycyA9ICB2aXJpZGlzKDYpW2MoMSwgNCldDQoNCm55dHNfZGF0YSAlPiUNCiAgICBncm91cF9ieSh5ZWFyKSAlPiUNCiAgICBzdW1tYXJpemUoIkNpZ2FyZXR0ZXMsIEV2ZXIiID0gKG1lYW4oRUNJR1QsIG5hLnJtID0gVFJVRSkgKiAxMDApLA0KICAgICAgICAgICAgIkUtY2lnYXJldHRlcywgRXZlciIgPSAobWVhbihFRUxDSUdULCBuYS5ybSA9IFRSVUUpICogMTAwKSwNCiAgICAgICAgICAgIkNpZ2FyZXR0ZXMsIEN1cnJlbnQiID0gKG1lYW4oQ0NJR1QsIG5hLnJtID0gVFJVRSkgKiAxMDApLA0KICAgICAgICAgIkUtY2lnYXJldHRlcywgQ3VycmVudCIgPSAobWVhbihDRUxDSUdULCBuYS5ybSA9IFRSVUUpICogMTAwKSkgJT4lDQogICAgcGl2b3RfbG9uZ2VyKGNvbHMgPSAtIHllYXIsIA0KICAgICAgICAgICAgIG5hbWVzX3RvID0gIkNhdGVnb3J5IiwgDQogICAgICAgICAgICB2YWx1ZXNfdG8gPSAiUGVyY2VudGFnZSBvZiBzdHVkZW50cyIpICU+JQ0KICAgIHNlcGFyYXRlKENhdGVnb3J5LCBpbnRvID0gYygiUHJvZHVjdCIsICJVc2VyIiksIHNlcCA9ICIsICIpICU+JQ0KICAgIGhlYWQoKQ0KDQoNCnBsb3Q2IDwtIG55dHNfZGF0YSAlPiUNCiAgZ3JvdXBfYnkoeWVhcikgJT4lDQogIHN1bW1hcml6ZSgNCiAgICAiQ2lnYXJldHRlcywgRXZlciIgPSAobWVhbihFQ0lHVCwgbmEucm0gPSBUUlVFKSAqIDEwMCksDQogICAgIkUtY2lnYXJldHRlcywgRXZlciIgPSAobWVhbihFRUxDSUdULCBuYS5ybSA9IFRSVUUpICogMTAwKSwNCiAgICAiQ2lnYXJldHRlcywgQ3VycmVudCIgPSAobWVhbihDQ0lHVCwgbmEucm0gPSBUUlVFKSAqIDEwMCksDQogICAgIkUtY2lnYXJldHRlcywgQ3VycmVudCIgPSAobWVhbihDRUxDSUdULCBuYS5ybSA9IFRSVUUpICogMTAwKQ0KICApICU+JQ0KICBwaXZvdF9sb25nZXIoY29scyA9IC15ZWFyLA0KICAgICAgICAgICAgICAgbmFtZXNfdG8gPSAiQ2F0ZWdvcnkiLA0KICAgICAgICAgICAgICAgdmFsdWVzX3RvID0gIlBlcmNlbnRhZ2Ugb2Ygc3R1ZGVudHMiKSAlPiUNCiAgc2VwYXJhdGUoQ2F0ZWdvcnksIGludG8gPSBjKCJQcm9kdWN0IiwgIlVzZXIiKSwgc2VwID0gIiwgIikgJT4lDQogIGdncGxvdChhZXMoDQogICAgeCA9IHllYXIsDQogICAgeSA9IGBQZXJjZW50YWdlIG9mIHN0dWRlbnRzYCwNCiAgICBjb2xvciA9IFByb2R1Y3QsDQogICAgbGluZXR5cGUgPSBVc2VyDQogICkpICsNCiAgZ2VvbV9saW5lKCkgKw0KICBnZW9tX3BvaW50KHNob3cubGVnZW5kID0gRkFMU0UsIHNpemUgPSAyKSArDQogIHNjYWxlX2xpbmV0eXBlX21hbnVhbCh2YWx1ZXMgPSBjKDIsIDEpKSArDQogIHNjYWxlX2NvbG9yX21hbnVhbCh2YWx1ZXMgPSB2X2NvbG9ycykgKw0KICB0aGVtZV9saW5lZHJhdygpICsNCiAgdGhlbWUobGVnZW5kLnBvc2l0aW9uID0gImJvdHRvbSIsDQogICAgICAgIGF4aXMudGl0bGUueCA9IGVsZW1lbnRfYmxhbmsoKSkgKw0KICBsYWJzKHRpdGxlID0gIkhvdyBkb2VzIGUtY2lnYXJldHRlIHVzZSBjb21wYXJlIHRvIGNpZ2FyZXR0ZSB1c2U/IiwNCiAgICAgICBzdWJ0aXRsZSA9ICJDdXJyZW50IGFuZCBldmVyIHVzZXJzIG9mIGUtY2lnYXJldHRlcyBhbmQgY2lnYXJldHRlcyIsDQogICAgICAgeSA9ICIlIG9mIHN0dWRlbnRzIikNCg0KcGxvdDYNCmBgYA0KDQpJbnRlcmVzdGluZyEgd2UgY2FuIHNlZSB0aGF0IGluIDIwMTkgdGhlIHBlcmNlbnRhZ2Ugb2Ygc3R1ZGVudHMgdGhhdCByZXBvcnRlZCBjdXJyZW50bHkgdXNpbmcgZS1jaWdhcmV0dGVzIGhhZCBzdXJwYXNzZWQgdGhvc2UgdGhhdCBldmVyIHRyaWVkIChldmVuIGp1c3Qgb25jZSkgYSBjaWdhcmV0dGUuIE92ZXJhbGwgY2lnYXJldHRlIHVzYWdlIGFwcGVhcnMgdG8gYmUgZGVjbGluaW5nIG92ZXIgdGltZS4gVGhpcyBpcyBub3QgdGhlIGNhc2UgZm9yIGUtY2lnYXJldHRlcy4NCg0KDQpOb3cgd2Ugd2lsbCBsb29rIGF0IHN0dWRlbnRzIHdobyByZXBvcnRlZCB0aGF0IHRoZXkgaGFkIGV2ZXIgdHJpZWQgZS1jaWdhcmV0dGVzIG9yIG5vbi1jaWdhcmV0dGUgcHJvZHVjdHMuIEluIHRoaXMgY2FzZSB3ZSB3aWxsIG5vdCBzZXBhcmF0ZSBvdXQgdXNlcnMgd2hvIHNwZWNpZmljYWxseSBvbmx5IHVzZWQgb25lIG9yIHRoZSBvdGhlci4gVGhlcmVmb3JlLCB0aGUgc3R1ZGVudHMgaW5jbHVkZWQgaW4gdGhpcyBwbG90IHdobyByZXBvcnRlZCBhcyBoYXZpbmcgZXZlciB0cmllZCBlLWNpZ2FyZXR0ZXMgbWlnaHQgYWxzbyBiZSAgY3VycmVudCB1c2VycyBvZiBub24tZS1jaWdhcmV0dGUgcHJvZHVjdHMgb3IgbWF5IGhhdmUgYXQgbGVhc3QgdHJpZWQgbm9uLWUtY2lnYXJldHRlIHByb2R1Y3RzLg0KDQoNCmBgYHtyfQ0KDQp2X2NvbG9ycyA9ICB2aXJpZGlzKDYpW2MoMSwgNCldDQoNCnBsb3Q3IDwtIG55dHNfZGF0YSAlPiUNCiAgZ3JvdXBfYnkoeWVhcikgJT4lDQogIHN1bW1hcml6ZSgNCiAgICBgZS1jaWdhcmV0dGVfZXZlcmAgPSAobWVhbihlY2lnX2V2ZXIsIG5hLnJtID0gVFJVRSkgKiAxMDApLA0KICAgIGBub24tZS1jaWdhcmV0dGVfZXZlcmAgPSAobWVhbihub25fZWNpZ19ldmVyLCBuYS5ybSA9IFRSVUUpICogMTAwKQ0KICApICU+JQ0KICBwaXZvdF9sb25nZXIoY29scyA9IC15ZWFyLA0KICAgICAgICAgICAgICAgbmFtZXNfdG8gPSAiQ2F0ZWdvcnkiLA0KICAgICAgICAgICAgICAgdmFsdWVzX3RvID0gIlBlcmNlbnRhZ2Ugb2Ygc3R1ZGVudHMiKSAlPiUNCiAgc2VwYXJhdGUoQ2F0ZWdvcnksIGludG8gPSBjKCJQcm9kdWN0IiwgIlVzZXIiKSwgc2VwID0gIl8iKSAlPiUNCiAgZ2dwbG90KGFlcyh4ID0geWVhciwNCiAgICAgICAgICAgICB5ID0gYFBlcmNlbnRhZ2Ugb2Ygc3R1ZGVudHNgLA0KICAgICAgICAgICAgIGNvbG9yID0gUHJvZHVjdCkpICsNCiAgZ2VvbV9saW5lKCkgKw0KICBnZW9tX3BvaW50KHNob3cubGVnZW5kID0gRkFMU0UsIHNpemUgPSAyKSArDQogIHNjYWxlX2NvbG9yX21hbnVhbCh2YWx1ZXMgPSB2X2NvbG9ycykgKw0KICBzY2FsZV95X2NvbnRpbnVvdXMoYnJlYWtzID0gc2VxKDAsIDYwLCBieSA9IDEwKSwgbGltaXRzID0gYygwLCA2MCkpICsNCiAgdGhlbWVfbGluZWRyYXcoKSArDQogIHRoZW1lKGxlZ2VuZC5wb3NpdGlvbiA9ICJib3R0b20iLA0KICAgICAgICBheGlzLnRpdGxlLnggPSBlbGVtZW50X2JsYW5rKCkpICsNCiAgbGFicyh0aXRsZSA9ICJIb3cgZG9lcyB0aGUgcmF0ZSBvZiBldmVyIHRyeWluZyBlLWNpZ2FyZXR0ZXMNCmNvbXBhcmUgdG8gZXZlciB0cnlpbmcgb3RoZXIgcHJvZHVjdHMgb3ZlciB0aW1lPyIsDQp5ID0gIiUgb2Ygc3R1ZGVudHMiKQ0KDQpwbG90Nw0KYGBgDQoNCg0KTm93IHdlIHdpbGwgZG8gdGhlIHNhbWUsIGJ1dCBmb3Igc3R1ZGVudHMgd2hvIHJlcG9ydGVkIGN1cnJlbnRseSB1c2luZyBlLWNpZ2FyZXR0ZXMgb3Igbm9uLWUtY2lnYXJldHRlIHByb2R1Y3RzLiANCg0KDQpgYGB7cn0NCnZfY29sb3JzID0gIHZpcmlkaXMoNilbYygxLCA0KV0NCg0KcGxvdDggPC0gbnl0c19kYXRhICU+JQ0KICBncm91cF9ieSh5ZWFyKSAlPiUNCiAgc3VtbWFyaXplKA0KICAgIGBlLWNpZ2FyZXR0ZV9jdXJyZW50YCA9IChtZWFuKGVjaWdfY3VycmVudCwgbmEucm0gPSBUUlVFKSAqIDEwMCksDQogICAgYG5vbi1lLWNpZ2FyZXR0ZV9jdXJyZW50YCA9IChtZWFuKG5vbl9lY2lnX2N1cnJlbnQsIG5hLnJtID0gVFJVRSkgKiAxMDApDQogICkgJT4lDQogIHBpdm90X2xvbmdlcihjb2xzID0gLXllYXIsDQogICAgICAgICAgICAgICBuYW1lc190byA9ICJDYXRlZ29yeSIsDQogICAgICAgICAgICAgICB2YWx1ZXNfdG8gPSAiUGVyY2VudGFnZSBvZiBzdHVkZW50cyIpICU+JQ0KICBzZXBhcmF0ZShDYXRlZ29yeSwgaW50byA9IGMoIlByb2R1Y3QiLCAiVXNlciIpLCBzZXAgPSAiXyIpICU+JQ0KICBnZ3Bsb3QoYWVzKHggPSB5ZWFyLCB5ID0gYFBlcmNlbnRhZ2Ugb2Ygc3R1ZGVudHNgLCBjb2xvciA9IFByb2R1Y3QpKSArDQogIGdlb21fbGluZShsaW5ldHlwZSA9ICJkYXNoZWQiKSArDQogIGdlb21fcG9pbnQoc2hvdy5sZWdlbmQgPSBGQUxTRSwgc2l6ZSA9IDIpICsNCiAgc2NhbGVfY29sb3JfbWFudWFsKHZhbHVlcyA9IHZfY29sb3JzKSArDQogIHNjYWxlX2xpbmV0eXBlX21hbnVhbCh2YWx1ZXMgPSBjKDEpKSArDQogIHNjYWxlX3lfY29udGludW91cyhicmVha3MgPSBzZXEoMCwgNjAsIGJ5ID0gMTApLCBsaW1pdHMgPSBjKDAsIDYwKSkgKw0KICB0aGVtZV9saW5lZHJhdygpICsNCiAgdGhlbWUobGVnZW5kLnBvc2l0aW9uID0gImJvdHRvbSIsDQogICAgICAgIGF4aXMudGl0bGUueCA9IGVsZW1lbnRfYmxhbmsoKSkgKw0KICBsYWJzKHRpdGxlID0gIkhvdyBkb2VzIHRoZSByYXRlIG9mIGN1cnJlbnRseSB1c2luZyBlLWNpZ2FyZXR0ZXMNCmNvbXBhcmUgdG8gY3VycmVudGx5IHVzaW5nIG90aGVyIHByb2R1Y3RzIG92ZXIgdGltZT8iLA0KICAgICAgIHkgPSAiJSBvZiBzdHVkZW50cyIpDQoNCnBsb3Q4DQpgYGANCg0KIyMjICoqUHV0dGluZyBwbG90cyB0b2dldGhlcioqDQoqKioNCg0KTm93IHdlIHdpbGwgcHV0IHRoZXNlIHBsb3RzIHRvZ2V0aGVyIHVzaW5nIHRoZSBgcGxvdF9ncmlkKClgIGZ1bmN0aW9uIG9mIHRoZSBgY293cGxvdGAgcGFja2FnZS4gIFdlIHdpbGwgYWxzbyBtb2RpZnkgdGhlIGxhYmVscyB1c2luZyB0aGUgYGdnZHJhdygpYCBmdW5jdGlvbiwgd2hpY2ggaXMgYWxzbyBwYXJ0IG9mIHRoZSBgY293cGxvdGAgcGFja2FnZS4NCg0KYGBge3IsIGZpZy5oZWlnaHQ9MTB9DQpwbG90QV91dyA8LSBwbG90MSArDQogIHRoZW1lKGF4aXMudGl0bGUueCA9IGVsZW1lbnRfYmxhbmsoKSwNCiAgICAgICAgbGVnZW5kLnBvc2l0aW9uID0gIm5vbmUiKSArDQogIGxhYnModGl0bGUgPSAiVG9iYWNjbyBwcm9kdWN0IHVzZXJzIG1vcmUgcHJldmFsZW50IGFmdGVyIDIwMTciLA0KICAgICAgIHN1YnRpdGxlID0gTlVMTCwNCiAgICAgICB5ID0gIiUgb2Ygc3R1ZGVudHMiKQ0KDQpwbG90Ql91dyA8LSBwbG90NyArDQogIHRoZW1lKGF4aXMudGl0bGUueCA9IGVsZW1lbnRfYmxhbmsoKSwNCiAgICAgICAgbGVnZW5kLnBvc2l0aW9uID0gIm5vbmUiKSArDQogICAgbGFicyh0aXRsZSA9ICIlIEV2ZXIgdHJ5aW5nIGUtY2lnYXJldHRlcyBpbmNyZWFzZXMgJg0KJSBFdmVyIHRyeWluZyBvdGhlciBwcm9kdWN0cyBkZWNyZWFzZXMiLA0KICAgICAgICAgc3VidGl0bGUgPSBOVUxMLA0KICAgICAgICAgeSA9ICIlIG9mIHN0dWRlbnRzIikNCg0KcGxvdENfdXcgPC0gcGxvdDggKw0KICB0aGVtZShheGlzLnRpdGxlLnggPSBlbGVtZW50X2JsYW5rKCksDQogICAgICAgIGxlZ2VuZC5wb3NpdGlvbiA9ICJub25lIikgKw0KICAgIGxhYnModGl0bGUgPSAiJSBDdXJyZW50bHkgdXNpbmcgZS1jaWdhcmV0dGVzIGluY3JlYXNlcyAmDQolIEN1cnJlbnRseSB1c2luZyBvdGhlciBwcm9kdWN0cyBkZWNyZWFzZXMiLA0KICAgICAgICAgc3VidGl0bGUgPSBOVUxMLA0KICAgICAgICAgeSA9ICIlIG9mIHN0dWRlbnRzIikNCg0KdGl0bGVfdXcgPC0gZ2dkcmF3KCkgKw0KICBkcmF3X2xhYmVsKA0KICAgICJJcyB0aGVyZSBhIHJlbGF0aW9uc2hpcCBiZXR3ZWVuIGUtY2lnYXJldHRlIHVzZSBhbmQgdG9iYWNjbyB1c2U/IiwNCiAgICBmb250ZmFjZSA9ICdib2xkJywNCiAgICBzaXplID0gMTQsDQogICAgeCA9IDAsDQogICAgaGp1c3QgPSAwDQogICkgKw0KICB0aGVtZSgNCiAgICBwbG90Lm1hcmdpbiA9IG1hcmdpbigwLCAwLCAwLCAwKQ0KICApDQoNCnBsb3RzQV91dyA8LSBwbG90X2dyaWQocGxvdEFfdXcsDQogICAgICAgICAgICAgICAgICAgICByZWxfd2lkdGhzID0gYygxLCAxKSkNCnBsb3RzQkNfdXcgPC0gcGxvdF9ncmlkKHBsb3RCX3V3LA0KICAgICAgICAgICAgICAgICAgICAgICAgcGxvdENfdXcsDQogICAgICAgICAgICAgICAgICAgICAgICByZWxfd2lkdGhzID0gYygxLCAxKSkNCg0KIyB0aGlzIHdpbGwgdGFrZSB0aGUgbGVnZW5kIGZyb20gcGxvdDFjIHRvIHVzZSBhcyB0aGUgbGVnZW5kIGZvciB0aGUgcGxvdCB3ZSBhcmUgY3JlYXRpbmcNCmxlZ2VuZF91dyA8LSBnZXRfbGVnZW5kKHBsb3QxYyArDQogICAgICAgICAgICAgICAgICAgICAgIHRoZW1lKGxlZ2VuZC5wb3NpdGlvbiA9ICJib3R0b20iLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZWdlbmQuZGlyZWN0aW9uID0gImhvcml6b250YWwiKSkNCg0KZmlndXJlX3V3IDwtIHBsb3RfZ3JpZCh0aXRsZV91dywNCiAgICAgICAgICAgICAgICAgICAgICAgcGxvdHNBX3V3LA0KICAgICAgICAgICAgICAgICAgICAgICBwbG90c0JDX3V3LA0KICAgICAgICAgICAgICAgICAgICAgICBsZWdlbmRfdXcsDQogICAgICAgICAgICAgICAgICAgICAgIG5jb2wgPSAxLA0KICAgICAgICAgICAgICAgICAgICAgICByZWxfaGVpZ2h0cyA9IGMoMC4xLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDEsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAwLjEpLA0KICAgICAgICAgICAgICAgICAgICAgICBzY2FsZSA9IDEuMCkNCg0KZmlndXJlX3V3DQpgYGANCg0KDQojIyMgKipTdXJ2ZXkgV2VpZ2h0aW5nKioNCioqKg0KYGBge3IsIGVjaG8gPSBGQUxTRX0NCiNJZiBpbnN0cnVjdG9ycyBzdGFydCBoZXJlLCB3ZSBuZWVkIHRvIGxvYWQgdGhlIGRhdGE6DQojIGxvYWQoaGVyZTo6aGVyZSgiZGF0YSIsICJ3cmFuZ2xlZF9kYXRhX3dpdGhfdmFyX2Zvcl9wbG90cy5yZGEiKSkNCmxvYWQoInd3dy9kYXRhL3dyYW5nbGVkX2RhdGFfd2l0aF92YXJfZm9yX3Bsb3RzLnJkYSIpDQpgYGANCiAgDQpJdCB0dXJucyBvdXQgdGhhdCBvdXIgYW5hbHlzaXMgdGh1cyBmYXIgaGFzIGJlZW4gYnJ1c2hpbmcgYW4gaW1wb3J0YW50IHN0YXRpc3RpY2FsIGNvbmNlcHQgdW5kZXIgdGhlIHJ1ZywgcmVsYXRlZCB0byBob3cgb3VyIGRhdGEgd2VyZSBjb2xsZWN0ZWQuIE91ciBkYXRhIGNvbWUgZnJvbSByZXNwb25zZXMgdG8gYSBzdXJ2ZXksIHdoaWNoIG1heSBoYXZlIGEgcGFydGljdWxhciBzYW1wbGluZyBzY2hlbWUgdG8gY2FwdHVyZSBkYXRhIGFib3V0IHRoZSBwb3B1bGF0aW9uIHdlIGFyZSBpbnRlcmVzdGVkIGluLiBGb3IgZXhhbXBsZSwgdGhlIHN1cnZleSBtYXkgYmUgZGVzaWduZWQgdG8gY2FwdHVyZSBhIHNldCBvZiBpbmRpdmlkdWFscyB3aG8gcmVmbGVjdCB0aGUgY2hhcmFjdGVyaXN0aWNzIG9mIHRoZSBwb3B1bGF0aW9uIHRoYXQgd2UgYXJlIGludGVyZXN0ZWQgaW4gZHJhd2luZyBjb25jbHVzaW9ucyBhYm91dC4gSG93ZXZlciwgb25seSBhIGZyYWN0aW9uIG9mIHRoZSBpbmRpdmlkdWFscyB3aG8gd2VyZSBjb250YWN0ZWQgYWJvdXQgdGFraW5nIHRoZSBzdXJ2ZXkgbWF5IGhhdmUgY29tcGxldGVkIGl0LCBhbmQgdGhpcyBmcmFjdGlvbiBvZiBpbmRpdmlkdWFscyBtYXkgbm8gbG9uZ2VyIGJlIHJlcHJlc2VudGF0aXZlIG9mIHRoZSBwb3B1bGF0aW9uLiBPciB0aGUgc3VydmV5IG1heSBiZSBkZXNpZ25lZCB0byBvdmVyLXNhbXBsZSBhIHBhcnRpY3VsYXIgZ3JvdXAgb2YgaW50ZXJlc3Qgc28gdGhhdCBpbmRpdmlkdWFscyBmcm9tIHRoYXQgZ3JvdXAgc2hvdyB1cCBtb3JlIG9mdGVuIGFzIHN1cnZleSByZXNwb25kZW50cyB0aGFuIGFyZSBwcmVzZW50IGluIHRoZSBwb3B1bGF0aW9uIG92ZXJhbGwuIEluIG9yZGVyIHRvIGFjY291bnQgZm9yIHRoZSBmYWN0IHRoYXQgdGhlIHN1cnZleSByZXNwb25kZW50cyBtYXkgbm90IHJlZmxlY3QgdGhlIGNvbXBvc2l0aW9uIG9mIHRoZSBwb3B1bGF0aW9uIHdlIHdhbnQgdG8gZ2VuZXJhbGl6ZSB0bywgd2UgY2FuIGVtcGxveSBhIHRlY2huaXF1ZSBjYWxsZWQgW3N1cnZleSB3ZWlnaHRpbmddKGh0dHA6Ly93d3cuYXBwbGllZC1zdXJ2ZXktbWV0aG9kcy5jb20vd2VpZ2h0Lmh0bWwpe3RhcmdldD0iX2JsYW5rIn0uDQoNClN1cnZleSB3ZWlnaHRpbmcgaXMgYSBjb21tb24gdGVjaG5pcXVlIHVzZWQgaW4gc3VydmV5IGRhdGEgYW5hbHlzaXMgYmVjYXVzZSBvZnRlbiB0aGUgaW5kaXZpZHVhbHMgdGhhdCB0YWtlIGEgc3VydmV5IGFyZSBub3QgbmVjZXNzYXJpbHkgcmVwcmVzZW50YXRpdmUgb2YgdGhlIHBvcHVsYXRpb24gdGhhdCB3ZSBhcmUgdHJ5aW5nIHRvIGdhdGhlciBpbmZvcm1hdGlvbiBhYm91dC4gRm9yIGV4YW1wbGUsIHdlIG1heSBoYXZlIG1vcmUgZmVtYWxlcyB0aGF0IHJlc3BvbmQgdG8gdGhlIHN1cnZleSB0aGFuIG1hbGVzIGJlY2F1c2UgcGVyaGFwcyBmZW1hbGUgc3R1ZGVudHMgd2VyZSBtb3JlIHdpbGxpbmcgdG8gcGFydGljaXBhdGUuIEluIHRoaXMgY2FzZSwgdGhlIHByb3BvcnRpb24gb2YgZGF0YSB2YWx1ZXMgaW4gb3VyIGRhdGEgd2lsbCBiZSBzbWFsbGVyIGZvciB0aGUgbWFsZXMgdGhhbiB0aGUgcHJvcG9ydGlvbiBvZiBhY3R1YWwgbWFsZSBzdHVkZW50cyBhbmQgbGFyZ2VyIGZvciB0aGUgZmVtYWxlcyB0aGFuIHRoZSB0cnVlIHByb3BvcnRpb24gb2YgYWN0dWFsIGZlbWFsZSBzdHVkZW50cy4gVG8gZ2V0IGEgYmV0dGVyIGVzdGltYXRlIG9mIG92ZXJhbGwgZS1jaWdhcmV0dGUgc21va2luZyByYXRlcywgdGhlIGRhdGEgZnJvbSB0aGUgbWFsZXMgY2FuIGJlIHdlaWdodGVkIGJhc2VkIG9uIHRoZSB0cnVlIHByb3BvcnRpb24gb2YgbWFsZSBzdHVkZW50cyB0byBhbXBsaWZ5IHRoZSBjb250cmlidXRpb24gb2YgdGhlIHJlc3BvbnNlcyBmcm9tIHRoZSBtYWxlcyB0aGF0IGRpZCBwYXJ0aWNpcGF0ZS4gQ29udmVyc2VseSwgdGhlIGZlbWFsZSBkYXRhIGNhbiBiZSB3ZWlnaHRlZCB0byBkaW1pbmlzaCB0aGUgY29udHJpYnV0aW9uIGlmIHRoZWlyIHJlc3BvbnNlcyB0byB0aGUgb3ZlcmFsbCBwaWN0dXJlLiBXZSB3aWxsIHNlZSBpZiB1c2luZyBzdXJ2ZXkgd2VpZ2h0aW5nIGNoYW5nZXMgdGhlIGdlbmVyYWwgdHJlbmRzIHRoYXQgd2Ugc2VlIGluIG91ciBkYXRhLiANCg0KQ2FsY3VsYXRpbmcgc3VydmV5IHdlaWdodHMgaW52b2x2ZXMgbWFraW5nIGEgd2VpZ2h0IGJhc2VkIG9uIHRoZSByYXRpbyBvZiB0aGUgcHJvcG9ydGlvbiBvZiBzdXJ2ZXkgcmVzcG9uZGVudHMgZnJvbSBhIHBhcnRpY3VsYXIgZ3JvdXAgYW5kIHRoZSBhY3R1YWwgcHJvcG9ydGlvbiBvZiB0aGF0IGdyb3VwIGluIHRoZSBwb3B1bGF0aW9uLiBGb3IgZXhhbXBsZSwgbGV0J3Mgc2F5IHRoYXQgZmVtYWxlcyBhY2NvdW50IGZvciA1MCUgb2YgdGhlIHBvcHVsYXRpb24gYW5kIG1hbGVzIGFjY291bnQgZm9yIDUwICUgb2YgdGhlIHBvcHVsYXRpb24uIExldCdzIGFsc28gc2F5IHRoYXQgNzUlIG9mIHRoZSByZXNwb25kZW50cyB0byB0aGUgc3VydmV5IHdlcmUgZmVtYWxlIGFuZCBvbmx5IDI1JSB3ZXJlIG1hbGVzLiANCg0KVGhlbiB3ZSBjb3VsZCBjYWxjdWxhdGUgc3VydmV5IHdlaWdodHMgdXNpbmcgdGhpcyBmb3JtdWxhOg0KDQokJCBcZnJhY3tcdGV4dHthY3R1YWwgcHJvcG9ydGlvbiBvZiBncm91cCBpbiB0aGUgcG9wdWxhdGlvbn19e1x0ZXh0eyBwcm9wb3J0aW9uIG9mIGdyb3VwIGluIHRoZSByZXNwb25kZW50c319JCQgIA0KDQpUaHVzIHRoZSB3ZWlnaHQgZm9yIHRoZSBmZW1hbGVzIHdvdWxkIGJlIGNhbGN1bGF0ZWQgYXM6DQoNCiQkIFxmcmFjey41fXsuNzV9ID0gLjY3JCQgIA0KDQpUaGUgd2VpZ2h0IGZvciB0aGUgbWFsZXMgd291bGQgYmUgY2FsY3VsYXRlZCBhczoNCg0KJCQgXGZyYWN7LjV9ey4yNX0gPSAyJCQNCg0KVGhlcmVmb3JlIGVhY2ggbWFsZSByZXNwb25zZSB2YWx1ZSB3b3VsZCBiZSBtdWx0aXBsaWVkIGJ5IGEgZmFjdG9yIG9mIDIgYW5kIHdvdWxkIGhhdmUgdHdpY2UgdGhlIGNvbnRyaWJ1dGlvbiwgd2hpbGUgdGhlIGZlbWFsZSByZXNwb25zZSB2YWx1ZXMgd291bGQgaGF2ZSBvbmx5IGFib3V0IDcwJSBvZiB0aGUgY29udHJpYnV0aW9uIHRoYXQgdGhleSB3b3VsZCBoYXZlIGhhZCB3aXRob3V0IHdlaWdodGluZy4NCg0KTm90ZSB0aGF0IHN1cnZleSB3ZWlnaHRzIGFyZSBpbiByZWFsaXR5IGNvcnJlY3RlZCBmb3Igb3RoZXIgYXNwZWN0cyAtIGZvciBleGFtcGxlIHRoZSByZXNwb25zZSByYXRlIHRvIGluZGl2aWR1YWwgcXVlc3Rpb25zLg0KDQpXZSBkbyBub3QgbmVlZCB0byBjYWxjdWxhdGUgc3VydmV5IHdlaWdodHMgZm9yIG91ciBkYXRhIGFzIHRoZXkgd2VyZSBhbHJlYWR5IHN1cHBsaWVkIGluIHRoZSBkYXRhc2V0LCBhcyBkZXNjcmliZWQgaW4gdGhlIGNvZGVib29rcy4gDQoNCiMjIyMgYHNydnlyYCBwYWNrYWdlIGFuZCBzdXJ2ZXkgZGVzaWduIA0KDQoqKioNCg0KV2Ugd2lsbCBub3cgdXNlIHRoZSBgc3J2eXJgIHBhY2thZ2UgdG8gZXZhbHVhdGUgb3VyIGRhdGEgdXNpbmcgc3VydmV5IHdlaWdodHMgdGhhdCB3ZXJlIHByb3ZpZGVkIGluIHRoZSBkYXRhIGZvciBlYWNoIHllYXIsIGFzIGRlc2NyaWJlZCBpbiB0aGUgcmVzcGVjdGl2ZSBjb2RlYm9va3MuIFRoaXMgcGFja2FnZSBjb250YWlucyBmdW5jdGlvbnMgdGhhdCBhbGxvdyB0aGUgdXNlciB0byBlYXNpbHkgcGVyZm9ybSBjYWxjdWxhdGlvbnMgZnJvbSB0aGUgZGF0YSB0aGF0IHRha2UgdGhlIHN1cnZleSBkZXNpZ24gaW50byBhY2NvdW50LCB3aXRob3V0IGhhdmluZyB0byB3b3JrIG91dCB0aGUgbWF0aCBieSBoYW5kLg0KDQpXaXRoaW4gdGhlIGRhdGEgeW91IHdpbGwgc2VlIHRoYXQgd2UgaGF2ZSB0aHJlZSB2YXJpYWJsZXMgcmVsYXRlZCB0byB0aGUgc3VydmV5IHNhbXBsaW5nIHNjaGVtZTogIGBwc3VgLCBgZmlud2d0YCwgYW5kIGBzdHJhdHVtYC4gRGV0YWlscyBhYm91dCB0aGVzZSB2YXJpYWJsZXMgYXJlIGF2YWlsYWJsZSwgZm9yIGV4YW1wbGUsIGluIHRoZSBbMjAxOSBNZXRob2RvbG9neSBSZXBvcnRdKC4vZG9jcy8yMDE5LW55dHMtZGF0YXNldC1hbmQtY29kZWJvb2stbWljcm9zb2Z0LWV4Y2VsLzIwMTktbnl0cy1tZXRob2RvbG9neS1yZXBvcnQtcC5wZGYpe3RhcmdldD0iX2JsYW5rIn0uDQoNCkluIGJyaWVmIHRoZXkgcmVwcmVzZW50OiANCg0KMSkgYHBzdWA6IFN1cnZleXMgbGlrZSB0aGUgb25lIHVzZWQgdG8gY3JlYXRlIHRoZSBkYXRhIHdlIGFyZSB1c2luZyBvZnRlbiBzYW1wbGUgcGVvcGxlIGJhc2VkIG9uIHN0cmF0YS4gVGhpcyBpcyBkb25lIHRvIGVuc3VyZSB0aGF0IHRoZSByZXNwb25zZXMgYXJlIHJlcHJlc2VudGF0aXZlIG9mIHRoZSBwb3B1bGF0aW9uIG9mIGludGVyZXN0LiBUaHVzLCBvZnRlbiBwZW9wbGUgZmlyc3QgdGhpbmsgYWJvdXQgZW5zdXJpbmcgdGhhdCBzdXJ2ZXlzIGFyZSBjb25kdWN0ZWQgaW4gYSB2YXJpZXR5IG9mIGdlb2dyYXBoaWNhbCBhcmVhcy4gVGhpcyBpcyBvZnRlbiBjYWxsZWQgdGhlICoqcHJpbWFyeSBzYW1wbGluZyB1bml0Kiogb3IgKipQU1UqKi4gSW4gW3RoaXMgc3VydmV5XShodHRwczovL3dlYi5zcGguaGFydmFyZC5lZHUvbWNoLWRhdGEtY29ubmVjdC9yZXN1bHRzL25hdGlvbmFsLXlvdXRoLXRvYmFjY28tc3VydmV5LW55dHMvKXt0YXJnZXQ9Il9ibGFuayJ9LCB0aGUgY291bnR5IHdoZXJlIHRoZSBzdHVkZW50J3Mgc2Nob29sIHdhcyBsb2NhdGVkIHdhcyB1c2VkIGFzIHRoZSBQU1UuIA0KDQoyKSBgc3RyYXR1bWA6IEEgY2F0ZWdvcmljYWwgdmFyaWFibGUgdGhhdCBpbmRpY2F0ZXMgc3Vic2V0cyBvZiB0aGUgZGF0YSB0aGF0IGluY2x1ZGUgcmVzcG9uZGVudHMgZnJvbSBkaWZmZXJlbnQgKlBTVXMqLiBJbiBvdXIgY2FzZSwgc3RyYXRhIGFyZSBkZXRlcm1pbmVkIGJ5IHRoZSBwcmVkb21pbmFudCBtaW5vcml0eSBpbiB0aGUgUFNVIChOb24tSGlzcGFuaWMgQmxhY2sgb3IgSGlzcGFuaWMpLCB3aGV0aGVyIHRoZSBQU1UgaXMgdXJiYW4gb3Igbm9uLXVyYmFuLCBhbmQgd2hhdCBwZXJjZW50IG9mIHRoZSBzdHVkZW50cyBpbiB0aGUgUFNVIGZhbGwgaW50byB0aGUgcHJlZG9taW5hbnQgbWlub3JpdHkgZ3JvdXAuIFBTVXMgYXJlIGFsbG9jYXRlZCBhY3Jvc3MgdGhlIDE2IHBvc3NpYmxlIHN0cmF0YSBhY2NvcmRpbmcgdG8gdGhlIHNhbXBsaW5nIHNjaGVtZS4gVGhlc2Ugc3RyYXRhIHZhbHVlcyBhbGxvdyBlc3RpbWF0ZXMgYmFzZWQgb24gdGhlIHN1cnZleSByZXNwb25zZXMgdG8gYmUgY2FsY3VsYXRlZCB1c2luZyBkaWZmZXJlbnQgc3RyYXRhIGFsbG93aW5nIGZvciBpbXByb3ZlZCBwcmVjaXNpb24gb2YgdGhlIHJlc3BvbnNlIGVzdGltYXRlcy4NCg0KMykgYGZpbndndGA6IFRoZSBzdXJ2ZXkgd2VpZ2h0IHdoaWNoIHdhcyBjYWxjdWxhdGVkIGJhc2VkIG9uIGEgdmFyaWV0eSBvZiBmYWN0b3JzLg0KDQpUaGlzIFtsaW5rXShodHRwczovL3dlYi5zcGguaGFydmFyZC5lZHUvbWNoLWRhdGEtY29ubmVjdC9yZXN1bHRzL25hdGlvbmFsLXlvdXRoLXRvYmFjY28tc3VydmV5LW55dHMvKXt0YXJnZXQ9Il9ibGFuayJ9IGFuZCB0aGlzIFtsaW5rXShodHRwczovL29zZi5pby9uN3IzMil7dGFyZ2V0PSJfYmxhbmsifSBoYXZlIG1vcmUgaW5mb3JtYXRpb24gYWJvdXQgdGhlIHN0dWR5IGRlc2lnbiBvZiB0aGUgZGF0YSB0aGF0IHdlIGFyZSB1c2luZy4NCg0KRm9yIGRldGFpbGVkIGluZm9ybWF0aW9uIG9uIHN1Y2ggc3VydmV5IGRlc2lnbnMgaW4gZ2VuZXJhbCBzZWUgW2hlcmVdKGh0dHA6Ly93d3cuYXNhc3Jtcy5vcmcvUHJvY2VlZGluZ3MveTIwMDgvRmlsZXMvMzAxODM1LnBkZil7dGFyZ2V0PSJfYmxhbmsifSBhbmQgW2hlcmVdKGh0dHA6Ly9vY3cuamhzcGguZWR1L2NvdXJzZXMvU3RhdE1ldGhvZHNGb3JTYW1wbGVTdXJ2ZXlzL1BERnMvTGVjdHVyZTUucGRmKXt0YXJnZXQ9Il9ibGFuayJ9Lg0KDQpXZSB3aWxsIHVzZSB0aGUgYGFzX3N1cnZleV9kZXNpZ24oKWAgZnVuY3Rpb24gb2YgdGhlIGBzcnZ5cmBwYWNrYWdlIHRvIGNyZWF0ZSBhIHN1cnZleSBvYmplY3Qgd2l0aCBhIHNwZWNpZmllZCBzdXJ2ZXkgZGVzaWduLiBUaGlzIGlzIGEgc3BlY2lhbCBSIG9iamVjdCB0aGF0IGluY2x1ZGVzIGluZm9ybWF0aW9uIGFib3V0IGhvdyB0aGUgc3VydmV5IHdhcyBjb25kdWN0ZWQgdGhhdCBjYW4gYmUgdGFrZW4gaW50byBhY2NvdW50IGluIHRoZSBhbmFseXNpcy4NCg0KVGhlcmUgYXJlIHNldmVyYWwgYXJndW1lbnRzIHRvIHBheSBhdHRlbnRpb24gdG86DQoNCjEpIFRoZSBgc3RyYXRhYCBhcmd1bWVudCBpcyB1c2VkIHRvIHNwZWNpZnkgdGhlIHZhcmlhYmxlKHMpIHRoYXQgZGVmaW5lZCBzdHJhdGEgaW4gdGhlIGRhdGEuIEluIHRoaXMgY2FzZSwgd2Ugd2lsbCB1c2UgdGhlIGBzdHJhdHVtYCB2YXJpYWJsZS4NCjIpIFRoZSBgaWRzYCBhcmd1bWVudCBpcyB1c2VkIHRvIGRlZmluZSBjbHVzdGVyIGlkcyB3aXRoaW4gdGhlIGRhdGEuIEluIHRoaXMgY2FzZSB3ZSB3aWxsIHVzZSB0aGUgYHBzdWAgdmFyaWFibGUuDQozKSBUaGUgYHdlaWdodGAgYXJndW1lbnQgaXMgdGhlICB1c2VkIHRvIGRlZmluZSB3aGljaCB2YXJpYWJsZShzKSBhcmUgdGhlIHN1cnZleSB3ZWlnaHRzLg0KNCkgVGhlIGBuZXN0ID0gVFJVRWAgYXJndW1lbnQsIGZvcmNlcyBjbHVzdGVyIGlkcyAoaW4gdGhpcyBjYXNlIHRoZSBQU1UpIHRvIGJlIG5lc3RlZCB3aXRoaW4gdGhlIHN0cmF0YS4NCg0KV2UgY2FuIHRoZW4gdXNlIHRoZSBgc3VydmV5X21lYW4oKWAgZnVuY3Rpb24gdG8gY2FsY3VsYXRlIHBlcmNlbnRhZ2VzIG9mIHN0dWRlbnRzIHdobyByZXBvcnQgdXNpbmcgdG9iYWNjbyBmb3IgZWFjaCB5ZWFyIHdoaWxlIGFjY291bnRpbmcgZm9yIHRoZSBzdXJ2ZXkgZGVzaWduIGFuZCB3ZWlnaHRzLiBXZSB3aWxsIHNwZWNpZnkgdGhhdCB3ZSB3YW50IFtjb25maWRlbmNlIGludGVydmFsXShodHRwczovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9Db25maWRlbmNlX2ludGVydmFsKXt0YXJnZXQ9Il9ibGFuayJ9IGVzdGltYXRlcyBieSB1c2luZyB0aGUgYHZhcnR5cGUgPSAiY2kiYCBhcmd1bWVudC4gVGhlIGNvbmZpZGVuY2UgaW50ZXJ2YWxzIGluIG91ciBjYXNlIGdpdmUgYSByYW5nZSBvZiBwb3NzaWJsZSB2YWx1ZXMgZm9yIHRoZSB0cnVlIHBvcHVsYXRpb24gbWVhbiBiYXNlZCBvbiB0aGUgZGF0YSBvYnNlcnZlZCBpbiB0aGUgc3VydmV5LiBXZSB3aWxsIG11bHRpcGx5IHRoZXNlIHZhbHVlcyBieSAxMDAgdG8gZ2V0IHBlcmNlbnRhZ2VzLiAoTm90ZTogV2UgY291bGQgYWxzbyBoYXZlIGNhbGN1bGF0ZWQgY29uZmlkZW5jZSBpbnRlcnZhbHMgZm9yIHRoZSB1bndlaWdodGVkIHJlc3VsdHMgYWJvdmUgYnkgY29tcHV0aW5nIHRoZW0gYnkgaGFuZDsgd2UgbGVhdmUgdGhpcyBhcyBhIHBvdGVudGlhbCBleGVyY2lzZS4pDQoNClNpbmNlIHRoZSBzdXJ2ZXkgd2VpZ2h0cyBhcmUgc3BlY2lmaWMgdG8gYSBzaW5nbGUgeWVhciBvZiB0aGUgc3VydmV5IHJlc3VsdHMsIHdlIG5lZWQgdG8gY3JlYXRlIHN1cnZleSBkZXNpZ24gb2JqZWN0cyBmb3IgZWFjaCB5ZWFyIHNlcGFyYXRlbHkuIFdlIHdpbGwgdXNlIGBncm91cF9ieWAgYW5kIGBncm91cF9tb2RpZnlgLCB3aGljaCBpcyBhbHNvIGZyb20gdGhlIGBkcGx5cmAgcGFja2FnZSwgdG8gZG8gdGhpcy4gV2UgZmlyc3Qgd3JpdGUgdGhlIGZ1bmN0aW9uIHRoYXQgd2Ugd2FudCB0byBjYWxsIG9uIGVhY2ggZ3JvdXAuDQoNClRoaXMgZnVuY3Rpb24gdGFrZXMgYW4gaW5wdXQgY2FsbGVkIGBjdXJyWWVhcmAsIHdoaWNoIHdpbGwgYmUgb25lIHNldCBvZiBzdXJ2ZXkgcmVzcG9uc2VzIGZvciBhIHNwZWNpZmljIHllYXIsIGFuZCB0aGVuIGNyZWF0ZXMgYSBzdXJ2ZXkgZGVzaWduIGJhc2VkIG9uIHRoZSBgc3RyYXR1bWAgYW5kIGBmaW53Z3RgIHZhbHVlcyBzcGVjaWZpYyB0byB0aGF0IHllYXIuIEl0IHRoZW4gY2FsY3VsYXRlcyB0aGUgcGVyY2VudCBvZiBzdHVkZW50IHJlc3BvbmRlbnRzIHdobyBoYXZlIGV2ZXIgdHJpZWQgYW55IHRvYmFjY28gcHJvZHVjdHMgb3Igd2hvIGFyZSBhIGN1cnJlbnQgdXNlciBvZiBhbnkgdG9iYWNjbyBwcm9kdWN0cyBhY2NvdW50aW5nIGZvciB0aGUgc3VydmV5IGRlc2lnbiBhbmQgd2VpZ2h0cyB1c2luZyBgc3VydmV5X21lYW4oKWAgYXMgd2FzIGp1c3QgZGVzY3JpYmVkLiBUaGUgZnVuY3Rpb24gdGhlbiB3cmFuZ2xlcyB0aGUgZGF0YSB0byBjb252ZXJ0IHRoZSBtZWFucyB0byBwZXJjZW50YWdlcyBhbmQgcmVmb3JtYXQgdGhlIGRhdGEgaW4gbG9uZyBmb3JtIGZvciBwbG90dGluZy4NCg0KT25lIHRlY2huaWNhbCBub3RlOiBzaW5jZSBzb21lIHllYXJzIGhhdmUgc3RyYXRhIHdpdGggYSBzaW5nbGUgUFNVLCB3ZSBuZWVkIHRvIHRlbGwgdGhlIHN1cnZleSB3ZWlnaHRpbmcgcGFja2FnZSBob3cgdG8gaGFuZGxlIGVzdGltYXRpbmcgd2l0aGluIHN0cmF0YSB2YXJpYW5jZXMuIFRoZSBsaW5lIGBvcHRpb25zKHN1cnZleS5sb25lbHkucHN1ID0gImFkanVzdCIpYCB0ZWxscyBSIHRvIGNlbnRlciB0aGUgc3RyYXR1bSB3aXRoIHRoZSBzaW5nbGUgUFNVIG9uIHRoZSBzYW1wbGUgZ3JhbmQgbWVhbiwgYSBjb25zZXJ2YXRpdmUgYXBwcm9hY2ggdG8gc29sdmluZyB0aGUgcHJvYmxlbS4gU2VlIGZ1cnRoZXIgaW5mb3JtYXRpb24gW2hlcmVdKGh0dHBzOi8vci1zdXJ2ZXkuci1mb3JnZS5yLXByb2plY3Qub3JnL3N1cnZleS9leG1hbXBsZS1sb25lbHkuaHRtbCl7dGFyZ2V0PSJfYmxhbmsifSBhbmQgW2hlcmVdKGh0dHA6Ly9yLXN1cnZleS5yLWZvcmdlLnItcHJvamVjdC5vcmcvc3VydmV5L2h0bWwvc3VydmV5b3B0aW9ucy5odG1sKXt0YXJnZXQ9Il9ibGFuayJ9Lg0KDQojIyMgKipXZWlnaHRlZCBTYW1wbGUqKg0KKioqDQoNCkZpcnN0LCB3ZSBzaG93IHRoZSBiYXNpYyBvdXRwdXQgb2YgdGhlIGBzdXJ2ZXlfbWVhbmAgZnVuY3Rpb24gYnkgeWVhci4gU2luY2Ugd2UgaW5jbHVkZSB0aGUgYXJndW1lbnQgYHZhcnR5cGUgPSAiY2kiYCwgd2UgZ2V0IGEgbWVhbiBhbmQgdXBwZXIgYW5kIGxvd2VyIGNvbmZpZGVuY2UgaW50ZXJ2YWwgYm91bmRzIGZvciB0aGUgbWVhbi4NCg0KYGBge3J9DQpzdXJ2ZXlNZWFuQSA8LSBmdW5jdGlvbihjdXJyWWVhcikgew0KICBvcHRpb25zKHN1cnZleS5sb25lbHkucHN1ID0gImFkanVzdCIpDQogIGN1cnJZZWFyICU+JQ0KICBhc19zdXJ2ZXlfZGVzaWduKHN0cmF0YSA9IHN0cmF0dW0sDQogICAgICAgICAgICAgICAgICAgICAgaWRzID0gcHN1LA0KICAgICAgICAgICAgICAgICAgd2VpZ2h0ICA9IGZpbndndCwNCiAgICAgICAgICAgICAgICAgICAgIG5lc3QgPSBUUlVFKSAlPiUNCiAgIHN1bW1hcml6ZSh0b2JhY2NvX2V2ZXIgPSBzdXJ2ZXlfbWVhbih0b2JhY2NvX2V2ZXIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFydHlwZSA9ICJjaSIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmEucm0gPSBUUlVFKSwNCiAgICAgICAgICB0b2JhY2NvX2N1cnJlbnQgPSBzdXJ2ZXlfbWVhbih0b2JhY2NvX2N1cnJlbnQsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFydHlwZSA9ICJjaSIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmEucm0gPSBUUlVFKSkgfQ0KDQoNCm55dHNfZGF0YSAlPiUNCiAgZ3JvdXBfYnkoeWVhcikgJT4lDQogIGRwbHlyOjpncm91cF9tb2RpZnkofiBzdXJ2ZXlNZWFuQSgueCkpICU+JQ0KICBoZWFkKCkNCmBgYA0KDQpOb3cgbGV0J3MgbWFrZSB0aGUgZnVuY3Rpb24gd3JhbmdsZSB0aGUgb3V0cHV0IGluIGEgbW9yZSB1c2FibGUgZm9ybSB0b286DQpgYGB7cn0NCg0Kc3VydmV5TWVhbkEgPC0gZnVuY3Rpb24oY3VyclllYXIpIHsNCiAgb3B0aW9ucyhzdXJ2ZXkubG9uZWx5LnBzdSA9ICJhZGp1c3QiKQ0KICBjdXJyWWVhciAlPiUNCiAgYXNfc3VydmV5X2Rlc2lnbihzdHJhdGEgPSBzdHJhdHVtLA0KICAgICAgICAgICAgICAgICAgICAgIGlkcyA9IHBzdSwNCiAgICAgICAgICAgICAgICAgIHdlaWdodCAgPSBmaW53Z3QsDQogICAgICAgICAgICAgICAgICAgICBuZXN0ID0gVFJVRSkgJT4lDQogICBzdW1tYXJpemUodG9iYWNjb19ldmVyID0gc3VydmV5X21lYW4odG9iYWNjb19ldmVyLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhcnR5cGUgPSAiY2kiLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hLnJtID0gVFJVRSksDQogICAgICAgICAgdG9iYWNjb19jdXJyZW50ID0gc3VydmV5X21lYW4odG9iYWNjb19jdXJyZW50LA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhcnR5cGUgPSAiY2kiLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hLnJtID0gVFJVRSkpICAlPiUNCiAgbXV0YXRlX2FsbCgiKiIsIDEwMCkgJT4lDQogIHBpdm90X2xvbmdlcihldmVyeXRoaW5nKCksDQogICAgICAgICAgICAgICBuYW1lc190byA9ICJUeXBlIiwNCiAgICAgICAgICAgICAgIHZhbHVlc190byA9ICJQZXJjZW50YWdlIG9mIHN0dWRlbnRzIikgJT4lDQogIG11dGF0ZShFc3RpbWF0ZSA9IGNhc2Vfd2hlbihzdHJfZGV0ZWN0KFR5cGUsICJfbG93IikgfiAiTG93ZXIiLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RyX2RldGVjdChUeXBlLCAiX3VwcCIpIH4gIlVwcGVyIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgVFJVRSB+ICJNZWFuIiksDQogICAgICAgICBVc2VyID0gY2FzZV93aGVuKHN0cl9kZXRlY3QoVHlwZSwgImV2ZXIiKSB+ICJFdmVyIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgc3RyX2RldGVjdChUeXBlLCAiY3VycmVudCIpIH4gIkN1cnJlbnQiLA0KICAgICAgICAgICAgICAgICAgICAgICAgICBUUlVFIH4gIk1lYW4iKSl9DQoNCm55dHNfZGF0YSAlPiUNCiAgZ3JvdXBfYnkoeWVhcikgJT4lDQogIGdyb3VwX21vZGlmeSh+IHN1cnZleU1lYW5BKC54KSkNCmBgYA0KDQpXZSB3aWxsIG5vdyBtYWtlIGEgcGxvdCB1c2luZyB0aGlzIGRhdGEuIFRoZSBjb25maWRlbmNlIGludGVydmFscyBhcmUgaW5jbHVkZWQgdXNpbmcgdGhlIGBnZW9tX2xpbmVyYW5nZSgpYCBmdW5jdGlvbiBvZiB0aGUgYGdncGxvdDJgIHBhY2thZ2UuDQoNCmBgYHtyfQ0KcGxvdEFfdyA8LSBueXRzX2RhdGEgJT4lDQogIGdyb3VwX2J5KHllYXIpICU+JQ0KICBncm91cF9tb2RpZnkofiBzdXJ2ZXlNZWFuQSgueCkpICU+JQ0KICBkcGx5cjo6c2VsZWN0KC1UeXBlKSAlPiUNCiAgcGl2b3Rfd2lkZXIobmFtZXNfZnJvbSA9IEVzdGltYXRlLA0KICAgICAgICAgICAgIHZhbHVlc19mcm9tID0gYFBlcmNlbnRhZ2Ugb2Ygc3R1ZGVudHNgKSAlPiUNCiAgZ2dwbG90KGFlcyh4ID0geWVhciwgeSA9IE1lYW4pKSArDQogIGdlb21fbGluZShhZXMobGluZXR5cGUgPSBVc2VyKSkgKw0KICBnZW9tX2xpbmVyYW5nZShhZXMoeW1pbiA9IExvd2VyLA0KICAgICAgICAgICAgICAgICAgICAgeW1heCA9IFVwcGVyKSwgDQogICAgICAgICAgICAgICAgICAgICBzaXplID0gMSwgDQogICAgICAgICAgICAgIHNob3cubGVnZW5kID0gRkFMU0UpICsNCiAgc2NhbGVfbGluZXR5cGVfbWFudWFsKHZhbHVlcyA9IGMoMiwgMSkpICsNCiAgc2NhbGVfeV9jb250aW51b3VzKGJyZWFrcyA9IHNlcSgwLCA3MCwgYnkgPSAxMCksDQogICAgICAgICAgICAgICAgICAgICBsYWJlbHMgPSBzZXEoMCwgNzAsIGJ5ID0gMTApLA0KICAgICAgICAgICAgICAgICAgICAgbGltaXRzID0gYygwLCA3MCkpICsNCiAgICB0aGVtZV9saW5lZHJhdygpICsNCiAgICB0aGVtZShsZWdlbmQucG9zaXRpb24gPSAibm9uZSIsDQogICAgICAgICAgYXhpcy50aXRsZS54ID0gZWxlbWVudF9ibGFuaygpKSArDQogICAgbGFicyh0aXRsZSA9ICJUb2JhY2NvIHByb2R1Y3QgdXNlcnMgbW9yZSBwcmV2YWxlbnQgYWZ0ZXIgMjAxNyIsDQogICAgICAgICB5ID0gIiUgb2Ygc3R1ZGVudHMiKQ0KcGxvdEFfdw0KYGBgDQoNCk5vdyB3ZSBjYW4gc2VlIHRoYXQgd2UgaGF2ZSBjb25maWRlbmNlIGludGVydmFsIHJhbmdlcyBwbG90dGVkIGZvciBlYWNoIHZhbHVlLiANCg0KV2Ugd2lsbCBtYWtlIGEgc2ltaWxhciBwbG90IGZvciBzdHVkZW50cyB3aG8gcmVwb3J0ZWQgZXZlciB0cnlpbmcgb3Igd2hvIGN1cnJlbnRseSB1c2UgZS1jaWdhcmV0dGVzIGFzIG9wcG9zZWQgdG8gdG9iYWNjbyBpbiBnZW5lcmFsLg0KDQpgYGB7cn0NCnZfY29sb3JzID0gIHZpcmlkaXMoNilbYygxLCA0KV0NCg0Kc3VydmV5TWVhbkIgPC0gZnVuY3Rpb24oY3VyclllYXIpIHsNCiAgb3B0aW9ucyhzdXJ2ZXkubG9uZWx5LnBzdSA9ICJhZGp1c3QiKQ0KICBjdXJyWWVhciAlPiUNCiAgYXNfc3VydmV5X2Rlc2lnbihzdHJhdGEgPSBzdHJhdHVtLA0KICAgICAgICAgICAgICAgICAgICAgIGlkcyA9IHBzdSwNCiAgICAgICAgICAgICAgICAgIHdlaWdodCAgPSBmaW53Z3QsDQogICAgICAgICAgICAgICAgICAgICBuZXN0ID0gVFJVRSkgJT4lDQogIHN1bW1hcml6ZShlY2lnX2V2ZXJfeWVhciA9IHN1cnZleV9tZWFuKGVjaWdfZXZlciwgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhcnR5cGUgPSAiY2kiLCANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmEucm0gPSBUUlVFKSwNCiAgICAgICAgbm9uX2VjaWdfZXZlcl95ZWFyID0gc3VydmV5X21lYW4obm9uX2VjaWdfZXZlciwgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhcnR5cGUgPSAiY2kiLCANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmEucm0gPSBUUlVFKSkgJT4lDQogIG11dGF0ZV9hbGwoIioiLCAxMDApICU+JQ0KICBwaXZvdF9sb25nZXIoZXZlcnl0aGluZygpLA0KICAgICAgICAgICBuYW1lc190byA9ICJDYXRlZ29yeSIsDQogICAgICAgICAgdmFsdWVzX3RvID0gIlBlcmNlbnRhZ2Ugb2Ygc3R1ZGVudHMiKSAlPiUNCiAgbXV0YXRlKEVzdGltYXRlID0gY2FzZV93aGVuKHN0cl9kZXRlY3QoQ2F0ZWdvcnksICJfbG93IikgfiAiTG93ZXIiLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RyX2RldGVjdChDYXRlZ29yeSwgIl91cHAiKSB+ICJVcHBlciIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBUUlVFIH4gIk1lYW4iKSwNCiAgICAgICAgICAgICBVc2VyID0gY2FzZV93aGVuKHN0cl9kZXRlY3QoQ2F0ZWdvcnksICJldmVyIikgfiAiRXZlciIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJfZGV0ZWN0KENhdGVnb3J5LCAiY3VycmVudCIpIH4gIkN1cnJlbnQiKSwNCiAgICAgIFByb2R1Y3QgPSBjYXNlX3doZW4oc3RyX2RldGVjdChDYXRlZ29yeSwgIm5vbl9lY2lnIikgfiAiT3RoZXIgcHJvZHVjdHMiLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVFJVRSB+ICJFLWNpZ2FyZXR0ZXMiKSkgJT4lDQogIGRwbHlyOjpzZWxlY3QoLUNhdGVnb3J5KSAlPiUNCiAgcGl2b3Rfd2lkZXIobmFtZXNfZnJvbSA9IEVzdGltYXRlLA0KICAgICAgICAgICAgICB2YWx1ZXNfZnJvbSA9IGBQZXJjZW50YWdlIG9mIHN0dWRlbnRzYCl9DQoNCm55dHNfZGF0YSAlPiUNCiAgZ3JvdXBfYnkoeWVhcikgJT4lDQogIGdyb3VwX21vZGlmeSggfiBzdXJ2ZXlNZWFuQigueCkpICU+JQ0KICBoZWFkKCkNCg0KDQpwbG90Ql93IDwtIG55dHNfZGF0YSAlPiUNCiAgZ3JvdXBfYnkoeWVhcikgJT4lDQogIGdyb3VwX21vZGlmeSggfiBzdXJ2ZXlNZWFuQigueCkpICU+JQ0KICBnZ3Bsb3QoYWVzKHggPSB5ZWFyLCB5ID0gTWVhbiwgY29sb3IgPSBQcm9kdWN0KSkgKw0KICBnZW9tX2xpbmUoKSArDQogIGdlb21fbGluZXJhbmdlKGFlcyh5bWluID0gTG93ZXIsIHltYXggPSBVcHBlciksDQogICAgICAgICAgICAgICAgIHNpemUgPSAxLA0KICAgICAgICAgICAgICAgICBzaG93LmxlZ2VuZCA9IEZBTFNFKSArDQogIHNjYWxlX2xpbmV0eXBlX21hbnVhbCh2YWx1ZXMgPSBjKDIsIDEpKSArDQogIHNjYWxlX2NvbG9yX21hbnVhbCh2YWx1ZXMgPSB2X2NvbG9ycykgKw0KICBzY2FsZV95X2NvbnRpbnVvdXMoDQogICAgYnJlYWtzID0gc2VxKDAsIDYwLCBieSA9IDEwKSwNCiAgICBsYWJlbHMgPSBzZXEoMCwgNjAsIGJ5ID0gMTApLA0KICAgIGxpbWl0cyA9IGMoMCwgNjApDQogICkgKw0KICB0aGVtZV9saW5lZHJhdygpICsNCiAgdGhlbWUobGVnZW5kLnBvc2l0aW9uID0gIm5vbmUiLA0KICAgICAgICBheGlzLnRpdGxlLnggPSBlbGVtZW50X2JsYW5rKCkpICsNCiAgbGFicyh0aXRsZSA9ICIlIEV2ZXIgdHJ5aW5nIGUtY2lnYXJldHRlcyBpbmNyZWFzZXMgJg0KJSBFdmVyIHRyeWluZyBvdGhlciBwcm9kdWN0cyBkZWNyZWFzZXMiLA0KICAgICAgIHkgPSAiJSBvZiBzdHVkZW50cyIpDQoNCnBsb3RCX3cNCmBgYA0KDQoNCk5vdyB3ZSB3aWxsIGRvIHRoZSBzYW1lIGJ1dCBmb3IgY3VycmVudCB1c2VyczoNCg0KYGBge3J9DQpzdXJ2ZXlNZWFuQyA8LSBmdW5jdGlvbihjdXJyWWVhcikgew0KICBvcHRpb25zKHN1cnZleS5sb25lbHkucHN1ID0gImFkanVzdCIpDQogIGN1cnJZZWFyICU+JQ0KICBhc19zdXJ2ZXlfZGVzaWduKHN0cmF0YSA9IHN0cmF0dW0sDQogICAgICAgICAgICAgICAgICAgICAgaWRzID0gcHN1LA0KICAgICAgICAgICAgICAgICAgd2VpZ2h0ICA9IGZpbndndCwNCiAgICAgICAgICAgICAgICAgICAgIG5lc3QgPSBUUlVFKSAlPiUNCiAgc3VtbWFyaXplKGVjaWdfY3VycmVudF95ZWFyID0gc3VydmV5X21lYW4oZWNpZ19jdXJyZW50LCANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFydHlwZSA9ICJjaSIsIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYS5ybSA9IFRSVUUpLA0KICAgICAgICBub25fZWNpZ19jdXJyZW50X3llYXIgPSBzdXJ2ZXlfbWVhbihub25fZWNpZ19jdXJyZW50LCANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFydHlwZSA9ICJjaSIsIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYS5ybSA9IFRSVUUpKSAlPiUNCiAgbXV0YXRlX2FsbCgiKiIsIDEwMCkgJT4lDQogIHBpdm90X2xvbmdlcihldmVyeXRoaW5nKCksDQogICAgICAgICAgIG5hbWVzX3RvID0gIkNhdGVnb3J5IiwNCiAgICAgICAgICB2YWx1ZXNfdG8gPSAiUGVyY2VudGFnZSBvZiBzdHVkZW50cyIpICU+JQ0KICBtdXRhdGUoRXN0aW1hdGUgPSBjYXNlX3doZW4oc3RyX2RldGVjdChDYXRlZ29yeSwgIl9sb3ciKSB+ICJMb3dlciIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJfZGV0ZWN0KENhdGVnb3J5LCAiX3VwcCIpIH4gIlVwcGVyIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFRSVUUgfiAiTWVhbiIpLA0KICAgICAgICAgICAgIFVzZXIgPSBjYXNlX3doZW4oc3RyX2RldGVjdChDYXRlZ29yeSwgImV2ZXIiKSB+ICJFdmVyIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cl9kZXRlY3QoQ2F0ZWdvcnksICJjdXJyZW50IikgfiAiQ3VycmVudCIpLA0KICAgICAgUHJvZHVjdCA9IGNhc2Vfd2hlbihzdHJfZGV0ZWN0KENhdGVnb3J5LCAibm9uX2VjaWciKSB+ICJPdGhlciBwcm9kdWN0cyIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBUUlVFIH4gIkUtY2lnYXJldHRlcyIpKSAlPiUNCiAgZHBseXI6OnNlbGVjdCgtQ2F0ZWdvcnkpICU+JQ0KICBwaXZvdF93aWRlcihuYW1lc19mcm9tID0gRXN0aW1hdGUsDQogICAgICAgICAgICAgIHZhbHVlc19mcm9tID0gYFBlcmNlbnRhZ2Ugb2Ygc3R1ZGVudHNgKX0NCg0KDQpwbG90Q193IDwtIG55dHNfZGF0YSAlPiUNCiAgZ3JvdXBfYnkoeWVhcikgJT4lDQogIGdyb3VwX21vZGlmeSggfiBzdXJ2ZXlNZWFuQygueCkpICU+JQ0KICBnZ3Bsb3QoYWVzKHggPSB5ZWFyLCB5ID0gTWVhbiwgY29sb3IgPSBQcm9kdWN0KSkgKw0KICBnZW9tX2xpbmUoYWVzKGxpbmV0eXBlID0gImRhc2hlZCIpKSArDQogIGdlb21fbGluZXJhbmdlKGFlcyh5bWluID0gTG93ZXIsIHltYXggPSBVcHBlciksDQogICAgICAgICAgICAgICAgIHNpemUgPSAxLA0KICAgICAgICAgICAgICAgICBzaG93LmxlZ2VuZCA9IEZBTFNFKSArDQogIHNjYWxlX2xpbmV0eXBlX21hbnVhbCh2YWx1ZXMgPSBjKDIsIDEpKSArDQogIHNjYWxlX3lfY29udGludW91cyhicmVha3MgPSBzZXEoMCwgNjAsIGJ5ID0gMTApLCBsaW1pdHMgPSBjKDAsIDYwKSkgKw0KICBzY2FsZV9jb2xvcl9tYW51YWwodmFsdWVzID0gdl9jb2xvcnMpICsNCiAgdGhlbWVfbGluZWRyYXcoKSArDQogIHRoZW1lKGxlZ2VuZC5wb3NpdGlvbiA9ICJub25lIiwNCiAgICAgICAgYXhpcy50aXRsZS54ID0gZWxlbWVudF9ibGFuaygpKSArDQogIGxhYnModGl0bGUgPSAiJSBDdXJyZW50bHkgdXNpbmcgZS1jaWdhcmV0dGVzIGluY3JlYXNlcyAmDQolIEN1cnJlbnRseSB1c2luZyBvdGhlciBwcm9kdWN0cyBkZWNyZWFzZXMiLA0KICAgICAgICB5ID0gIiUgb2Ygc3R1ZGVudHMiKQ0KcGxvdENfdw0KYGBgDQoNCmBgYHtyLCBlY2hvID0gRkFMU0V9DQojY29kZSB0byBjcmVhdGUgcHJvcGVyIGxlZ2VuZCBmb3IgaW5zdHJ1Y3RvcnMgc3RhcnRpbmcgYXQgc3VydmV5IHdlaWdodGluZyBzZWN0aW9uDQoNCnBsb3QxYyA8LSBueXRzX2RhdGEgJT4lDQogICAgZHBseXI6Omdyb3VwX2J5KHllYXIpICU+JQ0KICAgIGRwbHlyOjpzdW1tYXJpemUoIkV2ZXJfRS1jaWdhcmV0dGUiID0gDQogICAgICAgICAgICAgICAgICAgICAgIChtZWFuKGVjaWdfb25seV9ldmVyLCBuYS5ybSA9IFRSVUUpICogMTAwKSwNCiAgICAgICAgICAgICAgICAgICAgICJDdXJyZW50X0UtY2lnYXJldHRlIiA9IA0KICAgICAgICAgICAgICAgICAgICAgICAobWVhbihlY2lnX29ubHlfY3VycmVudCwgbmEucm0gPSBUUlVFKSAqIDEwMCksDQogICAgICAgICAgICAgICAgICAgICAiRXZlcl9Ob24tZS1jaWdhcmV0dGUiID0gDQogICAgICAgICAgICAgICAgICAgICAgIChtZWFuKG5vbl9lY2lnX29ubHlfZXZlciwgbmEucm0gPSBUUlVFKSAqIDEwMCksDQogICAgICAgICAgICAgICAgICAgICAiQ3VycmVudF9Ob24tZS1jaWdhcmV0dGUiID0gDQogICAgICAgICAgICAgICAgICAgICAgIChtZWFuKG5vbl9lY2lnX29ubHlfY3VycmVudCwgbmEucm0gPSBUUlVFKSAqIDEwMCkpICU+JQ0KICBwaXZvdF9sb25nZXIoY29scyA9IC0geWVhciwNCiAgICAgICAgICAgICAgIG5hbWVzX3RvID0gIlVzZXIiLA0KICAgICAgICAgICAgICAgdmFsdWVzX3RvID0gIlBlcmNlbnRhZ2Ugb2Ygc3R1ZGVudHMiKSAlPiUNCiAgc2VwYXJhdGUoVXNlciwgaW50byA9IGMoIlVzZXIiLCAiUHJvZHVjdCIpLCBzZXAgPSAiXyIpICU+JQ0KICBnZ3Bsb3QoYWVzKHggPSB5ZWFyLA0KICAgICAgICAgICAgIHkgPSBgUGVyY2VudGFnZSBvZiBzdHVkZW50c2AsDQogICAgICAgICAgICAgY29sb3IgPSBQcm9kdWN0KSkgKw0KICBnZW9tX2xpbmUoYWVzKGxpbmV0eXBlID0gVXNlcikpICsNCiAgZ2VvbV9wb2ludChzaG93LmxlZ2VuZCA9IEZBTFNFLCBzaXplID0gMikgKw0KICAjIHRoaXMgYWxsb3dzIHVzIHRvIGNob29zZSB3aGF0IHR5cGUgb2YgbGluZSB3ZSB3YW50IGZvciBlYWNoIGxpbmUNCiAgc2NhbGVfbGluZXR5cGVfbWFudWFsKHZhbHVlcyA9IGMoMiwgMSkpICsNCiAgIyB0aGlzIGFsbG93cyB1cyB0byBzcGVjaWZ5IGhvdyB0aGUgeS1heGlzIHNob3VsZCBhcHBlYXINCiAgc2NhbGVfeV9jb250aW51b3VzKGJyZWFrcyA9IHNlcSgwLCAzMCwgYnkgPSAxMCksDQogICAgICAgICAgICAgICAgICAgICAgICBsYWJlbHMgPSBzZXEoMCwgMzAsIGJ5ID0gMTApLA0KICAgICAgICAgICAgICAgICAgICAgICAgbGltaXRzID0gYygwLCAzMCkpICsNCiAgc2NhbGVfY29sb3JfbWFudWFsKHZhbHVlcyA9IHZfY29sb3JzKSArDQogICMgdGhpcyBhZGp1c3RzIHRoZSBiYWNrZ3JvdW5kIHN0eWxlIG9mIHRoZSBwbG90DQogIHRoZW1lX2xpbmVkcmF3KCkgKw0KICAjIHRoaXMgbW92ZXMgdGhlIGxlZ2VuZCB0byB0aGUgYm90dG9tIG9mIHRoZSBwbG90IGFuZCByZW1vdmVzIHRoZSB4IGF4aXMgdGl0bGUNCiAgdGhlbWUobGVnZW5kLnBvc2l0aW9uID0gImJvdHRvbSIsDQogICAgICAgIGF4aXMudGl0bGUueCA9IGVsZW1lbnRfYmxhbmsoKSkgKw0KICBsYWJzKHRpdGxlID0gIkhvdyBoYXMgdXNlIG9mIG9ubHkgZS1jaWdhcmV0dGVzIGFuZA0Kb25seSB0b2JhY2NvIHByb2R1Y3RzIGJlc2lkZXMgZS1jaWdhcmV0dGVzIHZhcmllZCBvdmVyIHRpbWU/IiwNCiAgICAgICB5ID0gIiUgb2Ygc3R1ZGVudHMiKQ0KDQpgYGANCg0KDQoNCg0KTm93IHdlIHdpbGwgcHV0IHRoZXNlIHBsb3RzIHRvZ2V0aGVyIGFnYWluIHVzaW5nIHRoZSBgY293cGxvdGAgcGFja2FnZToNCg0KYGBge3J9DQp0aXRsZV93IDwtIGdnZHJhdygpICsNCiAgZHJhd19sYWJlbCgNCiAgICBleHByZXNzaW9uKCJXaGF0IGlzIHRoZSByZWxhdGlvbnNoaXAgYmV0d2VlbiBlLWNpZ2FyZXR0ZSB1c2UgYW5kIHRvYmFjY28gdXNlPyIpLA0KICAgIGZvbnRmYWNlID0gJ2JvbGQnLA0KICAgIHNpemUgPSAxNCwNCiAgICB4ID0gMCwNCiAgICBoanVzdCA9IDANCiAgKSArDQogIHRoZW1lKA0KICAgIHBsb3QubWFyZ2luID0gbWFyZ2luKDAsIDAsIDAsIDApDQogICkNCg0KcGxvdHNBX3cgPC0gcGxvdF9ncmlkKHBsb3RBX3csDQogICAgICAgICAgICAgICAgICAgICByZWxfd2lkdGhzID0gYygxKSwNCiAgICAgICAgICAgICAgICAgICAgIGFsaWduID0gInYiLA0KICAgICAgICAgICAgICAgICAgICAgYXhpcyA9ICJidCIpDQpwbG90c0JDX3cgPC0gcGxvdF9ncmlkKHBsb3RCX3csDQogICAgICAgICAgICAgICAgICAgICBwbG90Q193LA0KICAgICAgICAgICAgICAgICAgICAgcmVsX3dpZHRocyA9IGMoMSwgMSksDQogICAgICAgICAgICAgICAgICAgICBhbGlnbiA9ICJ2IiwNCiAgICAgICAgICAgICAgICAgICAgIGF4aXMgPSAiYnQiKQ0KDQpsZWdlbmRfdyA8LSBnZXRfbGVnZW5kKHBsb3QxYyArDQogICAgICAgICAgICAgICAgICAgICAgIHRoZW1lKGxlZ2VuZC5wb3NpdGlvbiA9ICJib3R0b20iLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZWdlbmQuZGlyZWN0aW9uID0gImhvcml6b250YWwiKSkNCg0KZmlndXJlX3cgPC0gcGxvdF9ncmlkKHRpdGxlX3csDQogICAgICAgICAgICAgICAgICAgICAgcGxvdHNBX3csDQogICAgICAgICAgICAgICAgICAgICAgcGxvdHNCQ193LA0KICAgICAgICAgICAgICAgICAgICAgIGxlZ2VuZF93LA0KICAgICAgICAgICAgICAgICAgICAgIG5jb2wgPSAxLA0KICAgICAgICAgICAgICAgICAgICAgIHJlbF9oZWlnaHRzID0gYygwLjEsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDEsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDEsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDAuMSksDQogICAgICAgICAgICAgICAgICAgICAgc2NhbGUgPSAxLjApDQoNCmZpZ3VyZV93DQpgYGANCg0KV2UgY2FuIHNlZSB0aGF0IHRoZXNlIGZpZ3VyZXMgbG9vayBxdWl0ZSBzaW1pbGFyIHRvIHRoZSBvbmVzIGdlbmVyYXRlZCB3aXRob3V0IHVzaW5nIHRoZSBzdXJ2ZXkgd2VpZ2h0cy4NCg0KIyMjICoqQXJ0aWZpY2lhbCBDb2hvcnQqKg0KKioqDQoNCkFsdGhvdWdoIHRoZSBzdXJ2ZXkgZGVzaWduIGRvZXMgbm90IGFsbG93IHNwZWNpZmljIGluZGl2aWR1YWxzIHRvIGJlIGZvbGxvd2VkIG92ZXIgdGltZSwgd2Ugd2lsbCB1c2UgY2VydGFpbiBzdWJzZXRzIG9mIHRoZSBkYXRhIGZyb20gZWFjaCB5ZWFyIHRvIGNvbnN0cnVjdCBhbiBhcnRpZmljaWFsIGNvaG9ydCB3aGVyZSB3ZSBmb2xsb3cgc3R1ZGVudHMgb2YgdGhlIHNhbWUgYWdlIGdyb3VwIGFzIHRoZXkgZ2V0IG9sZGVyLiBUaGlzIHdpbGwgYWxsb3cgdXMgdG8gbG9vayBhdCBob3cgdG9iYWNjbyB1c2FnZSBjaGFuZ2VkIGZvciBzdHVkZW50cyB3aG8gd2VyZSBpbiA4dGggZ3JhZGUgaW4gMjAxNSBhcyB0aGV5IGFnZWQuIA0KDQpBbGwgb2YgdGhlIGRhdGEgc28gZmFyIGhhcyBpbmNsdWRlZCBhbGwgNnRoLTEydGggZ3JhZGVycyBldmVyeSB5ZWFyLiBOb3cgd2Ugd2lsbCBsb29rIGF0IGp1c3QgdGhlIGRhdGEgZm9yIHN0dWRlbnRzIGV4cGVjdGVkIHRvIGdyYWR1YXRlIGluIDIwMTkuIFRoZXNlIGFyZSB0aGUgc3R1ZGVudHMgd2hvIHdlcmUgaW4gOHRoIGdyYWRlIGluIDIwMTUsIG1vc3Qgb2Ygd2hvbSB3ZXJlIDl0aCBncmFkZXJzIGluIDIwMTYsIDEwdGggZ3JhZGVycyBpbiAyMDE3IGFuZCBzbyBvbi4gV2Ugd2lsbCBmaWx0ZXIgdGhlIGRhdGEgdG8ganVzdCB0aGUgc3R1ZGVudHMgZXhwZWN0ZWQgdG8gYmUgaW4gdGhlIGdyYWR1YXRpbmcgY2xhc3Mgb2YgMjAxOS4NCg0KDQpgYGB7cn0NCg0Kc3VydmV5TWVhbkNvaG9ydCA8LSBmdW5jdGlvbihjdXJyWWVhcikgew0KICBvcHRpb25zKHN1cnZleS5sb25lbHkucHN1ID0gImFkanVzdCIpDQogIGN1cnJZZWFyICU+JQ0KICBhc19zdXJ2ZXlfZGVzaWduKHN0cmF0YSA9IHN0cmF0dW0sDQogICAgICAgICAgICAgICAgICAgICAgaWRzID0gcHN1LA0KICAgICAgICAgICAgICAgICAgd2VpZ2h0ICA9IGZpbndndCwNCiAgICAgICAgICAgICAgICAgICAgIG5lc3QgPSBUUlVFKSAlPiUNCiAgc3VtbWFyaXplKGVjaWdfZXZlcl95ZWFyID0gDQogICAgICAgICAgICAgIHN1cnZleV9tZWFuKGVjaWdfZXZlciwgdmFydHlwZSA9ICJjaSIsIG5hLnJtID0gVFJVRSksDQogICAgICAgICAgICBlY2lnX2N1cnJlbnRfeWVhciA9IA0KICAgICAgICAgICAgICBzdXJ2ZXlfbWVhbihlY2lnX2N1cnJlbnQsIHZhcnR5cGUgPSAiY2kiLCBuYS5ybSA9IFRSVUUpLA0KICAgICAgICAgICAgbm9uX2VjaWdfZXZlcl95ZWFyID0gDQogICAgICAgICAgICAgIHN1cnZleV9tZWFuKG5vbl9lY2lnX2V2ZXIsIHZhcnR5cGUgPSAiY2kiLCBuYS5ybSA9IFRSVUUpLA0KICAgICAgICAgICAgbm9uX2VjaWdfY3VycmVudF95ZWFyID0gDQogICAgICAgICAgICAgIHN1cnZleV9tZWFuKG5vbl9lY2lnX2N1cnJlbnQsIHZhcnR5cGUgPSAiY2kiLCBuYS5ybSA9IFRSVUUpLA0KICAgICAgICAgICAgdG9iYWNjb19ldmVyX3llYXIgPSANCiAgICAgICAgICAgICAgc3VydmV5X21lYW4odG9iYWNjb19ldmVyLCB2YXJ0eXBlID0gImNpIiwgbmEucm0gPSBUUlVFKSwNCiAgICAgICAgICAgIHRvYmFjY29fY3VycmVudF95ZWFyID0gDQogICAgICAgICAgICAgIHN1cnZleV9tZWFuKHRvYmFjY29fY3VycmVudCwgdmFydHlwZSA9ICJjaSIsIG5hLnJtID0gVFJVRSkpICU+JQ0KICBtdXRhdGVfYWxsKCIqIiwgMTAwKSAlPiUNCiAgcGl2b3RfbG9uZ2VyKGV2ZXJ5dGhpbmcoKSwNCiAgICAgICAgICAgICAgIG5hbWVzX3RvID0gIkNhdGVnb3J5IiwNCiAgICAgICAgICAgICAgIHZhbHVlc190byA9ICJQZXJjZW50YWdlIG9mIHN0dWRlbnRzIikgJT4lDQogIG11dGF0ZShFc3RpbWF0ZSA9IGNhc2Vfd2hlbihzdHJfZGV0ZWN0KENhdGVnb3J5LCAiX2xvdyIpIH4gIkxvd2VyIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cl9kZXRlY3QoQ2F0ZWdvcnksICJfdXBwIikgfiAiVXBwZXIiLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVFJVRSB+ICJNZWFuIiksDQogICAgICAgICAgICAgVXNlciA9IGNhc2Vfd2hlbihzdHJfZGV0ZWN0KENhdGVnb3J5LCAiZXZlciIpIH4gIkV2ZXIiLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RyX2RldGVjdChDYXRlZ29yeSwgImN1cnJlbnQiKSB+ICJDdXJyZW50IiksDQogICAgICBQcm9kdWN0ID0gY2FzZV93aGVuKHN0cl9kZXRlY3QoQ2F0ZWdvcnksICJub25fZWNpZyIpIH4gIk90aGVyIHByb2R1Y3RzIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cl9kZXRlY3QoQ2F0ZWdvcnksICJ0b2JhY2NvIikgfiAiQW55IHRvYmFjY28gcHJvZHVjdCIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBUUlVFIH4gIkUtY2lnYXJldHRlcyIpKSAlPiUNCiAgZHBseXI6OnNlbGVjdCgtQ2F0ZWdvcnkpICU+JQ0KICBwaXZvdF93aWRlcihuYW1lc19mcm9tID0gRXN0aW1hdGUsDQogICAgICAgICAgICAgIHZhbHVlc19mcm9tID0gYFBlcmNlbnRhZ2Ugb2Ygc3R1ZGVudHNgKX0NCg0KDQpDb2hvcnRfZGF0YSA8LSBueXRzX2RhdGEgJT4lDQogIGZpbHRlcigoR3JhZGUgPT0gIjgiICYgeWVhciA9PSAyMDE1KSB8DQogICAgICAgICAoR3JhZGUgPT0gIjkiICYgeWVhciA9PSAyMDE2KSB8DQogICAgICAgICAoR3JhZGUgPT0gIjEwIiAmIHllYXIgPT0gMjAxNykgfA0KICAgICAgICAgKEdyYWRlID09ICIxMSIgJiB5ZWFyID09IDIwMTgpIHwNCiAgICAgICAgIChHcmFkZSA9PSAiMTIiICYgeWVhciA9PSAyMDE5KQ0KICAgICAgICAgKSAlPiUNCiAgZ3JvdXBfYnkoeWVhcikgJT4lDQogIGdyb3VwX21vZGlmeSh+IHN1cnZleU1lYW5Db2hvcnQoLngpKQ0KDQpoZWFkKENvaG9ydF9kYXRhKQ0KYGBgDQoNCldlIHdpbGwgbm93IG1ha2Ugc2ltaWxhciBwbG90cyB0byB0aG9zZSBhYm92ZSBmb3IgdGhpcyBzdWJzZXQgb2YgdGhlIGRhdGE6DQoNCmBgYHtyfQ0KcGxvdEFfd184IDwtIENvaG9ydF9kYXRhICU+JQ0KICBmaWx0ZXIoUHJvZHVjdCA9PSAiQW55IHRvYmFjY28gcHJvZHVjdCIpICU+JQ0KICBnZ3Bsb3QoYWVzKHggPSB5ZWFyLCB5ID0gTWVhbikpICsNCiAgZ2VvbV9saW5lKGFlcyhsaW5ldHlwZSA9IFVzZXIpKSArDQogIGdlb21fbGluZXJhbmdlKGFlcyh5bWluID0gTG93ZXIsIHltYXggPSBVcHBlciksIHNpemUgPSAxKSArDQogIHNjYWxlX2xpbmV0eXBlX21hbnVhbCh2YWx1ZXMgPSBjKDIsIDEpKSArDQogIHNjYWxlX3lfY29udGludW91cyhicmVha3MgPSBzZXEoMCwgNzAsIGJ5ID0gMTApLA0KICAgICAgICAgICAgICAgICAgICAgbGFiZWxzID0gc2VxKDAsIDcwLCBieSA9IDEwKSwNCiAgICAgICAgICAgICAgICAgICAgIGxpbWl0cyA9IGMoMCwgNzApKSArDQogIHNjYWxlX2NvbG9yX21hbnVhbCh2YWx1ZXMgPSB2X2NvbG9ycykgKw0KICB0aGVtZV9saW5lZHJhdygpICsNCiAgdGhlbWUobGVnZW5kLnBvc2l0aW9uID0gIm5vbmUiLA0KICAgICAgICBheGlzLnRpdGxlLnggPSBlbGVtZW50X2JsYW5rKCkpICsNCiAgbGFicyh0aXRsZSA9ICJUb2JhY2NvIHByb2R1Y3QgdXNlIGJlY2FtZSBpbmNyZWFzaW5nbHkgcHJldmFsZW50IiwNCiAgICAgICB5ID0gIiUgb2Ygc3R1ZGVudHMiKQ0KDQpwbG90Ql93XzggPC0gQ29ob3J0X2RhdGEgJT4lDQogIGZpbHRlcihQcm9kdWN0ICE9ICJBbnkgdG9iYWNjbyBwcm9kdWN0IiwgVXNlciA9PSAiRXZlciIpICU+JQ0KICBnZ3Bsb3QoYWVzKHggPSB5ZWFyLCB5ID0gTWVhbiwgY29sb3IgPSBQcm9kdWN0KSkgKw0KICBnZW9tX2xpbmUobGluZXR5cGUgPSAxKSArDQogIGdlb21fbGluZXJhbmdlKGFlcyh5bWluID0gTG93ZXIsIHltYXggPSBVcHBlciksIHNpemUgPSAxKSArDQogIHNjYWxlX3lfY29udGludW91cyhicmVha3MgPSBzZXEoMTAsIDYwLCBieSA9IDEwKSwgbGltaXRzID0gYygxMCwgNjApKSArDQogIHNjYWxlX2NvbG9yX21hbnVhbCh2YWx1ZXMgPSB2X2NvbG9ycykgKw0KICB0aGVtZV9saW5lZHJhdygpICsNCiAgdGhlbWUobGVnZW5kLnBvc2l0aW9uID0gIm5vbmUiLA0KICAgICAgICBheGlzLnRpdGxlLnggPSBlbGVtZW50X2JsYW5rKCkpICsNCiAgbGFicyh0aXRsZSA9ICIlIGV2ZXIgdHJ5aW5nIHRvYmFjY28gcHJvZHVjdHMgaW5jcmVhc2VzIiwNCiAgICAgICB5ID0gIiUgb2Ygc3R1ZGVudHMiKQ0KDQpwbG90Q193XzggPC0gQ29ob3J0X2RhdGEgJT4lDQogIGZpbHRlcihQcm9kdWN0ICE9ICJBbnkgdG9iYWNjbyBwcm9kdWN0IiwgVXNlciA9PSAiQ3VycmVudCIpICU+JQ0KICBnZ3Bsb3QoYWVzKHggPSB5ZWFyLCB5ID0gTWVhbiwgY29sb3IgPSBQcm9kdWN0KSkgKw0KICBnZW9tX2xpbmUoYWVzKGxpbmV0eXBlID0gVXNlcikpICsNCiAgZ2VvbV9saW5lcmFuZ2UoYWVzKHltaW4gPSBMb3dlciwgeW1heCA9IFVwcGVyKSwgc2l6ZSA9IDEpICsNCiAgc2NhbGVfbGluZXR5cGVfbWFudWFsKHZhbHVlcyA9IGMoMiwgMSkpICsNCiAgc2NhbGVfeV9jb250aW51b3VzKGJyZWFrcyA9IHNlcSgwLCA2MCwgYnkgPSAxMCksIGxpbWl0cyA9IGMoMCwgNjApKSArDQogIHNjYWxlX2NvbG9yX21hbnVhbCh2YWx1ZXMgPSB2X2NvbG9ycykgKw0KICB0aGVtZV9saW5lZHJhdygpICsNCiAgdGhlbWUobGVnZW5kLnBvc2l0aW9uID0gIm5vbmUiLA0KICAgICAgICBheGlzLnRpdGxlLnggPSBlbGVtZW50X2JsYW5rKCkpICsNCiAgbGFicyh0aXRsZSA9ICJFLWNpZ2FyZXR0ZSB1c2Ugc3VycGFzc2VzIHVzZSBvZiBvdGhlciBwcm9kdWN0cyIsDQogICAgICAgeSA9ICIlIG9mIHN0dWRlbnRzIikNCg0KdGl0bGVfd184IDwtIGdnZHJhdygpICsNCiAgZHJhd19sYWJlbCgNCiAgZXhwcmVzc2lvbigiRm9yIHN0dWRlbnRzIGluIHRoZSAyMDE5IGdyYWR1YXRpbmcgY2xhc3MsIGhvdyBhcmUgdmFwaW5nIGFuZCB0b2JhY2NvIHVzZSByZWxhdGVkPyIpLA0KICAgIGZvbnRmYWNlID0gJ2JvbGQnLA0KICAgIHNpemUgPSAxNCwNCiAgICB4ID0gMCwNCiAgICBoanVzdCA9IDANCiAgKSArDQogIHRoZW1lKA0KICAgIHBsb3QubWFyZ2luID0gbWFyZ2luKDAsIDAsIDAsIDApDQogICkNCg0KcGxvdHNBX3dfOCA8LSBwbG90X2dyaWQocGxvdEFfd184LA0KICAgICAgICAgICAgICAgICAgICAgICAgcmVsX3dpZHRocyA9IGMoMSksDQogICAgICAgICAgICAgICAgICAgICAgICBhbGlnbiA9ICJ2IiwNCiAgICAgICAgICAgICAgICAgICAgICAgIGF4aXMgPSAiYnQiKQ0KDQpwbG90c0JDX3dfOCA8LSBwbG90X2dyaWQocGxvdEJfd184LA0KICAgICAgICAgICAgICAgICAgICAgICAgIHBsb3RDX3dfOCwNCiAgICAgICAgICAgICAgICAgICAgICAgICByZWxfd2lkdGhzID0gYygxLCAxKSwNCiAgICAgICAgICAgICAgICAgICAgICAgICBheGlzID0gImJ0IikNCg0KbGVnZW5kX3dfOCA8LSBnZXRfbGVnZW5kKHBsb3QxYyArDQogICAgICAgICAgICAgICAgICAgICAgIHRoZW1lKGxlZ2VuZC5wb3NpdGlvbiA9ICJib3R0b20iLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZWdlbmQuZGlyZWN0aW9uID0gImhvcml6b250YWwiKSkNCg0KZmlndXJlX3dfOCA8LSBwbG90X2dyaWQodGl0bGVfd184LA0KICAgICAgICAgICAgICAgICAgICAgICAgcGxvdHNBX3dfOCwNCiAgICAgICAgICAgICAgICAgICAgICAgIHBsb3RzQkNfd184LA0KICAgICAgICAgICAgICAgICAgICAgICAgbGVnZW5kX3dfOCwNCiAgICAgICAgICAgICAgICAgICAgICAgIG5jb2wgPSAxLA0KICAgICAgICAgICAgICAgICAgICAgICAgcmVsX2hlaWdodHMgPSBjKDAuMSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMC4xKSwNCiAgICAgICAgICAgICAgICAgICAgICAgIHNjYWxlID0gMS4wDQopDQoNCmZpZ3VyZV93XzgNCmBgYA0KDQoNCg0KIyMgKipEYXRhIEFuYWx5c2lzKioNCioqKiANCg0KYGBge3IsIGVjaG8gPSBGQUxTRX0NCiNJZiBpbnN0cnVjdG9ycyBzdGFydCBoZXJlLCB3ZSBuZWVkIHRvIGxvYWQgdGhlIGRhdGE6DQojbG9hZChoZXJlOjpoZXJlKCJkYXRhIiwgIndyYW5nbGVkX2RhdGFfd2l0aF92YXJfZm9yX3Bsb3RzLnJkYSIpKQ0KbG9hZCgid3d3L2RhdGEvd3JhbmdsZWRfZGF0YV93aXRoX3Zhcl9mb3JfcGxvdHMucmRhIikNCmBgYA0KDQpBcyBhbiBleHRlbnNpb24sIHdlIHdpbGwgaW5jbHVkZSBzb21lIG1hdGVyaWFsIGhlcmUgb24gW2xvZ2lzdGljIHJlZ3Jlc3Npb25dKGh0dHBzOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL0xvZ2lzdGljX3JlZ3Jlc3Npb24pe3RhcmdldD0iX2JsYW5rIn0gYW5kIHN1cnZleS13ZWlnaHRlZCBsb2dpc3RpYyByZWdyZXNzaW9uIHRoYXQgd291bGQgYmUgYXBwcm9wcmlhdGUgZm9yIGFuc3dlcmluZyBRdWVzdGlvbiAyICgiSG93IGRvZXMgZS1jaWdhcmV0dGUgdXNlIGNvbXBhcmUgYmV0d2VlbiBtYWxlcyBhbmQgZmVtYWxlcz8iKSBmb3IgYSBzaW5nbGUgeWVhciB1c2luZyBzdGF0aXN0aWNhbCBpbmZlcmVuY2UsIHJhdGhlciB0aGFuIGp1c3QgZGF0YSB2aXN1YWxpemF0aW9ucy4NCg0KV2UgY2FuIGxvb2sgYXQgdGhlIGZpbmFsIGZpZ3VyZSBpbiB0aGUgc2VjdGlvbiBvbiBRdWVzdGlvbiAyIGFuZCBzZWUgdGhhdCBhbW9uZyBib3RoIGN1cnJlbnQgYW5kIGV2ZXIgdXNlcnMgb2YgZS1jaWdhcmV0dGVzLCBhIGhpZ2hlciBwZXJjZW50YWdlIG9mIG1hbGVzIHRoYW4gZmVtYWxlcyB1c2Ugb3IgaGF2ZSB1c2VkIGUtY2lnYXJldHRlcy4nDQoNCmBgYHtyLCBlY2hvID0gRkFMU0UsIG91dC53aWR0aCA9ICI4MDAgcHgifQ0Ka25pdHI6OmluY2x1ZGVfZ3JhcGhpY3MoInd3dy9pbWcvcGxvdDIucG5nIikNCmBgYA0KDQpCdXQgd2hhdCBpZiB3ZSB3YW50ZWQgdG8gcXVhbnRpZnkgdGhpcyBlZmZlY3QgYW5kIGFzc2VzcyB3aGV0aGVyIHRoaXMgZGlmZmVyZW5jZSBjYW4gYmUgY29uc2lkZXJlZCBzdGF0aXN0aWNhbGx5IHNpZ25pZmljYW50PyBUaGlzIGlzIHdoZXJlIHRoZSB0b29sIG9mIGxvZ2lzdGljIHJlZ3Jlc3Npb24gY2FuIGNvbWUgaW4gaGFuZHkuDQoNCiMjIyAqKkxvZ2lzdGljIHJlZ3Jlc3Npb24gbW90aXZhdGlvbioqDQoqKioNCg0KSGVyZSwgd2Ugd2lsbCBhcHByb2FjaCB0aGUgdG9waWMgb2YgW2xvZ2lzdGljIHJlZ3Jlc3Npb25dKGh0dHBzOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL0xvZ2lzdGljX3JlZ3Jlc3Npb24pe3RhcmdldD0iX2JsYW5rIn0gYXNzdW1pbmcgc29tZSBwcmlvciBrbm93bGVkZ2Ugb2Ygc2ltcGxlIGFuZCBtdWx0aXBsZSBsaW5lYXIgcmVncmVzc2lvbi4gVGhlc2UgaGF2ZSBiZWVuIGNvdmVyZWQgaW4gW2Fub3RoZXIgY2FzZSBzdHVkeV0oaHR0cHM6Ly9vcGVuY2FzZXN0dWRpZXMuZ2l0aHViLmlvL29jcy1icC1kaWV0LykuDQoNCkFzIGEgYnJpZWYgcmVtaW5kZXIsIGEgW2xpbmVhciByZWdyZXNzaW9uIG1vZGVsXShodHRwczovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9MaW5lYXJfcmVncmVzc2lvbil7dGFyZ2V0PSJfYmxhbmsifSBhbGxvd3MgdXMgdG8gZXN0aW1hdGUgdGhlIHJlbGF0aW9uc2hpcCBiZXR3ZWVuIGFuIG91dGNvbWUgdmFyaWFibGUsIGNhbGwgaXQgJFkkLCBhbmQgYSBzZXQgb2Ygb25lIG9yIG1vcmUgaW5wdXQgdmFyaWFibGVzLCAkWF8xLCBYXzIsIC4uLiwgWF9uJC4gV2UgY2FuIHdyaXRlIGEgc2ltcGxlIGxpbmVhciByZWdyZXNzaW9uIG1vZGVsIGFzOg0KDQokJCBFKFkpID0gXGJldGFfMCArIFxiZXRhXzEgWF8xJCQNCg0Kd2hlcmUgdGhlICRFKFkpJCBtZWFucyB0aGUgZXhwZWN0ZWQgdmFsdWUgb2YgJFkkLCBpLmUuLCBvdXIgbW9kZWwgZ2l2ZXMgdXMgYW4gZXN0aW1hdGUgb2YgdGhlIG1lYW4gdmFsdWUgb2YgJFkkIGdpdmVuIGEgcGFydGljdWxhciBpbnB1dCAkWF8xJC4gSGVyZSwgJFxiZXRhXzEkIHF1YW50aWZpZXMgdGhlIGV4cGVjdGVkIGRpZmZlcmVuY2UgaW4gJFkkIGNvbXBhcmluZyB0d28gaW5kaXZpZHVhbHMgd2hvIGFyZSBvbmUgdW5pdCBhcGFydCBpbiAkWF8xJC4NCg0KU2ltaWxhcmx5LCB3ZSBjYW4gaW5jbHVkZSBtb3JlIHRoYW4gb25lIHByZWRpY3RvciBzbyB0aGF0IG91ciBlcXVhdGlvbiBtaWdodCBsb29rIGxpa2U6DQoNCiQkIEUoWSkgPSBcYmV0YV8wICsgXGJldGFfMSBYXzEgKyBcYmV0YV8yIFhfMiQkDQoNCkhlcmUsICRcYmV0YV8xJCBxdWFudGlmaWVzIHRoZSBleHBlY3RlZCBkaWZmZXJlbmNlIGluICRZJCBjb21wYXJpbmcgdHdvIGluZGl2aWR1YWxzIHdobyBhcmUgb25lIHVuaXQgYXBhcnQgaW4gJFhfMSQsIGhvbGRpbmcgJFhfMiQgYXQgYSBmaXhlZCB2YWx1ZS4gVGhpcyBtYXRlcmlhbCBpcyBjb3ZlcmVkIGluIG1vcmUgZGV0YWlsIFtlbHNld2hlcmVdKGh0dHBzOi8vcmFmYWxhYi5naXRodWIuaW8vZHNib29rL2xpbmVhci1tb2RlbHMuaHRtbCNsaW5lYXItcmVncmVzc2lvbi1pbi10aGUtdGlkeXZlcnNlKXt0YXJnZXQ9Il9ibGFuayJ9IGFuZCBpbiBbYW5vdGhlciBjYXNlIHN0dWR5XShodHRwczovL29wZW5jYXNlc3R1ZGllcy5naXRodWIuaW8vb2NzLWJwLWRpZXQvKXt0YXJnZXQ9Il9ibGFuayJ9Lg0KDQpJbiB0aGUgY2FzZSBvZiBvdXIgcXVlc3Rpb24gb2YgaW50ZXJlc3QgZm9yIHRoaXMgY2FzZSBzdHVkeSwgaG93ZXZlciwgb3VyIG91dGNvbWUgdmFyaWFibGUgaXMgb2YgYSBwYXJ0aWN1bGFyIHR5cGU6IGl0IGlzIGEgWWVzLU5vIG9yICpiaW5hcnkqIG91dGNvbWUsIHNpbmNlIGVhY2ggc3R1ZGVudCByZXNwb25kZW50IGVpdGhlciBpcyBvciBpcyBub3QgYSBjdXJyZW50IHVzZXIgb2YgZS1jaWdhcmV0dGVzLiBUaGlzIG1lYW5zIGluIG91ciBzZXR0aW5nICRZJCBvbmx5IHRha2VzIG9uIHR3byB2YWx1ZXM6IFRSVUUgb3IgRkFMU0UsIHdoaWNoIHdlIGNhbiBhbHNvIHRoaW5rIG9mIGFzIDEgYW5kIDAuIEZvciB0aGlzIGtpbmQgb2Ygb3V0Y29tZSB2YXJpYWJsZSwgd2UgbmVlZCBhIHNwZWNpYWwga2luZCBvZiByZWdyZXNzaW9uLCBjYWxsZWQgKmxvZ2lzdGljIHJlZ3Jlc3Npb24qLiBBbmQgaW5zdGVhZCBvZiB1c2luZyBhIGxpbmVhciBtb2RlbCB0byBlc3RpbWF0ZSAkWSQgaXRzZWxmIGZvciBhIGdpdmVuIHNldCBvZiBpbnB1dCB2YXJpYWJsZXMsIHdlIHdpbGwgdXNlIGEgbGluZWFyIG1vZGVsIHRvIGVzdGltYXRlIHRoZSAqbG9nIG9kZHMgdGhhdCBZPTEqIGZvciBhIGdpdmVuIHNldCBvZiBpbnB1dCB2YXJpYWJsZXMuDQoNCklmIHdlIGRlZmluZSAkcD1QKFk9MSk9RShZKSQsIHRoZSBzdGFuZGFyZCBzaW1wbGUgbG9naXN0aWMgcmVncmVzc2lvbiBlcXVhdGlvbiBjYW4gYmUgd3JpdHRlbiBhczoNCg0KJCRsb2dpdChwKT0gbG9nX2UgKFxmcmFje3B9ezEtcH0pPSBcYmV0YV8wICsgXGJldGFfMSBYJCQgIA0KDQpJbiBvdXIgY2FzZSwgd2Ugd291bGQgZGVmaW5lICRwJCBhcyB0aGUgcHJvYmFiaWxpdHkgdGhhdCBhIHN0dWRlbnQgcmVzcG9uZGVudCBpcyBhIGN1cnJlbnQgZS1jaWdhcmV0dGUgdXNlciwgc2luY2UgJFkkIGlzIHRoZSBiaW5hcnkgdmFyaWFibGUgdGhhdCBpcyAxIHdoZW4gYSBzdHVkZW50IHJlc3BvbmRlbnQgaXMgYSBjdXJyZW50IGUtY2lnYXJldHRlIHVzZXIgYW5kIDAgaWYgbm90LiBUaGUgdmFsdWUgJFxmcmFje3B9ezEtcH0kIGlzIGNhbGxlZCB0aGUgKm9kZHMqIHRoYXQgJFkkIGlzIGVxdWFsIHRvIDEuDQoNClRoaXMgKmxvZ2l0KiBmdW5jdGlvbiBpcyBzaG9ydCBmb3IgKmxvZyBvZGRzKi4gDQoNCldoaWxlIGl0IG1heSBmZWVsIHN0cmFuZ2Ugd29ya2luZyB3aXRoIHRoZSBsb2cgb2RkcyB0aGF0IG91ciBvdXRjb21lIHZhcmlhYmxlIGlzIGVxdWFsIHRvIDEsIHRoZXJlIGFyZSBzb21lIGludHVpdGl2ZSByZWFzb25zIHdoeSBpdCBtYWtlcyBzZW5zZSB0byBkbyB0aGlzIGZyb20gdGhlIHBvaW50IG9mIHZpZXcgb2YgZml0dGluZyBhIGxpbmUgdG8gb3VyIGRhdGEgYW5kIGludGVycHJldGluZyB0aGUgcmVzdWx0cy4gVGhlIFtsb2cgb2Rkc10oaHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvTG9naXQpe3RhcmdldD0iX2JsYW5rIn0gY2FuIHRha2UgYW55IHZhbHVlIG9uIHRoZSByZWFsIG51bWJlciBsaW5lLCBhbGxvd2luZyB1cyB0byBlc3RpbWF0ZSBvdXIgbW9kZWwgcGFyYW1ldGVycyB3aXRoIG5vIGNvbnN0cmFpbnRzLiBJZiB3ZSBpbnN0ZWFkIHRyaWVkIHRvIHVzZSBzYXkgJHAkIGFzIHRoZSBvdXRjb21lIHZhcmlhYmxlLCB3ZSB3b3VsZCBzb21laG93IG5lZWQgdG8gY29uc3RyYWluICRcYmV0YV8wICsgXGJldGFfMSBYJCB0byBiZSBiZXR3ZWVuIDAgYW5kIDEsIHNpbmNlIHRoaXMgaXMgdGhlIG9ubHkgcG9zc2libGUgcmFuZ2Ugb2YgdmFsdWVzIGZvciBhIFtwcm9iYWJpbGl0eV0oaHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvUHJvYmFiaWxpdHkpe3RhcmdldD0iX2JsYW5rIn0uIEEgc2Vjb25kLCBtb3JlIHRlY2huaWNhbCByZWFzb24gaXMgdGhhdCB3b3JraW5nIG9uIHRoZSBsb2cgb2RkcyBzY2FsZSBnaXZlcyB1cyBhIG5pY2UgZm9ybXVsYXRpb24gb2Ygb3VyICpsaWtlbGlob29kKiwgaS5lLiwgYSBmdW5jdGlvbiBvZiBvdXIgdW5rbm93biBwYXJhbWV0ZXJzIHRoYXQgaW5jb3Jwb3JhdGVzIG91ciBvYnNlcnZlZCBkYXRhLiBXZSB1c2UgdGhpcyBbbGlrZWxpaG9vZCBmdW5jdGlvbl0oaHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvTGlrZWxpaG9vZF9mdW5jdGlvbil7dGFyZ2V0PSJfYmxhbmsifSB0byBlc3RpbWF0ZSBvdXIgdW5rbm93biBwYXJhbWV0ZXJzIChoZXJlLCAkXGJldGFfMCQgYW5kICRcYmV0YV8xJCkgYW5kIHRoaXMgZm9ybXVsYXRpb24gZ2l2ZXMgdXMgYSBuaWNlIHdheSB0byBjYWxjdWxhdGUgdGhlIFttYXhpbXVtIGxpa2VsaWhvb2QgZXN0aW1hdGVzXShodHRwczovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9NYXhpbXVtX2xpa2VsaWhvb2RfZXN0aW1hdGlvbil7dGFyZ2V0PSJfYmxhbmsifSBvZiB0aGVzZSBwYXJhbWV0ZXJzLg0KDQpUaGUgaW50dWl0aXZlIGV4cGxhbmF0aW9uIG9mIGxvZ2lzdGljIHJlZ3Jlc3Npb24gdGhlbiBpcyB0aGF0IHdlIGFyZSBmaXR0aW5nIGEgbGluZSB0byB0aGUgbG9nIG9kZHMgb2YgJFkkLCBhcyBpdCB2YXJpZXMgd2l0aCBkaWZmZXJlbnQgdmFsdWVzIG9mICRYJC4gV2Ugd2lsbCB3b3JrIHRocm91Z2ggYW4gZXhhbXBsZSBiZWxvdyB0byBpbGx1c3RyYXRlIGFuZCBob3BlZnVsbHkgY2xhcmlmeSB0aGlzLg0KDQoNCiMjIyAqKkxvZ2lzdGljIHJlZ3Jlc3Npb24gImJ5IGhhbmQiIGFuZCBieSBtb2RlbCoqDQoqKioNCg0KRm9yIHNpbXBsaWNpdHksIHdlIHdpbGwgY29uc2lkZXIganVzdCB0aGUgc2V0IG9mIGN1cnJlbnQgdXNlcnMgb2YgZS1jaWdhcmV0dGVzIGluIDIwMTUuIEhvdyBtdWNoIG1vcmUgbGlrZWx5IGlzIGEgbWFsZSBzdHVkZW50IHRvIGJlIGEgY3VycmVudCBlLWNpZ2FyZXR0ZSB1c2VyIHRoYW4gYSBmZW1hbGUgc3R1ZGVudD8NCg0KV2UgY2FuIGdldCBhIGZpcnN0IGxvb2sgYXQgdGhlIGFuc3dlciBieSBjYWxjdWxhdGluZyB0aGUgcGVyY2VudCBvZiBmZW1hbGVzIGFuZCBwZXJjZW50IG9mIG1hbGVzIHdobyBhcmUgY3VycmVudCBlLWNpZ2FyZXR0ZSB1c2VycyBvciBub3Q6IA0KDQpgYGB7cn0NCm55dHNfZGF0YSAlPiUgDQogIGZpbHRlcih5ZWFyID09IDIwMTUsICFpcy5uYShTZXgpKSAlPiUNCiAgZ3JvdXBfYnkoU2V4LCBlY2lnX2N1cnJlbnQpICU+JQ0KICBzdW1tYXJpemUobiA9IG4oKSkgJT4lDQogIG11dGF0ZShwY3QgPSBuIC8gc3VtKG4pKQ0KYGBgDQoNCldlIGNhbiBzZWUgdGhhdCB0aGUgcGVyY2VudGFnZSBpcyBsb3dlciBmb3IgZmVtYWxlcyB0aGFuIGZvciBtYWxlcy4gQW5vdGhlciB3YXkgb2Ygb3JnYW5pemluZyB0aGlzIGRhdGEgd291bGQgYmUgdG8gbWFrZSBhIFsyeDIgdGFibGVdKGh0dHBzOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL0NvbnRpbmdlbmN5X3RhYmxlKXt0YXJnZXQ9Il9ibGFuayJ9LCBhIGRhdGEgc3VtbWFyaXphdGlvbiBmcmVxdWVudGx5IHVzZWQgaW4gcHVibGljIGhlYWx0aCBzZXR0aW5ncy4NCg0KfCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgTWFsZSAgICAgfCBGZW1hbGV8IFRvdGFsfA0KfDotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLXwtLS0tLS0tLS06fC0tLS0tLTp8LS0tLS06fA0KfEN1cnJlbnQgZS1jaWdhcmV0dGUgdXNlciAgICAgICAgIHwgICAgICAxMTcxfCAgICA3NzJ8ICAxOTQzfA0KfE5vdCBjdXJyZW50IGUtY2lnYXJldHRlIHVzZXIgICAgIHwgICAgICA3Nzg3fCAgIDc4NTB8IDE1NjM3fA0KfFRvdGFsICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgICAgICA4OTU4fCAgIDg2MjJ8IDE3NTgwfA0KDQoNCkFzIGRpc2N1c3NlZCBhYm92ZSwgb25lIGltcG9ydGFudCBpbmdyZWRpZW50IGluIHVuZGVyc3RhbmRpbmcgdGhlIG91dHB1dCBvZiBsb2dpc3RpYyByZWdyZXNzaW9uIGlzIHVuZGVyc3RhbmRpbmcgdGhlIGNvbmNlcHQgb2YgYW4gb2RkcyBhbmQgYW4gb2RkcyByYXRpby4gV2UgY2FuIGFzaywgYW1vbmcgbWFsZXMgd2hvIHJlc3BvbmRlZCB0byB0aGUgc3VydmV5IGluIDIwMTUsIHdoYXQgYXJlIHRoZSBvZGRzIG9mIGJlaW5nIGEgY3VycmVudCBlLWNpZ2FyZXR0ZSB1c2VyPyBIb3cgYWJvdXQgZm9yIGZlbWFsZXM/IEhvdyBkbyB0aGVzZSBvZGRzIGNvbXBhcmU/IFRoZSBbb2RkcyByYXRpb10oaHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvT2Rkc19yYXRpbyl7dGFyZ2V0PSJfYmxhbmsifSBpcyBhIHRvb2wgZnJlcXVlbnRseSB1c2VkIGluIHB1YmxpYyBoZWFsdGggdG8gY29tcGFyZSB0aGUgb2RkcyBiZXR3ZWVuIHR3byBncm91cHMuIA0KDQpJbiB0aGlzIGNhc2U6DQoNCiogT2RkcyBvZiBjdXJyZW50IGUtY2lnYXJldHRlIHVzZSBmb3IgbWFsZXM6IDExNzEgLyA3Nzg3ID0gMC4xNTANCiogT2RkcyBvZiBjdXJyZW50IGUtY2lnYXJldHRlIHVzZSBmb3IgZmVtYWxlczogNzcyIC8gNzg1MCA9IDAuMDk4DQoqIE9kZHMgcmF0aW8gb2YgZS1jaWdhcmV0dGUgdXNlIGZvciBmZW1hbGVzIGFzIGNvbXBhcmVkIHRvIG1hbGVzOiAkJE9SID0gXGZyYWN7b2RkcyBcIGZvciBcIGZlbWFsZXN9e29kZHMgXCBmb3IgXCBtYWxlc30gPSBcZnJhY3s3NzIgLyA3ODUwfXsxMTcxIC8gNzc4N30gPSAwLjY1JCQNCiogTG9nIG9kZHMgcmF0aW86ICRsb2dfZShPUikgPSBsb2coMS41MykgPSAtMC40MiQNCg0KV2Ugd291bGQgaW50ZXJwcmV0IHRoZXNlIHZhbHVlcyBieSBzYXlpbmcgdGhhdCB0aGUgb2RkcyBvZiBiZWluZyBhIGN1cnJlbnQgZS1jaWdhcmV0dGUgdXNlciBmb3Igd29tZW4gYXJlIGFyb3VuZCAwLjY1IHRpbWVzIHRoZSBvZGRzIG9mIGJlaW5nIGEgY3VycmVudCBlLWNpZ2FyZXR0ZSB1c2VyIGZvciBtZW4sIG9yIDM1JSBsb3dlciBmb3Igd29tZW4uIFRoaXMgbWF0Y2hlcyB3aGF0IHdlIGNhbiBzZWUgaW4gb3VyIGRhdGEgdmlzdWFsaXphdGlvbnMgZm9yIFF1ZXN0aW9uIDIuDQoNCmBgYHtyLCBlY2hvID0gRkFMU0UsIG91dC53aWR0aCA9ICI4MDAgcHgifQ0Ka25pdHI6OmluY2x1ZGVfZ3JhcGhpY3MoInd3dy9pbWcvcGxvdDIucG5nIikNCmBgYA0KDQpXZSBjb3VsZCBhbHNvIGFuc3dlciB0aGlzIHF1ZXN0aW9uIHVzaW5nIGxvZ2lzdGljIHJlZ3Jlc3Npb246DQoNCiQkbG9nKG9kZHMgXCBvZiBcIGN1cnJlbnQgXCBlLWNpZ2FyZXR0ZSBcIHVzZSkgPSBcYmV0YV8wICsgXGJldGFfMSBcY2RvdCBTZXgkJA0KDQpIZXJlIGlzIGhvdyB3ZSB3b3VsZCBmaXQgb3VyIGxvZ2lzdGljIHJlZ3Jlc3Npb24gbW9kZWwsIHVzaW5nIHRoZSBgZ2xtYCBmdW5jdGlvbiBmcm9tIGJhc2UgUi4gV2UgYWxzbyB1c2UgdGhlIGB0aWR5YCBmdW5jdGlvbiBmcm9tIHRoZSBgYnJvb21gIHBhY2thZ2UgdG8gY3JlYXRlIGEgdGliYmxlIG9mIHRoZSBtb2RlbCBvdXRwdXQuDQoNCmBgYHtyfQ0KZGF0MjAxNSA8LSBueXRzX2RhdGEgJT4lIA0KICBmaWx0ZXIoeWVhciA9PSAyMDE1LCAhaXMubmEoU2V4KSkNCg0KY3VyckVjaWdTZXggPC0gZ2xtKGVjaWdfY3VycmVudCB+IFNleCwgZGF0YSA9IGRhdDIwMTUsIGZhbWlseSA9IGJpbm9taWFsKGxpbmsgPSAibG9naXQiKSkNCmN1cnJFY2lnU2V4VGlkeSA8LSBicm9vbTo6dGlkeShjdXJyRWNpZ1NleCkNCmN1cnJFY2lnU2V4VGlkeQ0KYGBgDQoNCkxvb2tpbmcgYXQgdGhpcyBvdXRwdXQsIG91ciBlc3RpbWF0ZWQgbG9naXN0aWMgcmVncmVzc2lvbiBlcXVhdGlvbiBpczoNCg0KJCRsb2cob2RkcyBcIG9mIFwgY3VycmVudCBcIGUtY2lnYXJldHRlIFwgdXNlKSA9IFxiZXRhXzAgKyBcYmV0YV8xIFxjZG90IFNleCA9IC0xLjg5IC0gMC40MjUgXGNkb3QgKFNleCA9PSBmZW1hbGUpJCQNCg0KT3VyICRcYmV0YV8xJCBwYXJhbWV0ZXIgdGVsbHMgdXMgdGhhdCB0aGUgbG9nIG9kZHMgb2YgYmVpbmcgYSBjdXJyZW50IGUtY2lnYXJldHRlIHVzZXIgYXJlIDAuNDI1IGxvd2VyIGZvciBmZW1hbGVzIGNvbXBhcmVkIHRvIG1hbGVzLCBpLmUuLCB0aGUgZGlmZmVyZW5jZSBpbiBsb2cgb2RkcyBvZiBiZWluZyBhIGN1cnJlbnQgZS1jaWdhcmV0dGUgdXNlciBmb3IgZmVtYWxlcyBjb21wYXJlZCB0byBtYWxlcyBpcyAtMC40MjUuIEFuZCB3ZSBjYW4gbm90aWNlIHRoYXQgdGhpcyB2YWx1ZSBtYXRjaGVzIHRoZSBsb2cgb2RkcyByYXRpbyB0aGF0IHdlIGNhbGN1bGF0ZWQgYnkgaGFuZCBmcm9tIHRoZSAyeDIgdGFibGUgYWJvdmUuIFRoaXMgaXMgYmVjYXVzZSBhIGRpZmZlcmVuY2UgaW4gbG9nIG9kZHMgaXMgdGhlIHNhbWUgYXMgYSBsb2cgb2RkcyByYXRpbyAtLSByZW1lbWJlciB5b3VyIFtydWxlcyBvZiBsb2dzXShodHRwczovL3d3dy5yYXBpZHRhYmxlcy5jb20vbWF0aC9hbGdlYnJhL0xvZ2FyaXRobS5odG1sI2xvZy1ydWxlcyl7dGFyZ2V0PSJfYmxhbmsifSENCg0KV2UgY2FuIGludGVycHJldCB0aGlzIG91dHB1dCBhcyBmb2xsb3dzOg0KDQoqICQtMC40MjUgPSBcYmV0YV8xID0gXGxvZyhPUikkDQoqIFRoZSBsb2cgb2RkcyBvZiBiZWluZyBhIGN1cnJlbnQgZS1jaWdhcmV0dGUgdXNlciBpcyAwLjQyNSBsb3dlciBmb3IgZmVtYWxlcyBjb21wYXJlZCB0byBtYWxlcw0KKiAkMC42NSA9IGVeey0wLjQyNX0gPSBlXntcYmV0YV8xfSA9IE9SJA0KKiBUaGUgb2RkcyBvZiBiZWluZyBhIGN1cnJlbnQgZS1jaWdhcmV0dGUgdXNlciBmb3IgZmVtYWxlcyBpcyAwLjY1IHRpbWVzIHRoZSBvZGRzIGZvciBtYWxlcy4NCiogVGhlIG9kZHMgb2YgYmVpbmcgYSBjdXJyZW50IGUtY2lnYXJldHRlIHVzZXIgZm9yIGZlbWFsZXMgaXMgMzUlIGxvd2VyIHRoYW4gdGhlIG9kZHMgZm9yIG1hbGVzLg0KDQpXZSBjYW4gYWxzbyBsb29rIGF0IHRoZSBvdGhlciBjb2x1bW5zIG9mIHRoZSBtb2RlbCBvdXRwdXQgdG8gYXNzZXNzIHdoZXRoZXIgb3VyIGRhdGEgaW5kaWNhdGUgdGhhdCAkXGJldGFfMSQgaXMgc3RhdGlzdGljYWxseSBzaWduaWZpY2FudGx5IGRpZmZlcmVudCBmcm9tIDAuIFRoZSBwLXZhbHVlIGZvciB0aGUgYFNleGAgdmFyaWFibGUgaW4gb3VyIG1vZGVsIGlzIGByIGZvcm1hdChjdXJyRWNpZ1NleFRpZHkgJT4lIGZpbHRlcih0ZXJtID09ICJTZXhmZW1hbGUiKSAlPiUgcHVsbChwLnZhbHVlKSwgZGlnaXRzID0gMylgLiBTaW5jZSB0aGlzIHZhbHVlIGlzIDwgMC4wNSwgd2Ugd291bGQgcmVqZWN0IHRoZSBudWxsIGh5cG90aGVzaXMgdGhhdCAkXGJldGFfMSA9IDAkIGJhc2VkIG9uIG91ciBtb2RlbCBvdXRwdXQuDQoNClNpbXBsZSBsb2dpc3RpYyByZWdyZXNzaW9uIGNhbiBiZSBleHRlbmRlZCB0byBpbmNsdWRlIGFkZGl0aW9uYWwgdmFyaWFibGVzIGluIHRoZSBtb2RlbCwgZm9yIGV4YW1wbGUgdG8gYWRqdXN0IGZvciBwb3RlbnRpYWwgY29uZm91bmRpbmcgdmFyaWFibGVzIHN1Y2ggYXMgYEFnZWAgb3IgYEdyYWRlYC4gRm9yIGV4YW1wbGUsIHN1cHBvc2Ugd2Ugd2FudCB0byBlc3RpbWF0ZSB0aGUgZWZmZWN0IG9mIGBTZXhgIG9uIGN1cnJlbnQgZS1jaWdhcmV0dGUgdXNlLCBob2xkaW5nIGBBZ2VgIGNvbnN0YW50LiBXZSBjb3VsZCBmaXQgdGhlIG1vZGVsOg0KDQokJGxvZyhvZGRzIFwgb2YgXCBjdXJyZW50IFwgZS1jaWdhcmV0dGUgXCB1c2UpID0gXGJldGFfMCArIFxiZXRhXzEgXGNkb3QgU2V4ICsgXGJldGFfMiBcY2RvdCBBZ2UkJA0KDQoNCmBgYHtyfQ0KY3VyckVjaWdTZXhBZ2UgPC0gZ2xtKGVjaWdfY3VycmVudCB+IFNleCArIEFnZSwgDQogICAgICAgICAgICAgICAgICAgICAgZGF0YSA9IGRhdDIwMTUsIA0KICAgICAgICAgICAgICAgICAgICAgIGZhbWlseSA9IGJpbm9taWFsKGxpbmsgPSAibG9naXQiKSkNCnRpZHkoY3VyckVjaWdTZXhBZ2UpDQpgYGANCg0KTm93IG91ciAkXGJldGFfMSQgcGFyYW1ldGVyIHRlbGxzIHVzIHRoYXQgdGhlIGxvZyBvZGRzIG9mIGJlaW5nIGFuIGN1cnJlbnQgZS1jaWdhcmV0dGUgdXNlciBhcmUgMC4zODUgbG93ZXIgZm9yIGZlbWFsZXMgY29tcGFyZWQgdG8gbWFsZXMsIHdpdGhpbiBhbiBhZ2UgZ3JvdXAsIG9yIGhvbGRpbmcgYEFnZWAgY29uc3RhbnQuDQoNCiMjIyAqKlN1cnZleSB3ZWlnaHRlZCBsb2dpc3RpYyByZWdyZXNzaW9uKioNCioqKg0KDQpBcyBkaXNjdXNzZWQgZWxzZXdoZXJlIGluIHRoaXMgY2FzZSBzdHVkeSwgb3VyIGRhdGEgY29tZSBmcm9tIGEgc3VydmV5LCB3aGVyZSBpbmRpdmlkdWFscyB3ZXJlIG5vdCBuZWNlc3NhcmlseSBzYW1wbGVkIGluIGRpcmVjdCBwcm9wb3J0aW9uIHRvIHRoZWlyIHBvcHVsYXRpb24gcmVwcmVzZW50YXRpb24sIHNvIGl0IGlzIG5lY2Vzc2FyeSB0byBpbmNvcnBvcmF0ZSBzdXJ2ZXkgd2VpZ2h0cyBpbnRvIG91ciBhbmFseXNpcyB0byBwZXJmb3JtIGluZmVyZW5jZSBhYm91dCB0aGUgcG9wdWxhdGlvbiBvZiBpbnRlcmVzdC4gTHVja2lseSwgdGhlcmUgYXJlIGltcGxlbWVudGF0aW9ucyBvZiBzdXJ2ZXktd2VpZ2h0ZWQgbG9naXN0aWMgcmVncmVzc2lvbiBpbiBSIHRoYXQgY2FuIGRvIHRoaXMgZm9yIHVzLg0KDQpXZSBmaXJzdCBjcmVhdGUgb3VyIHN1cnZleSBkZXNpZ24gb2JqZWN0IHVzaW5nIHRoZSBgYXNfc3VydmV5X2Rlc2lnbmAgZnVuY3Rpb24gZnJvbSB0aGUgYHNydnlyYCBwYWNrYWdlLCBhbmQgdGhlbiB1c2UgdGhlIGBzdnlnbG1gIGZ1bmN0aW9uIGZyb20gdGhlIGBzdXJ2ZXlgIHBhY2thZ2UgdG8gZml0IG91ciBsb2dpc3RpYyByZWdyZXNzaW9uIG1vZGVsLg0KDQpgYGB7cn0NCmRhdDIwMTVfc3VydmV5X2Rlc2lnbiA8LSBkYXQyMDE1ICU+JQ0KICAgICAgICAgICAgICAgICAgICAgICAgICBhc19zdXJ2ZXlfZGVzaWduKHN0cmF0YSA9IHN0cmF0dW0sDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkcyA9IHBzdSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2VpZ2h0ICA9IGZpbndndCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmVzdCA9IFRSVUUpDQoNCg0KY3VyckVjaWdTZXhfc3Z5IDwtIHN1cnZleTo6c3Z5Z2xtKGVjaWdfY3VycmVudCB+IFNleCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmYW1pbHkgPSBxdWFzaWJpbm9taWFsKGxpbmsgPSAnbG9naXQnKSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXNpZ24gPSBkYXQyMDE1X3N1cnZleV9kZXNpZ24pDQp0aWR5KGN1cnJFY2lnU2V4X3N2eSkNCmBgYA0KDQpOb3RlIHRoYXQgaW4gdGhpcyBjYXNlLCB3ZSB1c2UgdGhlIFtxdWFzaV0oaHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvUXVhc2ktbGlrZWxpaG9vZCl7dGFyZ2V0PSJfYmxhbmsifS1iaW5vbWlhbCBmYW1pbHkgcmF0aGVyIHRoYW4gdGhlIGJpbm9taWFsIGZhbWlseSwgd2hpY2ggYWxsb3dzIHRoZSBkYXRhIHRvIG5vdCBuZWNlc3NhcmlseSBsb29rIGxpa2UgYSBzYW1wbGUgZnJvbSBhIFtiaW5vbWlhbCBkaXN0cmlidXRpb25dKGh0dHBzOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL0Jpbm9taWFsX2Rpc3RyaWJ1dGlvbil7dGFyZ2V0PSJfYmxhbmsifS4gVGhpcyBpcyBiZWNhdXNlIGJ5IGluY29ycG9yYXRpbmcgb3VyIHN1cnZleSB3ZWlnaHRzLCBpdCBpcyBhcyBpZiBlYWNoIGluZGl2aWR1YWwgZG9lcyBub3QgaGF2ZSBhIDAgb3IgMSBhcyB0aGVpciBvdXRjb21lIHZhcmlhYmxlLCBzbyB3ZSBnZXQgYSB3YXJuaW5nIGlmIHdlIGRvIG5vdCB1c2UgdGhpcyB2YWx1ZSBmb3IgZmFtaWx5Lg0KDQpGcm9tIHRoaXMgbW9kZWwgb3V0cHV0LCB3ZSBjYW4gc2VlIHRoYXQgdGhlIGVzdGltYXRlIGluY29ycG9yYXRpbmcgc3VydmV5IHdlaWdodHMgaXMgYSBsaXR0bGUgZGlmZmVyZW50LiBUaGUgaW50ZXJwcmV0YXRpb24gaXMgYXMgZm9sbG93czoNCg0KKiAkLTAuMzgzID0gXGJldGFfMSA9IFxsb2coT1IpJA0KKiBUaGUgbG9nIG9kZHMgb2YgYmVpbmcgYSBjdXJyZW50IGUtY2lnYXJldHRlIHVzZXIgaXMgMC4zODMgbG93ZXIgZm9yIGZlbWFsZXMgdGhhbiBmb3IgbWFsZXMsIHRha2luZyBzdXJ2ZXkgd2VpZ2h0cyBpbnRvIGFjY291bnQuDQoqICQwLjY4ID0gZV57LTAuMzgzfSA9IGVee1xiZXRhXzF9ID0gT1IkDQoqIFRoZSBvZGRzIG9mIGJlaW5nIGEgY3VycmVudCBlLWNpZ2FyZXR0ZSB1c2VyIGZvciBmZW1hbGVzIGlzIDAuNjggdGltZXMgdGhlIG9kZHMgZm9yIG1hbGVzLCB0YWtpbmcgc3VydmV5IHdlaWdodHMgaW50byBhY2NvdW50Lg0KKiBUaGUgb2RkcyBvZiBiZWluZyBhIGN1cnJlbnQgZS1jaWdhcmV0dGUgdXNlciBmb3IgZmVtYWxlcyBpcyAzMiUgbG93ZXIgdGhhbiB0aGUgb2RkcyBmb3IgbWFsZXMsIHRha2luZyBzdXJ2ZXkgd2VpZ2h0cyBpbnRvIGFjY291bnQuDQoNCg0KQXMgYWJvdmUsIHdlIGNhbiBhbHNvIGZpdCBhIG1vcmUgY29tcGxpY2F0ZWQgbW9kZWwgd2l0aCBhZGRpdGlvbmFsIGNvdmFyaWF0ZXMuDQoNCmBgYHtyfQ0KY3VyckVjaWdTZXhBZ2Vfc3Z5IDwtIHN1cnZleTo6c3Z5Z2xtKGVjaWdfY3VycmVudCB+IFNleCArIEFnZSwNCiAgICAgICAgICAgICAgICAgICAgICBmYW1pbHkgPSBxdWFzaWJpbm9taWFsKGxpbmsgPSAnbG9naXQnKSwgDQogICAgICAgICAgICAgICAgICAgICAgZGVzaWduID0gZGF0MjAxNV9zdXJ2ZXlfZGVzaWduKQ0KdGlkeShjdXJyRWNpZ1NleEFnZV9zdnkpDQpgYGANCg0KSW4gdGhpcyBjYXNlLCB3ZSBjYW4gc2VlIHRoYXQgb3VyIGVzdGltYXRlZCBkaWZmZXJlbmNlIGluIGxvZyBvZGRzIGZvciBmZW1hbGVzIGNvbXBhcmVkIHRvIG1hbGVzLCAtMC4zODAsIGlzIG5vdCBtdWNoIGRpZmZlcmVudCB3aGV0aGVyIHdlIGFyZSBob2xkaW5nIGBBZ2VgIGNvbnN0YW50IG9yIG5vdC4NCg0KDQojIyAqKlN1bW1hcnkqKg0KKioqIA0KDQoNCiMjIyAqKlN1bW1hcnkgUGxvdCoqDQoqKioNCg0KRmluYWxseSB3ZSB3aWxsIHB1dCBvdXIgcGxvdHMgdG9nZXRoZXIgdG8gY3JlYXRlIGEgcGxvdCB0aGF0IGRlc2NyaWJlcyB0aGUgcmVsYXRpb25zaGlwIGJldHdlZW4gZS1jaWdhcmV0dGUgdXNhZ2UgYW5kIG92ZXJhbGwgdG9iYWNjbyB1c2UsIGNvbWJpbmluZyBib3RoIG91ciBmaXJzdCBzZXQgb2YgdW53ZWlnaHRlZCByZXN1bHRzLCBhbmQgdGhvc2UgY2FsY3VsYXRlZCB1c2luZyB0aGUgYHNydnlyYCBwYWNrYWdlLg0KDQpgYGB7cn0NCnRpdGxlX2ZpbmFsIDwtIGdnZHJhdygpICsNCiAgZHJhd19sYWJlbCgNCiAgICBleHByZXNzaW9uKCJXaGF0IGlzIHRoZSByZWxhdGlvbnNoaXAgYmV0d2VlbiBlLWNpZ2FyZXR0ZSB1c2UgYW5kIHRvYmFjY28gdXNlPyIpLA0KICAgIGZvbnRmYWNlID0gJ2JvbGQnLA0KICAgIHNpemUgPSAxNiwNCiAgICB4ID0gMC41KSArDQogIHRoZW1lKA0KICAgIHBsb3QubWFyZ2luID0gbWFyZ2luKDAsIDAsIDAsIDApDQogICkNCg0Kc3VidGl0bGVfdXdfZmluYWwgPC0gZ2dkcmF3KCkgKw0KICBkcmF3X2xhYmVsKA0KICAgIGV4cHJlc3Npb24ofiA2XnRoIH4gIi0iIH4gMTJedGggfiAiZ3JhZGVycywgdW53ZWlnaHRlZCIpLA0KICAgIHNpemUgPSAxMiwNCiAgICB4ID0gMC41KSArDQogIHRoZW1lKA0KICAgIHBsb3QubWFyZ2luID0gbWFyZ2luKDAsIDAsIDAsIDApDQogICkNCg0Kc3VidGl0bGVfd19maW5hbCA8LSBnZ2RyYXcoKSArDQogIGRyYXdfbGFiZWwoDQogICAgZXhwcmVzc2lvbih+IDZedGggfiAiLSIgfiAxMl50aCB+ICJncmFkZXJzLCB3ZWlnaHRlZCIpLA0KICAgIGZvbnRmYWNlID0gJ2JvbGQnLA0KICAgIHNpemUgPSAxMiwNCiAgICB4ID0gMC41KSArDQogIHRoZW1lKA0KICAgIHBsb3QubWFyZ2luID0gbWFyZ2luKDAsIDAsIDAsIDApDQogICkNCg0Kc3VidGl0bGVfd184X2ZpbmFsIDwtIGdnZHJhdygpICsNCiAgZHJhd19sYWJlbCgNCiAgICBleHByZXNzaW9uKCJBcHByb3hpbWF0ZSBncmFkdWF0aW5nIFxuIGNsYXNzIG9mIDIwMTksIHdlaWdodGVkIiksDQogICAgZm9udGZhY2UgPSAnYm9sZCcsDQogICAgc2l6ZSA9IDEyLA0KICAgIHggPSAwLjUpICsNCiAgdGhlbWUoDQogICAgcGxvdC5tYXJnaW4gPSBtYXJnaW4oMCwgMCwgMCwgMCkNCiAgKQ0KDQpzdWJ0aXRsZV9maW5hbCA8LSBwbG90X2dyaWQoc3VidGl0bGVfdXdfZmluYWwsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VidGl0bGVfd19maW5hbCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWJ0aXRsZV93XzhfZmluYWwsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbmNvbCA9IDMpDQoNCnBsb3RzQV90aXRsZV9maW5hbCA8LSBnZ2RyYXcoKSArDQogIGRyYXdfbGFiZWwoDQogICAgZXhwcmVzc2lvbigiUHJldmFsZW5jZSBvZiBhbnkgdG9iYWNjbyBwcm9kdWN0IHVzZSBieSB1c2VyIHR5cGUiKSwNCiAgICBzaXplID0gMTQsDQogICAgeCA9IDAuNSkgKw0KICB0aGVtZSgNCiAgICBwbG90Lm1hcmdpbiA9IG1hcmdpbigwLCAwLCAwLCAwKQ0KICApDQoNCnBsb3RzQV9maW5hbCA8LSBwbG90X2dyaWQocGxvdEFfdXcgKyB0aGVtZShwbG90LnRpdGxlID0gZWxlbWVudF9ibGFuaygpKSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgcGxvdEFfdyArIHRoZW1lKHBsb3QudGl0bGUgPSBlbGVtZW50X2JsYW5rKCkpLA0KICAgICAgICAgICAgICAgICAgICAgICAgICBwbG90QV93XzggKyB0aGVtZShwbG90LnRpdGxlID0gZWxlbWVudF9ibGFuaygpKSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgbmNvbCA9IDMsDQogICAgICAgICAgICAgICAgICAgICAgICAgIGFsaWduID0gInYiLA0KICAgICAgICAgICAgICAgICAgICAgICAgICBheGlzID0gImJ0IikNCg0KcGxvdHNCX3RpdGxlX2ZpbmFsIDwtIGdnZHJhdygpICsNCiAgZHJhd19sYWJlbCgNCiAgICBleHByZXNzaW9uKCJQcmV2YWxlbmNlIG9mIGV2ZXIgdHJ5aW5nIGJ5IHByb2R1Y3QgdHlwZSIpLA0KICAgIHNpemUgPSAxNCwNCiAgICB4ID0gMC41KSArDQogIHRoZW1lKA0KICAgIHBsb3QubWFyZ2luID0gbWFyZ2luKDAsIDAsIDAsIDApDQogICkNCg0KcGxvdHNCX2ZpbmFsIDwtIHBsb3RfZ3JpZChwbG90Ql91dyArIHRoZW1lKHBsb3QudGl0bGUgPSBlbGVtZW50X2JsYW5rKCkpLA0KICAgICAgICAgICAgICAgICAgICAgICAgICBwbG90Ql93ICsgdGhlbWUocGxvdC50aXRsZSA9IGVsZW1lbnRfYmxhbmsoKSksDQogICAgICAgICAgICAgICAgICAgICAgICAgIHBsb3RCX3dfOCArIHRoZW1lKHBsb3QudGl0bGUgPSBlbGVtZW50X2JsYW5rKCkpLA0KICAgICAgICAgICAgICAgICAgICAgICAgICBuY29sID0gMywNCiAgICAgICAgICAgICAgICAgICAgICAgICAgYWxpZ24gPSAidiIsDQogICAgICAgICAgICAgICAgICAgICAgICAgIGF4aXMgPSAiYnQiKQ0KDQpwbG90c0NfdGl0bGVfZmluYWwgPC0gZ2dkcmF3KCkgKw0KICBkcmF3X2xhYmVsKA0KICAgIGV4cHJlc3Npb24oIlByZXZhbGVuY2Ugb2YgY3VycmVudCB1c2UgYnkgcHJvZHVjdCB0eXBlIiksDQogICAgc2l6ZSA9IDE0LA0KICAgIHggPSAwLjUpICsNCiAgdGhlbWUoDQogICAgcGxvdC5tYXJnaW4gPSBtYXJnaW4oMCwgMCwgMCwgMCkNCiAgKQ0KDQpwbG90c0NfZmluYWwgPC0gcGxvdF9ncmlkKHBsb3RDX3V3ICsgdGhlbWUocGxvdC50aXRsZSA9IGVsZW1lbnRfYmxhbmsoKSksDQogICAgICAgICAgICAgICAgICAgICAgICAgIHBsb3RDX3cgKyB0aGVtZShwbG90LnRpdGxlID0gZWxlbWVudF9ibGFuaygpKSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgcGxvdENfd184ICsgdGhlbWUocGxvdC50aXRsZSA9IGVsZW1lbnRfYmxhbmsoKSksDQogICAgICAgICAgICAgICAgICAgICAgICAgIG5jb2wgPSAzLA0KICAgICAgICAgICAgICAgICAgICAgICAgICBhbGlnbiA9ICJ2IiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgYXhpcyA9ICJidCIpDQoNCmxlZ2VuZF9maW5hbCA8LSBnZXRfbGVnZW5kKHBsb3QxYyArDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoZW1lKGxlZ2VuZC5wb3NpdGlvbiA9ICJib3R0b20iLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZWdlbmQuZGlyZWN0aW9uID0gImhvcml6b250YWwiKSkNCg0KZmluYWxfcGxvdCA8LSBwbG90X2dyaWQodGl0bGVfZmluYWwsDQogICAgICAgICAgcGxvdHNBX3RpdGxlX2ZpbmFsLA0KICAgICAgICAgIHN1YnRpdGxlX2ZpbmFsLA0KICAgICAgICAgIHBsb3RzQV9maW5hbCwNCiAgICAgICAgICBwbG90c0JfdGl0bGVfZmluYWwsDQogICAgICAgICAgc3VidGl0bGVfZmluYWwsDQogICAgICAgICAgcGxvdHNCX2ZpbmFsLA0KICAgICAgICAgIHBsb3RzQ190aXRsZV9maW5hbCwNCiAgICAgICAgICBzdWJ0aXRsZV9maW5hbCwNCiAgICAgICAgICBwbG90c0NfZmluYWwsDQogICAgICAgICAgbGVnZW5kX2ZpbmFsLA0KICAgICAgICAgIG5jb2wgPSAxLA0KICAgICAgICAgIHJlbF9oZWlnaHRzID0gYygwLjIsDQogICAgICAgICAgICAgICAgICAgICAgICAgIDAuMiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgMC4xLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAxLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAwLjIsDQogICAgICAgICAgICAgICAgICAgICAgICAgIDAuMSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgMSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgMC4yLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAwLjEsDQogICAgICAgICAgICAgICAgICAgICAgICAgIDEsDQogICAgICAgICAgICAgICAgICAgICAgICAgIDAuMSkpDQoNCmZpbmFsX3Bsb3QNCmBgYA0KDQpgYGB7ciwgZWNobz1GQUxTRSwgZXZhbD1GQUxTRX0NCmdnc2F2ZShoZXJlOjpoZXJlKCJpbWciLCAiZmluYWxfcGxvdC5wbmciKSkNCmBgYA0KDQojIyMgKipTeW5vcHNpcyoqDQoqKioNCg0KSW4gdGhpcyBjYXNlIHN0dWR5LCB3ZSB1c2VkIGRhdGEgZnJvbSB0aGUgW05hdGlvbmFsIFlvdXRoIFRvYmFjY28gU3VydmV5IChOWVRTKV0oaHR0cHM6Ly93d3cuY2RjLmdvdi90b2JhY2NvL2RhdGFfc3RhdGlzdGljcy9zdXJ2ZXlzL255dHMvaW5kZXguaHRtKXt0YXJnZXQ9Il9ibGFuayJ9LCBhbiBhbm51YWwgc3VydmV5IHRoYXQgYXNrcyBzdHVkZW50cyBpbiBoaWdoIHNjaG9vbCBhbmQgbWlkZGxlIHNjaG9vbCAoZ3JhZGVzIDYtMTIpIGFib3V0IHRvYmFjY28gdXNhZ2UgaW4gdGhlIFVuaXRlZCBTdGF0ZXMgb2YgQW1lcmljYS4gV2UgdXNlZCBkYXRhIGZyb20gKioyMDE1LTIwMTkqKiBkdWUgdG8gdGhlIGZhY3QgdGhhdCB0aGVzZSB5ZWFycyBhcmUgdGhlIG1vc3QgcmVjZW50IHRoYXQgYXNrZWQgcXVlc3Rpb25zIHJlZ2FyZGluZyBlLWNpZ2FyZXR0ZSB1c2FnZS4NCg0KV2UgdXNlZCB0aGlzIGRhdGEgdG8gYW5zd2VyIHRoZXNlIHF1ZXN0aW9uczoNCg0KMSkgSG93IGhhcyB0b2JhY2NvIGFuZCBlLWNpZ2FyZXR0ZS92YXBpbmcgdXNlIGJ5IEFtZXJpY2FuIHlvdXRocyBjaGFuZ2VkIHNpbmNlIDIwMTU/DQoyKSBIb3cgZG9lcyBlLWNpZ2FyZXR0ZSB1c2UgY29tcGFyZSBiZXR3ZWVuIG1hbGVzIGFuZCBmZW1hbGVzPw0KMykgV2hhdCB2YXBpbmcgYnJhbmRzIGFuZCBmbGF2b3JzIGFwcGVhciB0byBiZSB1c2VkIHRoZSBtb3N0IGZyZXF1ZW50bHk/ICANCldlIHdpbGwgYmFzZSB0aGlzIG9uIHRoZSBmb2xsb3dpbmcgc3VydmV5IHF1ZXN0aW9uczogICANCj4gIkR1cmluZyB0aGUgcGFzdCAzMCBkYXlzLCB3aGF0IGJyYW5kIG9mIGUtY2lnYXJldHRlcyBkaWQgeW91IHVzdWFsbHkgdXNlPyIgICANCj4gIldoYXQgZmxhdm9ycyBvZiB0b2JhY2NvIHByb2R1Y3RzIGhhdmUgeW91IHVzZWQgaW4gdGhlIHBhc3QNCjMwIGRheXM/IiANCg0KNCkgSXMgdGhlcmUgYSByZWxhdGlvbnNoaXAgYmV0d2VlbiBlLWNpZ2FyZXR0ZS92YXBpbmcgdXNlIGFuZCBvdGhlciB0b2JhY2NvIHVzZT8NCg0KV2Ugc2hvd2VkIGhvdyB0byB3b3JrIHdpdGggdGhlIGRhdGEgaW4gdGhlIGZvcm1hdCBwcm92aWRlZCAoRXhjZWwpLCBob3cgdG8gdG8gdXNlIHRoZSBjb2RlYm9va3MgdG8gZGVjaWRlIHdoYXQgdmFyaWFibGVzIHRvIHVzZSB0byBhbnN3ZXIgb3VyIHF1ZXN0aW9ucyBhbmQgaG93IHRvIGNsZWFuIGFuZCByZWNvZGUgdGhlIGRhdGEgZnJvbSB0aGUgc3VydmV5IGZvciBvdXIgdmlzdWFsaXphdGlvbnMgYW5kIGFuYWx5c2lzLiBXZSBtYWRlIHZpc3VhbGl6YXRpb25zIG9mIG91ciBzdW1tYXJ5IHN0YXRpc3RpY3Mgb3ZlciB0aW1lLCB0byBpbGx1c3RyYXRlIHRoZSB0cmVuZHMgcHJlc2VudCBpbiB0aGUgZGF0YSBmb3IgZGlmZmVyZW50IHByb2R1Y3RzIGFuZCBncm91cHMgb2Ygc3R1ZGVudCByZXNwb25kZW50cy4NCg0KSW4gYW5zd2VyIHRvIG91ciBxdWVzdGlvbnMsIHdlIGZvdW5kIHRoYXQgdG9iYWNjbyB1c2UgaGFzIGdvbmUgdXAgc2xpZ2h0bHkgb3ZlcmFsbCBiZXR3ZWVuIDIwMTUgYW5kIDIwMTksIHdpdGggbGl0dGxlIGRpZmZlcmVuY2UgaW4gcmF0ZXMgb2YgY2hhbmdlIGNvbXBhcmluZyBtYWxlcyB0byBmZW1hbGVzLiBUaGlzIHNsaWdodCBpbmNyZWFzZSBpcyB0aGUgcmVzdWx0IG9mIGEgbGFyZ2UgaW5jcmVhc2UgaW4gZS1jaWdhcmV0dGUvdmFwaW5nIHVzZSwgY291cGxlZCB3aXRoIGEgZGVjcmVhc2UgaW4gdXNlIG9mIG90aGVyIHRvYmFjY28gcHJvZHVjdHMuIFRoZSBtb3N0IHVzZWQgYnJhbmQgb2YgZS1jaWdhcmV0dGUvdmFwaW5nIHByb2R1Y3RzIGlzIEp1dWwsIGFuZCBmcnVpdCwgbWVudGhvbCBhbmQgY2FuZHkvZGVzc2VydHMvc3dlZXRzIGFyZSB0aGUgbW9zdCBjb21tb25seSB1c2VkIGZsYXZvcnMuDQoNCldlIHRoZW4gaW50cm9kdWNlZCB0aGUgc3RhdGlzdGljYWwgY29uY2VwdCBvZiBzdXJ2ZXkgd2VpZ2h0aW5nLCBpbGx1c3RyYXRpbmcgaG93IHRvIGNhbGN1bGF0ZSB1c2FnZSBwZXJjZW50YWdlcyB1c2luZyBzdXJ2ZXktd2VpZ2h0ZWQgbWVhbnMsIGFuZCBjb21wYXJlIHRoZSByZXN1bHRzIGluIHRoZSB3ZWlnaHRlZCBhbmQgdW53ZWlnaHRlZCBjYXNlcy4gV2UgYWxzbyBpbnRyb2R1Y2VkIHRoZSB0b3BpYyBvZiBsb2dpc3RpYyByZWdyZXNzaW9uIGFuZCB3ZSBwZXJmb3JtZWQgYSBzdXJ2ZXktd2VpZ2h0ZWQgbG9naXN0aWMgcmVncmVzc2lvbiBhbmFseXNpcyB0byBjb21wYXJlIHRoZSB2YXBpbmcgcmF0ZXMgb2YgbWFsZSBhbmQgZmVtYWxlIHN0dWRlbnRzLiANCg0KIyMgKipTdWdnZXN0ZWQgSG9tZXdvcmsqKg0KKioqIA0KDQo8c3R5bGU+DQpkaXYuYmx1ZSB7IGJhY2tncm91bmQtY29sb3I6I2U2ZjBmZjsgYm9yZGVyLXJhZGl1czogNXB4OyBwYWRkaW5nOiAyMHB4O30NCjwvc3R5bGU+DQo8ZGl2IGNsYXNzID0gImJsdWUiPg0KDQorIENhbGN1bGF0ZSBjb25maWRlbmNlIGludGVydmFscyBmb3IgdGhlIHVud2VpZ2h0ZWQgZXN0aW1hdGVzIGFuZCBhZGQgdGhlIGFwcHJvcHJpYXRlIGVycm9yIGJhcnMgdG8gdGhlIG1haW4gZmlndXJlcy4NCisgQXBwbHkgc3VydmV5IHdlaWdodHMgdG8gb25lIG9mIHRoZSBmaWd1cmVzIHByb2R1Y2VkIGluIHRoaXMgY2FzZSBzdHVkeSBpbiB3aGljaCB3ZWlnaHRlZCBlc3RpbWF0ZXMgd2VyZSBub3QgcHJvZHVjZWQuIEluY2x1ZGUgZXJyb3IgYmFycyBpbiB0aGUgdXBkYXRlZCBmaWd1cmUuDQogICAgKyBEb2VzIHRoZSBmaWd1cmUgY2hhbmdlIGFmdGVyIHRoZSBhcHBsaWNhdGlvbiBvZiBzdXJ2ZXkgd2VpZ2h0cz8NCiAgICArIElmIHNvLCBkZXNjcmliZSBob3cuIA0KKyBSZXByb2R1Y2UgYGZpbmFsX3Bsb3RgIGFib3ZlIGZvciBhIGRpZmZlcmVudCBjb2hvcnQgb2YgeW91ciBjaG9pY2UuDQorIEZvY3VzaW5nIG9uIGEgc2luZ2xlIHllYXIgb2YgZGF0YSwgZXhwbG9yZSBkZW1vZ3JhcGhpYyBmYWN0b3JzIHRoYXQgY29udHJpYnV0ZSB0byB0b2JhY2NvIHVzZSBvZiBzb21lIGtpbmQuIENvbXBhcmUgcmVzdWx0cyBvZiB1bndlaWdodGVkIGFuZCB3ZWlnaHRlZCBhbmFseXNpcyAoZm9yIGV4YW1wbGUsIHVzaW5nIHRoZSBgc3Z5Z2xtYCBmdW5jdGlvbiB0byBjYWxjdWxhdGUgc3VydmV5LXdlaWdodGVkIGxvZ2lzdGljIHJlZ3Jlc3Npb24gZXN0aW1hdGVzKS4NCg0KPC9kaXY+DQoNCg0KIyMgKipBZGRpdGlvbmFsIEluZm9ybWF0aW9uKioNCioqKiANCg0KIyMjICoqSGVscGZ1bCBMaW5rcyoqDQoqKioNCg0KW1RpZHl2ZXJzZV0oaHR0cHM6Ly93d3cudGlkeXZlcnNlLm9yZy8pe3RhcmdldD0iX2JsYW5rIn0gIA0KW1dyaXRpbmcgZnVuY3Rpb25zXShodHRwczovL3I0ZHMuaGFkLmNvLm56L2Z1bmN0aW9ucy5odG1sKXt0YXJnZXQ9Il9ibGFuayJ9ICAgDQpbQ29kZWJvb2tzXShodHRwczovL3d3dy5saWIubmNzdS5lZHUvZGF0YS9pY3BzcmZhcSN3aGF0YXJlKXt0YXJnZXQ9Il9ibGFuayJ9ICANCltMb25naXR1ZGluYWwgc3R1ZGllc10oaHR0cHM6Ly93d3cuYm1qLmNvbS9hYm91dC1ibWovcmVzb3VyY2VzLXJlYWRlcnMvcHVibGljYXRpb25zL2VwaWRlbWlvbG9neS11bmluaXRpYXRlZC83LWxvbmdpdHVkaW5hbC1zdHVkaWVzKXt0YXJnZXQ9Il9ibGFuayJ9ICAgDQpbUGFuZWwgZGF0YV0oaHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvUGFuZWxfZGF0YSl7dGFyZ2V0PSJfYmxhbmsifSAgICANCltDcm9zcy1zZWN0aW9uYWwgZGF0YV0oaHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvQ3Jvc3Mtc2VjdGlvbmFsX2RhdGEpe3RhcmdldD0iX2JsYW5rIn0gICAgDQpbU3VydmV5IHdlaWdodGluZ10oaHR0cDovL3d3dy5hcHBsaWVkLXN1cnZleS1tZXRob2RzLmNvbS93ZWlnaHQuaHRtbCl7dGFyZ2V0PSJfYmxhbmsifSAgDQpbQ29uZmlkZW5jZSBpbnRlcnZhbHNdKGh0dHBzOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL0NvbmZpZGVuY2VfaW50ZXJ2YWwpe3RhcmdldD0iX2JsYW5rIn0gICANCltJbnRyb2R1Y3Rpb24gdG8gTG9nYXJpdGhtc10oaHR0cHM6Ly93d3cubWF0aHNpc2Z1bi5jb20vYWxnZWJyYS9sb2dhcml0aG1zLmh0bWwpe3RhcmdldD0iX2JsYW5rIn0gICANCltMb2dhcml0aG1dKGh0dHBzOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL0xvZ2FyaXRobSl7dGFyZ2V0PSJfYmxhbmsifSANCltSdWxlcyBvZiBsb2dzXShodHRwczovL3d3dy5yYXBpZHRhYmxlcy5jb20vbWF0aC9hbGdlYnJhL0xvZ2FyaXRobS5odG1sI2xvZy1ydWxlcyl7dGFyZ2V0PSJfYmxhbmsifSBbT2RkcyByYXRpb10oaHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvT2Rkc19yYXRpbyl7dGFyZ2V0PSJfYmxhbmsifSAgICANCltMb2cgb2Rkc10oaHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvTG9naXQpe3RhcmdldD0iX2JsYW5rIn0gICANClsyeDIgdGFibGVdKGh0dHBzOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL0NvbnRpbmdlbmN5X3RhYmxlKXt0YXJnZXQ9Il9ibGFuayJ9ICANCltQcm9iYWJpbGl0eV0oaHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvUHJvYmFiaWxpdHkpe3RhcmdldD0iX2JsYW5rIn0gICANCltMaWtlbGlob29kIGZ1bmN0aW9uXShodHRwczovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9MaWtlbGlob29kX2Z1bmN0aW9uKXt0YXJnZXQ9Il9ibGFuayJ9ICAgDQpbTWF4aW11bSBsaWtlbGlob29kIGVzdGltYXRlc10oaHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvTWF4aW11bV9saWtlbGlob29kX2VzdGltYXRpb24pe3RhcmdldD0iX2JsYW5rIn0gICANCltMaW5lYXIgcmVncmVzc2lvbiBtb2RlbF0oaHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvTGluZWFyX3JlZ3Jlc3Npb24pe3RhcmdldD0iX2JsYW5rIn0gICANCltMb2dpc3RpYyByZWdyZXNzaW9uXShodHRwczovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9Mb2dpc3RpY19yZWdyZXNzaW9uKXt0YXJnZXQ9Il9ibGFuayJ9ICAgDQpbUXVhc2ktbGlrZWxpaG9vZF0oaHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvUXVhc2ktbGlrZWxpaG9vZCl7dGFyZ2V0PSJfYmxhbmsifSAgIA0KW0Jpbm9taWFsIGRpc3RyaWJ1dGlvbl0oaHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvQmlub21pYWxfZGlzdHJpYnV0aW9uKXt0YXJnZXQ9Il9ibGFuayJ9ICAgDQoNCkZvciBtb3JlIGluZm9ybWF0aW9uIG9uIGxpbmVhciByZWdyZXNzaW9uIHNlZSB0aGlzIFtib29rXShodHRwczovL3JhZmFsYWIuZ2l0aHViLmlvL2RzYm9vay9saW5lYXItbW9kZWxzLmh0bWwjbGluZWFyLXJlZ3Jlc3Npb24taW4tdGhlLXRpZHl2ZXJzZSl7dGFyZ2V0PSJfYmxhbmsifSBhbmQgdGhpcyBbY2FzZSBzdHVkeV0oaHR0cHM6Ly9vcGVuY2FzZXN0dWRpZXMuZ2l0aHViLmlvL29jcy1icC1kaWV0Lyl7dGFyZ2V0PSJfYmxhbmsifS4NCg0KRm9yIG1vcmUgaW5mb3JtYXRpb24gb24gc3VydmV5IGRlc2lnbnMgc2VlIFtoZXJlXShodHRwOi8vd3d3LmFzYXNybXMub3JnL1Byb2NlZWRpbmdzL3kyMDA4L0ZpbGVzLzMwMTgzNS5wZGYpe3RhcmdldD0iX2JsYW5rIn0gYW5kIFtoZXJlXShodHRwOi8vb2N3Lmpoc3BoLmVkdS9jb3Vyc2VzL1N0YXRNZXRob2RzRm9yU2FtcGxlU3VydmV5cy9QREZzL0xlY3R1cmU1LnBkZil7dGFyZ2V0PSJfYmxhbmsifS4gIA0KDQpGb3IgbW9yZSBpbmZvcm1hdGlvbiBvbiBzdXJ2ZXkgYW5hbHlzaXMgaW4gUiBbaGVyZV0oaHR0cHM6Ly9yLXN1cnZleS5yLWZvcmdlLnItcHJvamVjdC5vcmcvc3VydmV5L2V4bWFtcGxlLWxvbmVseS5odG1sKXt0YXJnZXQ9Il9ibGFuayJ9IGFuZCBbaGVyZV0oaHR0cDovL3Itc3VydmV5LnItZm9yZ2Uuci1wcm9qZWN0Lm9yZy9zdXJ2ZXkvaHRtbC9zdXJ2ZXlvcHRpb25zLmh0bWwpe3RhcmdldD0iX2JsYW5rIn0uICAgDQoNCklmIHlvdSBhcmUgaW50ZXJlc3RlZCBpbiBhbiBpbmZvLWdyYXBoaWMgc3VtbWFyeSBvZiB0aGUgMjAxOSBmaW5kaW5ncywgYW5kIGxpbmtzIHRvIG1hbnkgbW9yZSByZXNvdXJjZXMgYWJvdXQgdGhpcyB0b3BpYyBhbmQgZGF0YXNldCwgc2VlIHRoZSBGREEncyB3ZWJzaXRlIFtoZXJlXShodHRwczovL3d3dy5mZGEuZ292L3RvYmFjY28tcHJvZHVjdHMveW91dGgtYW5kLXRvYmFjY28veW91dGgtdG9iYWNjby11c2UtcmVzdWx0cy1uYXRpb25hbC15b3V0aC10b2JhY2NvLXN1cnZleSl7dGFyZ2V0PSJfYmxhbmsifS4NCg0KPHU+KipQYWNrYWdlcyB1c2VkIGluIHRoaXMgY2FzZSBzdHVkeToqKjwvdT4NCg0KUGFja2FnZSAgIHwgVXNlIGluIHRoaXMgY2FzZSBzdHVkeSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgDQotLS0tLS0tLS0tIHwtLS0tLS0tLS0tLS0tDQpbaGVyZV0oaHR0cHM6Ly9naXRodWIuY29tL2plbm55YmMvaGVyZV9oZXJlKXt0YXJnZXQ9Il9ibGFuayJ9ICAgICAgIHwgdG8gZWFzaWx5IGxvYWQgYW5kIHNhdmUgZGF0YSAgDQpbcmVhZHhsXShodHRwczovL3JlYWR4bC50aWR5dmVyc2Uub3JnLyl7dGFyZ2V0PSJfYmxhbmsifSAgICAgIHwgdG8gaW1wb3J0IHRoZSBkYXRhIGluIHRoZSBleGNlbCBmaWxlcyANClttYWdyaXR0cl0oaHR0cHM6Ly9jcmFuLnItcHJvamVjdC5vcmcvd2ViL3BhY2thZ2VzL21hZ3JpdHRyL3ZpZ25ldHRlcy9tYWdyaXR0ci5odG1sKXt0YXJnZXQ9Il9ibGFuayJ9IHwgdG8gdXNlIHRoZSBjb21wb3VuZCBhc3NpZ25tZW50IHBpcGUgb3BlcmF0b3IgYCU8PiVgDQpbc3RyaW5ncl0oaHR0cHM6Ly9zdHJpbmdyLnRpZHl2ZXJzZS5vcmcvYXJ0aWNsZXMvc3RyaW5nci5odG1sKXt0YXJnZXQ9Il9ibGFuayJ9ICAgIHwgdG8gbWFuaXB1bGF0ZSB0aGUgY2hhcmFjdGVyIHN0cmluZ3Mgd2l0aGluIHRoZSBkYXRhICANCltwdXJycl0oaHR0cHM6Ly9wdXJyci50aWR5dmVyc2Uub3JnLyl7dGFyZ2V0PSJfYmxhbmsifSAgIHwgdG8gaW1wb3J0IHRoZSBkYXRhIGluIGFsbCB0aGUgZGlmZmVyZW50IGV4Y2VsIGFuZCBjc3YgZmlsZXMgZWZmaWNpZW50bHkNCltkcGx5cl0oaHR0cHM6Ly9kcGx5ci50aWR5dmVyc2Uub3JnLyl7dGFyZ2V0PSJfYmxhbmsifSAgICAgIHwgdG8gYXJyYW5nZS9maWx0ZXIvc2VsZWN0L2NvbXBhcmUgc3BlY2lmaWMgc3Vic2V0cyBvZiB0aGUgZGF0YSAgDQpbcmVhZHJdKGh0dHBzOi8vcmVhZHIudGlkeXZlcnNlLm9yZy8pe3RhcmdldD0iX2JsYW5rIn0gICAgICB8IHRvIGltcG9ydCB0aGUgQ1NWIGZpbGUgZGF0YQ0KW3RpZHlyXShodHRwczovL3RpZHlyLnRpZHl2ZXJzZS5vcmcvKXt0YXJnZXQ9Il9ibGFuayJ9ICAgICAgfCB0byByZWFycmFuZ2UgZGF0YSBpbiB3aWRlIGFuZCBsb25nIGZvcm1hdHMgDQpbZ2dwbG90Ml0oaHR0cHM6Ly9nZ3Bsb3QyLnRpZHl2ZXJzZS5vcmcvKXt0YXJnZXQ9Il9ibGFuayJ9ICAgIHwgdG8gbWFrZSB2aXN1YWxpemF0aW9ucyB3aXRoIG11bHRpcGxlIGxheWVycw0KW3NjYWxlc10oaHR0cHM6Ly9jcmFuLnItcHJvamVjdC5vcmcvd2ViL3BhY2thZ2VzL3NjYWxlcy9zY2FsZXMucGRmKXt0YXJnZXQ9Il9ibGFuayJ9ICAgIHwgdG8gYWxsb3cgdXMgdG8gbG9vayBhdCB0aGUgY29sb3JzIHdpdGhpbiB0aGUgdmlyaWRpcyBwYWNrYWdlDQpbdmlyaWRpc10oaHR0cHM6Ly9jcmFuLnItcHJvamVjdC5vcmcvd2ViL3BhY2thZ2VzL3ZpcmlkaXMvdmlnbmV0dGVzL2ludHJvLXRvLXZpcmlkaXMuaHRtbCl7dGFyZ2V0PSJfYmxhbmsifSAgICB8IHRvIG1ha2UgcGxvdHMgd2l0aCBhIGNvbG9yIHBhbGV0dGUgdGhhdCBpcyBjb21wYXRpYmxlIHdpdGggY29sb3IgYmxpbmRuZXNzDQpbZm9yY2F0c10oaHR0cHM6Ly9mb3JjYXRzLnRpZHl2ZXJzZS5vcmcvKXt0YXJnZXQ9Il9ibGFuayJ9ICAgIHwgdG8gYWxsb3cgZm9yIHJlb3JkZXJpbmcgb2YgZmFjdG9ycyBpbiBwbG90cw0KW25hbmlhcl0oaHR0cHM6Ly9jcmFuLnItcHJvamVjdC5vcmcvd2ViL3BhY2thZ2VzL25hbmlhci92aWduZXR0ZXMvZ2V0dGluZy1zdGFydGVkLXctbmFuaWFyLmh0bWwpe3RhcmdldD0iX2JsYW5rIn0gIHwgdG8gbWFrZSBhIHZpc3VhbGl6YXRpb24gb2YgbWlzc2luZyBkYXRhDQpbc3lydnJdKGh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9zcnZ5ci9zcnZ5ci5wZGYpe3RhcmdldD0iX2JsYW5rIn0gfCB0byB1c2Ugc3VydmV5IHdlaWdodHMNCltjb3dwbG90XShodHRwczovL2NyYW4uci1wcm9qZWN0Lm9yZy93ZWIvcGFja2FnZXMvY293cGxvdC92aWduZXR0ZXMvaW50cm9kdWN0aW9uLmh0bWwpe3RhcmdldD0iX2JsYW5rIn0gfCB0byBhbGxvdyBwbG90cyB0byBiZSBjb21iaW5lZCANClticm9vbV0oaHR0cHM6Ly9jcmFuLnItcHJvamVjdC5vcmcvd2ViL3BhY2thZ2VzL2Jyb29tL3ZpZ25ldHRlcy9icm9vbS5odG1sKXt0YXJnZXQ9Il9ibGFuayJ9IHwgdG8gY3JlYXRlIG5pY2VseSBmb3JtYXR0ZWQgbW9kZWwgb3V0cHV0DQpbc3VydmV5XShodHRwOi8vci1zdXJ2ZXkuci1mb3JnZS5yLXByb2plY3Qub3JnL3N1cnZleS9pbmRleC5odG1sKXt0YXJnZXQ9Il9ibGFuayJ9IHwgdG8gZml0IHN1cnZleS13ZWlnaHRlZCBsb2dpc3RpYyByZWdyZXNzaW9uDQoNCiMjIyAqKlNlc3Npb24gaW5mbyoqDQoqKioNCg0KYGBge3J9DQpzZXNzaW9uSW5mbygpDQpgYGANCg0KIyMjICoqQWNrbm93bGVkZ21lbnRzKioNCioqKg0KDQpXZSB3b3VsZCBsaWtlIHRvIGFja25vd2xlZGdlIFtSZW5lZSBKb2huc29uXShodHRwczovL3d3dy5qaHNwaC5lZHUvZmFjdWx0eS9kaXJlY3RvcnkvcHJvZmlsZS8yODQ4L3JlbmVlLW0tam9obnNvbikgZm9yIGFzc2lzdGluZyBpbiBmcmFtaW5nIHRoZSBtYWpvciBkaXJlY3Rpb24gb2YgdGhlIGNhc2Ugc3R1ZHkgYW5kIGZvciByZXZpZXdpbmcgdGhlIGNhc2Ugc3R1ZHkgZm9yIHN1YmplY3QgbWF0dGVyIGNvbnRlbnQuDQoNCldlIHdvdWxkIGFsc28gbGlrZSB0byBhY2tub3dsZWRnZSB0aGUgW0Jsb29tYmVyZyBBbWVyaWNhbiBIZWFsdGggSW5pdGlhdGl2ZV0oaHR0cHM6Ly9hbWVyaWNhbmhlYWx0aC5qaHUuZWR1LykgZm9yIGZ1bmRpbmcgdGhpcyB3b3JrLiANCg0KPHNjcmlwdCB0eXBlPSd0ZXh0L2phdmFzY3JpcHQnIGlkPSdjbHVzdHJtYXBzJyBzcmM9Jy8vY2RuLmNsdXN0cm1hcHMuY29tL21hcF92Mi5qcz9jbD0wODA4MDgmdz1hJnQ9dHQmZD10eWdEWV9UYkc3WEUySFZVQzZFb3g2Wjc0aTJFNU1VQnFDQTgzUGdKOVNZJmNvPWZmZmZmZiZjbW89M2FjYzNhJmNtbj1mZjUzNTMmY3Q9ODA4MDgwJz48L3NjcmlwdD4NCg0K</div>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("section-TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("index.Rmd");
});
</script>

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#section-TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
